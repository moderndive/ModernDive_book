<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>B Inference Examples | Statistical Inference via Data Science</title>
<meta name="author" content="Chester Ismay, Albert Y. Kim, and Arturo Valdivia   Foreword by Kelly S. McConville">
<meta name="description" content="This appendix is designed to provide you with examples of the five basic hypothesis tests and their corresponding confidence intervals. Traditional theory-based methods as well as...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="B Inference Examples | Statistical Inference via Data Science">
<meta property="og:type" content="book">
<meta property="og:description" content="This appendix is designed to provide you with examples of the five basic hypothesis tests and their corresponding confidence intervals. Traditional theory-based methods as well as...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="B Inference Examples | Statistical Inference via Data Science">
<meta name="twitter:site" content="@ModernDive">
<meta name="twitter:description" content="This appendix is designed to provide you with examples of the five basic hypothesis tests and their corresponding confidence intervals. Traditional theory-based methods as well as...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YVFBK9P73R"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-YVFBK9P73R');
    </script><!-- Open Graph Meta Tags --><meta property="og:title" content="ModernDive V2">
<meta property="og:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools.">
<meta property="og:image" content="https://moderndive.com/v2/images/logos/v2_cover.jpg">
<meta property="og:url" content="https://moderndive.com/v2/appendixB.html">
<meta name="twitter:card" content="summary_large_image">
<!-- Set up favicon --><link rel="icon" href="images/logos/favicons/favicon.ico" type="image/x-icon">
<!-- Redirect to ModernDive V2 --><script>
      if (window.location.pathname === '/v2') {
        window.location.replace(window.location.pathname + '/');
      }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="A ModernDive into R and the Tidyverse &lt;br&gt; (Second Edition)">Statistical Inference via Data Science</a>:
        <small class="text-muted">A ModernDive into R and the Tidyverse <br> (Second Edition)</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to ModernDive (v2)</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="about-the-authors.html">About the authors</a></li>
<li><a class="" href="getting-started.html"><span class="header-section-number">1</span> Getting Started with Data in R</a></li>
<li class="book-part">Data Science with tidyverse</li>
<li><a class="" href="viz.html"><span class="header-section-number">2</span> Data Visualization</a></li>
<li><a class="" href="wrangling.html"><span class="header-section-number">3</span> Data Wrangling</a></li>
<li><a class="" href="tidy.html"><span class="header-section-number">4</span> Data Importing and Tidy Data</a></li>
<li class="book-part">Statistical Modeling with moderndive</li>
<li><a class="" href="regression.html"><span class="header-section-number">5</span> Simple Linear Regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">6</span> Multiple Regression</a></li>
<li class="book-part">Statistical Inference with infer</li>
<li><a class="" href="sampling.html"><span class="header-section-number">7</span> Sampling</a></li>
<li><a class="" href="confidence-intervals.html"><span class="header-section-number">8</span> Estimation, Confidence Intervals, and Bootstrapping</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">9</span> Hypothesis Testing</a></li>
<li><a class="" href="inference-for-regression.html"><span class="header-section-number">10</span> Inference for Regression</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="thinking-with-data.html"><span class="header-section-number">11</span> Tell Your Story with Data</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="appendixA.html"><span class="header-section-number">A</span> Statistical Background</a></li>
<li><a class="active" href="appendixB.html"><span class="header-section-number">B</span> Inference Examples</a></li>
<li><a class="" href="appendixC.html"><span class="header-section-number">C</span> Tips and Tricks</a></li>
<li><a class="" href="the-theory-behind-the-bootstrap-method.html"><span class="header-section-number">D</span> The Theory Behind the Bootstrap Method</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/moderndive/ModernDive_book/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><img src="https://moderndive.com/wide_format.png" alt="ModernDive" style="max-width: 100%; width: 100%; height: auto; display: block; margin: 0 auto; padding-top: 10px;"><div id="appendixB" class="section level1" number="13">
<h1>
<span class="header-section-number">B</span> Inference Examples<a class="anchor" aria-label="anchor" href="#appendixB"><i class="fas fa-link"></i></a>
</h1>
<p>This appendix is designed to provide you with examples of the five basic hypothesis tests and their corresponding confidence intervals. Traditional theory-based methods as well as computational-based methods are presented. <!-- You can also use this appendix as a way to check for understanding of which statistical graphic is most appropriate given the problem set-up. --></p>
<div class="learncheck">
<p>
<strong>Note: This appendix is still under construction. If you would
like to contribute, please check us out on GitHub at <a href="https://github.com/moderndive/moderndive_book" class="uri">https://github.com/moderndive/moderndive_book</a>.</strong>
</p>
</div>
<div id="needed-packages-1" class="section level3 unnumbered">
<h3>Needed packages<a class="anchor" aria-label="anchor" href="#needed-packages-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb592"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div id="inference-mind-map" class="section level2" number="13.1">
<h2>
<span class="header-section-number">B.1</span> Inference mind map<a class="anchor" aria-label="anchor" href="#inference-mind-map"><i class="fas fa-link"></i></a>
</h2>
<p>To help you better navigate and choose the appropriate analysis, we’ve created a mind map on <a href="http://coggle.it" class="uri">http://coggle.it</a> available <a href="https://coggle.it/diagram/Vxlydu1akQFeqo6-">here</a> and below.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:infer-map"></span>
<iframe src="https://coggle.it/diagram/Vxlydu1akQFeqo6-" width="100%" height="1200pt" data-external="1">
</iframe>
<p class="caption">
FIGURE B.1: Mind map for Inference.
</p>
</div>
</div>
<div id="one-mean" class="section level2" number="13.2">
<h2>
<span class="header-section-number">B.2</span> One mean<a class="anchor" aria-label="anchor" href="#one-mean"><i class="fas fa-link"></i></a>
</h2>
<div id="problem-statement" class="section level3" number="13.2.1">
<h3>
<span class="header-section-number">B.2.1</span> Problem statement<a class="anchor" aria-label="anchor" href="#problem-statement"><i class="fas fa-link"></i></a>
</h3>
<p>The National Survey of Family Growth conducted by the
Centers for Disease Control gathers information on family life, marriage and divorce, pregnancy,
infertility, use of contraception, and men’s and women’s health. One of the variables collected on
this survey is the age at first marriage. 5,534 randomly sampled US women between 2006 and 2010 completed the survey. The women sampled here had been married at least once. Do we have evidence that the mean age of first marriage for all US women from 2006 to 2010 is greater than 23 years? <span class="citation">(Tweaked a bit from <a href="references.html#ref-isrs2014">Diez, Barr, and Çetinkaya-Rundel 2014</a> [Chapter 4])</span></p>
</div>
<div id="competing-hypotheses" class="section level3" number="13.2.2">
<h3>
<span class="header-section-number">B.2.2</span> Competing hypotheses<a class="anchor" aria-label="anchor" href="#competing-hypotheses"><i class="fas fa-link"></i></a>
</h3>
<div id="in-words" class="section level4 unnumbered">
<h4>In words<a class="anchor" aria-label="anchor" href="#in-words"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Null hypothesis: The mean age of first marriage for all US women from 2006 to 2010 is equal to 23 years.</li>
<li>Alternative hypothesis: The mean age of first marriage for all US women from 2006 to 2010 is greater than 23 years.</li>
</ul>
</div>
<div id="in-symbols-with-annotations" class="section level4 unnumbered">
<h4>In symbols (with annotations)<a class="anchor" aria-label="anchor" href="#in-symbols-with-annotations"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<span class="math inline">\(H_0: \mu = \mu_{0}\)</span>, where <span class="math inline">\(\mu\)</span> represents the mean age of first marriage for all US women from 2006 to 2010 and <span class="math inline">\(\mu_0\)</span> is 23.</li>
<li><span class="math inline">\(H_A: \mu &gt; 23\)</span></li>
</ul>
</div>
<div id="set-alpha" class="section level4 unnumbered">
<h4>Set <span class="math inline">\(\alpha\)</span><a class="anchor" aria-label="anchor" href="#set-alpha"><i class="fas fa-link"></i></a>
</h4>
<p>It’s important to set the significance level before starting the testing using the data. Let’s set the significance level at 5% here.</p>
</div>
</div>
<div id="exploring-the-sample-data" class="section level3" number="13.2.3">
<h3>
<span class="header-section-number">B.2.3</span> Exploring the sample data<a class="anchor" aria-label="anchor" href="#exploring-the-sample-data"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb593"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age_at_marriage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://moderndive.com/data/ageAtMar.csv"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb594"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age_summ</span> <span class="op">&lt;-</span> <span class="va">age_at_marriage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    sample_size <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,</span>
<span>    minimum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,</span>
<span>    lower_quartile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>,</span>
<span>    upper_quartile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">age</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">age_summ</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span></span>
<span>    font_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/output_type.html">is_latex_output</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span>,</span>
<span>    latex_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hold_position"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
sample_size
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
minimum
</th>
<th style="text-align:right;">
lower_quartile
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
upper_quartile
</th>
<th style="text-align:right;">
max
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:right;">
5534
</td>
<td style="text-align:right;">
23.4
</td>
<td style="text-align:right;">
4.72
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
43
</td>
</tr></tbody>
</table></div>
<p>The histogram below also shows the distribution of <code>age</code>.</p>
<div class="sourceCode" id="cb595"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">age_at_marriage</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/hist1b-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>The observed statistic of interest here is the sample mean:</p>
<div class="sourceCode" id="cb596"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_bar</span> <span class="op">&lt;-</span> <span class="va">age_at_marriage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">age</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span><span class="va">x_bar</span></span></code></pre></div>
<pre><code>Response: age (numeric)
# A tibble: 1 × 1
     stat
    &lt;dbl&gt;
1 23.4402</code></pre>
<div id="guess-about-statistical-significance" class="section level4 unnumbered">
<h4>Guess about statistical significance<a class="anchor" aria-label="anchor" href="#guess-about-statistical-significance"><i class="fas fa-link"></i></a>
</h4>
<p>We are looking to see if the observed sample mean of 23.44 is statistically greater than <span class="math inline">\(\mu_0 = 23\)</span>. They seem to be quite close, but we have a large sample size here. Let’s guess that the large sample size will lead us to reject this practically small difference.</p>
</div>
</div>
<div id="non-traditional-methods" class="section level3" number="13.2.4">
<h3>
<span class="header-section-number">B.2.4</span> Non-traditional methods<a class="anchor" aria-label="anchor" href="#non-traditional-methods"><i class="fas fa-link"></i></a>
</h3>
<div id="bootstrapping-for-hypothesis-test" class="section level4 unnumbered">
<h4>Bootstrapping for hypothesis test<a class="anchor" aria-label="anchor" href="#bootstrapping-for-hypothesis-test"><i class="fas fa-link"></i></a>
</h4>
<p>In order to look to see if the observed sample mean of 23.44 is statistically greater than <span class="math inline">\(\mu_0 = 23\)</span>, we need to account for the sample size. We also need to determine a process that replicates how the original sample of size 5534 was selected.</p>
<p>We can use the idea of <em>bootstrapping</em> to simulate the population from which the sample came and then generate samples from that simulated population to account for sampling variability. Recall how bootstrapping would apply in this context:</p>
<ol style="list-style-type: decimal">
<li>Sample with replacement from our original sample of 5534 women and repeat this process 10,000 times,</li>
<li>calculate the mean for each of the 10,000 bootstrap samples created in Step 1,</li>
<li>combine all of these bootstrap statistics calculated in Step 2 into a <code>boot_distn</code> object, and</li>
<li>shift the center of this distribution over to the null value of 23. (This is needed since it will be centered at 23.44 via the process of bootstrapping.)</li>
</ol>
<div class="sourceCode" id="cb598"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2018</span><span class="op">)</span></span>
<span><span class="va">null_distn_one_mean</span> <span class="op">&lt;-</span> <span class="va">age_at_marriage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">age</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"point"</span>, mu <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb599"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_distn_one_mean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-656-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We can next use this distribution to observe our <span class="math inline">\(p\)</span>-value. Recall this is a right-tailed test so we will be looking for values that are greater than or equal to 23.44 for our <span class="math inline">\(p\)</span>-value.</p>
<div class="sourceCode" id="cb600"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_distn_one_mean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">x_bar</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-657-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div id="calculate-p-value" class="section level5 unnumbered">
<h5>Calculate <span class="math inline">\(p\)</span>-value<a class="anchor" aria-label="anchor" href="#calculate-p-value"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb601"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="va">null_distn_one_mean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_pvalue</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">x_bar</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span>
<span><span class="va">pvalue</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
<p>So our <span class="math inline">\(p\)</span>-value is 0 and we reject the null hypothesis at the 5% level. You can also see this from the histogram above that we are far into the tail of the null distribution.</p>
</div>
</div>
<div id="bootstrapping-for-confidence-interval" class="section level4 unnumbered">
<h4>Bootstrapping for confidence interval<a class="anchor" aria-label="anchor" href="#bootstrapping-for-confidence-interval"><i class="fas fa-link"></i></a>
</h4>
<p>We can also create a confidence interval for the unknown population parameter <span class="math inline">\(\mu\)</span> using our sample data using <em>bootstrapping</em>. Note that we don’t need to shift this distribution since we want the center of our confidence interval to be our point estimate <span class="math inline">\(\bar{x}_{obs} = 23.44\)</span>.</p>
<div class="sourceCode" id="cb603"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_distn_one_mean</span> <span class="op">&lt;-</span> <span class="va">age_at_marriage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">age</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb604"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="va">boot_distn_one_mean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_confidence_interval.html">get_ci</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ci</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1  23.3148  23.5669</code></pre>
<div class="sourceCode" id="cb606"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_distn_one_mean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_confidence_interval.html">shade_ci</a></span><span class="op">(</span>endpoints <span class="op">=</span> <span class="va">ci</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-661-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We see that 23 is not contained in this confidence interval as a plausible value of <span class="math inline">\(\mu\)</span> (the unknown population mean) and the entire interval is larger than 23. This matches with our hypothesis test results of rejecting the null hypothesis in favor of the alternative (<span class="math inline">\(\mu &gt; 23\)</span>).</p>
<p><strong>Interpretation</strong>: We are 95% confident the true mean age of first marriage for all US women from 2006 to 2010 is between 23.315 and 23.567.</p>
</div>
</div>
<div id="traditional-methods" class="section level3" number="13.2.5">
<h3>
<span class="header-section-number">B.2.5</span> Traditional methods<a class="anchor" aria-label="anchor" href="#traditional-methods"><i class="fas fa-link"></i></a>
</h3>
<div id="check-conditions" class="section level4 unnumbered">
<h4>Check conditions<a class="anchor" aria-label="anchor" href="#check-conditions"><i class="fas fa-link"></i></a>
</h4>
<p>Remember that in order to use the shortcut (formula-based, theoretical) approach, we need to check that some conditions are met.</p>
<ol style="list-style-type: decimal">
<li>
<p><em>Independent observations</em>: The observations are collected independently.</p>
<p>The cases are selected independently through random sampling so this condition is met.</p>
</li>
<li>
<p><em>Approximately normal</em>: The distribution of the response variable should be normal or the sample size should be at least 30.</p>
<p>The histogram for the sample above does show some skew.</p>
</li>
</ol>
<p>The Q-Q plot below also shows some skew.</p>
<div class="sourceCode" id="cb607"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">age_at_marriage</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/qqplotmean-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>The sample size here is quite large though (<span class="math inline">\(n = 5534\)</span>) so both conditions are met.</p>
</div>
<div id="test-statistic" class="section level4 unnumbered">
<h4>Test statistic<a class="anchor" aria-label="anchor" href="#test-statistic"><i class="fas fa-link"></i></a>
</h4>
<p>The test statistic is a random variable based on the sample data. Here, we want to look at a way to estimate the population mean <span class="math inline">\(\mu\)</span>. A good guess is the sample mean <span class="math inline">\(\bar{X}\)</span>. Recall that this sample mean is actually a random variable that will vary as different samples are (theoretically, would be) collected. We are looking to see how likely is it for us to have observed a sample mean of <span class="math inline">\(\bar{x}_{obs} = 23.44\)</span> or larger assuming that the population mean is 23 (assuming the null hypothesis is true). If the conditions are met and assuming <span class="math inline">\(H_0\)</span> is true, we can “standardize” this original test statistic of <span class="math inline">\(\bar{X}\)</span> into a <span class="math inline">\(T\)</span> statistic that follows a <span class="math inline">\(t\)</span> distribution with degrees of freedom equal to <span class="math inline">\(df = n - 1\)</span>:</p>
<p><span class="math display">\[ T =\dfrac{ \bar{X} - \mu_0}{ S / \sqrt{n} } \sim t (df = n - 1) \]</span></p>
<p>where <span class="math inline">\(S\)</span> represents the standard deviation of the sample and <span class="math inline">\(n\)</span> is the sample size.</p>
<div id="observed-test-statistic" class="section level5 unnumbered">
<h5>Observed test statistic<a class="anchor" aria-label="anchor" href="#observed-test-statistic"><i class="fas fa-link"></i></a>
</h5>
<p>While one could compute this observed test statistic by “hand”, the focus here is on the set-up of the problem and in understanding which formula for the test statistic applies. We can use the <code><a href="https://infer.tidymodels.org/reference/t_test.html">t_test()</a></code> function to perform this analysis for us.</p>
<div class="sourceCode" id="cb608"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_test_results</span> <span class="op">&lt;-</span> <span class="va">age_at_marriage</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/t_test.html">t_test</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">age</span> <span class="op">~</span> <span class="cn">NULL</span>,</span>
<span>    alternative <span class="op">=</span> <span class="st">"greater"</span>,</span>
<span>    mu <span class="op">=</span> <span class="fl">23</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">t_test_results</span></span></code></pre></div>
<pre><code># A tibble: 1 × 7
  statistic  t_df     p_value alternative estimate lower_ci upper_ci
      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1   6.93570  5533 2.25216e-12 greater      23.4402  23.3358      Inf</code></pre>
<p>We see here that the <span class="math inline">\(t_{obs}\)</span> value is 6.936.</p>
</div>
</div>
<div id="compute-p-value" class="section level4 unnumbered">
<h4>Compute <span class="math inline">\(p\)</span>-value<a class="anchor" aria-label="anchor" href="#compute-p-value"><i class="fas fa-link"></i></a>
</h4>
<p>The <span class="math inline">\(p\)</span>-value—the probability of observing an <span class="math inline">\(t_{obs}\)</span> value of 6.936 or more in our null distribution of a <span class="math inline">\(t\)</span> with 5533 degrees of freedom—is essentially 0.</p>
</div>
<div id="state-conclusion" class="section level4 unnumbered">
<h4>State conclusion<a class="anchor" aria-label="anchor" href="#state-conclusion"><i class="fas fa-link"></i></a>
</h4>
<p>We, therefore, have sufficient evidence to reject the null hypothesis. Our initial guess that our observed sample mean was statistically greater than the hypothesized mean has supporting evidence here. Based on this sample, we have evidence that the mean age of first marriage for all US women from 2006 to 2010 is greater than 23 years.</p>
</div>
<div id="confidence-interval" class="section level4 unnumbered">
<h4>Confidence interval<a class="anchor" aria-label="anchor" href="#confidence-interval"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb610"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">age_at_marriage</span><span class="op">$</span><span class="va">age</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">23</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">conf</span></span></code></pre></div>
<pre><code>[1] 23.3 23.6
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
<div id="comparing-results" class="section level3" number="13.2.6">
<h3>
<span class="header-section-number">B.2.6</span> Comparing results<a class="anchor" aria-label="anchor" href="#comparing-results"><i class="fas fa-link"></i></a>
</h3>
<p>Observing the bootstrap distribution that were created, it makes quite a bit of sense that the results are so similar for traditional and non-traditional methods in terms of the <span class="math inline">\(p\)</span>-value and the confidence interval since these distributions look very similar to normal distributions. The conditions also being met (the large sample size was the driver here) leads us to better guess that using any of the methods whether they are traditional (formula-based) or non-traditional (computational-based) will lead to similar results.</p>
</div>
</div>
<div id="one-proportion" class="section level2" number="13.3">
<h2>
<span class="header-section-number">B.3</span> One proportion<a class="anchor" aria-label="anchor" href="#one-proportion"><i class="fas fa-link"></i></a>
</h2>
<div id="problem-statement-1" class="section level3" number="13.3.1">
<h3>
<span class="header-section-number">B.3.1</span> Problem statement<a class="anchor" aria-label="anchor" href="#problem-statement-1"><i class="fas fa-link"></i></a>
</h3>
<p>The CEO of a large electric utility claims that 80 percent of his 1,000,000 customers are satisfied with the service they receive. To test this claim, the local newspaper surveyed 100 customers, using simple random sampling. 73 were satisfied and the remaining were unsatisfied. Based on these findings from the sample, can we reject the CEO’s hypothesis that 80% of the customers are satisfied? [Tweaked a bit from <a href="http://stattrek.com/hypothesis-test/proportion.aspx?Tutorial=AP" class="uri">http://stattrek.com/hypothesis-test/proportion.aspx?Tutorial=AP</a>]</p>
</div>
<div id="competing-hypotheses-1" class="section level3" number="13.3.2">
<h3>
<span class="header-section-number">B.3.2</span> Competing hypotheses<a class="anchor" aria-label="anchor" href="#competing-hypotheses-1"><i class="fas fa-link"></i></a>
</h3>
<div id="in-words-1" class="section level4 unnumbered">
<h4>In words<a class="anchor" aria-label="anchor" href="#in-words-1"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Null hypothesis: The proportion of all customers of the large electric utility satisfied with service they receive is equal 0.80.</li>
<li>Alternative hypothesis: The proportion of all customers of the large electric utility satisfied with service they receive is different from 0.80.</li>
</ul>
</div>
<div id="in-symbols-with-annotations-1" class="section level4 unnumbered">
<h4>In symbols (with annotations)<a class="anchor" aria-label="anchor" href="#in-symbols-with-annotations-1"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<span class="math inline">\(H_0: \pi = p_{0}\)</span>, where <span class="math inline">\(\pi\)</span> represents the proportion of all customers of the large electric utility satisfied with service they receive and <span class="math inline">\(p_0\)</span> is 0.8.</li>
<li><span class="math inline">\(H_A: \pi \ne 0.8\)</span></li>
</ul>
</div>
<div id="set-alpha-1" class="section level4 unnumbered">
<h4>Set <span class="math inline">\(\alpha\)</span><a class="anchor" aria-label="anchor" href="#set-alpha-1"><i class="fas fa-link"></i></a>
</h4>
<p>It’s important to set the significance level before starting the testing using the data. Let’s set the significance level at 5% here.</p>
</div>
</div>
<div id="exploring-the-sample-data-1" class="section level3" number="13.3.3">
<h3>
<span class="header-section-number">B.3.3</span> Exploring the sample data<a class="anchor" aria-label="anchor" href="#exploring-the-sample-data-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb612"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"satisfied"</span>, <span class="fl">73</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"unsatisfied"</span>, <span class="fl">27</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html">enframe</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>satisfy <span class="op">=</span> <span class="va">value</span><span class="op">)</span></span></code></pre></div>
<p>The bar graph below also shows the distribution of <code>satisfy</code>.</p>
<div class="sourceCode" id="cb613"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">elec</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">satisfy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/bar-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>The observed statistic is computed as</p>
<div class="sourceCode" id="cb614"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_hat</span> <span class="op">&lt;-</span> <span class="va">elec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">satisfy</span>, success <span class="op">=</span> <span class="st">"satisfied"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span></span>
<span><span class="va">p_hat</span></span></code></pre></div>
<pre><code>Response: satisfy (factor)
# A tibble: 1 × 1
   stat
  &lt;dbl&gt;
1  0.73</code></pre>
<div id="guess-about-statistical-significance-1" class="section level4 unnumbered">
<h4>Guess about statistical significance<a class="anchor" aria-label="anchor" href="#guess-about-statistical-significance-1"><i class="fas fa-link"></i></a>
</h4>
<p>We are looking to see if the sample proportion of 0.73 is statistically different from <span class="math inline">\(p_0 = 0.8\)</span> based on this sample. They seem to be quite close, and our sample size is not huge here (<span class="math inline">\(n = 100\)</span>). Let’s guess that we do not have evidence to reject the null hypothesis.</p>
</div>
</div>
<div id="non-traditional-methods-1" class="section level3" number="13.3.4">
<h3>
<span class="header-section-number">B.3.4</span> Non-traditional methods<a class="anchor" aria-label="anchor" href="#non-traditional-methods-1"><i class="fas fa-link"></i></a>
</h3>
<div id="simulation-for-hypothesis-test" class="section level4 unnumbered">
<h4>Simulation for hypothesis test<a class="anchor" aria-label="anchor" href="#simulation-for-hypothesis-test"><i class="fas fa-link"></i></a>
</h4>
<p>In order to look to see if 0.73 is statistically different from 0.8, we need to account for the sample size. We also need to determine a process that replicates how the original sample of size 100 was selected. We can use the idea of an unfair coin to <em>simulate</em> this process. We will simulate flipping an unfair coin (with probability of success 0.8 matching the null hypothesis) 100 times. Then we will keep track of how many heads come up in those 100 flips. Our simulated statistic matches with how we calculated the original statistic <span class="math inline">\(\hat{p}\)</span>: the number of heads (satisfied) out of our total sample of 100. We then repeat this process many times (say 10,000) to create the null distribution looking at the simulated proportions of successes:</p>
<div class="sourceCode" id="cb616"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2018</span><span class="op">)</span></span>
<span><span class="va">null_distn_one_prop</span> <span class="op">&lt;-</span> <span class="va">elec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">satisfy</span>, success <span class="op">=</span> <span class="st">"satisfied"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"point"</span>, p <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb617"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_distn_one_prop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-664-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We can next use this distribution to observe our <span class="math inline">\(p\)</span>-value. Recall this is a two-tailed test so we will be looking for values that are 0.8 - 0.73 = 0.07 away from 0.8 in BOTH directions for our <span class="math inline">\(p\)</span>-value:</p>
<div class="sourceCode" id="cb618"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_distn_one_prop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">p_hat</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-665-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div id="calculate-p-value-1" class="section level5 unnumbered">
<h5>Calculate <span class="math inline">\(p\)</span>-value<a class="anchor" aria-label="anchor" href="#calculate-p-value-1"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb619"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="va">null_distn_one_prop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_pvalue</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">p_hat</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span>
<span><span class="va">pvalue</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1  0.1136</code></pre>
<p>So our <span class="math inline">\(p\)</span>-value is 0.114 and we fail to reject the null hypothesis at the 5% level.</p>
</div>
</div>
<div id="bootstrapping-for-confidence-interval-1" class="section level4 unnumbered">
<h4>Bootstrapping for confidence interval<a class="anchor" aria-label="anchor" href="#bootstrapping-for-confidence-interval-1"><i class="fas fa-link"></i></a>
</h4>
<p>We can also create a confidence interval for the unknown population parameter <span class="math inline">\(\pi\)</span> using our sample data. To do so, we use <em>bootstrapping</em>, which involves</p>
<ol style="list-style-type: decimal">
<li>sampling with replacement from our original sample of 100 survey respondents and repeating this process 10,000 times,</li>
<li>calculating the proportion of successes for each of the 10,000 bootstrap samples created in Step 1,</li>
<li>combining all of these bootstrap statistics calculated in Step 2 into a <code>boot_distn</code> object,</li>
<li>identifying the 2.5th and 97.5th percentiles of this distribution (corresponding to the 5% significance level chosen) to find a 95% confidence interval for <span class="math inline">\(\pi\)</span>, and</li>
<li>interpret this confidence interval in the context of the problem.</li>
</ol>
<div class="sourceCode" id="cb621"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_distn_one_prop</span> <span class="op">&lt;-</span> <span class="va">elec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">satisfy</span>, success <span class="op">=</span> <span class="st">"satisfied"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span></span></code></pre></div>
<p>Just as we use the <code>mean</code> function for calculating the mean over a numerical variable, we can also use it to compute the proportion of successes for a categorical variable where we specify what we are calling a “success” after the <code>==</code>. (Think about the formula for calculating a mean and how R handles logical statements such as <code>satisfy == "satisfied"</code> for why this must be true.)</p>
<div class="sourceCode" id="cb622"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="va">boot_distn_one_prop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_confidence_interval.html">get_ci</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ci</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1     0.64     0.81</code></pre>
<div class="sourceCode" id="cb624"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_distn_one_prop</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_confidence_interval.html">shade_ci</a></span><span class="op">(</span>endpoints <span class="op">=</span> <span class="va">ci</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-669-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We see that 0.80 is contained in this confidence interval as a plausible value of <span class="math inline">\(\pi\)</span> (the unknown population proportion). This matches with our hypothesis test results of failing to reject the null hypothesis.</p>
<p><strong>Interpretation</strong>: We are 95% confident the true proportion of customers who are satisfied with the service they receive is between 0.64 and 0.81.</p>
</div>
</div>
<div id="traditional-methods-1" class="section level3" number="13.3.5">
<h3>
<span class="header-section-number">B.3.5</span> Traditional methods<a class="anchor" aria-label="anchor" href="#traditional-methods-1"><i class="fas fa-link"></i></a>
</h3>
<div id="check-conditions-1" class="section level4 unnumbered">
<h4>Check conditions<a class="anchor" aria-label="anchor" href="#check-conditions-1"><i class="fas fa-link"></i></a>
</h4>
<p>Remember that in order to use the shortcut (formula-based, theoretical) approach, we need to check that some conditions are met.</p>
<ol style="list-style-type: decimal">
<li>
<p><em>Independent observations</em>: The observations are collected independently.</p>
<p>The cases are selected independently through random sampling so this condition is met.</p>
</li>
<li>
<p><em>Approximately normal</em>: The number of expected successes and expected failures is at least 10.</p>
<p>This condition is met since 73 and 27 are both greater than 10.</p>
</li>
</ol>
</div>
<div id="test-statistic-1" class="section level4 unnumbered">
<h4>Test statistic<a class="anchor" aria-label="anchor" href="#test-statistic-1"><i class="fas fa-link"></i></a>
</h4>
<p>The test statistic is a random variable based on the sample data. Here, we want to look at a way to estimate the population proportion <span class="math inline">\(\pi\)</span>. A good guess is the sample proportion <span class="math inline">\(\hat{P}\)</span>. Recall that this sample proportion is actually a random variable that will vary as different samples are (theoretically, would be) collected. We are looking to see how likely is it for us to have observed a sample proportion of <span class="math inline">\(\hat{p}_{obs} = 0.73\)</span> or more extreme assuming that the population proportion is 0.80 (assuming the null hypothesis is true). If the conditions are met and assuming <span class="math inline">\(H_0\)</span> is true, we can standardize this original test statistic of <span class="math inline">\(\hat{P}\)</span> into a <span class="math inline">\(Z\)</span> statistic that follows a <span class="math inline">\(N(0, 1)\)</span> distribution.</p>
<p><span class="math display">\[ Z =\dfrac{ \hat{P} - p_0}{\sqrt{\dfrac{p_0(1 - p_0)}{n} }} \sim N(0, 1) \]</span></p>
<div id="observed-test-statistic-1" class="section level5 unnumbered">
<h5>Observed test statistic<a class="anchor" aria-label="anchor" href="#observed-test-statistic-1"><i class="fas fa-link"></i></a>
</h5>
<p>While one could compute this observed test statistic by “hand” by plugging the observed values into the formula, the focus here is on the set-up of the problem and in understanding which formula for the test statistic applies. The calculation has been done in R below for completeness though:</p>
<div class="sourceCode" id="cb625"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_hat</span> <span class="op">&lt;-</span> <span class="fl">0.73</span></span>
<span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="op">(</span><span class="va">z_obs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p_hat</span> <span class="op">-</span> <span class="va">p0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">p0</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p0</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] -1.75</code></pre>
<p>We see here that the <span class="math inline">\(z_{obs}\)</span> value is around -1.75. Our observed sample proportion of 0.73 is 1.75 standard errors below the hypothesized parameter value of 0.8.</p>
</div>
</div>
<div id="visualize-and-compute-p-value" class="section level4 unnumbered">
<h4>Visualize and compute <span class="math inline">\(p\)</span>-value<a class="anchor" aria-label="anchor" href="#visualize-and-compute-p-value"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb627"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">elec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">satisfy</span>, success <span class="op">=</span> <span class="st">"satisfied"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"point"</span>, p <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/assume.html">assume</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"z"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">z_obs</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/pvaloneprop-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb628"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">z_obs</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.0801</code></pre>
<p>The <span class="math inline">\(p\)</span>-value—the probability of observing an <span class="math inline">\(z_{obs}\)</span> value of -1.75 or more extreme (in both directions) in our null distribution—is around 8%.</p>
<p>Note that we could also do this test directly using the <code>prop.test</code> function.</p>
<div class="sourceCode" id="cb630"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">elec</span><span class="op">$</span><span class="va">satisfy</span><span class="op">)</span>,</span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">elec</span><span class="op">$</span><span class="va">satisfy</span><span class="op">)</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  correct <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>
    1-sample proportions test without continuity correction

data:  table(elec$satisfy), null probability 0.8
X-squared = 3, df = 1, p-value = 0.08
alternative hypothesis: true p is not equal to 0.8
95 percent confidence interval:
 0.636 0.807
sample estimates:
   p 
0.73 </code></pre>
<p><code>prop.test</code> does a <span class="math inline">\(\chi^2\)</span> test here but this matches up exactly with what we would expect: <span class="math inline">\(x^2_{obs} = 3.06 = (-1.75)^2 = (z_{obs})^2\)</span> and the <span class="math inline">\(p\)</span>-values are the same because we are focusing on a two-tailed test.</p>
<p>Note that the 95 percent confidence interval given above matches well with the one calculated using bootstrapping.</p>
</div>
<div id="state-conclusion-1" class="section level4 unnumbered">
<h4>State conclusion<a class="anchor" aria-label="anchor" href="#state-conclusion-1"><i class="fas fa-link"></i></a>
</h4>
<p>We, therefore, do not have sufficient evidence to reject the null hypothesis. Our initial guess that our observed sample proportion was not statistically different from the hypothesized proportion has not been invalidated. Based on this sample, we have do not evidence that the proportion of all customers of the large electric utility satisfied with service they receive is different from 0.80, at the 5% level.</p>
</div>
</div>
<div id="comparing-results-1" class="section level3" number="13.3.6">
<h3>
<span class="header-section-number">B.3.6</span> Comparing results<a class="anchor" aria-label="anchor" href="#comparing-results-1"><i class="fas fa-link"></i></a>
</h3>
<p>Observing the bootstrap distribution and the null distribution that were created, it makes quite a bit of sense that the results are so similar for traditional and non-traditional methods in terms of the <span class="math inline">\(p\)</span>-value and the confidence interval since these distributions look very similar to normal distributions. The conditions also being met leads us to better guess that using any of the methods whether they are traditional (formula-based) or non-traditional (computational-based) will lead to similar results.</p>
</div>
</div>
<div id="two-proportions" class="section level2" number="13.4">
<h2>
<span class="header-section-number">B.4</span> Two proportions<a class="anchor" aria-label="anchor" href="#two-proportions"><i class="fas fa-link"></i></a>
</h2>
<div id="problem-statement-2" class="section level3" number="13.4.1">
<h3>
<span class="header-section-number">B.4.1</span> Problem statement<a class="anchor" aria-label="anchor" href="#problem-statement-2"><i class="fas fa-link"></i></a>
</h3>
<p>A 2010 survey asked 827 randomly sampled registered voters
in California “Do you support? Or do you oppose? Drilling for oil and natural gas off the Coast of
California? Or do you not know enough to say?” Conduct a hypothesis test to determine if the data
provide strong evidence that the proportion of college
graduates who do not have an opinion on this issue is
different than that of non-college graduates. <span class="citation">(Tweaked a bit from <a href="references.html#ref-isrs2014">Diez, Barr, and Çetinkaya-Rundel 2014</a> [Chapter 6])</span></p>
</div>
<div id="competing-hypotheses-2" class="section level3" number="13.4.2">
<h3>
<span class="header-section-number">B.4.2</span> Competing hypotheses<a class="anchor" aria-label="anchor" href="#competing-hypotheses-2"><i class="fas fa-link"></i></a>
</h3>
<div id="in-words-2" class="section level4 unnumbered">
<h4>In words<a class="anchor" aria-label="anchor" href="#in-words-2"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Null hypothesis: There is no association between having an opinion on drilling and having a college degree for all registered California voters in 2010.</p></li>
<li><p>Alternative hypothesis: There is an association between having an opinion on drilling and having a college degree for all registered California voters in 2010.</p></li>
</ul>
</div>
<div id="another-way-in-words" class="section level4 unnumbered">
<h4>Another way in words<a class="anchor" aria-label="anchor" href="#another-way-in-words"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Null hypothesis: The probability that a Californian voter in 2010 having no opinion on drilling and is a college graduate is the <strong>same</strong> as that of a non-college graduate.</p></li>
<li><p>Alternative hypothesis: These parameter probabilities are different.</p></li>
</ul>
</div>
<div id="in-symbols-with-annotations-2" class="section level4 unnumbered">
<h4>In symbols (with annotations)<a class="anchor" aria-label="anchor" href="#in-symbols-with-annotations-2"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<span class="math inline">\(H_0: \pi_{college} = \pi_{no\_college}\)</span> or <span class="math inline">\(H_0: \pi_{college} - \pi_{no\_college} = 0\)</span>, where <span class="math inline">\(\pi\)</span> represents the probability of not having an opinion on drilling.</li>
<li><span class="math inline">\(H_A: \pi_{college} - \pi_{no\_college} \ne 0\)</span></li>
</ul>
</div>
<div id="set-alpha-2" class="section level4 unnumbered">
<h4>Set <span class="math inline">\(\alpha\)</span><a class="anchor" aria-label="anchor" href="#set-alpha-2"><i class="fas fa-link"></i></a>
</h4>
<p>It’s important to set the significance level before starting the testing using the data. Let’s set the significance level at 5% here.</p>
</div>
</div>
<div id="exploring-the-sample-data-2" class="section level3" number="13.4.3">
<h3>
<span class="header-section-number">B.4.3</span> Exploring the sample data<a class="anchor" aria-label="anchor" href="#exploring-the-sample-data-2"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb632"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">offshore</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://moderndive.com/data/offshore.csv"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb633"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="va">offshore</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://sfirke.github.io/janitor/reference/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">college_grad</span>, <span class="va">response</span><span class="op">)</span></span>
<span><span class="va">counts</span></span></code></pre></div>
<pre><code> college_grad no opinion opinion
           no        131     258
          yes        104     334</code></pre>
<p>Observe that of the college graduates, a proportion of 104/(104 + 334) = 0.237 have no opinion on drilling. On the other hand, of the non-college graduates, a proportion of 131/(131 + 258) = 0.337 have no opinion on drilling, whereas the difference in these proportions is 0.237 - 0.337 = -0.099.</p>
<p>Let’s visualize these in a barchart. However, we first reverse the order of the levels in the categorical variable <code>response</code> using the <code><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev()</a></code> function from the <code>forcats</code> package. We do this because the default ordering of levels in a factor is alphanumeric. However, we are interested in proportions that have <code>no opinion</code> and not <code>opinion</code>. Thus we need to reverse the default alphanumeric order.</p>
<div class="sourceCode" id="cb635"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">offshore</span> <span class="op">&lt;-</span> <span class="va">offshore</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>response <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">offshore</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">college_grad</span>, fill <span class="op">=</span> <span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"College grad?"</span>, y <span class="op">=</span> <span class="st">"Proportion with no opinion on drilling"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/stacked_bar-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div id="guess-about-statistical-significance-2" class="section level4 unnumbered">
<h4>Guess about statistical significance<a class="anchor" aria-label="anchor" href="#guess-about-statistical-significance-2"><i class="fas fa-link"></i></a>
</h4>
<p>We are looking to see if a difference exists in the size of the bars corresponding to <code>no opinion</code> for the plot. Based solely on the plot, we have little reason to believe that a difference exists since the bars seem to be about the same size, BUT…it’s important to use statistics to see if that difference is actually statistically significant!</p>
</div>
</div>
<div id="non-traditional-methods-2" class="section level3" number="13.4.4">
<h3>
<span class="header-section-number">B.4.4</span> Non-traditional methods<a class="anchor" aria-label="anchor" href="#non-traditional-methods-2"><i class="fas fa-link"></i></a>
</h3>
<div id="collecting-summary-info" class="section level4 unnumbered">
<h4>Collecting summary info<a class="anchor" aria-label="anchor" href="#collecting-summary-info"><i class="fas fa-link"></i></a>
</h4>
<p>The observed statistic is</p>
<div class="sourceCode" id="cb636"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_hat</span> <span class="op">&lt;-</span> <span class="va">offshore</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">college_grad</span>, success <span class="op">=</span> <span class="st">"no opinion"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in props"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d_hat</span></span></code></pre></div>
<pre><code>Response: response (factor)
Explanatory: college_grad (factor)
# A tibble: 1 × 1
        stat
       &lt;dbl&gt;
1 -0.0993180</code></pre>
</div>
<div id="randomization-for-hypothesis-test" class="section level4 unnumbered">
<h4>Randomization for hypothesis test<a class="anchor" aria-label="anchor" href="#randomization-for-hypothesis-test"><i class="fas fa-link"></i></a>
</h4>
<p>In order to ascertain if the observed sample proportion with no opinion for college graduates of 0.237 is statistically different than the observed sample proportion with no opinion for non-college graduates of 0.337, we need to account for the sample sizes. Note that this is the same as ascertaining if the observed difference in sample proportions -0.099 is statistically different than 0. We also need to determine a process that replicates how the original group sizes of 389 and 438 were selected.</p>
<p>We can use the idea of <em>randomization testing</em> (also known as <em>permutation testing</em>) to simulate the population from which the sample came (with two groups of different sizes) and then generate samples using <em>shuffling</em> from that simulated population to account for sampling variability.</p>
<div class="sourceCode" id="cb638"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2018</span><span class="op">)</span></span>
<span><span class="va">null_distn_two_props</span> <span class="op">&lt;-</span> <span class="va">offshore</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">college_grad</span>, success <span class="op">=</span> <span class="st">"no opinion"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in props"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb639"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_distn_two_props</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-674-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We can next use this distribution to observe our <span class="math inline">\(p\)</span>-value. Recall this is a two-tailed test so we will be looking for values that are greater than or equal to 0.099 or less than or equal to -0.099 for our <span class="math inline">\(p\)</span>-value.</p>
<div class="sourceCode" id="cb640"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_distn_two_props</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">d_hat</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-675-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div id="calculate-p-value-2" class="section level5 unnumbered">
<h5>Calculate <span class="math inline">\(p\)</span>-value<a class="anchor" aria-label="anchor" href="#calculate-p-value-2"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb641"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="va">null_distn_two_props</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_pvalue</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">d_hat</span>, direction <span class="op">=</span> <span class="st">"two_sided"</span><span class="op">)</span></span>
<span><span class="va">pvalue</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1  0.0024</code></pre>
<p>So our <span class="math inline">\(p\)</span>-value is 0.002 and we reject the null hypothesis at the 5% level. You can also see this from the histogram above that we are far into the tails of the null distribution.</p>
</div>
</div>
<div id="bootstrapping-for-confidence-interval-2" class="section level4 unnumbered">
<h4>Bootstrapping for confidence interval<a class="anchor" aria-label="anchor" href="#bootstrapping-for-confidence-interval-2"><i class="fas fa-link"></i></a>
</h4>
<p>We can also create a confidence interval for the unknown population parameter <span class="math inline">\(\pi_{college} - \pi_{no\_college}\)</span> using our sample data with <em>bootstrapping</em>.</p>
<div class="sourceCode" id="cb643"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_distn_two_props</span> <span class="op">&lt;-</span> <span class="va">offshore</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">college_grad</span>, success <span class="op">=</span> <span class="st">"no opinion"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in props"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb644"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="va">boot_distn_two_props</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_confidence_interval.html">get_ci</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ci</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
   lower_ci   upper_ci
      &lt;dbl&gt;      &lt;dbl&gt;
1 -0.160030 -0.0379112</code></pre>
<div class="sourceCode" id="cb646"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_distn_two_props</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_confidence_interval.html">shade_ci</a></span><span class="op">(</span>endpoints <span class="op">=</span> <span class="va">ci</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-679-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We see that 0 is not contained in this confidence interval as a plausible value of <span class="math inline">\(\pi_{college} - \pi_{no\_college}\)</span> (the unknown population parameter). This matches with our hypothesis test results of rejecting the null hypothesis. Since zero is not a plausible value of the population parameter, we have evidence that the proportion of college graduates in California with no opinion on drilling is different than that of non-college graduates.</p>
<p><strong>Interpretation</strong>: We are 95% confident the true proportion of non-college graduates with no opinion on offshore drilling in California is between 0.16 dollars smaller to 0.04 dollars smaller than for college graduates.</p>
</div>
</div>
<div id="traditional-methods-2" class="section level3" number="13.4.5">
<h3>
<span class="header-section-number">B.4.5</span> Traditional methods<a class="anchor" aria-label="anchor" href="#traditional-methods-2"><i class="fas fa-link"></i></a>
</h3>
<div id="check-conditions-2" class="section level4 unnumbered">
<h4>Check conditions<a class="anchor" aria-label="anchor" href="#check-conditions-2"><i class="fas fa-link"></i></a>
</h4>
<p>Remember that in order to use the short-cut (formula-based, theoretical) approach, we need to check that some conditions are met.</p>
<ol style="list-style-type: decimal">
<li>
<p><em>Independent observations</em>: Each case that was selected must be independent of all the other cases selected.</p>
<p>This condition is met since cases were selected at random to observe.</p>
</li>
<li>
<p><em>Sample size</em>: The number of pooled successes and pooled failures must be at least 10 for each group.</p>
<p>We need to first figure out the pooled success rate: <span class="math display">\[\hat{p}_{obs} = \dfrac{131 + 104}{827} = 0.28.\]</span> We now determine expected (pooled) success and failure counts:</p>
<p><span class="math inline">\(0.28 \cdot (131 + 258) = 108.92\)</span>, <span class="math inline">\(0.72 \cdot (131 + 258) = 280.08\)</span></p>
<p><span class="math inline">\(0.28 \cdot (104 + 334) = 122.64\)</span>, <span class="math inline">\(0.72 \cdot (104 + 334) = 315.36\)</span></p>
</li>
<li>
<p><em>Independent selection of samples</em>: The cases are not paired in any meaningful way.</p>
<p>We have no reason to suspect that a college graduate selected would have any relationship to a non-college graduate selected.</p>
</li>
</ol>
</div>
</div>
<div id="test-statistic-2" class="section level3" number="13.4.6">
<h3>
<span class="header-section-number">B.4.6</span> Test statistic<a class="anchor" aria-label="anchor" href="#test-statistic-2"><i class="fas fa-link"></i></a>
</h3>
<p>The test statistic is a random variable based on the sample data. Here, we are interested in seeing if our observed difference in sample proportions corresponding to no opinion on drilling (<span class="math inline">\(\hat{p}_{college, obs} - \hat{p}_{no\_college, obs}\)</span> = -0.092) is statistically different than 0. Assuming that conditions are met and the null hypothesis is true, we can use the standard normal distribution to standardize the difference in sample proportions (<span class="math inline">\(\hat{P}_{college} - \hat{P}_{no\_college}\)</span>) using the standard error of <span class="math inline">\(\hat{P}_{college} - \hat{P}_{no\_college}\)</span> and the pooled estimate:</p>
<p><span class="math display">\[ Z =\dfrac{ (\hat{P}_{college} - \hat{P}_{no_college}) - 0}{\sqrt{\dfrac{\hat{P}(1 - \hat{P})}{n_1} + \dfrac{\hat{P}(1 - \hat{P})}{n_2} }} \sim N(0, 1) \]</span> where <span class="math inline">\(\hat{P} = \dfrac{\text{total number of successes} }{ \text{total number of cases}}.\)</span></p>
<div id="observed-test-statistic-2" class="section level4 unnumbered">
<h4>Observed test statistic<a class="anchor" aria-label="anchor" href="#observed-test-statistic-2"><i class="fas fa-link"></i></a>
</h4>
<p>While one could compute this observed test statistic by “hand”, the focus here is on the set-up of the problem and in understanding which formula for the test statistic applies. We can use the <code>prop.test</code> function to perform this analysis for us.</p>
<div class="sourceCode" id="cb647"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z_hat</span> <span class="op">&lt;-</span> <span class="va">offshore</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="va">college_grad</span>, success <span class="op">=</span> <span class="st">"no opinion"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"z"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">z_hat</span></span></code></pre></div>
<pre><code>Response: response (factor)
Explanatory: college_grad (factor)
# A tibble: 1 × 1
      stat
     &lt;dbl&gt;
1 -3.16081</code></pre>
<p>The observed difference in sample proportions is 3.16 standard deviations smaller than 0.</p>
<p>The <span class="math inline">\(p\)</span>-value—the probability of observing a <span class="math inline">\(Z\)</span> value of -3.16 or more extreme in our null distribution—is 0.0016. This can also be calculated in R directly:</p>
<div class="sourceCode" id="cb649"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.16</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.00158</code></pre>
</div>
</div>
<div id="state-conclusion-2" class="section level3" number="13.4.7">
<h3>
<span class="header-section-number">B.4.7</span> State conclusion<a class="anchor" aria-label="anchor" href="#state-conclusion-2"><i class="fas fa-link"></i></a>
</h3>
<p>We, therefore, have sufficient evidence to reject the null hypothesis. Our initial guess that a statistically significant difference did not exist in the proportions of no opinion on offshore drilling between college educated and non-college educated Californians was not validated. We do have evidence to suggest that there is a dependency between college graduation and position on offshore drilling for Californians.</p>
</div>
<div id="comparing-results-2" class="section level3" number="13.4.8">
<h3>
<span class="header-section-number">B.4.8</span> Comparing results<a class="anchor" aria-label="anchor" href="#comparing-results-2"><i class="fas fa-link"></i></a>
</h3>
<p>Observing the bootstrap distribution and the null distribution that were created, it makes quite a bit of sense that the results are so similar for traditional and non-traditional methods in terms of the <span class="math inline">\(p\)</span>-value and the confidence interval since these distributions look very similar to normal distributions. The conditions were not met since the number of pairs was small, but the sample data was not highly skewed. Using any of the methods whether they are traditional (formula-based) or non-traditional (computational-based) lead to similar results.</p>
</div>
</div>
<div id="two-means-independent-samples" class="section level2" number="13.5">
<h2>
<span class="header-section-number">B.5</span> Two means (independent samples)<a class="anchor" aria-label="anchor" href="#two-means-independent-samples"><i class="fas fa-link"></i></a>
</h2>
<div id="problem-statement-3" class="section level3" number="13.5.1">
<h3>
<span class="header-section-number">B.5.1</span> Problem statement<a class="anchor" aria-label="anchor" href="#problem-statement-3"><i class="fas fa-link"></i></a>
</h3>
<p>Average income varies from one region of the country to
another, and it often reflects both lifestyles and regional living expenses. Suppose a new graduate
is considering a job in two locations, Cleveland, OH and Sacramento, CA, and he wants to see
whether the average income in one of these cities is higher than the other. He would like to conduct
a hypothesis test based on two randomly selected samples from the 2000 Census. <span class="citation">(Tweaked a bit from <a href="references.html#ref-isrs2014">Diez, Barr, and Çetinkaya-Rundel 2014</a> [Chapter 5])</span></p>
</div>
<div id="competing-hypotheses-3" class="section level3" number="13.5.2">
<h3>
<span class="header-section-number">B.5.2</span> Competing hypotheses<a class="anchor" aria-label="anchor" href="#competing-hypotheses-3"><i class="fas fa-link"></i></a>
</h3>
<div id="in-words-3" class="section level4 unnumbered">
<h4>In words<a class="anchor" aria-label="anchor" href="#in-words-3"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Null hypothesis: There is no association between income and location (Cleveland, OH and Sacramento, CA).</li>
<li>Alternative hypothesis: There is an association between income and location (Cleveland, OH and Sacramento, CA).</li>
</ul>
</div>
<div id="another-way-in-words-1" class="section level4 unnumbered">
<h4>Another way in words<a class="anchor" aria-label="anchor" href="#another-way-in-words-1"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Null hypothesis: The mean income is the <strong>same</strong> for both cities.</li>
<li>Alternative hypothesis: The mean income is different for the two cities.</li>
</ul>
</div>
<div id="in-symbols-with-annotations-3" class="section level4 unnumbered">
<h4>In symbols (with annotations)<a class="anchor" aria-label="anchor" href="#in-symbols-with-annotations-3"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<span class="math inline">\(H_0: \mu_{sac} = \mu_{cle}\)</span> or <span class="math inline">\(H_0: \mu_{sac} - \mu_{cle} = 0\)</span>, where <span class="math inline">\(\mu\)</span> represents the average income.</li>
<li><span class="math inline">\(H_A: \mu_{sac} - \mu_{cle} \ne 0\)</span></li>
</ul>
</div>
<div id="set-alpha-3" class="section level4 unnumbered">
<h4>Set <span class="math inline">\(\alpha\)</span><a class="anchor" aria-label="anchor" href="#set-alpha-3"><i class="fas fa-link"></i></a>
</h4>
<p>It’s important to set the significance level before starting the testing using the data. Let’s set the significance level at 5% here.</p>
</div>
</div>
<div id="exploring-the-sample-data-3" class="section level3" number="13.5.3">
<h3>
<span class="header-section-number">B.5.3</span> Exploring the sample data<a class="anchor" aria-label="anchor" href="#exploring-the-sample-data-3"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb651"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cle_sac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="st">"https://moderndive.com/data/cleSac.txt"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>    metro_area <span class="op">=</span> <span class="va">Metropolitan_area_Detailed</span>,</span>
<span>    income <span class="op">=</span> <span class="va">Total_personal_income</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb652"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inc_summ</span> <span class="op">&lt;-</span> <span class="va">cle_sac</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">metro_area</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    sample_size <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span>,</span>
<span>    minimum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span>,</span>
<span>    lower_quartile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">income</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span>,</span>
<span>    upper_quartile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">income</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>    max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">inc_summ</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span></span>
<span>    font_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/output_type.html">is_latex_output</a></span><span class="op">(</span><span class="op">)</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span>,</span>
<span>    latex_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hold_position"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
metro_area
</th>
<th style="text-align:right;">
sample_size
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
minimum
</th>
<th style="text-align:right;">
lower_quartile
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
upper_quartile
</th>
<th style="text-align:right;">
max
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Cleveland_ OH
</td>
<td style="text-align:right;">
212
</td>
<td style="text-align:right;">
27467
</td>
<td style="text-align:right;">
27681
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8475
</td>
<td style="text-align:right;">
21000
</td>
<td style="text-align:right;">
35275
</td>
<td style="text-align:right;">
152400
</td>
</tr>
<tr>
<td style="text-align:left;">
Sacramento_ CA
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
32428
</td>
<td style="text-align:right;">
35774
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8050
</td>
<td style="text-align:right;">
20000
</td>
<td style="text-align:right;">
49350
</td>
<td style="text-align:right;">
206900
</td>
</tr>
</tbody>
</table></div>
<p>The boxplot below also shows the mean for each group highlighted by the red dots.</p>
<div class="sourceCode" id="cb653"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cle_sac</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">metro_area</span>, y <span class="op">=</span> <span class="va">income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"point"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/boxplot-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div id="guess-about-statistical-significance-3" class="section level4 unnumbered">
<h4>Guess about statistical significance<a class="anchor" aria-label="anchor" href="#guess-about-statistical-significance-3"><i class="fas fa-link"></i></a>
</h4>
<p>We are looking to see if a difference exists in the mean income of the two levels of the explanatory variable. Based solely on the boxplot, we have reason to believe that no difference exists. The distributions of income seem similar and the means fall in roughly the same place.</p>
</div>
</div>
<div id="non-traditional-methods-3" class="section level3" number="13.5.4">
<h3>
<span class="header-section-number">B.5.4</span> Non-traditional methods<a class="anchor" aria-label="anchor" href="#non-traditional-methods-3"><i class="fas fa-link"></i></a>
</h3>
<div id="collecting-summary-info-1" class="section level4 unnumbered">
<h4>Collecting summary info<a class="anchor" aria-label="anchor" href="#collecting-summary-info-1"><i class="fas fa-link"></i></a>
</h4>
<p>We now compute the observed statistic:</p>
<div class="sourceCode" id="cb654"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_hat</span> <span class="op">&lt;-</span> <span class="va">cle_sac</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">income</span> <span class="op">~</span> <span class="va">metro_area</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span></span>
<span>    stat <span class="op">=</span> <span class="st">"diff in means"</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sacramento_ CA"</span>, <span class="st">"Cleveland_ OH"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">d_hat</span></span></code></pre></div>
<pre><code>Response: income (numeric)
Explanatory: metro_area (factor)
# A tibble: 1 × 1
     stat
    &lt;dbl&gt;
1 4960.48</code></pre>
</div>
<div id="randomization-for-hypothesis-test-1" class="section level4 unnumbered">
<h4>Randomization for hypothesis test<a class="anchor" aria-label="anchor" href="#randomization-for-hypothesis-test-1"><i class="fas fa-link"></i></a>
</h4>
<p>In order to look to see if the observed sample mean for Sacramento of 27467.066 is statistically different than that for Cleveland of 32427.543, we need to account for the sample sizes. Note that this is the same as looking to see if <span class="math inline">\(\bar{x}_{sac} - \bar{x}_{cle}\)</span> is statistically different than 0. We also need to determine a process that replicates how the original group sizes of 212 and 175 were selected.</p>
<p>We can use the idea of <em>randomization testing</em> (also known as <em>permutation testing</em>) to simulate the population from which the sample came (with two groups of different sizes) and then generate samples using <em>shuffling</em> from that simulated population to account for sampling variability.</p>
<div class="sourceCode" id="cb656"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2018</span><span class="op">)</span></span>
<span><span class="va">null_distn_two_means</span> <span class="op">&lt;-</span> <span class="va">cle_sac</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">income</span> <span class="op">~</span> <span class="va">metro_area</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span></span>
<span>    stat <span class="op">=</span> <span class="st">"diff in means"</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sacramento_ CA"</span>, <span class="st">"Cleveland_ OH"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb657"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_distn_two_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-683-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We can next use this distribution to observe our <span class="math inline">\(p\)</span>-value. Recall this is a two-tailed test so we will be looking for values that are greater than or equal to 4960.477 or less than or equal to -4960.477 for our <span class="math inline">\(p\)</span>-value.</p>
<div class="sourceCode" id="cb658"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_distn_two_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">d_hat</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-684-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div id="calculate-p-value-3" class="section level5 unnumbered">
<h5>Calculate <span class="math inline">\(p\)</span>-value<a class="anchor" aria-label="anchor" href="#calculate-p-value-3"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb659"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="va">null_distn_two_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_pvalue</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">d_hat</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span>
<span><span class="va">pvalue</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1  0.1262</code></pre>
<p>So our <span class="math inline">\(p\)</span>-value is 0.126 and we fail to reject the null hypothesis at the 5% level. You can also see this from the histogram above that we are not very far into the tail of the null distribution.</p>
</div>
</div>
<div id="bootstrapping-for-confidence-interval-3" class="section level4 unnumbered">
<h4>Bootstrapping for confidence interval<a class="anchor" aria-label="anchor" href="#bootstrapping-for-confidence-interval-3"><i class="fas fa-link"></i></a>
</h4>
<p>We can also create a confidence interval for the unknown population parameter <span class="math inline">\(\mu_{sac} - \mu_{cle}\)</span> using our sample data with <em>bootstrapping</em>. Here we will bootstrap each of the samples with replacement instead of shuffling. This is done by setting the <code>type</code> argument in the <code>generate</code> function to “bootstrap”.</p>
<div class="sourceCode" id="cb661"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_distn_two_means</span> <span class="op">&lt;-</span> <span class="va">cle_sac</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">income</span> <span class="op">~</span> <span class="va">metro_area</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span></span>
<span>    stat <span class="op">=</span> <span class="st">"diff in means"</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sacramento_ CA"</span>, <span class="st">"Cleveland_ OH"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb662"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="va">boot_distn_two_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_confidence_interval.html">get_ci</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ci</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1 -1359.50  11499.7</code></pre>
<div class="sourceCode" id="cb664"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_distn_two_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_confidence_interval.html">shade_ci</a></span><span class="op">(</span>endpoints <span class="op">=</span> <span class="va">ci</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-688-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We see that 0 is contained in this confidence interval as a plausible value of <span class="math inline">\(\mu_{sac} - \mu_{cle}\)</span> (the unknown population parameter). This matches with our hypothesis test results of failing to reject the null hypothesis. Since zero is a plausible value of the population parameter, we do not have evidence that Sacramento incomes are different than Cleveland incomes.</p>
<p><strong>Interpretation</strong>: We are 95% confident the true mean yearly income for those living in Sacramento is between 1359.5 dollars smaller to 11499.69 dollars higher than for Cleveland.</p>
<p><strong>Note</strong>: You could also use the null distribution based on randomization with a shift to have its center at <span class="math inline">\(\bar{x}_{sac} - \bar{x}_{cle} = \$4960.48\)</span> instead of at 0 and calculate its percentiles. The confidence interval produced via this method should be comparable to the one done using bootstrapping above.</p>
</div>
</div>
<div id="traditional-methods-3" class="section level3" number="13.5.5">
<h3>
<span class="header-section-number">B.5.5</span> Traditional methods<a class="anchor" aria-label="anchor" href="#traditional-methods-3"><i class="fas fa-link"></i></a>
</h3>
<div id="check-conditions-3" class="section level5 unnumbered">
<h5>Check conditions<a class="anchor" aria-label="anchor" href="#check-conditions-3"><i class="fas fa-link"></i></a>
</h5>
<p>Remember that in order to use the short-cut (formula-based, theoretical) approach, we need to check that some conditions are met.</p>
<ol style="list-style-type: decimal">
<li>
<p><em>Independent observations</em>: The observations are independent in both groups.</p>
<p>This <code>metro_area</code> variable is met since the cases are randomly selected from each city.</p>
</li>
<li><p><em>Approximately normal</em>: The distribution of the response for each group should be normal or the sample sizes should be at least 30.</p></li>
</ol>
<div class="sourceCode" id="cb665"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cle_sac</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">income</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, binwidth <span class="op">=</span> <span class="fl">20000</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">metro_area</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/hist-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We have some reason to doubt the normality assumption here since both the histograms show deviation from a normal model fitting the data well for each group. The sample sizes for each group are greater than 100 though so the assumptions should still apply.</p>
<ol start="3" style="list-style-type: decimal">
<li>
<p><em>Independent samples</em>: The samples should be collected without any natural pairing.</p>
<p>There is no mention of there being a relationship between those selected in Cleveland and in Sacramento.</p>
</li>
</ol>
</div>
</div>
<div id="test-statistic-3" class="section level3" number="13.5.6">
<h3>
<span class="header-section-number">B.5.6</span> Test statistic<a class="anchor" aria-label="anchor" href="#test-statistic-3"><i class="fas fa-link"></i></a>
</h3>
<p>The test statistic is a random variable based on the sample data. Here, we are interested in seeing if our observed difference in sample means (<span class="math inline">\(\bar{x}_{sac, obs} - \bar{x}_{cle, obs}\)</span> = 4960.477) is statistically different than 0. Assuming that conditions are met and the null hypothesis is true, we can use the <span class="math inline">\(t\)</span> distribution to standardize the difference in sample means (<span class="math inline">\(\bar{X}_{sac} - \bar{X}_{cle}\)</span>) using the approximate standard error of <span class="math inline">\(\bar{X}_{sac} - \bar{X}_{cle}\)</span> (invoking <span class="math inline">\(S_{sac}\)</span> and <span class="math inline">\(S_{cle}\)</span> as estimates of unknown <span class="math inline">\(\sigma_{sac}\)</span> and <span class="math inline">\(\sigma_{cle}\)</span>).</p>
<p><span class="math display">\[ T =\dfrac{ (\bar{X}_1 - \bar{X}_2) - 0}{ \sqrt{\dfrac{S_1^2}{n_1} + \dfrac{S_2^2}{n_2}}  } \sim t (df = min(n_1 - 1, n_2 - 1)) \]</span> where 1 = Sacramento and 2 = Cleveland with <span class="math inline">\(S_1^2\)</span> and <span class="math inline">\(S_2^2\)</span> the sample variance of the incomes of both cities, respectively, and <span class="math inline">\(n_1 = 175\)</span> for Sacramento and <span class="math inline">\(n_2 = 212\)</span> for Cleveland.</p>
<div id="observed-test-statistic-3" class="section level4 unnumbered">
<h4>Observed test statistic<a class="anchor" aria-label="anchor" href="#observed-test-statistic-3"><i class="fas fa-link"></i></a>
</h4>
<p>Note that we could also do (ALMOST) this test directly using the <code>t.test</code> function. The <code>x</code> and <code>y</code> arguments are expected to both be numeric vectors here so we’ll need to appropriately filter our datasets.</p>
<div class="sourceCode" id="cb666"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cle_sac</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">income</span> <span class="op">~</span> <span class="va">metro_area</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span></span>
<span>    stat <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cleveland_ OH"</span>, <span class="st">"Sacramento_ CA"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code>Response: income (numeric)
Explanatory: metro_area (factor)
# A tibble: 1 × 1
      stat
     &lt;dbl&gt;
1 -1.50062</code></pre>
<!--
Note that the degrees of freedom reported above are different than what we used above in specifying the **Test Statistic**.  The degrees of freedom used here is also known as the Satterthwaite approximation and involves a quite complicated formula.  For most problems, the much simpler smaller of sample sizes minus one will suffice.
-->
<p>We see here that the observed test statistic value is around -1.5. <!-- with $df = min(212 - 1, 175 - 1) = 174$.--></p>
<p>While one could compute this observed test statistic by “hand”, the focus here is on the set-up of the problem and in understanding which formula for the test statistic applies.</p>
<!--
We can use the `inference` function in the `oilabs` package to perform this analysis for us.  Note that to obtain the `F value` given here, you divide the observed $MSG$ value of 17.53 by the observed $MSE$ value of 1.75.  (The use of the word `Residuals` will make more sense when we have covered regression.)
-->
<!--Recall that for large degrees of freedom, the $t$ distribution is roughly equal to the standard normal curve so our difference in `df` for the Satterthwaite and "min" variations doesn't really matter.-->
</div>
</div>
<div id="compute-p-value-1" class="section level3" number="13.5.7">
<h3>
<span class="header-section-number">B.5.7</span> Compute <span class="math inline">\(p\)</span>-value<a class="anchor" aria-label="anchor" href="#compute-p-value-1"><i class="fas fa-link"></i></a>
</h3>
<p>The <span class="math inline">\(p\)</span>-value—the probability of observing an <span class="math inline">\(t_{174}\)</span> value of -1.501 or more extreme (in both directions) in our null distribution—is 0.13. This can also be calculated in R directly:</p>
<div class="sourceCode" id="cb668"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.501</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fl">212</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">175</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.135</code></pre>
<p>We can also approximate by using the standard normal curve:</p>
<div class="sourceCode" id="cb670"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.501</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.133</code></pre>
</div>
<div id="state-conclusion-3" class="section level3" number="13.5.8">
<h3>
<span class="header-section-number">B.5.8</span> State conclusion<a class="anchor" aria-label="anchor" href="#state-conclusion-3"><i class="fas fa-link"></i></a>
</h3>
<p>We, therefore, do not have sufficient evidence to reject the null hypothesis. Our initial guess that a statistically significant difference not existing in the means was backed by this statistical analysis. We do not have evidence to suggest that the true mean income differs between Cleveland, OH and Sacramento, CA based on this data.</p>
</div>
<div id="comparing-results-3" class="section level3" number="13.5.9">
<h3>
<span class="header-section-number">B.5.9</span> Comparing results<a class="anchor" aria-label="anchor" href="#comparing-results-3"><i class="fas fa-link"></i></a>
</h3>
<p>Observing the bootstrap distribution and the null distribution that were created, it makes quite a bit of sense that the results are so similar for traditional and non-traditional methods in terms of the <span class="math inline">\(p\)</span>-value and the confidence interval since these distributions look very similar to normal distributions. The conditions also being met leads us to better guess that using any of the methods whether they are traditional (formula-based) or non-traditional (computational-based) will lead to similar results.</p>
</div>
</div>
<div id="two-means-paired-samples" class="section level2" number="13.6">
<h2>
<span class="header-section-number">B.6</span> Two means (paired samples)<a class="anchor" aria-label="anchor" href="#two-means-paired-samples"><i class="fas fa-link"></i></a>
</h2>
<div id="problem-statement-4" class="section level3 unnumbered">
<h3>Problem statement<a class="anchor" aria-label="anchor" href="#problem-statement-4"><i class="fas fa-link"></i></a>
</h3>
<p>Trace metals in drinking water affect the flavor and an unusually high concentration can pose a health hazard. Ten pairs of data were taken measuring zinc concentration in bottom water and surface water at 10 randomly selected locations on a stretch of river. Do the data suggest that the true average concentration in the surface water is smaller than that of bottom water? (Note that units are not given.) [Tweaked a bit from Penn State’s STAT 500 course.]</p>
</div>
<div id="competing-hypotheses-4" class="section level3" number="13.6.1">
<h3>
<span class="header-section-number">B.6.1</span> Competing hypotheses<a class="anchor" aria-label="anchor" href="#competing-hypotheses-4"><i class="fas fa-link"></i></a>
</h3>
<div id="in-words-4" class="section level4 unnumbered">
<h4>In words<a class="anchor" aria-label="anchor" href="#in-words-4"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Null hypothesis: The mean concentration in the bottom water is the same as that of the surface water at different paired locations.</li>
<li>Alternative hypothesis: The mean concentration in the surface water is smaller than that of the bottom water at different paired locations.</li>
</ul>
</div>
<div id="in-symbols-with-annotations-4" class="section level4 unnumbered">
<h4>In symbols (with annotations)<a class="anchor" aria-label="anchor" href="#in-symbols-with-annotations-4"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<span class="math inline">\(H_0: \mu_{diff} = 0\)</span>, where <span class="math inline">\(\mu_{diff}\)</span> represents the mean difference in concentration for surface water minus bottom water.</li>
<li><span class="math inline">\(H_A: \mu_{diff} &lt; 0\)</span></li>
</ul>
</div>
<div id="set-alpha-4" class="section level4 unnumbered">
<h4>Set <span class="math inline">\(\alpha\)</span><a class="anchor" aria-label="anchor" href="#set-alpha-4"><i class="fas fa-link"></i></a>
</h4>
<p>It’s important to set the significance level before starting the testing using the data. Let’s set the significance level at 5% here.</p>
</div>
</div>
<div id="exploring-the-sample-data-4" class="section level3" number="13.6.2">
<h3>
<span class="header-section-number">B.6.2</span> Exploring the sample data<a class="anchor" aria-label="anchor" href="#exploring-the-sample-data-4"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb672"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zinc_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://moderndive.com/data/zinc_tidy.csv"</span><span class="op">)</span></span></code></pre></div>
<p>We want to look at the differences in <code>surface - bottom</code> for each location:</p>
<div class="sourceCode" id="cb673"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zinc_diff</span> <span class="op">&lt;-</span> <span class="va">zinc_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">loc_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>pair_diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">concentration</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Next we calculate the mean difference as our observed statistic:</p>
<div class="sourceCode" id="cb674"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_hat</span> <span class="op">&lt;-</span> <span class="va">zinc_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">pair_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span><span class="va">d_hat</span></span></code></pre></div>
<pre><code>Response: pair_diff (numeric)
# A tibble: 1 × 1
     stat
    &lt;dbl&gt;
1 -0.0804</code></pre>
<p>The histogram below also shows the distribution of <code>pair_diff</code>.</p>
<div class="sourceCode" id="cb676"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">zinc_diff</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pair_diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.04</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/hist1a-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div id="guess-about-statistical-significance-4" class="section level4 unnumbered">
<h4>Guess about statistical significance<a class="anchor" aria-label="anchor" href="#guess-about-statistical-significance-4"><i class="fas fa-link"></i></a>
</h4>
<p>We are looking to see if the sample paired mean difference of -0.08 is statistically less than 0. They seem to be quite close, but we have a small number of pairs here. Let’s guess that we will fail to reject the null hypothesis.</p>
</div>
</div>
<div id="non-traditional-methods-4" class="section level3" number="13.6.3">
<h3>
<span class="header-section-number">B.6.3</span> Non-traditional methods<a class="anchor" aria-label="anchor" href="#non-traditional-methods-4"><i class="fas fa-link"></i></a>
</h3>
<div id="bootstrapping-for-hypothesis-test-1" class="section level4 unnumbered">
<h4>Bootstrapping for hypothesis test<a class="anchor" aria-label="anchor" href="#bootstrapping-for-hypothesis-test-1"><i class="fas fa-link"></i></a>
</h4>
<p>In order to look to see if the observed sample mean difference <span class="math inline">\(\bar{x}_{diff} = -0.08\)</span> is statistically less than 0, we need to account for the number of pairs. We also need to determine a process that replicates how the paired data was selected in a way similar to how we calculated our original difference in sample means.</p>
<p>Treating the differences as our data of interest, we next use the process of <strong>bootstrapping</strong> to build other simulated samples and then calculate the mean of the bootstrap samples. We hypothesize that the mean difference is zero.</p>
<p>This process is similar to comparing the One Mean example seen above, but using the differences between the two groups as a single sample with a hypothesized mean difference of 0.</p>
<div class="sourceCode" id="cb677"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2018</span><span class="op">)</span></span>
<span><span class="va">null_distn_paired_means</span> <span class="op">&lt;-</span> <span class="va">zinc_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">pair_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"point"</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb678"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_distn_paired_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-692-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We can next use this distribution to observe our <span class="math inline">\(p\)</span>-value. Recall this is a left-tailed test so we will be looking for values that are less than or equal to -0.08 for our <span class="math inline">\(p\)</span>-value.</p>
<div class="sourceCode" id="cb679"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_distn_paired_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">d_hat</span>, direction <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-693-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div id="calculate-p-value-4" class="section level5 unnumbered">
<h5>Calculate <span class="math inline">\(p\)</span>-value<a class="anchor" aria-label="anchor" href="#calculate-p-value-4"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb680"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="va">null_distn_paired_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_pvalue</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">d_hat</span>, direction <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span></span>
<span><span class="va">pvalue</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
<p>So our <span class="math inline">\(p\)</span>-value is essentially 0 and we reject the null hypothesis at the 5% level. You can also see this from the histogram above that we are far into the left tail of the null distribution.</p>
</div>
</div>
<div id="bootstrapping-for-confidence-interval-4" class="section level4 unnumbered">
<h4>Bootstrapping for confidence interval<a class="anchor" aria-label="anchor" href="#bootstrapping-for-confidence-interval-4"><i class="fas fa-link"></i></a>
</h4>
<p>We can also create a confidence interval for the unknown population parameter <span class="math inline">\(\mu_{diff}\)</span> using our sample data (the calculated differences) with <em>bootstrapping</em>. This is similar to the bootstrapping done in a one sample mean case, except now our data is differences instead of raw numerical data.
Note that this code is identical to the pipeline shown in the hypothesis test above except the <code><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize()</a></code> function is not called.</p>
<div class="sourceCode" id="cb682"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_distn_paired_means</span> <span class="op">&lt;-</span> <span class="va">zinc_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">pair_diff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb683"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="va">boot_distn_paired_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_confidence_interval.html">get_ci</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ci</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
  lower_ci   upper_ci
     &lt;dbl&gt;      &lt;dbl&gt;
1  -0.1116 -0.0501975</code></pre>
<div class="sourceCode" id="cb685"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_distn_paired_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_confidence_interval.html">shade_ci</a></span><span class="op">(</span>endpoints <span class="op">=</span> <span class="va">ci</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-697-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We see that 0 is not contained in this confidence interval as a plausible value of <span class="math inline">\(\mu_{diff}\)</span> (the unknown population parameter). This matches with our hypothesis test results of rejecting the null hypothesis. Since zero is not a plausible value of the population parameter and since the entire confidence interval falls below zero, we have evidence that surface zinc concentration levels are lower, on average, than bottom level zinc concentrations.</p>
<p><strong>Interpretation</strong>: We are 95% confident the true mean zinc concentration on the surface is between 0.11 units smaller to 0.05 units smaller than on the bottom.</p>
</div>
</div>
<div id="traditional-methods-4" class="section level3" number="13.6.4">
<h3>
<span class="header-section-number">B.6.4</span> Traditional methods<a class="anchor" aria-label="anchor" href="#traditional-methods-4"><i class="fas fa-link"></i></a>
</h3>
<div id="check-conditions-4" class="section level4 unnumbered">
<h4>Check conditions<a class="anchor" aria-label="anchor" href="#check-conditions-4"><i class="fas fa-link"></i></a>
</h4>
<p>Remember that in order to use the shortcut (formula-based, theoretical) approach, we need to check that some conditions are met.</p>
<ol style="list-style-type: decimal">
<li>
<p><em>Independent observations</em>: The observations among pairs are independent.</p>
<p>The locations are selected independently through random sampling so this condition is met.</p>
</li>
<li>
<p><em>Approximately normal</em>: The distribution of population of differences is normal or the number of pairs is at least 30.</p>
<p>The histogram above does show some skew so we have reason to doubt the population being normal based on this sample. We also only have 10 pairs which is fewer than the 30 needed. A theory-based test may not be valid here.</p>
</li>
</ol>
</div>
<div id="test-statistic-4" class="section level4 unnumbered">
<h4>Test statistic<a class="anchor" aria-label="anchor" href="#test-statistic-4"><i class="fas fa-link"></i></a>
</h4>
<p>The test statistic is a random variable based on the sample data. Here, we want to look at a way to estimate the population mean difference <span class="math inline">\(\mu_{diff}\)</span>. A good guess is the sample mean difference <span class="math inline">\(\bar{X}_{diff}\)</span>. Recall that this sample mean is actually a random variable that will vary as different samples are (theoretically, would be) collected. We are looking to see how likely is it for us to have observed a sample mean of <span class="math inline">\(\bar{x}_{diff} = -0.08\)</span> or smaller assuming that the population mean difference is 0 (assuming the null hypothesis is true). If the conditions are met and assuming <span class="math inline">\(H_0\)</span> is true, we can “standardize” this original test statistic of <span class="math inline">\(\bar{X}_{diff}\)</span> into a <span class="math inline">\(T\)</span> statistic that follows a <span class="math inline">\(t\)</span> distribution with degrees of freedom equal to <span class="math inline">\(df = n - 1\)</span>:</p>
<p><span class="math display">\[ T =\dfrac{ \bar{X}_{diff} - 0}{ S_{diff} / \sqrt{n} } \sim t (df = n - 1) \]</span></p>
<p>where <span class="math inline">\(S\)</span> represents the standard deviation of the sample differences and <span class="math inline">\(n\)</span> is the number of pairs.</p>
<div id="observed-test-statistic-4" class="section level5 unnumbered">
<h5>Observed test statistic<a class="anchor" aria-label="anchor" href="#observed-test-statistic-4"><i class="fas fa-link"></i></a>
</h5>
<p>While one could compute this observed test statistic by “hand”, the focus here is on the set-up of the problem and in understanding which formula for the test statistic applies. We can use the <code>t_test</code> function on the differences to perform this analysis for us.</p>
<div class="sourceCode" id="cb686"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_test_results</span> <span class="op">&lt;-</span> <span class="va">zinc_diff</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/t_test.html">t_test</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">pair_diff</span> <span class="op">~</span> <span class="cn">NULL</span>,</span>
<span>    alternative <span class="op">=</span> <span class="st">"less"</span>,</span>
<span>    mu <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">t_test_results</span></span></code></pre></div>
<pre><code># A tibble: 1 × 7
  statistic  t_df     p_value alternative estimate lower_ci   upper_ci
      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
1  -4.86381     9 0.000445558 less         -0.0804     -Inf -0.0500982</code></pre>
<p>We see here that the <span class="math inline">\(t_{obs}\)</span> value is -4.864.</p>
</div>
</div>
<div id="compute-p-value-2" class="section level4 unnumbered">
<h4>Compute <span class="math inline">\(p\)</span>-value<a class="anchor" aria-label="anchor" href="#compute-p-value-2"><i class="fas fa-link"></i></a>
</h4>
<p>The <span class="math inline">\(p\)</span>-value—the probability of observing a <span class="math inline">\(t_{obs}\)</span> value of -4.864 or less in our null distribution of a <span class="math inline">\(t\)</span> with 9 degrees of freedom—is 0. This can also be calculated in R directly:</p>
<div class="sourceCode" id="cb688"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4.8638</span>, df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">zinc_diff</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.000446</code></pre>
</div>
<div id="state-conclusion-4" class="section level4 unnumbered">
<h4>State conclusion<a class="anchor" aria-label="anchor" href="#state-conclusion-4"><i class="fas fa-link"></i></a>
</h4>
<p>We, therefore, have sufficient evidence to reject the null hypothesis. Our initial guess that our observed sample mean difference was not statistically less than the hypothesized mean of 0 has been invalidated here. Based on this sample, we have evidence that the mean concentration in the bottom water is greater than that of the surface water at different paired locations.</p>
</div>
</div>
<div id="comparing-results-4" class="section level3" number="13.6.5">
<h3>
<span class="header-section-number">B.6.5</span> Comparing results<a class="anchor" aria-label="anchor" href="#comparing-results-4"><i class="fas fa-link"></i></a>
</h3>
<p>Observing the bootstrap distribution and the null distribution that were created, it makes quite a bit of sense that the results are so similar for traditional and non-traditional methods in terms of the <span class="math inline">\(p\)</span>-value and the confidence interval since these distributions look very similar to normal distributions. The conditions were not met since the number of pairs was small, but the sample data was not highly skewed. Using any of the methods whether they are traditional (formula-based) or non-traditional (computational-based) lead to similar results here.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="appendixA.html"><span class="header-section-number">A</span> Statistical Background</a></div>
<div class="next"><a href="appendixC.html"><span class="header-section-number">C</span> Tips and Tricks</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#appendixB"><span class="header-section-number">B</span> Inference Examples</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#needed-packages-1">Needed packages</a></li></ul>
</li>
<li><a class="nav-link" href="#inference-mind-map"><span class="header-section-number">B.1</span> Inference mind map</a></li>
<li>
<a class="nav-link" href="#one-mean"><span class="header-section-number">B.2</span> One mean</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#problem-statement"><span class="header-section-number">B.2.1</span> Problem statement</a></li>
<li><a class="nav-link" href="#competing-hypotheses"><span class="header-section-number">B.2.2</span> Competing hypotheses</a></li>
<li><a class="nav-link" href="#exploring-the-sample-data"><span class="header-section-number">B.2.3</span> Exploring the sample data</a></li>
<li><a class="nav-link" href="#non-traditional-methods"><span class="header-section-number">B.2.4</span> Non-traditional methods</a></li>
<li><a class="nav-link" href="#traditional-methods"><span class="header-section-number">B.2.5</span> Traditional methods</a></li>
<li><a class="nav-link" href="#comparing-results"><span class="header-section-number">B.2.6</span> Comparing results</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#one-proportion"><span class="header-section-number">B.3</span> One proportion</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#problem-statement-1"><span class="header-section-number">B.3.1</span> Problem statement</a></li>
<li><a class="nav-link" href="#competing-hypotheses-1"><span class="header-section-number">B.3.2</span> Competing hypotheses</a></li>
<li><a class="nav-link" href="#exploring-the-sample-data-1"><span class="header-section-number">B.3.3</span> Exploring the sample data</a></li>
<li><a class="nav-link" href="#non-traditional-methods-1"><span class="header-section-number">B.3.4</span> Non-traditional methods</a></li>
<li><a class="nav-link" href="#traditional-methods-1"><span class="header-section-number">B.3.5</span> Traditional methods</a></li>
<li><a class="nav-link" href="#comparing-results-1"><span class="header-section-number">B.3.6</span> Comparing results</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#two-proportions"><span class="header-section-number">B.4</span> Two proportions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#problem-statement-2"><span class="header-section-number">B.4.1</span> Problem statement</a></li>
<li><a class="nav-link" href="#competing-hypotheses-2"><span class="header-section-number">B.4.2</span> Competing hypotheses</a></li>
<li><a class="nav-link" href="#exploring-the-sample-data-2"><span class="header-section-number">B.4.3</span> Exploring the sample data</a></li>
<li><a class="nav-link" href="#non-traditional-methods-2"><span class="header-section-number">B.4.4</span> Non-traditional methods</a></li>
<li><a class="nav-link" href="#traditional-methods-2"><span class="header-section-number">B.4.5</span> Traditional methods</a></li>
<li><a class="nav-link" href="#test-statistic-2"><span class="header-section-number">B.4.6</span> Test statistic</a></li>
<li><a class="nav-link" href="#state-conclusion-2"><span class="header-section-number">B.4.7</span> State conclusion</a></li>
<li><a class="nav-link" href="#comparing-results-2"><span class="header-section-number">B.4.8</span> Comparing results</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#two-means-independent-samples"><span class="header-section-number">B.5</span> Two means (independent samples)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#problem-statement-3"><span class="header-section-number">B.5.1</span> Problem statement</a></li>
<li><a class="nav-link" href="#competing-hypotheses-3"><span class="header-section-number">B.5.2</span> Competing hypotheses</a></li>
<li><a class="nav-link" href="#exploring-the-sample-data-3"><span class="header-section-number">B.5.3</span> Exploring the sample data</a></li>
<li><a class="nav-link" href="#non-traditional-methods-3"><span class="header-section-number">B.5.4</span> Non-traditional methods</a></li>
<li><a class="nav-link" href="#traditional-methods-3"><span class="header-section-number">B.5.5</span> Traditional methods</a></li>
<li><a class="nav-link" href="#test-statistic-3"><span class="header-section-number">B.5.6</span> Test statistic</a></li>
<li><a class="nav-link" href="#compute-p-value-1"><span class="header-section-number">B.5.7</span> Compute \(p\)-value</a></li>
<li><a class="nav-link" href="#state-conclusion-3"><span class="header-section-number">B.5.8</span> State conclusion</a></li>
<li><a class="nav-link" href="#comparing-results-3"><span class="header-section-number">B.5.9</span> Comparing results</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#two-means-paired-samples"><span class="header-section-number">B.6</span> Two means (paired samples)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#problem-statement-4">Problem statement</a></li>
<li><a class="nav-link" href="#competing-hypotheses-4"><span class="header-section-number">B.6.1</span> Competing hypotheses</a></li>
<li><a class="nav-link" href="#exploring-the-sample-data-4"><span class="header-section-number">B.6.2</span> Exploring the sample data</a></li>
<li><a class="nav-link" href="#non-traditional-methods-4"><span class="header-section-number">B.6.3</span> Non-traditional methods</a></li>
<li><a class="nav-link" href="#traditional-methods-4"><span class="header-section-number">B.6.4</span> Traditional methods</a></li>
<li><a class="nav-link" href="#comparing-results-4"><span class="header-section-number">B.6.5</span> Comparing results</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/moderndive/ModernDive_book//blob/v2/92-appendixB.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/moderndive/ModernDive_book//edit/v2/92-appendixB.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Statistical Inference via Data Science</strong>: A ModernDive into R and the Tidyverse <br> (Second Edition)" was written by Chester Ismay, Albert Y. Kim, and Arturo Valdivia <br> Foreword by Kelly S. McConville. It was last built on August 06, 2025.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
