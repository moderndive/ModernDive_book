<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>D Learning Check Solutions | Statistical Inference via Data Science</title>
<meta name="author" content="Chester Ismay, Albert Y. Kim, and Arturo Valdivia   Foreword by Kelly S. McConville">
<meta name="generator" content="bookdown 0.46 with bs4_book()">
<meta property="og:title" content="D Learning Check Solutions | Statistical Inference via Data Science">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="D Learning Check Solutions | Statistical Inference via Data Science">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YVFBK9P73R"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-YVFBK9P73R');
    </script><!-- Open Graph Meta Tags --><meta property="og:title" content="ModernDive V2">
<meta property="og:description" content="If you detect any errors or have suggestions regarding these solutions, please file an issue at the ModernDive GitHub repository or, ideally, create a Pull Request on GitHub on the same repository...">
<meta property="og:image" content="https://moderndive.com/v2/images/logos/v2_cover.jpg">
<meta property="og:url" content="https://moderndive.com/v2/appendixD.html">
<meta name="twitter:card" content="summary_large_image">
<!-- Set up favicon --><link rel="icon" href="images/logos/favicons/favicon.ico" type="image/x-icon">
<!-- Redirect to ModernDive V2 --><script>
      if (window.location.pathname === '/v2') {
        window.location.replace(window.location.pathname + '/');
      }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="If you detect any errors or have suggestions regarding these solutions, please file an issue at the ModernDive GitHub repository or, ideally, create a Pull Request on GitHub on the same repository...">
<meta property="og:description" content="A book created with bookdown.">
<meta name="twitter:description" content="If you detect any errors or have suggestions regarding these solutions, please file an issue at the ModernDive GitHub repository or, ideally, create a Pull Request on GitHub on the same repository...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="A ModernDive into R and the Tidyverse &lt;br&gt; (Second Edition)">Statistical Inference via Data Science</a>:
        <small class="text-muted">A ModernDive into R and the Tidyverse <br> (Second Edition)</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to ModernDive (v2)</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="about-the-authors.html">About the authors</a></li>
<li><a class="" href="getting-started.html"><span class="header-section-number">1</span> Getting Started with Data in R</a></li>
<li class="book-part">Data Science with tidyverse</li>
<li><a class="" href="viz.html"><span class="header-section-number">2</span> Data Visualization</a></li>
<li><a class="" href="wrangling.html"><span class="header-section-number">3</span> Data Wrangling</a></li>
<li><a class="" href="tidy.html"><span class="header-section-number">4</span> Data Importing and Tidy Data</a></li>
<li class="book-part">Statistical Modeling with moderndive</li>
<li><a class="" href="regression.html"><span class="header-section-number">5</span> Simple Linear Regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">6</span> Multiple Regression</a></li>
<li class="book-part">Statistical Inference with infer</li>
<li><a class="" href="sampling.html"><span class="header-section-number">7</span> Sampling</a></li>
<li><a class="" href="confidence-intervals.html"><span class="header-section-number">8</span> Estimation, Confidence Intervals, and Bootstrapping</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">9</span> Hypothesis Testing</a></li>
<li><a class="" href="inference-for-regression.html"><span class="header-section-number">10</span> Inference for Regression</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="thinking-with-data.html"><span class="header-section-number">11</span> Tell Your Story with Data</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="appendixA.html"><span class="header-section-number">A</span> Statistical Background</a></li>
<li><a class="" href="appendixB.html"><span class="header-section-number">B</span> Inference Examples</a></li>
<li><a class="" href="appendixC.html"><span class="header-section-number">C</span> Tips and Tricks</a></li>
<li><a class="active" href="appendixD.html"><span class="header-section-number">D</span> Learning Check Solutions</a></li>
<li><a class="" href="the-theory-behind-the-bootstrap-method.html"><span class="header-section-number">E</span> The Theory Behind the Bootstrap Method</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/moderndive/ModernDive_book/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><img src="https://moderndive.com/wide_format.png" alt="ModernDive" style="max-width: 100%; width: 100%; height: auto; display: block; margin: 0 auto; padding-top: 10px;"><div id="appendixD" class="section level1" number="15">
<h1>
<span class="header-section-number">D</span> Learning Check Solutions<a class="anchor" aria-label="anchor" href="#appendixD"><i class="fas fa-link"></i></a>
</h1>
<p>If you detect any errors or have suggestions regarding these solutions, please <a href="https://github.com/moderndive/ModernDive_book/issues">file an issue at the ModernDive GitHub repository</a> or, ideally, create a Pull Request on GitHub on the same repository making the suggested changes yourself (into the <code>v2</code> branch) for us to review. Thanks!</p>
<div id="chapter-1-solutions" class="section level2" number="15.1">
<h2>
<span class="header-section-number">D.1</span> Chapter 1 Solutions<a class="anchor" aria-label="anchor" href="#chapter-1-solutions"><i class="fas fa-link"></i></a>
</h2>
<p><strong>(LC1.1)</strong> Repeat the earlier installation steps … for <code>dplyr</code>, <code>nycflights23</code>, and <code>knitr</code>.</p>
<p><strong>Solution</strong>: In RStudio → <strong>Packages</strong> tab → <strong>Install</strong> → enter <code>dplyr</code>, <code>nycflights23</code>, <code>knitr</code> → <strong>Install</strong>.
(Or run <code>install.packages(c("dplyr","nycflights23","knitr"))</code> in the Console.)</p>
<p><strong>(LC1.2)</strong> “Load” the <code>dplyr</code>, <code>nycflights23</code>, and <code>knitr</code> packages as well by repeating the earlier steps.</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb741"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/nycflights23/">nycflights23</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC1.3)</strong> What does any ONE row in this <code>flights</code> dataset refer to?</p>
<p><strong>Solution</strong>: <strong>B. Data on a flight</strong> (one departure) from a NYC airport in 2023.</p>
<p><strong>(LC1.4)</strong> What are some other examples in this dataset of <em>categorical</em> variables? What makes them different than <em>quantitative</em> variables?</p>
<p><strong>Solution</strong>: Hint: Type <code><a href="https://moderndive.github.io/nycflights23/reference/flights.html">?flights</a></code> in the console to see what all the variables mean!</p>
<ul>
<li>Categorical:
<ul>
<li>
<code>carrier</code> the company</li>
<li>
<code>dest</code> the destination</li>
<li>
<code>flight</code> the flight number. Even though this is a number, its simply a label. Example United 1545 is not less than United 1714</li>
</ul>
</li>
<li>Quantitative:
<ul>
<li>
<code>distance</code> the distance in miles</li>
<li>
<code>time_hour</code> time</li>
</ul>
</li>
</ul>
<p><strong>(LC1.5)</strong> What do <code>lat</code>, <code>lon</code>, <code>alt</code>, <code>tz</code>, <code>dst</code>, and <code>tzone</code> describe in <code>airports</code>? (Best guess.)</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>
<code>lat</code> = latitude, <code>lon</code> = longitude</li>
<li>
<code>alt</code> = airport altitude (likely feet)</li>
<li>
<code>tz</code> = time zone offset from UTC (hours)</li>
<li>
<code>dst</code> = daylight savings time code/indicator</li>
<li>
<code>tzone</code> = time zone name (IANA string)</li>
</ul>
<p><strong>(LC1.6)</strong> Provide variables in a data frame where at least one is an ID variable and at least two are not.</p>
<p><strong>Solution</strong>: In the <code>weather</code> data frame, the combination of <code>origin</code>, <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code> are identification variables as they identify the observation in question.
* Anything else pertains to observations: <code>temp</code>, <code>humid</code>, <code>wind_speed</code>, etc.</p>
<p><strong>(LC1.7)</strong> Look at the help file for <code>airports</code>. Revise your earlier guesses about <code>lat</code>, <code>lon</code>, <code>alt</code>, <code>tz</code>, <code>dst</code>, <code>tzone</code> as needed.</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>
<code>lat</code>, <code>lon</code>: <strong>geographic latitude/longitude</strong> of the airport</li>
<li>
<code>alt</code>: <strong>altitude</strong> (feet)</li>
<li>
<code>tz</code>: <strong>hours offset from UTC</strong> (e.g., −5 for Eastern Standard Time)</li>
<li>
<code>dst</code>: <strong>daylight saving time</strong> indicator (e.g., “A” = observes DST, etc., per help file coding)</li>
<li>
<code>tzone</code>: <strong>IANA time zone name</strong> (e.g., <code>"America/New_York"</code>)</li>
</ul>
<p>This documentation is also available on the package website <a href="https://moderndive.github.io/nycflights23/reference/flights.html">here</a>.</p>
<hr>
</div>
<div id="chapter-2-solutions" class="section level2" number="15.2">
<h2>
<span class="header-section-number">D.2</span> Chapter 2 Solutions<a class="anchor" aria-label="anchor" href="#chapter-2-solutions"><i class="fas fa-link"></i></a>
</h2>
<p>Needed packages</p>
<div class="sourceCode" id="cb742"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/nycflights23/">nycflights23</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC2.1)</strong> Take a look at both the <code>flights</code> data frame from the <code>nycflights23</code> package and the <code>envoy_flights</code> data frame from the <code>moderndive</code> package by running <code>View(flights)</code> and <code>View(envoy_flights)</code>. In what respect do these data frames differ? For example, think about the number of rows in each dataset.</p>
<p><strong>Solution</strong>: <code>envoy_flights</code> is a subset of <code>flights</code> containing only rows where <code>carrier == "MQ"</code> (Envoy Air). It has the same columns but <strong>fewer rows</strong> than <code>flights</code>.</p>
<p><strong>(LC2.2)</strong> What are practical reasons why <code>dep_delay</code> and <code>arr_delay</code> have a positive relationship?</p>
<p><strong>Solution</strong>: If a plane leaves late, it often loses its departure slot, encounters downstream congestion/spacing, and arrives late as well. Crewing/turnaround buffers can’t fully absorb big late departures, so late out often leads to late in (though some time can be made up while in flight).</p>
<p><strong>(LC2.3)</strong> What variables in <code>weather</code> would you expect to have a negative correlation with <code>dep_delay</code>? Why?</p>
<p><strong>Solution</strong>: <strong>Visibility (<code>visib</code>)</strong> and <strong>pressure (<code>pressure</code>)</strong>—higher values usually mean clearer, calmer weather and thus <strong>fewer</strong> delays (negative relationship). (By contrast, <code>precip</code>, <code>wind_speed</code>, <code>wind_gust</code> would tend to be positively related to delays.)</p>
<p><strong>(LC2.4)</strong> Why do you believe there is a cluster of points near (0, 0)? What does (0, 0) correspond to in terms of the Envoy Air flights?</p>
<p><strong>Solution</strong>: (0, 0) is <strong>on-time departure and on-time arrival</strong>. Many flights leave and arrive close to schedule, producing a dense cluster around the origin.</p>
<p><strong>(LC2.5)</strong> What are some other features of the plot that stand out to you?</p>
<p><strong>Solution</strong>: Different people will answer this one differently. One answer is most flights depart and arrive less than an hour late.</p>
<p><strong>(LC2.6)</strong> Create a new scatterplot with different variables in <code>envoy_flights</code>.</p>
<p><strong>Solution</strong>: Many possibilities for this one, see the plot below. Is there a pattern in departure delay depending on when the flight is scheduled to depart? Interestingly, there seems to be only a few blocks of time where flights depart with Envoy.</p>
<div class="sourceCode" id="cb743"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">envoy_flights</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dep_time</span>, y <span class="op">=</span> <span class="va">dep_delay</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-02-alt-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p><strong>(LC2.7)</strong> Why is setting <code>alpha</code> useful with scatterplots?</p>
<p><strong>Solution</strong>: Lower <code>alpha</code> reveals <strong>point density</strong> under overplotting—darker regions indicate where many points overlap, which a regular opaque scatterplot hides.</p>
<p><strong>(LC2.8)</strong> After viewing Figure <a href="viz.html#fig:alpha">2.4</a>, give an approximate range of arrival delays and departure delays that occur most frequently. How has that region changed compared to when you observed the same plot without <code>alpha = 0.2</code> set in Figure <a href="viz.html#fig:noalpha">2.2</a>?</p>
<p><strong>Solution</strong>: The densest region is <strong>near zero</strong> (roughly within about -25 minutes for both departure and arrival). With transparency, that high-density core is <strong>much clearer</strong> than in the opaque plot.</p>
<p><strong>(LC2.9)</strong> Take a look at both the <code>weather</code> data frame from the <code>nycflights23</code> package and the <code>early_january_2023_weather</code> data frame from the <code>moderndive</code> package by running <code>View(weather)</code> and <code>View(early_january_2023_weather)</code>. In what respect do these data frames differ?</p>
<p><strong>Solution</strong>: <code>early_january_2023_weather</code> is a <strong>subset</strong>: only <code>origin == "EWR"</code>, <code>month == 1</code>, and <code>day &lt;= 15</code>. Same variables; <strong>fewer rows</strong>.</p>
<p><strong>(LC2.10)</strong> <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> the <code>flights</code> data frame again. Why does the <code>time_hour</code> variable uniquely identify the hour of the measurement, whereas the <code>hour</code> variable does not?</p>
<p><strong>Solution</strong>: <code>time_hour</code> encodes <strong>date + hour</strong> (a <code>POSIXct</code> timestamp in R). <code>hour</code> alone repeats 0–23 <strong>every day</strong> (and across airports), so it’s not unique.</p>
<p><strong>(LC2.11)</strong> Why should linegraphs be avoided when there is not a clear ordering of the horizontal axis?</p>
<p><strong>Solution</strong>: Connecting points implies a meaningful <strong>sequence/continuity</strong>. Without a real order, lines suggest patterns that don’t exist and can mislead.</p>
<p><strong>(LC2.12)</strong> Why are linegraphs frequently used when time is the explanatory variable on the x-axis?</p>
<p><strong>Solution</strong>: Time is inherently <strong>ordered</strong>; connecting adjacent times shows <strong>trends and changes over time</strong> smoothly.</p>
<p><strong>(LC2.13)</strong> Plot a time series of a variable other than <code>wind_speed</code> for Newark Airport in the first 15 days of January 2023. Try to select a variable that doesn’t have a lot of missing (<code>NA</code>) values.</p>
<p><strong>Solution</strong>:</p>
<p>One example is <code>visib</code>ility.</p>
<div class="sourceCode" id="cb744"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">early_january_2023_weather</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_hour</span>, y <span class="op">=</span> <span class="va">visib</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-02-demo-code-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p><strong>(LC2.14)</strong> What does changing the number of bins from 30 to 20 tell us about the distribution of wind speeds?</p>
<p><strong>Solution</strong>: Fewer, wider bins <strong>smooth</strong> the histogram, making the overall pattern clearer (most observations at lower speeds), while sacrificing fine detail.</p>
<p><strong>(LC2.15)</strong> Would you classify the distribution of wind speeds as symmetric or skewed in one direction or another?</p>
<p><strong>Solution</strong>: <strong>Right-skewed</strong>—a concentration at low speeds with a tail extending to higher wind speeds.</p>
<p><strong>(LC2.16)</strong> What would you guess is the “center” value in this distribution? Why did you make that choice?</p>
<p><strong>Solution</strong>: Around <strong>~10 mph</strong>. The tallest bins cluster roughly in the 5–15 mph range, so the typical value is near 10.</p>
<p><strong>(LC2.17)</strong> Is this data spread out greatly from the center or is it close? Why?</p>
<p><strong>Solution</strong>: <strong>Moderate spread</strong>: most values are between 0–20 mph, with relatively few beyond 30 mph (a right tail but not extremely wide).</p>
<p><strong>(LC2.18)</strong> What other things do you notice about this faceted plot? How does a faceted plot help us see relationships between two variables?</p>
<p><strong>Solution</strong>: Distributions look <strong>similar across months</strong>, with some months slightly windier. Faceting puts months in <strong>comparable panels with shared scales</strong>, making cross-month contrasts easy.</p>
<p><strong>(LC2.19)</strong> What do 1–12 correspond to? What about 10, 20, 30?</p>
<p><strong>Solution</strong>: <strong>1–12 = months</strong> of the year. <strong>10, 20, 30 = wind speed tick marks (mph)</strong> on the x-axis.</p>
<p><strong>(LC2.20)</strong> For which types of datasets would faceted plots not work well in comparing relationships between variables? Give an example describing the nature of these variables and other important characteristics.</p>
<p><strong>Solution</strong>: When the facetting variable has <strong>many levels</strong> (e.g., hundreds of ZIP codes) or <strong>few observations per level</strong>, producing tiny, sparse panels that are hard to compare.</p>
<p><strong>(LC2.21)</strong> Does the <code>wind_speed</code> variable in the <code>weather</code> dataset have a lot of variability? Why do you say that?</p>
<p><strong>Solution</strong>: <strong>Some</strong>, but mostly concentrated: many observations between <strong>0–20 mph</strong>, with fewer high-speed outliers. So variability exists with a right tail, but the bulk is low-to-moderate.</p>
<p><strong>(LC2.22)</strong> What do the dots at the top of the plot for January correspond to? Explain what might have occurred in January to produce these points.</p>
<p><strong>Solution</strong>: <strong>Outliers</strong> (unusually high winds). Likely stormy or gusty winter days causing much higher wind speeds.</p>
<p><strong>(LC2.23)</strong> Which months have the highest variability in wind speed? Why?</p>
<p><strong>Solution</strong>: <strong>Winter months (e.g., Jan–Mar)</strong> show wider spread likely due to seasonal systems bringing stronger, more variable winds.</p>
<p><strong>(LC2.24)</strong> We looked at the distribution of the numerical variable <code>wind_speed</code> split by the numerical variable <code>month</code> that we converted using the <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> function in order to make a side-by-side boxplot. Why would a boxplot of <code>wind_speed</code> split by the numerical variable <code>pressure</code> similarly converted to a categorical variable using the <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> not be informative?</p>
<p><strong>Solution</strong>: <code>pressure</code> is <strong>continuous with many distinct values</strong>; turning it into a factor yields <strong>lots of tiny groups</strong> with few points each. This leads to clutter that is hard to interpret.</p>
<p><strong>(LC2.25)</strong> Boxplots provide a simple way to identify outliers. Why may outliers be easier to identify when looking at a boxplot instead of a faceted histogram?</p>
<p><strong>Solution</strong>: Boxplots <strong>explicitly mark</strong> outliers as points; histograms spread counts across bins, so rare extreme values don’t stand out as clearly.</p>
<p><strong>(LC2.26)</strong> Why are histograms inappropriate for categorical variables?</p>
<p><strong>Solution</strong>: Histograms assume a <strong>numeric</strong>, <strong>ordered</strong> x-axis and contiguous bins. Categorical levels aren’t numeric or ordered in that sense.</p>
<p><strong>(LC2.27)</strong> What is the difference between histograms and barplots?</p>
<p><strong>Solution</strong>: <strong>Histograms</strong>: numeric variable, contiguous bins (no gaps), y = counts/density. <strong>Barplots</strong>: categorical variable, separate bars with gaps, y = counts (or given frequencies).</p>
<p><strong>(LC2.28)</strong> How many Alaska Air flights departed NYC in 2023?</p>
<p><strong>Solution</strong>: <strong>7,843 flights</strong> (<code>carrier == "AS"</code>).</p>
<p><strong>(LC2.29)</strong> What was the 7th highest airline for departed flights from NYC in 2023? How could we better present the table to get this answer quickly?</p>
<p><strong>Solution</strong>: Sorted by departures, the 7th highest is <strong>NK</strong> (Spirit Airlines) with <strong>15,189 flights</strong>.
A <strong>descending sort</strong> of the table or an <strong>ordered barplot</strong> makes rankings clearer at a glance.</p>
<p><strong>(LC2.30)</strong> Why should pie charts be avoided and replaced by barplots?</p>
<p><strong>Solution</strong>: Humans compare <strong>lengths</strong> better than <strong>angles/areas</strong>. Pie charts distort judgments (angles &gt; 90 degrees overestimated, &lt; 90 degrees underestimated); barplots enable clean, one-axis comparisons.</p>
<p><strong>(LC2.31)</strong> Why do you think people continue to use pie charts?</p>
<p><strong>Solution</strong>: Familiar defaults in some plotting software, perceived simplicity/aesthetics, and stakeholder expectations (even though they’re harder to read accurately).</p>
<p><strong>(LC2.32)</strong> What kinds of questions are not easily answered by looking at Figure <a href="viz.html#fig:flights-stacked-bar">2.23</a>?</p>
<p><strong>Solution</strong>: Comparing <strong>origins across carriers</strong> is hard (segments lack a common baseline). It’s also hard to see <strong>small differences</strong> within stacked segments.</p>
<p><strong>(LC2.33)</strong> What can you say, if anything, about the relationship between airline and airport in NYC in 2023 in regard to the number of departing flights?</p>
<p><strong>Solution</strong>: Carriers show <strong>airport specialization patterns</strong>. Some airlines have many more departures from one NYC airport than the others.</p>
<p><strong>(LC2.34)</strong> Why might the side-by-side barplot be preferable to a stacked barplot in this case?</p>
<p><strong>Solution</strong>: They give each origin a <strong>common baseline within each carrier</strong>, making cross-origin comparisons <strong>straightforward</strong>.</p>
<p><strong>(LC2.35)</strong> What are the disadvantages of using a dodged barplot, in general?</p>
<p><strong>Solution</strong>: Can <strong>clutter</strong> with many categories; labels/legend get busy; totals are harder to read; bars become thin and harder to compare when levels proliferate.</p>
<p><strong>(LC2.36)</strong> Why is the faceted barplot preferred to the side-by-side and stacked barplots in this case?</p>
<p><strong>Solution</strong>: Separate panels per origin reduce clutter and keep <strong>shared scales</strong>, making it easier to <strong>rank carriers within each airport</strong> and compare patterns across airports.</p>
<p><strong>(LC2.37)</strong> What information about the different carriers at different airports is more easily seen in the faceted barplot?</p>
<p><strong>Solution</strong>: <strong>Which carriers dominate each airport</strong>, clear <strong>rankings within each airport</strong>, and presence/absence of specific carriers at specific airports, without the visual interference of stacking or dodging.</p>
<hr>
</div>
<div id="chapter-3-solutions" class="section level2" number="15.3">
<h2>
<span class="header-section-number">D.3</span> Chapter 3 Solutions<a class="anchor" aria-label="anchor" href="#chapter-3-solutions"><i class="fas fa-link"></i></a>
</h2>
<p>Needed packages</p>
<div class="sourceCode" id="cb745"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/nycflights23/">nycflights23</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC3.1)</strong> What’s another way of using the “not” operator <code>!</code> to filter only the rows that are not going to Burlington, VT nor Seattle, WA in the <code>flights</code> data frame? Test this out using the previous code.</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb746"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Original in book</span></span>
<span><span class="va">not_BTV_SEA</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">dest</span> <span class="op">==</span> <span class="st">"BTV"</span> <span class="op">|</span> <span class="va">dest</span> <span class="op">==</span> <span class="st">"SEA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternative way</span></span>
<span><span class="va">not_BTV_SEA</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">dest</span> <span class="op">==</span> <span class="st">"BTV"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">dest</span> <span class="op">==</span> <span class="st">"SEA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Yet another way</span></span>
<span><span class="va">not_BTV_SEA</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">dest</span> <span class="op">!=</span> <span class="st">"BTV"</span>, <span class="va">dest</span> <span class="op">!=</span> <span class="st">"SEA"</span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC3.2)</strong> Say a doctor is studying the effect of smoking on lung cancer for a large number of patients who have records measured at five-year intervals. She notices that a large number of patients have missing data points because the patient has died, so she chooses to ignore these patients in her analysis. What is wrong with this doctor’s approach?</p>
<p><strong>Solution</strong>: That introduces <strong>survivorship bias / informative dropout</strong>. Missingness is <em>not at random</em> (death is related to smoking/cancer). Excluding them biases effects toward healthier survivors and underestimates harm.</p>
<p><strong>(LC3.3)</strong> Modify the above <code>summarize</code> function to create <code>summary_temp</code> to also use the <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> summary function: <code>summarize(count = n())</code>. What does the returned value correspond to?</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb747"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_windspeed</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">wind_speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            std_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">wind_speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><code>count</code> is the <strong>number of rows summarized</strong> (per group if grouped). It does <strong>not</strong> ignore <code>NA</code>s unless you pre-filter.</p>
<p><strong>(LC3.4)</strong> Why doesn’t the following code work? Run the code line-by-line instead of all at once, and then look at the data. In other words, select and then run <code>summary_windspeed &lt;- weather |&gt; summarize(mean = mean(wind_speed, na.rm = TRUE))</code> first.</p>
<div class="sourceCode" id="cb748"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_windspeed</span> <span class="op">&lt;-</span> <span class="va">weather</span> <span class="op">|&gt;</span>   </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">wind_speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>std_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">wind_speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Solution</strong>: After the first <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> you have a 1-row data frame with only <code>mean</code>; <code>wind_speed</code> no longer exists, so the second <code>summarize(sd(wind_speed))</code> errors. Compute both in one step to fix it:</p>
<div class="sourceCode" id="cb749"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">wind_speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                     std_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">wind_speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC3.5)</strong> Recall from Chapter <a href="viz.html#viz">2</a> when we looked at wind speeds by months in NYC. What does the standard deviation column in the <code>summary_monthly_temp</code> data frame tell us about temperatures in NYC throughout the year?</p>
<div class="inline-table"><table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
month
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
std_dev
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
42.8
</td>
<td style="text-align:right;">
6.37
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
40.3
</td>
<td style="text-align:right;">
10.32
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
43.9
</td>
<td style="text-align:right;">
6.76
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
56.0
</td>
<td style="text-align:right;">
9.64
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
62.4
</td>
<td style="text-align:right;">
8.45
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
69.6
</td>
<td style="text-align:right;">
6.47
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
79.2
</td>
<td style="text-align:right;">
5.51
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
75.3
</td>
<td style="text-align:right;">
5.05
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
70.1
</td>
<td style="text-align:right;">
9.09
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
61.0
</td>
<td style="text-align:right;">
7.80
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
47.0
</td>
<td style="text-align:right;">
7.91
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
43.9
</td>
<td style="text-align:right;">
6.79
</td>
</tr>
</tbody>
</table></div>
<p><strong>Solution</strong>: The SD shows <strong>within-month variability</strong> of temperatures. The largest spread for a given month was in February with the second highest in April. This would lead us to expect different temperatures on different days in those months compared to months like July and August that have the smallest standard deviations.</p>
<p><strong>(LC3.6)</strong> What code would be required to get the mean and standard deviation wind speed for each day in 2023 for NYC?</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb750"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weather</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_ws <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">wind_speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            sd_ws <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">wind_speed</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 364 × 5
    year month   day  mean_ws   sd_ws
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1  2023     1     1  8.39110 4.56829
 2  2023     1     2  5.45022 2.49590
 3  2023     1     3  4.76295 3.29083
 4  2023     1     4  5.30637 2.84225
 5  2023     1     5  5.57809 2.93970
 6  2023     1     6  6.24937 3.76913
 7  2023     1     7 10.8525  2.81767
 8  2023     1     8  8.34316 3.37724
 9  2023     1     9  8.26324 4.19758
10  2023     1    10  8.49308 2.53893
# ℹ 354 more rows</code></pre>
<p>Note: <code>group_by(day)</code> is not enough, because <code>day</code> is a value between 1-31. We need to <code>group_by(year, month, day)</code>.</p>
<p><strong>(LC3.7)</strong> Recreate <code>by_monthly_origin</code>, but instead of grouping via <code>group_by(origin, month)</code>, group variables in a different order <code>group_by(month, origin)</code>. What differs in the resulting dataset?</p>
<div class="sourceCode" id="cb752"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">by_monthly_origin</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">origin</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb753"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">by_monthly_origin</span></span></code></pre></div>
<div class="inline-table"><table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
month
</th>
<th style="text-align:left;">
origin
</th>
<th style="text-align:right;">
count
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
11623
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
10918
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
13479
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
10991
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
10567
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
13203
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
12593
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
12158
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
14763
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
12022
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
11638
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
13816
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
12371
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
11822
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
14517
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
11339
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
11014
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
13568
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
11646
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
11188
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
13377
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
11561
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
11130
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
14074
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
11373
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
10760
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
13372
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
11805
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
10920
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
13861
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
10737
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
10520
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
13264
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:right;">
10517
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:right;">
10413
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:right;">
12432
</td>
</tr>
</tbody>
</table></div>
<p>In <code>by_monthly_origin</code> the <code>month</code> column is now first and the rows are sorted by <code>month</code> instead of origin. If you compare the values of <code>count</code> in <code>by_origin_monthly</code> and <code>by_monthly_origin</code> using the <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> function, you’ll see that the values are actually the same, just presented in a different order.</p>
<p><strong>Solution</strong>: The <strong>counts are identical</strong>; only the <strong>grouping structure and column order</strong> of the grouping keys in the result differ (and potentially the default post-summarize grouping retained/dropped message).</p>
<p><strong>(LC3.8)</strong> How could we identify how many flights left each of the three airports for each <code>carrier</code>?</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb754"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_flights_by_airport</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">origin</span>, <span class="va">carrier</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>num <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">origin</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">num</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb755"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count_flights_by_airport</span></span></code></pre></div>
<div class="inline-table"><table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
origin
</th>
<th style="text-align:left;">
carrier
</th>
<th style="text-align:right;">
num
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
UA
</td>
<td style="text-align:right;">
72545
</td>
</tr>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
YX
</td>
<td style="text-align:right;">
29077
</td>
</tr>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
NK
</td>
<td style="text-align:right;">
9430
</td>
</tr>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
AA
</td>
<td style="text-align:right;">
7559
</td>
</tr>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
B6
</td>
<td style="text-align:right;">
6855
</td>
</tr>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
DL
</td>
<td style="text-align:right;">
6355
</td>
</tr>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
AS
</td>
<td style="text-align:right;">
3676
</td>
</tr>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
9E
</td>
<td style="text-align:right;">
1728
</td>
</tr>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
G4
</td>
<td style="text-align:right;">
671
</td>
</tr>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
MQ
</td>
<td style="text-align:right;">
357
</td>
</tr>
<tr>
<td style="text-align:left;">
EWR
</td>
<td style="text-align:left;">
OO
</td>
<td style="text-align:right;">
325
</td>
</tr>
<tr>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:left;">
B6
</td>
<td style="text-align:right;">
43418
</td>
</tr>
<tr>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:left;">
DL
</td>
<td style="text-align:right;">
29424
</td>
</tr>
<tr>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:left;">
9E
</td>
<td style="text-align:right;">
19316
</td>
</tr>
<tr>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:left;">
YX
</td>
<td style="text-align:right;">
17436
</td>
</tr>
<tr>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:left;">
AA
</td>
<td style="text-align:right;">
14319
</td>
</tr>
<tr>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:left;">
OO
</td>
<td style="text-align:right;">
4602
</td>
</tr>
<tr>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:left;">
AS
</td>
<td style="text-align:right;">
4167
</td>
</tr>
<tr>
<td style="text-align:left;">
JFK
</td>
<td style="text-align:left;">
HA
</td>
<td style="text-align:right;">
366
</td>
</tr>
<tr>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:left;">
YX
</td>
<td style="text-align:right;">
42272
</td>
</tr>
<tr>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:left;">
9E
</td>
<td style="text-align:right;">
33097
</td>
</tr>
<tr>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:left;">
DL
</td>
<td style="text-align:right;">
25783
</td>
</tr>
<tr>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:left;">
AA
</td>
<td style="text-align:right;">
18647
</td>
</tr>
<tr>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:left;">
B6
</td>
<td style="text-align:right;">
15896
</td>
</tr>
<tr>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:left;">
WN
</td>
<td style="text-align:right;">
12385
</td>
</tr>
<tr>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:left;">
UA
</td>
<td style="text-align:right;">
7096
</td>
</tr>
<tr>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:left;">
NK
</td>
<td style="text-align:right;">
5759
</td>
</tr>
<tr>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:left;">
OO
</td>
<td style="text-align:right;">
1505
</td>
</tr>
<tr>
<td style="text-align:left;">
LGA
</td>
<td style="text-align:left;">
F9
</td>
<td style="text-align:right;">
1286
</td>
</tr>
</tbody>
</table></div>
<p>Note: the <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> function counts rows, whereas the <code>sum(VARIABLE_NAME)</code> function sums all values of a certain numerical variable <code>VARIABLE_NAME</code>.</p>
<p><strong>(LC3.9)</strong> How does the <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> operation differ from a <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> followed by a <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>?</p>
<p><strong>Solution</strong>: <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> <strong>keeps/discards rows</strong> based on conditions (no aggregation). <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>+<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> <strong>collapses rows into group-level statistics</strong>.</p>
<p><strong>(LC3.10)</strong> What do positive values of the <code>gain</code> variable in <code>flights</code> correspond to? What about negative values? And what about a zero value?</p>
<p><strong>Solution</strong>: <code>gain = dep_delay - arr_delay</code>.
Positive ⇒ <strong>made up time</strong> (arrived earlier/less late than departure delay).
Negative ⇒ <strong>lost time</strong> (arrived even later relative to departure delay).
Zero ⇒ <strong>no change</strong>.</p>
<ul>
<li>Say a flight departed 20 minutes late, i.e. <code>dep_delay = 20</code>.</li>
<li>Then arrived 10 minutes late, i.e. <code>arr_delay = 10</code>.</li>
<li>Then <code>gain = dep_delay - arr_delay = 20 - 10  = 10</code> is positive, so it “made up/gained time in the air.”</li>
<li>0 means the departure and arrival time were the same, so no time was made up in the air. We see in most cases that the <code>gain</code> is near 0 minutes.</li>
<li>I never understood this. If the pilot says “we’re going make up time in the air”
because of delay by flying faster, why don’t you always just fly faster to begin
with?</li>
</ul>
<p><strong>(LC3.11)</strong> Could we create the <code>dep_delay</code> and <code>arr_delay</code> columns by simply subtracting <code>dep_time</code> from <code>sched_dep_time</code> and similarly for arrivals? Try the code out and explain any differences between the result and what actually appears in <code>flights</code>.</p>
<p><strong>Solution</strong>: Not reliably. <code>dep_time</code>/<code>sched_dep_time</code> are <strong>clock times (hhmm)</strong> and can cross midnight; simple subtraction ignores <strong>rollovers/time parsing</strong>. The provided <code>dep_delay</code>/<code>arr_delay</code> already account for that logic. You can’t do direct arithmetic on times. The difference in time between 12:03 and 11:59 is 4 minutes, but <code>1203-1159 = 44</code>.</p>
<p><strong>(LC3.12)</strong> What can we say about the distribution of <code>gain</code>? Describe it in a few sentences using the plot and the <code>gain_summary</code> data frame values.</p>
<p><strong>Solution</strong>: The histogram is <strong>centered near 0</strong> with most flights having small gains/losses, and <strong>long tails</strong> in both directions. Median is near 0 at 11; a few flights gain or lose a lot of minutes, but that’s uncommon.</p>
<p><strong>(LC3.13)</strong> Looking at Figure <a href="wrangling.html#fig:reldiagram">3.7</a>, when joining <code>flights</code> and <code>weather</code> (or, in other words, matching the hourly weather values with each flight), why do we need to join by all of <code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code>, and <code>origin</code>, and not just <code>hour</code>?</p>
<p><strong>Solution</strong>: <code>hour</code> repeats every day and at all three origins. You need <strong>year, month, day, hour, origin</strong> to uniquely identify the <strong>correct hourly record at the correct airport</strong>. <code>hour</code> is simply a value between 0 and 23; to identify a <em>specific</em> hour, we need to know which year, month, day and at which airport.</p>
<p><strong>(LC3.14)</strong> What surprises you about the top 10 destinations from NYC in 2023?</p>
<p><strong>Solution</strong>: Answers vary. Example: heavy traffic to <strong>Florida hubs</strong> and <strong>ORD/ATL</strong>; <strong>west-coast</strong> volumes lower/higher than intuition. Also, the high number of flights to Boston; wouldn’t it be easier and quicker to take the train?</p>
<p><strong>(LC3.15)</strong> What are some advantages of data in normal forms? What are some disadvantages?</p>
<p><strong>Solution</strong>: Pros: <strong>less redundancy</strong>, <strong>consistent updates</strong>, <strong>smaller storage</strong>, <strong>clean joins</strong>. Cons: Need <strong>more joins</strong>, queries can be <strong>harder/slower</strong>, less convenient for quick, denormalized reporting.</p>
<p><strong>(LC3.16)</strong> What are some ways to select all three of the <code>dest</code>, <code>air_time</code>, and <code>distance</code> variables from <code>flights</code>? Give the code showing how to do this in at least three different ways.</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb756"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dest</span>, <span class="va">air_time</span>, <span class="va">distance</span><span class="op">)</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dest</span>, <span class="va">air_time</span>, <span class="va">distance</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dest</span><span class="op">:</span><span class="va">distance</span><span class="op">)</span> </span>
<span><span class="co"># If you check out the dplyr help pages you'll also see `any_of()`</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dest"</span>,<span class="st">"air_time"</span>,<span class="st">"distance"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC3.17)</strong> How could one use <code>starts_with</code>, <code>ends_with</code>, and <code>contains</code> to select columns from the <code>flights</code> data frame? Provide three different examples in total: one for <code>starts_with</code>, one for <code>ends_with</code>, and one for <code>contains</code>.</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb757"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"sched_"</span><span class="op">)</span><span class="op">)</span>     <span class="co"># e.g., sched_dep_time, sched_arr_time</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"_delay"</span><span class="op">)</span><span class="op">)</span>       <span class="co"># dep_delay, arr_delay</span></span>
<span><span class="va">flights</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"time"</span><span class="op">)</span><span class="op">)</span>          <span class="co"># dep_time, arr_time, sched_*_time, etc.</span></span></code></pre></div>
<p><strong>(LC3.18)</strong> Why might we want to use the <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> function on a data frame?</p>
<p><strong>Solution</strong>: To <strong>focus</strong> on relevant variables, <strong>declutter</strong> views, <strong>speed up</strong> downstream operations/joins, and <strong>reduce memory</strong>.</p>
<p><strong>(LC3.19)</strong> Create a new data frame that shows the top 5 airports with the largest arrival delays from NYC in 2023.</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb758"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top5_arr_delay</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dest</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_arr_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">arr_delay</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .groups<span class="op">=</span><span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">mean_arr_delay</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Useful for looking up the name of the airports!</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">airports</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dest"</span> <span class="op">=</span> <span class="st">"faa"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Can rename with select too!</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">dest</span>, airport_name <span class="op">=</span> <span class="va">name</span>, <span class="va">mean_arr_delay</span><span class="op">)</span></span>
<span><span class="va">top5_arr_delay</span></span></code></pre></div>
<pre><code># A tibble: 5 × 3
  dest  airport_name                                mean_arr_delay
  &lt;chr&gt; &lt;chr&gt;                                                &lt;dbl&gt;
1 PSE   Mercedita Airport                                  37.5549
2 ANC   Ted Stevens Anchorage International Airport        36.4505
3 RNO   Reno Tahoe International Airport                   34.4341
4 ABQ   Albuquerque International Sunport                  26.7156
5 ONT   Ontario International Airport                      26.1388</code></pre>
<p><strong>(LC3.20)</strong> Using the datasets included in the <code>nycflights23</code> package, compute the available seat miles for each airline sorted in descending order. After completing all the necessary data wrangling steps, the resulting data frame should have 13 rows (one for each airline) and 2 columns (airline name and available seat miles). Here are some hints:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Crucial</strong>: Unless you are very confident in what you are doing, it is worthwhile to not starting coding right away, but rather first sketch out on paper all the necessary data wrangling steps not using exact code, but rather high-level <em>pseudocode</em> that is informal yet detailed enough to articulate what you are doing. This way you won’t confuse <em>what</em> you are trying to do (the algorithm) with <em>how</em> you are going to do it (writing <code>dplyr</code> code).</li>
<li>Take a close look at all the datasets using the <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> function: <code>flights</code>, <code>weather</code>, <code>planes</code>, <code>airports</code>, and <code>airlines</code> to identify which variables are necessary to compute available seat miles.</li>
<li>Figure <a href="wrangling.html#fig:reldiagram">3.7</a> above showing how the various datasets can be joined will also be useful.</li>
<li>Consider the data wrangling verbs in Table <a href="wrangling.html#tab:wrangle-summary-table">3.2</a> as your toolbox!</li>
</ol>
<p><strong>Solution</strong>: Here are some examples of student-written <a href="https://twitter.com/rudeboybert/status/964181298691629056">pseudocode</a>. Based on our own pseudocode, let’s first display the entire solution.</p>
<div class="sourceCode" id="cb760"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">planes</span>, by <span class="op">=</span> <span class="st">"tailnum"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">carrier</span>, <span class="va">seats</span>, <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="va">seats</span> <span class="op">*</span> <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">carrier</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ASM</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">ASM</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 13 × 2
   carrier         ASM
   &lt;chr&gt;         &lt;dbl&gt;
 1 UA      18753552904
 2 B6      18302094316
 3 DL      15282765973
 4 AA      11173950579
 5 NK       3880566315
 6 YX       3512338372
 7 AS       2974953367
 8 9E       2501279760
 9 WN       1986242879
10 HA        683807124
11 OO        325167024
12 F9        230428926
13 MQ         16311790</code></pre>
<p>Let’s now break this down step-by-step. To compute the available seat miles for a given flight, we need the <code>distance</code> variable from the <code>flights</code> data frame and the <code>seats</code> variable from the <code>planes</code> data frame, necessitating a join by the key variable <code>tailnum</code> as illustrated in Figure <a href="wrangling.html#fig:reldiagram">3.7</a>. To keep the resulting data frame easy to view, we’ll <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> only these two variables and <code>carrier</code>:</p>
<div class="sourceCode" id="cb762"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">planes</span>, by <span class="op">=</span> <span class="st">"tailnum"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">carrier</span>, <span class="va">seats</span>, <span class="va">distance</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 424,068 × 3
   carrier seats distance
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;
 1 UA        149     2500
 2 DL        222      760
 3 B6        200     1576
 4 B6         20      636
 5 UA        149      488
 6 AA        162     1085
 7 B6        246     1576
 8 AA        162      719
 9 UA        178     1400
10 NK        190     1065
# ℹ 424,058 more rows</code></pre>
<p>Now for each flight we can compute the available seat miles <code>ASM</code> by multiplying the number of seats by the distance via a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>:</p>
<div class="sourceCode" id="cb764"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">planes</span>, by <span class="op">=</span> <span class="st">"tailnum"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">carrier</span>, <span class="va">seats</span>, <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Added:</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="va">seats</span> <span class="op">*</span> <span class="va">distance</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 424,068 × 4
   carrier seats distance    ASM
   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;
 1 UA        149     2500 372500
 2 DL        222      760 168720
 3 B6        200     1576 315200
 4 B6         20      636  12720
 5 UA        149      488  72712
 6 AA        162     1085 175770
 7 B6        246     1576 387696
 8 AA        162      719 116478
 9 UA        178     1400 249200
10 NK        190     1065 202350
# ℹ 424,058 more rows</code></pre>
<p>Next we want to sum the <code>ASM</code> for each carrier. We achieve this by first grouping by <code>carrier</code> and then summarizing using the <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> function:</p>
<div class="sourceCode" id="cb766"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">planes</span>, by <span class="op">=</span> <span class="st">"tailnum"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">carrier</span>, <span class="va">seats</span>, <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="va">seats</span> <span class="op">*</span> <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Added:</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">carrier</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ASM</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 13 × 2
   carrier         ASM
   &lt;chr&gt;         &lt;dbl&gt;
 1 9E       2501279760
 2 AA      11173950579
 3 AS       2974953367
 4 B6      18302094316
 5 DL      15282765973
 6 F9        230428926
 7 HA        683807124
 8 MQ         16311790
 9 NK       3880566315
10 OO        325167024
11 UA      18753552904
12 WN       1986242879
13 YX       3512338372</code></pre>
<p>However, because for certain carriers certain flights have missing <code>NA</code> values, the resulting table also returns <code>NA</code>’s. We can eliminate these by adding a <code>na.rm = TRUE</code> argument to <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>, telling R that we want to remove the <code>NA</code>’s in the sum. We saw this in Section <a href="wrangling.html#summarize">3.3</a>:</p>
<div class="sourceCode" id="cb768"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">planes</span>, by <span class="op">=</span> <span class="st">"tailnum"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">carrier</span>, <span class="va">seats</span>, <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="va">seats</span> <span class="op">*</span> <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">carrier</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Modified:</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ASM</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 13 × 2
   carrier         ASM
   &lt;chr&gt;         &lt;dbl&gt;
 1 9E       2501279760
 2 AA      11173950579
 3 AS       2974953367
 4 B6      18302094316
 5 DL      15282765973
 6 F9        230428926
 7 HA        683807124
 8 MQ         16311790
 9 NK       3880566315
10 OO        325167024
11 UA      18753552904
12 WN       1986242879
13 YX       3512338372</code></pre>
<p>Finally, we <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> the data in <code><a href="https://dplyr.tidyverse.org/reference/desc.html">desc()</a></code>ending order of <code>ASM</code>.</p>
<div class="sourceCode" id="cb770"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">planes</span>, by <span class="op">=</span> <span class="st">"tailnum"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">carrier</span>, <span class="va">seats</span>, <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="va">seats</span> <span class="op">*</span> <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">carrier</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ASM</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Added:</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">ASM</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 13 × 2
   carrier         ASM
   &lt;chr&gt;         &lt;dbl&gt;
 1 UA      18753552904
 2 B6      18302094316
 3 DL      15282765973
 4 AA      11173950579
 5 NK       3880566315
 6 YX       3512338372
 7 AS       2974953367
 8 9E       2501279760
 9 WN       1986242879
10 HA        683807124
11 OO        325167024
12 F9        230428926
13 MQ         16311790</code></pre>
<p>While the above data frame is correct, the IATA <code>carrier</code> code is not always useful. For example, what carrier is <code>WN</code>? We can address this by joining with the <code>airlines</code> dataset using <code>carrier</code> is the key variable. While this step is not absolutely required, it goes a long way to making the table easier to make sense of. It is important to be empathetic with the ultimate consumers of your presented data!</p>
<div class="sourceCode" id="cb772"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">planes</span>, by <span class="op">=</span> <span class="st">"tailnum"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">carrier</span>, <span class="va">seats</span>, <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="va">seats</span> <span class="op">*</span> <span class="va">distance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">carrier</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>ASM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ASM</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">ASM</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Added:</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">airlines</span>, by <span class="op">=</span> <span class="st">"carrier"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">carrier</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 13 × 2
           ASM name                  
         &lt;dbl&gt; &lt;chr&gt;                 
 1 18753552904 United Air Lines Inc. 
 2 18302094316 JetBlue Airways       
 3 15282765973 Delta Air Lines Inc.  
 4 11173950579 American Airlines Inc.
 5  3880566315 Spirit Air Lines      
 6  3512338372 Republic Airline      
 7  2974953367 Alaska Airlines Inc.  
 8  2501279760 Endeavor Air Inc.     
 9  1986242879 Southwest Airlines Co.
10   683807124 Hawaiian Airlines Inc.
11   325167024 SkyWest Airlines Inc. 
12   230428926 Frontier Airlines Inc.
13    16311790 Envoy Air             </code></pre>
<hr>
</div>
<div id="chapter-4-solutions" class="section level2" number="15.4">
<h2>
<span class="header-section-number">D.4</span> Chapter 4 Solutions<a class="anchor" aria-label="anchor" href="#chapter-4-solutions"><i class="fas fa-link"></i></a>
</h2>
<p>Needed packages</p>
<div class="sourceCode" id="cb774"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/nycflights23/">nycflights23</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rudeboybert/fivethirtyeight">fivethirtyeight</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC4.1)</strong> What are common characteristics of “tidy” datasets?</p>
<p><strong>Solution</strong>: Rows correspond to observations, while columns correspond to variables. Each type of observational unit is stored in its own table.</p>
<p><strong>(LC4.2)</strong> What makes “tidy” datasets useful for organizing data?</p>
<p><strong>Solution</strong>: Tidy datasets are an organized way of viewing data. This format is required for the <code>ggplot2</code> and <code>dplyr</code> packages for data visualization and wrangling. They provide a consistent, standardized structure so that functions work seamlessly together across packages. This uniform format makes it easier to wrangle, visualize, and analyze data without reshaping it repeatedly.</p>
<p><strong>(LC4.3)</strong> Take a look the <code>airline_safety</code> data frame included in the <code>fivethirtyeight</code> data. Run the following:</p>
<div class="sourceCode" id="cb775"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airline_safety</span></span></code></pre></div>
<p>After reading the help file by running <code><a href="https://rdrr.io/pkg/fivethirtyeight/man/airline_safety.html">?airline_safety</a></code>, we see that <code>airline_safety</code> is a data frame containing information on different airlines companies’ safety records. This data was originally reported on the data journalism website FiveThirtyEight.com in Nate Silver’s article <a href="https://fivethirtyeight.com/features/should-travelers-avoid-flying-airlines-that-have-had-crashes-in-the-past/">“Should Travelers Avoid Flying Airlines That Have Had Crashes in the Past?”</a>. Let’s ignore the <code>incl_reg_subsidiaries</code> and <code>avail_seat_km_per_week</code> variables for simplicity:</p>
<div class="sourceCode" id="cb776"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airline_safety_smaller</span> <span class="op">&lt;-</span> <span class="va">airline_safety</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">incl_reg_subsidiaries</span>, <span class="va">avail_seat_km_per_week</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">airline_safety_smaller</span></span></code></pre></div>
<pre><code># A tibble: 56 × 7
   airline incidents_85_99 fatal_accidents_85_99 fatalities_85_99 incidents_00_14 fatal_accidents_00_14 fatalities_00_14
   &lt;chr&gt;             &lt;int&gt;                 &lt;int&gt;            &lt;int&gt;           &lt;int&gt;                 &lt;int&gt;            &lt;int&gt;
 1 Aer Li…               2                     0                0               0                     0                0
 2 Aerofl…              76                    14              128               6                     1               88
 3 Aeroli…               6                     0                0               1                     0                0
 4 Aerome…               3                     1               64               5                     0                0
 5 Air Ca…               2                     0                0               2                     0                0
 6 Air Fr…              14                     4               79               6                     2              337
 7 Air In…               2                     1              329               4                     1              158
 8 Air Ne…               3                     0                0               5                     1                7
 9 Alaska…               5                     0                0               5                     1               88
10 Alital…               7                     2               50               4                     0                0
# ℹ 46 more rows</code></pre>
<p>This data frame is not in “tidy” format. How would you convert this data frame to be in “tidy” format, in particular so that it has a variable <code>incident_type_years</code> indicating the incident type/year and a variable <code>count</code> of the counts?</p>
<p><strong>Solution</strong>:</p>
<p>This can been done using the <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> function from the <code>tidyr</code> package:</p>
<div class="sourceCode" id="cb778"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airline_safety_smaller_tidy</span> <span class="op">&lt;-</span> <span class="va">airline_safety_smaller</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    names_to <span class="op">=</span> <span class="st">"incident_type_years"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>    cols <span class="op">=</span> <span class="op">-</span><span class="va">airline</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">airline_safety_smaller_tidy</span></span></code></pre></div>
<pre><code># A tibble: 336 × 3
   airline    incident_type_years   count
   &lt;chr&gt;      &lt;chr&gt;                 &lt;int&gt;
 1 Aer Lingus incidents_85_99           2
 2 Aer Lingus fatal_accidents_85_99     0
 3 Aer Lingus fatalities_85_99          0
 4 Aer Lingus incidents_00_14           0
 5 Aer Lingus fatal_accidents_00_14     0
 6 Aer Lingus fatalities_00_14          0
 7 Aeroflot   incidents_85_99          76
 8 Aeroflot   fatal_accidents_85_99    14
 9 Aeroflot   fatalities_85_99        128
10 Aeroflot   incidents_00_14           6
# ℹ 326 more rows</code></pre>
<p>If you look at the resulting <code>airline_safety_smaller_tidy</code> data frame in the spreadsheet viewer, you’ll see that the variable <code>incident_type_years</code> has 6 possible values: <code>"incidents_85_99", "fatal_accidents_85_99", "fatalities_85_99",  "incidents_00_14", "fatal_accidents_00_14", "fatalities_00_14"</code> corresponding to the 6 columns of <code>airline_safety_smaller</code> we tidied.</p>
<p>Note that prior to <code>tidyr</code> version 1.0.0 released to CRAN in September 2019, this could also have been done using the <code><a href="https://tidyr.tidyverse.org/reference/gather.html">gather()</a></code> function from the <code>tidyr</code> package. The <code><a href="https://tidyr.tidyverse.org/reference/gather.html">gather()</a></code> function still works, but its further development has stopped in favor of <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>.</p>
<div class="sourceCode" id="cb780"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airline_safety_smaller_tidy</span> <span class="op">&lt;-</span> <span class="va">airline_safety_smaller</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">incident_type_years</span>, value <span class="op">=</span> <span class="va">count</span>, <span class="op">-</span><span class="va">airline</span><span class="op">)</span></span>
<span><span class="va">airline_safety_smaller_tidy</span></span></code></pre></div>
<pre><code># A tibble: 336 × 3
   airline               incident_type_years count
   &lt;chr&gt;                 &lt;chr&gt;               &lt;int&gt;
 1 Aer Lingus            incidents_85_99         2
 2 Aeroflot              incidents_85_99        76
 3 Aerolineas Argentinas incidents_85_99         6
 4 Aeromexico            incidents_85_99         3
 5 Air Canada            incidents_85_99         2
 6 Air France            incidents_85_99        14
 7 Air India             incidents_85_99         2
 8 Air New Zealand       incidents_85_99         3
 9 Alaska Airlines       incidents_85_99         5
10 Alitalia              incidents_85_99         7
# ℹ 326 more rows</code></pre>
<p><strong>(LC4.4)</strong> Convert the <code>dem_score</code> data frame into
a tidy data frame and assign the name of <code>dem_score_tidy</code> to the resulting long-formatted data frame.</p>
<p><strong>Solution</strong>: Running the following in the console:</p>
<div class="sourceCode" id="cb782"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem_score_tidy</span> <span class="op">&lt;-</span> <span class="va">dem_score</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    names_to <span class="op">=</span> <span class="st">"year"</span>, values_to <span class="op">=</span> <span class="st">"democracy_score"</span>,</span>
<span>    cols <span class="op">=</span> <span class="op">-</span><span class="va">country</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Let’s now compare the <code>dem_score</code> and <code>dem_score_tidy</code>. <code>dem_score</code> has democracy score information for each year in columns, whereas in <code>dem_score_tidy</code> there are explicit variables <code>year</code> and <code>democracy_score</code>. While both representations of the data contain the same information, we can only use <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> to create plots using the <code>dem_score_tidy</code> data frame.</p>
<div class="sourceCode" id="cb783"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem_score</span></span></code></pre></div>
<pre><code># A tibble: 96 × 10
   country    `1952` `1957` `1962` `1967` `1972` `1977` `1982` `1987` `1992`
   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 Albania        -9     -9     -9     -9     -9     -9     -9     -9      5
 2 Argentina      -9     -1     -1     -9     -9     -9     -8      8      7
 3 Armenia        -9     -7     -7     -7     -7     -7     -7     -7      7
 4 Australia      10     10     10     10     10     10     10     10     10
 5 Austria        10     10     10     10     10     10     10     10     10
 6 Azerbaijan     -9     -7     -7     -7     -7     -7     -7     -7      1
 7 Belarus        -9     -7     -7     -7     -7     -7     -7     -7      7
 8 Belgium        10     10     10     10     10     10     10     10     10
 9 Bhutan        -10    -10    -10    -10    -10    -10    -10    -10    -10
10 Bolivia        -4     -3     -3     -4     -7     -7      8      9      9
# ℹ 86 more rows</code></pre>
<div class="sourceCode" id="cb785"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dem_score_tidy</span></span></code></pre></div>
<pre><code># A tibble: 864 × 3
   country   year  democracy_score
   &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;
 1 Albania   1952               -9
 2 Albania   1957               -9
 3 Albania   1962               -9
 4 Albania   1967               -9
 5 Albania   1972               -9
 6 Albania   1977               -9
 7 Albania   1982               -9
 8 Albania   1987               -9
 9 Albania   1992                5
10 Argentina 1952               -9
# ℹ 854 more rows</code></pre>
<p><strong>(LC4.5)</strong> Read in the life expectancy data stored at <a href="https://moderndive.com/v2/data/le_mess.csv" class="uri">https://moderndive.com/v2/data/le_mess.csv</a> and convert it to a tidy data frame.</p>
<p><strong>Solution</strong>: The code is similar:</p>
<div class="sourceCode" id="cb787"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">life_expectancy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://moderndive.com/data/le_mess.csv"</span><span class="op">)</span></span>
<span><span class="va">life_expectancy_tidy</span> <span class="op">&lt;-</span> <span class="va">life_expectancy</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    names_to <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"life_expectancy"</span>,</span>
<span>    cols <span class="op">=</span> <span class="op">-</span><span class="va">country</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We observe the same structure with respect to <code>year</code> in <code>life_expectancy</code> vs <code>life_expectancy_tidy</code> as we did in <code>dem_score</code> vs <code>dem_score_tidy</code>:</p>
<div class="sourceCode" id="cb788"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">life_expectancy</span></span></code></pre></div>
<pre><code># A tibble: 202 × 67
   country      `1951` `1952` `1953` `1954` `1955` `1956` `1957` `1958` `1959` `1960` `1961` `1962` `1963` `1964` `1965`
   &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 Afghanistan   27.13  27.67  28.19  28.73  29.27  29.8   30.34  30.86  31.4   31.94  32.47  33.01  33.53  34.07  34.6 
 2 Albania       54.72  55.23  55.85  56.59  57.45  58.42  59.48  60.6   61.75  62.87  63.92  64.84  65.6   66.18  66.59
 3 Algeria       43.03  43.5   43.96  44.44  44.93  45.44  45.94  46.45  46.97  47.5   48.02  48.55  49.07  49.58  50.09
 4 Angola        31.05  31.59  32.14  32.69  33.24  33.78  34.33  34.88  35.43  35.98  36.53  37.08  37.63  38.18  38.74
 5 Antigua and…  58.26  58.8   59.34  59.87  60.41  60.93  61.45  61.97  62.48  62.97  63.46  63.93  64.38  64.81  65.23
 6 Argentina     61.93  62.54  63.1   63.59  64.03  64.41  64.73  65     65.22  65.39  65.53  65.64  65.74  65.84  65.95
 7 Armenia       62.67  63.13  63.6   64.07  64.54  65     65.45  65.92  66.39  66.86  67.33  67.82  68.3   68.78  69.26
 8 Aruba         58.96  60.01  60.98  61.87  62.69  63.42  64.09  64.68  65.2   65.66  66.07  66.44  66.79  67.11  67.44
 9 Australia     68.71  69.11  69.69  69.84  70.16  70.03  70.31  70.86  70.43  70.87  71.14  70.91  70.97  70.63  70.96
10 Austria       65.24  66.78  67.27  67.3   67.58  67.7   67.46  68.46  68.39  68.75  69.72  69.51  69.64  70.13  69.92
# ℹ 192 more rows
# ℹ 51 more variables: `1966` &lt;dbl&gt;, `1967` &lt;dbl&gt;, `1968` &lt;dbl&gt;, `1969` &lt;dbl&gt;, `1970` &lt;dbl&gt;, `1971` &lt;dbl&gt;,
#   `1972` &lt;dbl&gt;, `1973` &lt;dbl&gt;, `1974` &lt;dbl&gt;, `1975` &lt;dbl&gt;, `1976` &lt;dbl&gt;, `1977` &lt;dbl&gt;, `1978` &lt;dbl&gt;, `1979` &lt;dbl&gt;,
#   `1980` &lt;dbl&gt;, `1981` &lt;dbl&gt;, `1982` &lt;dbl&gt;, `1983` &lt;dbl&gt;, `1984` &lt;dbl&gt;, `1985` &lt;dbl&gt;, `1986` &lt;dbl&gt;, `1987` &lt;dbl&gt;,
#   `1988` &lt;dbl&gt;, `1989` &lt;dbl&gt;, `1990` &lt;dbl&gt;, `1991` &lt;dbl&gt;, `1992` &lt;dbl&gt;, `1993` &lt;dbl&gt;, `1994` &lt;dbl&gt;, `1995` &lt;dbl&gt;,
#   `1996` &lt;dbl&gt;, `1997` &lt;dbl&gt;, `1998` &lt;dbl&gt;, `1999` &lt;dbl&gt;, `2000` &lt;dbl&gt;, `2001` &lt;dbl&gt;, `2002` &lt;dbl&gt;, `2003` &lt;dbl&gt;,
#   `2004` &lt;dbl&gt;, `2005` &lt;dbl&gt;, `2006` &lt;dbl&gt;, `2007` &lt;dbl&gt;, `2008` &lt;dbl&gt;, `2009` &lt;dbl&gt;, `2010` &lt;dbl&gt;, `2011` &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb790"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">life_expectancy_tidy</span></span></code></pre></div>
<pre><code># A tibble: 13,332 × 3
   country     year  life_expectancy
   &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan 1951            27.13
 2 Afghanistan 1952            27.67
 3 Afghanistan 1953            28.19
 4 Afghanistan 1954            28.73
 5 Afghanistan 1955            29.27
 6 Afghanistan 1956            29.8 
 7 Afghanistan 1957            30.34
 8 Afghanistan 1958            30.86
 9 Afghanistan 1959            31.4 
10 Afghanistan 1960            31.94
# ℹ 13,322 more rows</code></pre>
<hr>
</div>
<div id="chapter-5-solutions" class="section level2" number="15.5">
<h2>
<span class="header-section-number">D.5</span> Chapter 5 Solutions<a class="anchor" aria-label="anchor" href="#chapter-5-solutions"><i class="fas fa-link"></i></a>
</h2>
<p>Needed packages</p>
<div class="sourceCode" id="cb792"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb793"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UN_data_ch5</span> <span class="op">&lt;-</span> <span class="va">un_member_states_2024</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">iso</span>, </span>
<span>         life_exp <span class="op">=</span> <span class="va">life_expectancy_2022</span>, </span>
<span>         fert_rate <span class="op">=</span> <span class="va">fertility_rate_2022</span>, </span>
<span>         obes_rate <span class="op">=</span> <span class="va">obesity_rate_2016</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC5.1)</strong> Conduct a new EDA with <code>y = fert_rate</code> and <code>x = obes_rate</code>. What can you say about the relationship?</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb794"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1) Look at raw values</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">UN_data_ch5</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 181
Columns: 4
$ iso       &lt;chr&gt; "AFG", "ALB", "DZA", "AGO", "ATG", "ARG", "ARM", "AUS", "AUT", "AZE", "BHS", "BHR", "BGD", "BRB", "B…
$ life_exp  &lt;dbl&gt; 53.6, 79.5, 78.0, 62.1, 77.8, 78.3, 76.1, 83.1, 82.3, 74.2, 76.1, 79.9, 74.7, 78.5, 74.3, 81.9, 75.8…
$ fert_rate &lt;dbl&gt; 4.3, 1.4, 2.7, 5.0, 1.6, 1.9, 1.6, 1.6, 1.5, 1.6, 1.4, 1.8, 1.9, 1.6, 1.5, 1.6, 2.0, 4.7, 1.4, 2.5, …
$ obes_rate &lt;dbl&gt; 5.5, 21.7, 27.4, 8.2, 18.9, 28.3, 20.2, 29.0, 20.1, 19.9, 31.6, 29.8, 3.6, 23.1, 24.5, 22.1, 24.1, 9…</code></pre>
<div class="sourceCode" id="cb796"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2) Summary statistics</span></span>
<span><span class="va">UN_data_ch5</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">fert_rate</span>, <span class="va">obes_rate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">moderndive</span><span class="fu">::</span><span class="fu"><a href="moderndive.github.io/moderndive/reference/tidy_summary.html">tidy_summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 2 × 11
  column        n group type      min    Q1     mean median    Q3   max      sd
  &lt;chr&gt;     &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1 fert_rate   181 &lt;NA&gt;  numeric   1.1   1.6  2.50110    2     3.2   6.6 1.15041
2 obes_rate   181 &lt;NA&gt;  numeric   2.1   9.6 19.2785    20.6  25.2  51.6 9.98920</code></pre>
<div class="sourceCode" id="cb798"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3) Visualizations</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">UN_data_ch5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">obes_rate</span>, y <span class="op">=</span> <span class="va">fert_rate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Obesity rate (2016)"</span>, y <span class="op">=</span> <span class="st">"Fertility rate (2022)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-05-alt2-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb799"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Optional: correlation</span></span>
<span><span class="va">UN_data_ch5</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">moderndive</span><span class="fu">::</span><span class="fu"><a href="moderndive.github.io/moderndive/reference/get_correlation.html">get_correlation</a></span><span class="op">(</span><span class="va">fert_rate</span> <span class="op">~</span> <span class="va">obes_rate</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
        cor
      &lt;dbl&gt;
1 -0.435236</code></pre>
<p>EDA = raw data + summaries + plot. The scatterplot with the regression line and the correlation quantify direction/strength. This data shows a <strong>negative</strong> association between obesity rate and fertility rate (points slope down; negative correlation): as obesity rate increases, fertility rate tends to decrease.</p>
<p><strong>(LC5.2)</strong> Main purpose of EDA?</p>
<p><strong>Solution</strong>: <strong>B.</strong><br>
EDA helps you <strong>understand relationships, spot outliers/missingness, and check assumptions</strong> before modeling, not to predict or fabricate variables.</p>
<p><strong>(LC5.3)</strong> Which is correct about the correlation coefficient?</p>
<p><strong>Solution</strong>: <strong>C.</strong><br>
Pearson’s correlation is bounded in <strong>[-1, 1]</strong> and measures <strong>linear</strong> association strength/direction.</p>
<p><strong>(LC5.4)</strong> Fit a simple linear regression using <code>lm(fert_rate ~ obes_rate, data = UN_data_ch5)</code> where <code>obes_rate</code> is the new explanatory variable <span class="math inline">\(x\)</span>. Learn about the “best-fitting” line from the regression coefficients by applying the <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> function. How do the regression results match up with your earlier exploratory data analysis?</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb801"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_obesity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fert_rate</span> <span class="op">~</span> <span class="va">obes_rate</span>, data <span class="op">=</span> <span class="va">UN_data_ch5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m_obesity</span><span class="op">)</span></span></code></pre></div>
<pre><code>(Intercept)   obes_rate 
     3.4674     -0.0501 </code></pre>
<div class="sourceCode" id="cb803"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># or a tidy table:</span></span>
<span><span class="fu">moderndive</span><span class="fu">::</span><span class="fu"><a href="moderndive.github.io/moderndive/reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">m_obesity</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 2 × 7
  term      estimate std_error statistic p_value lower_ci upper_ci
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 intercept    3.467     0.168    20.618       0    3.136    3.799
2 obes_rate   -0.05      0.008    -6.468       0   -0.065   -0.035</code></pre>
<p>The slope sign should match your EDA: typically <strong>negative</strong>, meaning higher obesity rate is associated with lower fertility. The magnitude tells <strong>how much</strong> fertility changes per 1-point increase in obesity (on average). If your plot/correlation looked negative, a negative fitted slope confirms that.</p>
<p><strong>(LC5.5)</strong> What does the intercept <span class="math inline">\(b_0\)</span> represent?</p>
<p><strong>Solution</strong>: <strong>B.</strong><br><span class="math inline">\(b_0\)</span> is the <strong>predicted response when <span class="math inline">\(x = 0\)</span></strong>. It may be outside the data’s range (so often not substantively meaningful), but that’s the definition.</p>
<p><strong>(LC5.6)</strong> What best describes the “slope”?</p>
<p><strong>Solution</strong>: <strong>C.</strong><br>
The slope is the <strong>change in the outcome</strong> for a <strong>one-unit increase in the explanatory</strong> variable, on average.</p>
<p><strong>(LC5.7)</strong> What does a negative slope indicate?</p>
<p><strong>Solution</strong>: <strong>A.</strong><br>
As <span class="math inline">\(x\)</span> increases, the <strong>predicted</strong> <span class="math inline">\(y\)</span> <strong>decreases</strong> (downward trend).</p>
<p><strong>(LC5.8)</strong> What is a “wrapper function”?</p>
<p><strong>Solution</strong>: <strong>B.</strong>
Wrapper functions <strong>combine other functions</strong> into a simpler interface (e.g., <code><a href="moderndive.github.io/moderndive/reference/get_regression_points.html">moderndive::get_regression_points()</a></code> wraps <code><a href="https://generics.r-lib.org/reference/augment.html">broom::augment()</a></code> and some cleaning).</p>
<hr>
<p><strong>(LC5.9)</strong> Create a data frame of residuals for the obesity model.</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb805"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_obesity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fert_rate</span> <span class="op">~</span> <span class="va">obes_rate</span>, data <span class="op">=</span> <span class="va">UN_data_ch5</span><span class="op">)</span></span>
<span><span class="va">resids_df</span> <span class="op">&lt;-</span> <span class="fu">moderndive</span><span class="fu">::</span><span class="fu"><a href="moderndive.github.io/moderndive/reference/get_regression_points.html">get_regression_points</a></span><span class="op">(</span><span class="va">m_obesity</span><span class="op">)</span></span>
<span><span class="va">resids_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">obes_rate</span>, <span class="va">fert_rate</span>, <span class="va">fert_rate_hat</span>, <span class="va">residual</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 6 × 4
  obes_rate fert_rate fert_rate_hat residual
      &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1       5.5       4.3         3.192    1.108
2      21.7       1.4         2.38    -0.98 
3      27.4       2.7         2.094    0.606
4       8.2       5           3.056    1.944
5      18.9       1.6         2.52    -0.92 
6      28.3       1.9         2.049   -0.149</code></pre>
<p><code><a href="moderndive.github.io/moderndive/reference/get_regression_points.html">get_regression_points()</a></code> returns observed <span class="math inline">\(y\)</span>, fitted <span class="math inline">\(\hat y\)</span>, and residuals <span class="math inline">\(y-\hat y\)</span> in a tidy frame, perfect for diagnostics and sorting.</p>
<hr>
<p><strong>(LC5.10)</strong> True statement about the regression line?</p>
<p><strong>Solution</strong>: <strong>B.</strong><br>
OLS chooses the line that <strong>minimizes the sum of squared residuals</strong> (squared differences between observed and fitted).</p>
<p><strong>(LC5.11)</strong> EDA with <code>x = continent</code>, <code>y = gdp_per_capita</code>.</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb807"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gapminder2022</span> <span class="op">&lt;-</span> <span class="va">un_member_states_2024</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, life_exp <span class="op">=</span> <span class="va">life_expectancy_2022</span>, <span class="va">continent</span>, <span class="va">gdp_per_capita</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Raw look</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">gapminder2022</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 188
Columns: 4
$ country        &lt;chr&gt; "Afghanistan", "Albania", "Algeria", "Andorra", "Angola", "Antigua and Barbuda", "Argentina", "…
$ life_exp       &lt;dbl&gt; 53.6, 79.5, 78.0, 83.4, 62.1, 77.8, 78.3, 76.1, 83.1, 82.3, 74.2, 76.1, 79.9, 74.7, 78.5, 74.3,…
$ continent      &lt;fct&gt; Asia, Europe, Africa, Europe, Africa, North America, South America, Asia, Oceania, Europe, Asia…
$ gdp_per_capita &lt;dbl&gt; 356, 6810, 4343, 41993, 3000, 19920, 13651, 7018, 65100, 52085, 7762, 31458, 30147, 2688, 20239…</code></pre>
<div class="sourceCode" id="cb809"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summaries</span></span>
<span><span class="va">gapminder2022</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gdp_per_capita</span>, <span class="va">continent</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">moderndive</span><span class="fu">::</span><span class="fu"><a href="moderndive.github.io/moderndive/reference/tidy_summary.html">tidy_summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 7 × 11
  column             n group         type        min      Q1    mean  median      Q3     max      sd
  &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 gdp_per_capita   188 &lt;NA&gt;          numeric 259.025 2255.36 18472.8 6741.29 20395.5 240862. 30858.0
2 continent         52 Africa        factor   NA       NA       NA     NA       NA       NA     NA  
3 continent         44 Asia          factor   NA       NA       NA     NA       NA       NA     NA  
4 continent         43 Europe        factor   NA       NA       NA     NA       NA       NA     NA  
5 continent         23 North America factor   NA       NA       NA     NA       NA       NA     NA  
6 continent         14 Oceania       factor   NA       NA       NA     NA       NA       NA     NA  
7 continent         12 South America factor   NA       NA       NA     NA       NA       NA     NA  </code></pre>
<div class="sourceCode" id="cb811"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualization</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gapminder2022</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">continent</span>, y <span class="op">=</span> <span class="va">gdp_per_capita</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Helpful with longer names/categories</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Continent"</span>, y <span class="op">=</span> <span class="st">"GDP per capita (USD)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-05-v6-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>Boxplots/facets reveal <strong>distribution and differences</strong>. Notice a <strong>higher median</strong> in <strong>Europe</strong> and <strong>lower</strong> in <strong>Africa</strong>, with Europe showing widest spread.</p>
<p><strong>(LC5.12)</strong> Baseline group in categorical regression?</p>
<p><strong>Solution</strong>: <strong>B.</strong><br>
The baseline is the <strong>reference category</strong> against which others are <strong>compared</strong> (it’s not necessarily largest/smallest by any statistic unless you set it).</p>
<p><strong>(LC5.13)</strong> Fit <code>lm(gdp_per_capita ~ continent, data = gapminder2022)</code> and compare to EDA.</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb812"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_gdp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">gdp_per_capita</span> <span class="op">~</span> <span class="va">continent</span>, data <span class="op">=</span> <span class="va">gapminder2022</span><span class="op">)</span></span>
<span><span class="fu">moderndive</span><span class="fu">::</span><span class="fu"><a href="moderndive.github.io/moderndive/reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">m_gdp</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 6 × 7
  term                     estimate std_error statistic p_value  lower_ci upper_ci
  &lt;chr&gt;                       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 intercept                 2637.1    3727.63     0.707   0.48  -4717.83   9992.03
2 continent: Asia          13014.3    5506.08     2.364   0.019  2150.33  23878.2 
3 continent: Europe        43061.4    5540.65     7.772   0     32129.2   53993.5 
4 continent: North America 13713.5    6731.31     2.037   0.043   432.033 26994.9 
5 continent: Oceania       10031.0    8093.58     1.239   0.217 -5938.28  26000.4 
6 continent: South America  8083.51   8608.60     0.939   0.349 -8901.98  25069.0 </code></pre>
<p>The <strong>intercept</strong> is the baseline continent’s mean GDP per capita. Each <strong>continent coefficient</strong> is an <strong>offset from the baseline mean</strong>. Signs/magnitudes should mirror your boxplot: positive for richer-than-baseline continents, negative for poorer-than-baseline.</p>
<p><strong>(LC5.14)</strong> How many “offsets” for 4 levels?</p>
<p><strong>Solution</strong>: <strong>C. (3)</strong>
With <span class="math inline">\(k\)</span> categories, you get <strong><span class="math inline">\(k-1\)</span></strong> offsets plus 1 intercept for the baseline.</p>
<p><strong>(LC5.15)</strong> Positive coefficient in a categorical model means?</p>
<p><strong>Solution</strong>: <strong>C.</strong>
A positive coefficient means that group’s <strong>mean response is higher than the baseline’s</strong> (by that coefficient amount).</p>
<p><strong>(LC5.16)</strong> Which is true about residuals?</p>
<p><strong>Solution</strong>: <strong>A.</strong><br>
A residual is <span class="math inline">\(y - \hat y\)</span>. It can be <strong>positive or negative</strong> and is crucial for model fit checks.</p>
<p><strong>(LC5.17)</strong> Find the five most negative residuals; interpret.</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb814"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">life_exp_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">life_exp</span> <span class="op">~</span> <span class="va">continent</span>, data <span class="op">=</span> <span class="va">gapminder2022</span><span class="op">)</span></span>
<span><span class="va">rp</span> <span class="op">&lt;-</span> <span class="fu">moderndive</span><span class="fu">::</span><span class="fu"><a href="moderndive.github.io/moderndive/reference/get_regression_points.html">get_regression_points</a></span><span class="op">(</span><span class="va">life_exp_model</span>, ID <span class="op">=</span> <span class="st">"country"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">residual</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">continent</span>, <span class="va">life_exp</span>, <span class="va">life_exp_hat</span>, <span class="va">residual</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 5 × 5
  country                  continent     life_exp life_exp_hat residual
  &lt;chr&gt;                    &lt;fct&gt;            &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 Afghanistan              Asia             53.65       74.95   -21.3  
2 Central African Republic Africa           55.52       66.31   -10.79 
3 Somalia                  Africa           55.72       66.31   -10.59 
4 Haiti                    North America    65.95       76.295  -10.345
5 Mozambique               Africa           57.1        66.31    -9.21 </code></pre>
<p><strong>Negative</strong> residuals are <strong>below</strong> their continent’s mean. Their life expectancy is lower than their continent’s average by residual (in magnitude) years.</p>
<p><strong>(LC5.18)</strong> Find the five most positive residuals; interpret.</p>
<p><strong>Solution</strong>:</p>
<div class="sourceCode" id="cb816"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">residual</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">continent</span>, <span class="va">life_exp</span>, <span class="va">life_exp_hat</span>, <span class="va">residual</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 5 × 5
  country   continent life_exp life_exp_hat residual
  &lt;chr&gt;     &lt;fct&gt;        &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 Algeria   Africa       78.03        66.31    11.72
2 Singapore Asia         86.43        74.95    11.48
3 Libya     Africa       77.18        66.31    10.87
4 Tunisia   Africa       76.82        66.31    10.51
5 Japan     Asia         84.91        74.95     9.96</code></pre>
<p><strong>Positive</strong> residuals are <strong>above</strong> their continent’s mean (higher life expectancy than their continent average by residual years).</p>
<p><strong>(LC5.19)</strong> Compute the sum of squared residuals (SSR) for three lines in the toy example and show the regression line is smallest.</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>The “best” fitting solid regression line in blue:</li>
</ul>
<p><span class="math display">\[
\sum_{i=1}^{n}(y_i - \widehat{y}_i)^2 = (2.0-1.5)^2+(1.0-2.0)^2+(3.0-2.5)^2 = 1.5
\]</span></p>
<ul>
<li>An arbitrarily chosen dotted red line:</li>
</ul>
<p><span class="math display">\[
\sum_{i=1}^{n}(y_i - \widehat{y}_i)^2 = (2.0-2.5)^2+(1.00-2.5)^2+(3.0-2.5)^2 = 2.75
\]</span></p>
<ul>
<li>Another arbitrarily chosen dashed green line:</li>
</ul>
<p><span class="math display">\[
\sum_{i=1}^{n}(y_i - \widehat{y}_i)^2 = (2.0-2.0)^2+(1.0-1.5)^2+(3.0-1.0)^2 = 4.25
\]</span></p>
<p>As calculated, <span class="math inline">\(1.5 &lt; 2.75 &lt; 4.25\)</span>. Therefore, we show that the regression line in blue has the smallest value of the residual sum of squares.</p>
<hr>
</div>
<div id="chapter-6-solutions" class="section level2" number="15.6">
<h2>
<span class="header-section-number">D.6</span> Chapter 6 Solutions<a class="anchor" aria-label="anchor" href="#chapter-6-solutions"><i class="fas fa-link"></i></a>
</h2>
<p>Needed packages</p>
<div class="sourceCode" id="cb818"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.statlearning.com">ISLR2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb819"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UN_data_ch6</span> <span class="op">&lt;-</span> <span class="va">un_member_states_2024</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">country</span>, </span>
<span>         <span class="va">life_expectancy_2022</span>, </span>
<span>         <span class="va">fertility_rate_2022</span>, </span>
<span>         <span class="va">income_group_2024</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>life_exp <span class="op">=</span> <span class="va">life_expectancy_2022</span>, </span>
<span>         fert_rate <span class="op">=</span> <span class="va">fertility_rate_2022</span>, </span>
<span>         income <span class="op">=</span> <span class="va">income_group_2024</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>income <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">income</span>, </span>
<span>                         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Low income"</span>, <span class="st">"Lower middle income"</span>, </span>
<span>                                    <span class="st">"Upper middle income"</span>, <span class="st">"High income"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb820"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">credit_ch6</span> <span class="op">&lt;-</span> <span class="va">Credit</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>debt <span class="op">=</span> <span class="va">Balance</span>, credit_limit <span class="op">=</span> <span class="va">Limit</span>, </span>
<span>         income <span class="op">=</span> <span class="va">Income</span>, credit_rating <span class="op">=</span> <span class="va">Rating</span>, age <span class="op">=</span> <span class="va">Age</span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC6.1)</strong> What is the goal of including an interaction term?</p>
<p><strong>Solution:</strong> <strong>B.</strong><br>
It lets the effect of one explanatory variable depend on the level of another.</p>
<p><strong>(LC6.2)</strong> How do main effects plus interactions change coefficient interpretation?</p>
<p><strong>Solution:</strong> <strong>C.</strong><br>
Coefficients become conditional effects that depend on the interacting variable(s).</p>
<p><strong>(LC6.3)</strong> Which statement about dummy variables is correct?</p>
<p><strong>Solution:</strong> <strong>B.</strong><br>
They encode categorical variables with at least two levels.</p>
<p><strong>(LC6.4)</strong> Model with one categorical and one numerical regressor, no interactions: interpretation?</p>
<p><strong>Solution:</strong> <strong>B.</strong><br>
All categories share the same slope; only intercepts differ.</p>
<p><strong>(LC6.5)</strong> Compute observed responses, fitted values, and residuals for the no interaction model.</p>
<p><strong>Solution:</strong> Use the fitted no interaction model and generate regression points:</p>
<div class="sourceCode" id="cb821"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_no_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fert_rate</span> <span class="op">~</span> <span class="va">life_exp</span> <span class="op">+</span> <span class="va">income</span>, data <span class="op">=</span> <span class="va">UN_data_ch6</span><span class="op">)</span></span>
<span><span class="va">pts_no_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="moderndive.github.io/moderndive/reference/get_regression_points.html">get_regression_points</a></span><span class="op">(</span><span class="va">model_no_int</span><span class="op">)</span></span>
<span><span class="co"># Columns include fert_rate (observed y), fert_rate_hat (fitted ŷ), and residual = y - ŷ</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pts_no_int</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 6 × 6
     ID fert_rate life_exp income              fert_rate_hat residual
  &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;                       &lt;dbl&gt;    &lt;dbl&gt;
1     1       4.3    53.65 Low income                  5.369   -1.069
2     2       1.4    79.47 Upper middle income         1.531   -0.131
3     3       2.7    78.03 Lower middle income         2.197    0.503
4     4       5      62.11 Lower middle income         3.799    1.201
5     5       1.6    77.8  High income                 1.872   -0.272
6     6       1.9    78.31 Upper middle income         1.648    0.252</code></pre>
<p>Interpretation: for each row, compare <code>fert_rate</code> to <code>fert_rate_hat</code>; the residual is their difference.</p>
<p><strong>(LC6.6)</strong> Main benefit of visualizing fitted values and residuals?</p>
<p><strong>Solution:</strong> <strong>B.</strong><br>
To assess model assumptions like linearity and constant variance.</p>
<p><strong>(LC6.7)</strong> EDA for debt with <code>credit_rating</code> and <code>age</code>. What can you say?</p>
<p><strong>Solution:</strong> Make scatterplots and summaries; compute correlations:</p>
<div class="sourceCode" id="cb823"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">credit_ch6</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">debt</span>, <span class="va">credit_rating</span>, <span class="va">age</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="moderndive.github.io/moderndive/reference/tidy_summary.html">tidy_summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 3 × 11
  column            n group type      min     Q1     mean median     Q3   max       sd
  &lt;chr&gt;         &lt;int&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 debt            400 &lt;NA&gt;  numeric     0  68.75 520.015   459.5 863     1999 459.759 
2 credit_rating   400 &lt;NA&gt;  numeric    93 247.25 354.94    344   437.25   982 154.724 
3 age             400 &lt;NA&gt;  numeric    23  41.75  55.6675   56    70       98  17.2498</code></pre>
<div class="sourceCode" id="cb825"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">credit_ch6</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">credit_rating</span>, <span class="va">debt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Credit rating"</span>, y <span class="op">=</span> <span class="st">"Debt ($)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-06-v5-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb826"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">credit_ch6</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">debt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, y <span class="op">=</span> <span class="st">"Debt ($)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-06-v5-2.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb827"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">credit_ch6</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">debt</span>, <span class="va">credit_rating</span>, <span class="va">age</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>                 debt credit_rating     age
debt          1.00000         0.864 0.00184
credit_rating 0.86363         1.000 0.10316
age           0.00184         0.103 1.00000</code></pre>
<p>Patterns to look for: higher credit ratings often associate with lower debt; age can show weak or nonlinear association. Your plots and correlations should guide the final statement.</p>
<p><strong>(LC6.8)</strong> Fit <code>lm(debt ~ credit_rating + age, data = credit_ch6)</code> and compare to EDA.</p>
<p><strong>Solution:</strong> Fit and read coefficients, then check signs and magnitudes against your plots.</p>
<div class="sourceCode" id="cb829"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_ca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">debt</span> <span class="op">~</span> <span class="va">credit_rating</span> <span class="op">+</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">credit_ch6</span><span class="op">)</span></span>
<span><span class="fu"><a href="moderndive.github.io/moderndive/reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">m_ca</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 3 × 7
  term          estimate std_error statistic p_value lower_ci upper_ci
  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 intercept     -269.581    44.806    -6.017       0 -357.668 -181.494
2 credit_rating    2.593     0.074    34.84        0    2.447    2.74 
3 age             -2.351     0.668    -3.521       0   -3.663   -1.038</code></pre>
<p>Interpretation: the coefficient on <code>credit_rating</code> is the partial effect holding <code>age</code> fixed; same for <code>age</code>. If EDA showed debt decreasing as rating increases, expect a negative coefficient on <code>credit_rating</code>. If age showed a weak relationship, expect a small coefficient or consider adding nonlinear terms if residual plots suggest curvature.</p>
<p><strong>(LC6.9)</strong> Interpretation of a regression coefficient in multiple regression.</p>
<p><strong>Solution:</strong> <strong>A.</strong><br>
It is the additional effect of a regressor/predictor variable on the response after accounting for other regressors.</p>
<p><strong>(LC6.10)</strong> Characteristic of the best fitting plane with two numerical regressors.</p>
<p><strong>Solution:</strong> <strong>C.</strong><br>
It minimizes the sum of squared residuals over all observations.</p>
<p><strong>(LC6.11)</strong> What does the intercept represent with two explanatory variables?</p>
<p><strong>Solution:</strong> <strong>D.</strong><br>
The expected response when all regressors are zero.</p>
<p><strong>(LC6.12)</strong> What is a partial slope?</p>
<p><strong>Solution:</strong> <strong>A.</strong><br>
The additional effect of a regressor on the response after the others are taken into account.</p>
<hr>
</div>
<div id="chapter-7-solutions" class="section level2" number="15.7">
<h2>
<span class="header-section-number">D.7</span> Chapter 7 Solutions<a class="anchor" aria-label="anchor" href="#chapter-7-solutions"><i class="fas fa-link"></i></a>
</h2>
<p>Needed packages</p>
<div class="sourceCode" id="cb831"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC7.1)</strong> Why is it important to mix the balls before a new sample?</p>
<p><strong>Solution:</strong> To randomize selection and reduce dependence or bias between samples.</p>
<p><strong>(LC7.2)</strong> Why didn’t all students get the same sample proportion?</p>
<p><strong>Solution:</strong> Sampling variation. Different random samples from the same population yield different statistics.</p>
<p><strong>(LC7.3)</strong> Why can’t we study sampling variation with only one virtual sample?</p>
<p><strong>Solution:</strong> One sample shows only one outcome. Many samples are needed to observe variability and form a sampling distribution.</p>
<p><strong>(LC7.4)</strong> Why didn’t we take 1000 samples of 50 balls by hand?</p>
<p><strong>Solution:</strong> It is impractical and time consuming. Simulation is fast, scalable, and reproducible.</p>
<p><strong>(LC7.5)</strong> From the 1000-sample histogram, is 30% red in <span class="math inline">\(n = 50\)</span> likely? What about 10%?</p>
<p><strong>Solution:</strong> 30% is plausible though less common. 10% is very unlikely.</p>
<p><strong>(LC7.6)</strong> As in Figure 7.12 comparing sample sizes, what about the center of the histograms?</p>
<p><strong>Solution:</strong> <strong>C.</strong> The center of each histogram seems to be about the same, regardless of the sample size.</p>
<p><strong>(LC7.7)</strong> As the sample size increases, the histogram gets narrower. What happens to the sample proportions?</p>
<p><strong>Solution:</strong> <strong>A.</strong> They vary less.</p>
<p><strong>(LC7.8)</strong> Why use random sampling when constructing sampling distributions?</p>
<p><strong>Solution:</strong> <strong>B.</strong> To minimize bias and make inferences about the population.</p>
<p><strong>(LC7.9)</strong> Why construct a histogram of sample means or proportions in a simulation study?</p>
<p><strong>Solution:</strong> <strong>A.</strong> To visualize the distribution and assess normality or other patterns.</p>
<p><strong>(LC7.10)</strong> In the bowl activity, what is the population parameter? Do we know its value? How can we know it exactly?</p>
<p><strong>Solution:</strong> The population parameter is the true proportion of red balls, <span class="math inline">\(p\)</span>. We can know it exactly by counting all balls and computing the proportion in the full population.</p>
<p><strong>(LC7.11)</strong> How did we ensure the shovel samples were random?</p>
<p><strong>Solution:</strong> By mixing the bowl between samples and sampling with replacement so each ball has equal chance on each draw.</p>
<p><strong>(LC7.12)</strong> What is the expected value of the sample mean in the context of sampling distributions?</p>
<p><strong>Solution:</strong> <strong>B.</strong> The population mean.</p>
<p><strong>(LC7.13)</strong> What is the role of the Central Limit Theorem in inference?</p>
<p><strong>Solution:</strong> <strong>B.</strong> It says the sampling distribution of the sample mean approaches normal as the sample size becomes large, regardless of the population distribution.</p>
<p><strong>(LC7.14)</strong> What does “sampling variation” refer to?</p>
<p><strong>Solution:</strong> <strong>B.</strong> Differences in sample statistics due to random sampling.</p>
<p><strong>(LC7.15)</strong> How does increasing the sample size affect the standard error of the sample mean?</p>
<p><strong>Solution:</strong> <strong>B.</strong> It decreases the standard error.</p>
<p><strong>(LC7.16)</strong> When does the sampling distribution of the sample mean approximate normal?</p>
<p><strong>Solution:</strong></p>
<ul>
<li>When the population is normal: yes, for any <span class="math inline">\(n\)</span>.<br>
</li>
<li>When the sample size is very large: yes, by the CLT.<br>
</li>
<li>When the sample size is sufficiently large regardless of population: yes, by the CLT.<br>
</li>
<li>When the population is uniform: approximately normal if <span class="math inline">\(n\)</span> is large, but not necessarily for small <span class="math inline">\(n\)</span>.</li>
</ul>
<p><strong>(LC7.17)</strong> In comparing two samples, why do we add variances when finding the SE of a difference?</p>
<p><strong>Solution:</strong> <strong>B.</strong> Adding variances reflects the total uncertainty contributed by both independent samples.</p>
<p><strong>(LC7.18)</strong> For large samples, what is the shape of the sampling distribution of the difference in sample proportions?</p>
<p><strong>Solution:</strong> <strong>B.</strong> Bell shaped, approximating a normal distribution.</p>
<hr>
</div>
<div id="chapter-8-solutions" class="section level2" number="15.8">
<h2>
<span class="header-section-number">D.8</span> Chapter 8 Solutions<a class="anchor" aria-label="anchor" href="#chapter-8-solutions"><i class="fas fa-link"></i></a>
</h2>
<p>Needed packages</p>
<div class="sourceCode" id="cb832"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC8.1)</strong> What is the expected value of the sample mean weight of almonds in a large sample according to the sampling distribution theory?</p>
<p><strong>Solution:</strong> <strong>D.</strong>
On average, the sample mean equals the population mean (unbiased), though any single sample can vary.</p>
<p><strong>(LC8.2)</strong> What is a point estimate and how does it differ from an interval estimate?</p>
<p><strong>Solution:</strong> <strong>B.</strong>
A point estimate is one number (e.g., <span class="math inline">\(\bar x\)</span>). An interval estimate gives a plausible range that accounts for sampling variability.</p>
<p><strong>(LC8.3)</strong> What does the population mean (<span class="math inline">\(\mu\)</span>) represent in the almond activity?</p>
<p><strong>Solution:</strong> <strong>C.</strong>
It’s the average weight of <strong>all</strong> 5,000 almonds (the full population), not just a sample.</p>
<p><strong>(LC8.4)</strong> Which best describes the population standard deviation (<span class="math inline">\(\sigma\)</span>) in the almond activity?</p>
<p><strong>Solution:</strong> <strong>B.</strong>
<span class="math inline">\(\sigma\)</span> measures spread around the <strong>population</strong> mean, not the sample mean.</p>
<p><strong>(LC8.5)</strong> Why use the sample mean to estimate the population mean?</p>
<p><strong>Solution:</strong> <strong>B.</strong>
<span class="math inline">\(\bar x\)</span> is an unbiased estimator of <span class="math inline">\(\mu\)</span>; across repeated samples it hits <span class="math inline">\(\mu\)</span> on average.</p>
<p><strong>(LC8.6)</strong> How is the standard error of the sample mean calculated here?</p>
<p><strong>Solution:</strong> <strong>B.</strong>
<span class="math inline">\(SE(\bar x)=\sigma/\sqrt{n}\)</span>; larger <span class="math inline">\(n\)</span> shrinks variability of <span class="math inline">\(\bar x\)</span>.</p>
<p><strong>(LC8.7)</strong> What does a 95% confidence interval represent here?</p>
<p><strong>Solution:</strong> <strong>C.</strong>
Before sampling, the procedure yields intervals that capture <span class="math inline">\(\mu\)</span> 95% of the time; numerically that’s <span class="math inline">\(\bar x \pm 1.96\times SE\)</span>.</p>
<p><strong>(LC8.8)</strong> Why does the <span class="math inline">\(t\)</span> distribution have thicker tails than the standard normal?</p>
<p><strong>Solution:</strong> <strong>D.</strong>
Using <span class="math inline">\(s\)</span> instead of <span class="math inline">\(\sigma\)</span> adds uncertainty; <span class="math inline">\(t\)</span> accounts for this with heavier tails.</p>
<p><strong>(LC8.9)</strong> Effect of increasing degrees of freedom on the <span class="math inline">\(t\)</span> distribution?</p>
<p><strong>Solution:</strong> <strong>B.</strong>
Tails thin and the distribution approaches the standard normal as df increases.</p>
<p><strong>(LC8.10)</strong> What is the chief difference between a bootstrap distribution and a sampling distribution?</p>
<p><strong>Solution:</strong> A bootstrap distribution resamples <strong>from the original sample</strong> (with replacement), while a sampling distribution resamples <strong>from the entire population</strong>.</p>
<p><strong>(LC8.11)</strong> Looking at the bootstrap distribution for the sample mean in Figure 8.14, between what two values would you say most values lie?</p>
<p><strong>Solution:</strong> Roughly between <strong>3.60 and 3.75 grams</strong>.</p>
<p><strong>(LC8.12)</strong> Which of the following is true about the confidence level when constructing a confidence interval?</p>
<p><strong>Solution:</strong> <strong>A.</strong> The confidence level sets the interval’s width and affects how likely it is to contain the true parameter.</p>
<p><strong>(LC8.13)</strong> How does increasing the sample size affect the width of a confidence interval for a given confidence level?</p>
<p><strong>Solution:</strong> <strong>C.</strong> It decreases the width, making the estimate more precise.</p>
<p><strong>(LC8.14)</strong> Construct a 95% confidence interval for the <em>median</em> weight of all almonds with the percentile method. Is it appropriate to also use the standard-error method?</p>
<p><strong>Solution:</strong> The percentile method is appropriate for the median.</p>
<div class="sourceCode" id="cb833"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bootstrap_distribution</span> <span class="op">&lt;-</span> <span class="va">almonds_sample</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">weight</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span></span>
<span><span class="va">percentile_ci</span> <span class="op">&lt;-</span> <span class="va">bootstrap_distribution</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_confidence_interval.html">get_confidence_interval</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.95</span>, type <span class="op">=</span> <span class="st">"percentile"</span><span class="op">)</span></span>
<span><span class="va">percentile_ci</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1      3.3        4</code></pre>
<p>The standard-error method is not ideal, because SE-based formulas assume symmetry/normality, which may not hold for medians. The standard-error method is not appropriate here, because the bootstrap distribution is not bell-shaped:</p>
<div class="sourceCode" id="cb835"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="va">bootstrap_distribution</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-08-alt2-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p><strong>(LC8.15)</strong> What are the advantages of using <code>infer</code> for building confidence intervals?</p>
<p><strong>Solution:</strong> Clearer, step-by-step workflow; consistent syntax across CI and hypothesis testing; easier extension to multi-variable cases; and built-in visualization tools.</p>
<p><strong>(LC8.16)</strong> What is the main purpose of bootstrapping in statistical inference?</p>
<p><strong>Solution:</strong> <strong>B.</strong> To generate multiple samples from the original data for estimating parameters.</p>
<p><strong>(LC8.17)</strong> Which function denotes the variables of interest for inference?</p>
<p><strong>Solution:</strong> <strong>C.</strong> <code><a href="https://infer.tidymodels.org/reference/specify.html">specify()</a></code>.</p>
<p><strong>(LC8.18)</strong> What is a key difference between the percentile method and the standard error method for constructing confidence intervals using bootstrap samples?</p>
<p><strong>Solution:</strong> <strong>B.</strong> Percentile method takes the middle 95% of bootstrap statistics; the SE method centers on the original sample mean and adds/subtracts 1.96 × bootstrap SE.</p>
<hr>
</div>
<div id="chapter-9-solutions" class="section level2" number="15.9">
<h2>
<span class="header-section-number">D.9</span> Chapter 9 Solutions<a class="anchor" aria-label="anchor" href="#chapter-9-solutions"><i class="fas fa-link"></i></a>
</h2>
<p>Needed packages</p>
<div class="sourceCode" id="cb836"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/nycflights23/">nycflights23</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ggplot2movies</span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC9.1)</strong> Why does the given code produce an error with <code>stat = "diff in means"</code>?</p>
<p><strong>Solution:</strong>
Because the response variable <code>popular_or_not</code> is categorical, not numerical. The statistic <code>"diff in means"</code> requires a numeric response. With categorical responses, you must use <code>"diff in props"</code>.</p>
<p><strong>(LC9.2)</strong> Why are we relatively confident that the distributions of the sample proportions approximate the population distributions?</p>
<p><strong>Solution:</strong>
Because the sample sizes are large (1000 songs per genre). With large, representative random samples, sample proportions are good approximations of population proportions due to <a href="https://en.wikipedia.org/wiki/Law_of_large_numbers">the Law of Large Numbers</a> and the Central Limit Theorem.</p>
<p><strong>(LC9.3)</strong> Using the definition of <em>p-value</em>, what does the p-value represent in the Spotify test?</p>
<p><strong>Solution:</strong>
It is the probability, assuming no true difference in popularity between metal and deep house, of obtaining a sample difference in proportions as large as or larger than the observed one in favor of metal.</p>
<p><strong>(LC9.4)</strong> How did Allen Downey’s diagram help us conclude whether a difference existed between popularity rates?</p>
<p><strong>Solution:</strong>
We followed the steps: (1) specify variables and hypotheses, (2) assume the null universe of no difference, (3) simulate data under this null by permutation, (4) calculate the observed test statistic and compare it to the null distribution, and (5) compute the p-value. Since the observed difference lay far in the tail of the null distribution, the p-value was small, leading us to reject the null and conclude metal songs are more popular.</p>
<p><strong>(LC9.5)</strong> What is wrong about saying, “The defendant is innocent” in a US trial?</p>
<p><strong>Solution:</strong>
The court can only conclude “not guilty.” This means insufficient evidence to convict, not proof of innocence. Similarly, in hypothesis testing, we “fail to reject” <span class="math inline">\(H_0\)</span> but never “accept” it as true.</p>
<p><strong>(LC9.6)</strong> What is the purpose of hypothesis testing?</p>
<p><strong>Solution:</strong>
To assess whether sample evidence provides enough support to reject a null hypothesis about a population parameter, under controlled risk of error.</p>
<p><strong>(LC9.7)</strong> What are some flaws with hypothesis testing, and how could we alleviate them?</p>
<p><strong>Solution:</strong>
Flaws:</p>
<ul>
<li>Overreliance on arbitrary cutoffs (e.g., <span class="math inline">\(p &lt; 0.05\)</span>).<br>
</li>
<li>Misinterpretation of “failing to reject” as proof of <span class="math inline">\(H_0\)</span>.<br>
</li>
<li>Sensitivity to sample size (tiny effects significant with large <span class="math inline">\(n\)</span>).</li>
</ul>
<p>Alleviations: Report effect sizes, confidence intervals, and use context-specific significance levels rather than fixed thresholds.</p>
<p><strong>(LC9.8)</strong> Comparing <span class="math inline">\(\alpha = 0.1\)</span> and <span class="math inline">\(\alpha = 0.01\)</span>, which has a higher chance of Type I Error?</p>
<p><strong>Solution:</strong>
<span class="math inline">\(\alpha = 0.1\)</span>. A larger <span class="math inline">\(\alpha\)</span> increases the probability of rejecting <span class="math inline">\(H_0\)</span> when it is actually true.</p>
<p><strong>(LC9.9)</strong> Conduct the same analysis comparing action versus romance movies using the <em>median</em> rating instead of the mean. What was different and what was the same?</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb837"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In calculate() step replace "diff in means" with "diff in medians"</span></span>
<span><span class="va">null_distribution_movies_median</span> <span class="op">&lt;-</span> <span class="va">movies_sample</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">rating</span> <span class="op">~</span> <span class="va">genre</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"permute"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in medians"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Action"</span>, <span class="st">"Romance"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compute observed "diff in medians"</span></span>
<span><span class="va">obs_diff_medians</span> <span class="op">&lt;-</span> <span class="va">movies_sample</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">rating</span> <span class="op">~</span> <span class="va">genre</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in medians"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Action"</span>, <span class="st">"Romance"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">obs_diff_medians</span></span></code></pre></div>
<pre><code>Response: rating (numeric)
Explanatory: genre (factor)
# A tibble: 1 × 1
   stat
  &lt;dbl&gt;
1 -1.55</code></pre>
<div class="sourceCode" id="cb839"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize p-value. Observing this difference in medians under H0</span></span>
<span><span class="co"># is very unlikely! Suggesting H0 is false, similarly to when we used</span></span>
<span><span class="co"># "diff in means" as the test statistic. </span></span>
<span><span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="va">null_distribution_movies_median</span>, bins <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">obs_diff_medians</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-09-sized-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb840"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># p-value is very small, just like when we used "diff in means"</span></span>
<span><span class="co"># as the test statistic. </span></span>
<span><span class="va">null_distribution_movies_median</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">obs_diff_medians</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1   0.008</code></pre>
<p><strong>(LC9.10)</strong> What conclusions can you make from viewing the faceted histogram of <code>rating</code> versus <code>genre</code> that you could not see with the boxplot?</p>
<p><strong>Solution:</strong>
From the faceted histogram, we can also see the comparison of <code>rating</code> versus <code>genre</code> over each year, but we cannot conclude them from the boxplot.</p>
<p><strong>(LC9.11)</strong> Describe how we used Allen Downey’s diagram to conclude if a statistical difference existed.</p>
<p><strong>Solution:</strong><br>
We (1) stated variables and hypotheses, (2) assumed the null universe where action and romance have the same mean, (3) generated shuffled datasets under this null, (4) calculated the difference in sample means for each, (5) compared the observed difference to this null distribution, and (6) computed the <span class="math inline">\(p\)</span>-value. If the <span class="math inline">\(p\)</span>-value is larger than <span class="math inline">\(\alpha\)</span>, we failed to reject <span class="math inline">\(H_0\)</span>; otherwise, we reject <span class="math inline">\(H_0\)</span> and conclude a statistical difference existed.</p>
<p><strong>(LC9.12)</strong> Why are we relatively confident that the distributions of the sample ratings approximate the population distributions?</p>
<p><strong>Solution:</strong>
Because the sample of movies was taken randomly from the full IMDb database and has reasonable size, making it representative. By the Central Limit Theorem, with sufficiently large <span class="math inline">\(n\)</span>, sample-based statistics approximate population parameters well.</p>
<p><strong>(LC9.13)</strong> Using the definition of <span class="math inline">\(p\)</span>-value, what does the <span class="math inline">\(p\)</span>-value represent here?</p>
<p><strong>Solution:</strong>
It is the probability, assuming no true difference in mean ratings between action and romance movies, of obtaining a sample mean difference at least as extreme (in either direction) as the observed difference.</p>
<p><strong>(LC9.14)</strong> What is the value of the <span class="math inline">\(p\)</span>-value for this two-sided test?</p>
<p><strong>Solution:</strong>
The <span class="math inline">\(p\)</span>-value here is <span class="math inline">\(0.004\)</span>.</p>
<p><strong>(LC9.15)</strong> Test your wrangling and EDA skills:</p>
<ul>
<li>Create an action/romance-only data frame from <code>movies</code>.</li>
<li>Make boxplots and faceted histograms of IMDb rating by genre.</li>
<li>Compare these with the sample plots.</li>
</ul>
<p><strong>Solution:</strong></p>
<ul>
<li>Use <code>dplyr</code> and <code>tidyr</code> to create the necessary data frame focused on only action and romance movies (but not both) from the <code>movies</code> data frame in the <code>ggplot2movies</code> package.</li>
</ul>
<div class="sourceCode" id="cb842"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">action_romance</span> <span class="op">&lt;-</span> <span class="va">movies</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">title</span>, <span class="va">year</span>, <span class="va">rating</span>, <span class="va">Action</span>, <span class="va">Romance</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">(</span><span class="va">Action</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">Romance</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">(</span><span class="va">Action</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">Romance</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>genre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Action</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"Action"</span>, <span class="st">"Romance"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note above:</p>
<ol style="list-style-type: decimal">
<li>In the <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> command that <code>(Action == 1 | Romance == 1)</code> picks out the movies that are either action or romance while the <code>!(Action == 1 &amp; Romance == 1)</code> leaves out the movies that are classified as both.</li>
<li>In the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> we use <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> to create a new variable <code>genre</code> whose values are either <code>"Action"</code> or <code>"Romance"</code>.</li>
</ol>
<ul>
<li>Make a boxplot and a faceted histogram of this population data comparing ratings of action and romance movies from IMDb.</li>
</ul>
<div class="sourceCode" id="cb843"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Faceted histogram</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">action_romance</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">rating</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genre</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-09-facet-viz-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb844"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Boxplot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">action_romance</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">rating</span>, x <span class="op">=</span> <span class="va">genre</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-09-v5-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>The results look similar to the previous plots. There are more outliers shown for Romance in the boxplot done here.</p>
<hr>
</div>
<div id="chapter-10-solutions" class="section level2" number="15.10">
<h2>
<span class="header-section-number">D.10</span> Chapter 10 Solutions<a class="anchor" aria-label="anchor" href="#chapter-10-solutions"><i class="fas fa-link"></i></a>
</h2>
<p>Needed packages</p>
<div class="sourceCode" id="cb845"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC10.1)</strong> Meaning of the error term <span class="math inline">\(\epsilon\)</span> in <span class="math inline">\(Y = \beta_0 + \beta_1 X + \epsilon\)</span>.</p>
<p><strong>Solution:</strong> <strong>C.</strong>
It is the part of the response not explained by the line.</p>
<p><strong>(LC10.2)</strong> A key property of the least squares estimates <span class="math inline">\(b_0, b_1\)</span>.</p>
<p><strong>Solution:</strong> <strong>B.</strong>
They are linear combinations of the observed responses <span class="math inline">\(y_1, y_2, \ldots, y_n\)</span>.</p>
<p><strong>(LC10.3)</strong> How to encode a two-group difference in means with regression.</p>
<p><strong>Solution:</strong> <strong>C.</strong>
Include a dummy variable for the groups; its coefficient equals the mean difference.</p>
<p><strong>(LC10.4)</strong> Meaning of the null hypothesis <span class="math inline">\(H_0: \beta_1 = 0\)</span>.</p>
<p><strong>Solution:</strong> <strong>A.</strong>
There is no linear association between the explanatory variable and the response.</p>
<p><strong>(LC10.5)</strong> An assumption required by the linear regression model.</p>
<p><strong>Solution:</strong> <strong>A.</strong>
The error terms are normally distributed with mean zero and constant variance.</p>
<p><strong>(LC10.6)</strong> Why the slope estimate <span class="math inline">\(b_1\)</span> is a random variable.</p>
<p><strong>Solution:</strong> <strong>C.</strong>
It varies from sample to sample due to sampling variation.</p>
<p><strong>(LC10.7)</strong> Residual analysis for UN data (<span class="math inline">\(y =\)</span> fertility, <span class="math inline">\(x =\)</span> life expectancy).</p>
<p><strong>Solution:</strong>
Compute fitted values and residuals with <code><a href="moderndive.github.io/moderndive/reference/get_regression_points.html">get_regression_points()</a></code>.</p>
<div class="sourceCode" id="cb846"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simple_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">fertility_rate_2022</span> <span class="op">~</span> <span class="va">hdi_2022</span>, </span>
<span>                   data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">un_member_states_2024</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">regression_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="moderndive.github.io/moderndive/reference/get_regression_points.html">get_regression_points</a></span><span class="op">(</span><span class="va">simple_model</span>, ID <span class="op">=</span> <span class="st">"country"</span><span class="op">)</span></span>
<span><span class="va">regression_points</span></span></code></pre></div>
<pre><code># A tibble: 107 × 5
   country      fertility_rate_2022 hdi_2022 fertility_rate_2022_hat residual
   &lt;chr&gt;                      &lt;dbl&gt;    &lt;dbl&gt;                   &lt;dbl&gt;    &lt;dbl&gt;
 1 Afghanistan                  4.3    0.462                   4.035    0.265
 2 Algeria                      2.7    0.745                   2.394    0.306
 3 Argentina                    1.9    0.849                   1.791    0.109
 4 Armenia                      1.6    0.786                   2.157   -0.557
 5 Australia                    1.6    0.946                   1.229    0.371
 6 Austria                      1.5    0.926                   1.345    0.155
 7 Azerbaijan                   1.6    0.76                    2.307   -0.707
 8 Bahamas, The                 1.4    0.82                    1.959   -0.559
 9 Bahrain                      1.8    0.888                   1.565    0.235
10 Barbados                     1.6    0.809                   2.023   -0.423
# ℹ 97 more rows</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:model1residualshist2"></span>
<img src="ModernDive_files/figure-html/model1residualshist2-1.png" alt="Histogram of residuals." width="\textwidth"><p class="caption">
FIGURE D.1: Histogram of residuals.
</p>
</div>
<p>The residuals appear to follow a <strong>N</strong>ormal distribution pretty closely. There is one bin near 0.5 that is a bit high, but overall the histogram looks reasonably symmetric and mound-shaped.</p>
<div class="sourceCode" id="cb848"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">regression_points</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hdi_2022</span>, y <span class="op">=</span> <span class="va">residual</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"HDI"</span>, y <span class="op">=</span> <span class="st">"Residual"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lc-10-alt2"></span>
<img src="ModernDive_files/figure-html/lc-10-alt2-1.png" alt="Plot of residuals over HDI." width="\textwidth"><p class="caption">
FIGURE D.2: Plot of residuals over HDI.
</p>
</div>
<p>This plot seems to fit equality of variance. There doesn’t appear to be a strong “fan formation” in this graph.</p>
<p><strong>(LC10.8)</strong> Interpretation of a near-zero <span class="math inline">\(p\)</span>-value for the slope.</p>
<p><strong>Solution:</strong> <strong>B.</strong>
There is strong evidence against <span class="math inline">\(H_0: \beta_1 = 0\)</span>, indicating a linear relationship between the explanatory and response variables.</p>
<p><strong>(LC10.9)</strong> Which assumptions a residual plot helps assess.</p>
<p><strong>Solution:</strong>
Residual plots help check linearity and equal variance. They do not directly check independence (need residuals vs time if sequential data). They are not sufficient for normality, which requires histograms or QQ-plots.</p>
<p><strong>(LC10.10)</strong> Meaning of a U-shaped residual plot.</p>
<p><strong>Solution:</strong> <strong>B.</strong>
It suggests violation of the linearity assumption.</p>
<p><strong>(LC10.11)</strong> Simulation-based inference for the correlation coefficient.</p>
<p><strong>Solution:</strong>
Use the <code>infer</code> workflow with <code>stat = "correlation"</code> on <code>waiting ~ duration</code>.</p>
<ul>
<li>CI: <code>specify() |&gt; generate(reps, type = "bootstrap") |&gt; calculate(stat = "correlation") |&gt; get_confidence_interval(type = "percentile", level = 0.95)</code>.</li>
<li>Test <span class="math inline">\(H_0:\rho=0\)</span>: <code>specify() |&gt; hypothesize(null = "independence") |&gt; generate(reps, type = "permute") |&gt; calculate(stat = "correlation")</code>, then compare the observed correlation with <code><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value()</a></code> / <code>get_p_value(direction = "both")</code>.</li>
</ul>
<p><strong>(LC10.12)</strong> Why the bootstrap percentile method is appropriate for <span class="math inline">\(\beta_1\)</span> here.</p>
<p><strong>Solution:</strong> <strong>D.</strong>
It does not require the bootstrap distribution to be normally shaped.</p>
<p><strong>(LC10.13)</strong> Role of the permutation test for <span class="math inline">\(\beta_1\)</span>.</p>
<p><strong>Solution:</strong> <strong>B.</strong>
It assesses whether the observed slope could occur by chance under <span class="math inline">\(H_0\)</span> of no relationship.</p>
<p><strong>(LC10.14)</strong> <span class="math inline">\(p\)</span>-value near 0 from the null distribution of slopes.</p>
<p><strong>Solution:</strong> <strong>C.</strong>
The observed slope is significantly different from 0, suggesting a meaningful relationship.</p>
<p><strong>(LC10.15)</strong> Meaning of <span class="math inline">\(\beta_j\)</span> in multiple regression.</p>
<p><strong>Solution:</strong> <strong>D.</strong>
The partial slope for <span class="math inline">\(X_j\)</span>, accounting for all other regressors.</p>
<p><strong>(LC10.16)</strong> Why convert <code>continent_of_origin</code> to a factor.</p>
<p><strong>Solution:</strong> <strong>B.</strong>
To create dummy variables representing its categories.</p>
<p><strong>(LC10.17)</strong> Purpose of a scatterplot matrix here.</p>
<p><strong>Solution:</strong> <strong>C.</strong>
Examine pairwise linear relationships and spot multicollinearity among regressors.</p>
<p><strong>(LC10.18)</strong> Role of dummy variables for <code>continent_of_origin</code>.</p>
<p><strong>Solution:</strong> <strong>B.</strong>
They shift the intercept according to the category.</p>
<p><strong>(LC10.19)</strong> Why it matters that estimators are unbiased.</p>
<p><strong>Solution:</strong> <strong>B.</strong>
On average, the estimates equal the true population parameters.</p>
<p><strong>(LC10.20)</strong> Why coefficients change with different regressor sets.</p>
<p><strong>Solution:</strong> <strong>C.</strong>
Each coefficient depends on the specific combination of regressors in the model.</p>
<p><strong>(LC10.21)</strong> Constructing a 95% CI for a coefficient in MLR.</p>
<p><strong>Solution:</strong> <strong>A.</strong>
Point estimate <span class="math inline">\(\pm\)</span> (critical <span class="math inline">\(t\)</span> value <span class="math inline">\(\times\)</span> standard error).</p>
<p><strong>(LC10.22)</strong> What the ANOVA model-comparison test evaluates.</p>
<p><strong>Solution:</strong> <strong>B.</strong>
Whether the reduced model is adequate or the full model is needed.</p>
<p><strong>(LC10.23)</strong> Why use simulation-based methods in MLR.</p>
<p><strong>Solution:</strong> <strong>D.</strong>
They don’t rely on normality assumptions or large sample sizes.</p>
<p><strong>(LC10.24)</strong> Purpose of the bootstrap distribution for partial slopes.</p>
<p><strong>Solution:</strong> <strong>B.</strong>
To approximate the sampling distribution by resampling with replacement.</p>
<p><strong>(LC10.25)</strong> CI for a partial slope includes 0.</p>
<p><strong>Solution:</strong> <strong>A.</strong>
No statistically significant relationship with the response (at the chosen level).</p>
<p><strong>(LC10.26)</strong> Observed test statistic far to the right of the null distribution.</p>
<p><strong>Solution:</strong> <strong>C.</strong>
Likely statistically significant; reject the null.</p>
<hr>
</div>
<div id="chapter-11-solutions" class="section level2" number="15.11">
<h2>
<span class="header-section-number">D.11</span> Chapter 11 Solutions<a class="anchor" aria-label="anchor" href="#chapter-11-solutions"><i class="fas fa-link"></i></a>
</h2>
<p>Needed packages</p>
<div class="sourceCode" id="cb849"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rudeboybert/fivethirtyeight">fivethirtyeight</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>(LC11.1)</strong> Check that the LINE conditions are met for inference in the Seattle house prices example with
<code>price_interaction &lt;- lm(log10_price ~ log10_size * condition, data = house_prices)</code>.</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb850"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">price_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">log10_price</span> <span class="op">~</span> <span class="va">log10_size</span> <span class="op">*</span> <span class="va">condition</span>,</span>
<span>  data <span class="op">=</span> <span class="va">house_prices</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">regression_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="moderndive.github.io/moderndive/reference/get_regression_points.html">get_regression_points</a></span><span class="op">(</span><span class="va">price_interaction</span>, ID <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code></pre></div>
<p>Plot log10 size and log10 price by condition:</p>
<div class="sourceCode" id="cb851"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">house_prices</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">sqft_living</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Log10 Size (sqft)"</span>, y <span class="op">=</span> <span class="st">"Log10 Price ($)"</span>, color <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lc-11-alt2"></span>
<img src="ModernDive_files/figure-html/lc-11-alt2-1.png" alt="Log10 size vs. log10 price by condition." width="\textwidth"><p class="caption">
FIGURE D.3: Log10 size vs. log10 price by condition.
</p>
</div>
<ul>
<li>
<strong>Linearity:</strong> The relationship between log10 size and log10 price is approximately linear within each condition level. This is a little challenging to see due to overplotting.</li>
<li>
<strong>Independence:</strong> Each house sale is a separate observation, so independence is reasonable.</li>
</ul>
<p>Plot Q-Q plot of residuals:</p>
<div class="sourceCode" id="cb852"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">regression_points</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">residual</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">geom_qq_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Q-Q Plot of Residuals"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/lc-11-v4-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>Histogram of residuals:</p>
<div class="sourceCode" id="cb853"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">regression_points</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">residual</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.05</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Residual"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lc-11-hist-white-border"></span>
<img src="ModernDive_files/figure-html/lc-11-hist-white-border-1.png" alt="Histogram of residuals." width="\textwidth"><p class="caption">
FIGURE D.4: Histogram of residuals.
</p>
</div>
<ul>
<li>
<strong>Normality:</strong> Residuals appear roughly bell-shaped after the log10 transformation.</li>
</ul>
<p>Plot residuals vs. fitted (<code>log10_price_hat</code>) values:</p>
<div class="sourceCode" id="cb854"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">regression_points</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">log10_price_hat</span>, y <span class="op">=</span> <span class="va">residual</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Fitted Values"</span>, y <span class="op">=</span> <span class="st">"Residuals"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lc-11-v6"></span>
<img src="ModernDive_files/figure-html/lc-11-v6-1.png" alt="Residuals vs. fitted values." width="\textwidth"><p class="caption">
FIGURE D.5: Residuals vs. fitted values.
</p>
</div>
<ul>
<li>
<strong>Equal variance:</strong> The spread of residuals is fairly constant across fitted values.
Overall, the LINE conditions are reasonably satisfied.</li>
</ul>
<p><strong>(LC11.2)</strong> Repeat the regression modeling and prediction for a house of condition 5 and size 1900 square feet, but using the parallel slopes model.</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb855"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">house_prices</span> <span class="op">&lt;-</span> <span class="va">house_prices</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    log10_price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span>,</span>
<span>    log10_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">sqft_living</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># Fit regression model:</span></span>
<span><span class="va">price_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">log10_price</span> <span class="op">~</span> <span class="va">log10_size</span> <span class="op">+</span> <span class="va">condition</span>,</span>
<span>  data <span class="op">=</span> <span class="va">house_prices</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get regression table:</span></span>
<span><span class="fu"><a href="moderndive.github.io/moderndive/reference/get_regression_table.html">get_regression_table</a></span><span class="op">(</span><span class="va">price_interaction</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 6 × 7
  term         estimate std_error statistic p_value lower_ci upper_ci
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 intercept       2.882     0.036    79.994   0        2.811    2.952
2 log10_size      0.837     0.006   134.169   0        0.825    0.85 
3 condition: 2   -0.039     0.033    -1.16    0.246   -0.104    0.027
4 condition: 3    0.032     0.031     1.037   0.3     -0.028    0.092
5 condition: 4    0.044     0.031     1.422   0.155   -0.017    0.104
6 condition: 5    0.096     0.031     3.094   0.002    0.035    0.156</code></pre>
<div class="sourceCode" id="cb857"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">2.88</span> <span class="op">+</span> <span class="fl">0.096</span> <span class="op">+</span> <span class="fl">0.837</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="fl">1900</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 525190</code></pre>
<p><strong>(LC11.3)</strong> Interpret the results of the other rows in <code>get_regression_table(price_interaction)</code> not already discussed.</p>
<p><strong>Solution:</strong></p>
<ul>
<li>
<code>condition2</code>–<code>condition5</code>: These give the intercept differences relative to condition 1 houses. For example, a positive value for <code>condition5</code> means condition 5 houses start with higher baseline log10 price at size = 1 square foot.</li>
<li>
<code>log10_size:condition2</code>–<code>log10_size:condition5</code>: These give slope differences relative to condition 1. A positive coefficient means price increases faster with size for that condition compared to condition 1.</li>
</ul>
<p><strong>(LC11.4)</strong> Create, visualize, and interpret confidence intervals using both theory-based and simulation-based approaches.</p>
<p><strong>Solution:</strong></p>
<ul>
<li>
<strong>Theory-based:</strong> Use <code>get_regression_table(price_interaction)</code> which reports CIs from the <span class="math inline">\(t\)</span>-distribution. For example, the CI for <code>log10_size</code> excludes 0, so size is significant.</li>
<li>
<strong>Simulation-based:</strong> Bootstrap the regression with resampling (<code>infer</code> package with <code><a href="https://generics.r-lib.org/reference/fit.html">fit()</a></code> + <code><a href="https://infer.tidymodels.org/reference/get_confidence_interval.html">get_confidence_interval()</a></code>). Plot the bootstrap distribution of coefficients and shade the middle 95%.
Both approaches agree: only <code>log10_size</code> has a confidence interval that does not include 0, confirming its significant relationship with log10 price.</li>
</ul>
<p><strong>(LC11.5)</strong> What date between 1994 and 2003 has the fewest number of births in the US? What story could you tell about why?</p>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb859"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">US_births_1994_2003</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">births</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 3,652 × 6
    year month date_of_month date       day_of_week births
   &lt;int&gt; &lt;int&gt;         &lt;int&gt; &lt;date&gt;     &lt;ord&gt;        &lt;int&gt;
 1  2001    12            25 2001-12-25 Tues          6443
 2  2000    12            25 2000-12-25 Mon           6566
 3  2003    12            25 2003-12-25 Thurs         6628
 4  2002    12            25 2002-12-25 Wed           6629
 5  1999    12            25 1999-12-25 Sat           6674
 6  2000    12            24 2000-12-24 Sun           6801
 7  1995    12            24 1995-12-24 Sun           6999
 8  2002     4             7 2002-04-07 Sun           7008
 9  2002     3            31 2002-03-31 Sun           7019
10  1998    12            25 1998-12-25 Fri           7020
# ℹ 3,642 more rows</code></pre>
<p>The dates with the fewest number of births in the US were 12/25 of the years of 2001, 2000, 2003, 2002, and 1999. Because it is Christmas Day and hospitals don’t generally induce labor on that day.</p>
<hr>
</div>
<div id="appendix-a1-solutions" class="section level2" number="15.12">
<h2>
<span class="header-section-number">D.12</span> Appendix A1 Solutions<a class="anchor" aria-label="anchor" href="#appendix-a1-solutions"><i class="fas fa-link"></i></a>
</h2>
<p><strong>(LCA1.1)</strong> What proportion of the area under the normal curve is less than 3? Greater than 12? Between 0 and 12?</p>
<ul>
<li>Less than 3: 3 is one standard deviation less than the mean of 6, since <span class="math inline">\(\frac{3 - \mu}{\sigma} = \frac{3-6}{3} = -1\)</span>. Thus we compute the area to the left of <span class="math inline">\(z = -1\)</span> in Figure <a href="appendixA.html#fig:normal-rule-of-thumb">A.2</a>: 0.15% + 2.35% + 13.5% = 16%.</li>
<li>Greater than 12: 12 is two standard deviations greater than the mean of 6, since <span class="math inline">\(\frac{12 - \mu}{\sigma} = \frac{12-6}{3} = +2\)</span>, we compute the area to the right of <span class="math inline">\(z = +2\)</span> in Figure <a href="appendixA.html#fig:normal-rule-of-thumb">A.2</a>: 2.35% + 0.15% = 2.5%.</li>
<li>Between 0 and 12: 0 is two standard deviations less than the mean of 6, since <span class="math inline">\(\frac{0 - \mu}{\sigma} = \frac{0-6}{3} = -2\)</span>. Thus we compute the area between <span class="math inline">\(z = -2\)</span> and <span class="math inline">\(z = +2\)</span> in Figure <a href="appendixA.html#fig:normal-rule-of-thumb">A.2</a>: 13.5% + 34% + 34% + 13.5% = 95%.</li>
</ul>
<p><strong>(LCA1.2)</strong> What is the 2.5th percentile of the area under the normal curve? The 97.5th percentile? The 100th percentile?</p>
<ul>
<li>2.5th percentile: Starting from the left of Figure <a href="appendixA.html#fig:normal-rule-of-thumb">A.2</a>, since 0.15% + 2.35% = 2.5%, the 2.5th percentile is <span class="math inline">\(z = -2\)</span>. However, this is in standard units. Thus we need the value in the normal distribution that is two standard deviations lower than the mean: <span class="math inline">\(\mu - 2 \cdot\sigma = 6 - 2 \cdot 3 = 0\)</span>.</li>
<li>97.5th percentile: Starting from the left of Figure <a href="appendixA.html#fig:normal-rule-of-thumb">A.2</a>, since 0.15% + 2.35% + 13.5% + 34% + 34% + 13.5% = 97.5%, the 97.5th percentile is <span class="math inline">\(z = +2\)</span>. However, this is in standard units. Thus we need the value in the normal distribution that is two standard deviations higher than the mean: <span class="math inline">\(\mu + 2 \cdot\sigma = 6 + 2 \cdot 3 = 12\)</span>.</li>
<li>100th percentile: <span class="math inline">\(+\infty\)</span>. In other words, 100% of values will be less than positive infinity.</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="appendixC.html"><span class="header-section-number">C</span> Tips and Tricks</a></div>
<div class="next"><a href="the-theory-behind-the-bootstrap-method.html"><span class="header-section-number">E</span> The Theory Behind the Bootstrap Method</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#appendixD"><span class="header-section-number">D</span> Learning Check Solutions</a></li>
<li><a class="nav-link" href="#chapter-1-solutions"><span class="header-section-number">D.1</span> Chapter 1 Solutions</a></li>
<li><a class="nav-link" href="#chapter-2-solutions"><span class="header-section-number">D.2</span> Chapter 2 Solutions</a></li>
<li><a class="nav-link" href="#chapter-3-solutions"><span class="header-section-number">D.3</span> Chapter 3 Solutions</a></li>
<li><a class="nav-link" href="#chapter-4-solutions"><span class="header-section-number">D.4</span> Chapter 4 Solutions</a></li>
<li><a class="nav-link" href="#chapter-5-solutions"><span class="header-section-number">D.5</span> Chapter 5 Solutions</a></li>
<li><a class="nav-link" href="#chapter-6-solutions"><span class="header-section-number">D.6</span> Chapter 6 Solutions</a></li>
<li><a class="nav-link" href="#chapter-7-solutions"><span class="header-section-number">D.7</span> Chapter 7 Solutions</a></li>
<li><a class="nav-link" href="#chapter-8-solutions"><span class="header-section-number">D.8</span> Chapter 8 Solutions</a></li>
<li><a class="nav-link" href="#chapter-9-solutions"><span class="header-section-number">D.9</span> Chapter 9 Solutions</a></li>
<li><a class="nav-link" href="#chapter-10-solutions"><span class="header-section-number">D.10</span> Chapter 10 Solutions</a></li>
<li><a class="nav-link" href="#chapter-11-solutions"><span class="header-section-number">D.11</span> Chapter 11 Solutions</a></li>
<li><a class="nav-link" href="#appendix-a1-solutions"><span class="header-section-number">D.12</span> Appendix A1 Solutions</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/moderndive/ModernDive_book//blob/v2/94-appendixD.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/moderndive/ModernDive_book//edit/v2/94-appendixD.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Statistical Inference via Data Science</strong>: A ModernDive into R and the Tidyverse <br> (Second Edition)" was written by Chester Ismay, Albert Y. Kim, and Arturo Valdivia <br> Foreword by Kelly S. McConville. It was last built on December 09, 2025.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
