
Needed packages

```{r lc-04-1, message=FALSE}
library(dplyr)
library(ggplot2)
library(readr)
library(tidyr)
library(nycflights23)
library(fivethirtyeight)
``` 


**(LC4.1)** What are common characteristics of "tidy" datasets?

**Solution**: Rows correspond to observations, while columns correspond to variables. Each type of observational unit is stored in its own table.

**(LC4.2)** What makes "tidy" datasets useful for organizing data?

**Solution**: Tidy datasets are an organized way of viewing data. This format is required for the `ggplot2` and `dplyr` packages for data visualization and wrangling. They provide a consistent, standardized structure so that functions work seamlessly together across packages. This uniform format makes it easier to wrangle, visualize, and analyze data without reshaping it repeatedly.

**(LC4.3)** Take a look the `airline_safety` data frame included in the `fivethirtyeight` data. Run the following:

```{r lc-04-alt, eval=FALSE}
airline_safety
```

After reading the help file by running `?airline_safety`, we see that `airline_safety` is a data frame containing information on different airlines companies' safety records. This data was originally reported on the data journalism website FiveThirtyEight.com in Nate Silver's article ["Should Travelers Avoid Flying Airlines That Have Had Crashes in the Past?"](https://fivethirtyeight.com/features/should-travelers-avoid-flying-airlines-that-have-had-crashes-in-the-past/). Let's ignore the `incl_reg_subsidiaries` and `avail_seat_km_per_week` variables for simplicity:

```{r lc-04-assign-airline_safety_sma}
airline_safety_smaller <- airline_safety |>
  select(-c(incl_reg_subsidiaries, avail_seat_km_per_week))
airline_safety_smaller
```

This data frame is not in "tidy" format. How would you convert this data frame to be in "tidy" format, in particular so that it has a variable `incident_type_years` indicating the incident type/year and a variable `count` of the counts?

**Solution**: 

This can been done using the `pivot_longer()` function from the `tidyr` package:

```{r lc-04-pivot-longer}
airline_safety_smaller_tidy <- airline_safety_smaller |>
  pivot_longer(
    names_to = "incident_type_years",
    values_to = "count",
    cols = -airline
  )
airline_safety_smaller_tidy
```

If you look at the resulting `airline_safety_smaller_tidy` data frame in the spreadsheet viewer, you'll see that the variable `incident_type_years` has 6 possible values: `"incidents_85_99", "fatal_accidents_85_99", "fatalities_85_99", 
"incidents_00_14", "fatal_accidents_00_14", "fatalities_00_14"` corresponding to the 6 columns of `airline_safety_smaller` we tidied. 

Note that prior to `tidyr` version 1.0.0 released to CRAN in September 2019, this could also have been done using the `gather()` function from the `tidyr` package. The `gather()` function still works, but its further development has stopped in favor of `pivot_longer()`.

```{r lc-04-assign-airline_safety_sma-v2}
airline_safety_smaller_tidy <- airline_safety_smaller |>
  gather(key = incident_type_years, value = count, -airline)
airline_safety_smaller_tidy
```

**(LC4.4)**  Convert the `dem_score` data frame into
a tidy data frame and assign the name of `dem_score_tidy` to the resulting long-formatted data frame.

**Solution**: Running the following in the console:

```{r lc-04-pivot-longer2}
dem_score_tidy <- dem_score |>
  pivot_longer(
    names_to = "year", values_to = "democracy_score",
    cols = -country
  )
```

Let's now compare the `dem_score` and `dem_score_tidy`. `dem_score` has democracy score information for each year in columns, whereas in `dem_score_tidy` there are explicit variables `year` and `democracy_score`. While both representations of the data contain the same information, we can only use `ggplot()` to create plots using the `dem_score_tidy` data frame.

```{r lc-04-v7}
dem_score
dem_score_tidy
```

**(LC4.5)**  Read in the life expectancy data stored at <https://moderndive.com/v2/data/le_mess.csv> and convert it to a tidy data frame. 

**Solution**: The code is similar:

```{r lc-04-pivot-longer2-dup1, eval=FALSE}
life_expectancy <- read_csv("https://moderndive.com/data/le_mess.csv")
life_expectancy_tidy <- life_expectancy |>
  pivot_longer(
    names_to = "year",
    values_to = "life_expectancy",
    cols = -country
  )
```

```{r lc-04-pivot-longer2-dup2, echo=FALSE, purl=FALSE, message=FALSE, warning=FALSE}
life_expectancy <- read_csv("../data/le_mess.csv")
life_expectancy_tidy <- life_expectancy |>
  pivot_longer(
    names_to = "year",
    values_to = "life_expectancy",
    cols = -country
  )
```

We observe the same structure with respect to `year` in `life_expectancy` vs `life_expectancy_tidy` as we did in `dem_score` vs `dem_score_tidy`:

```{r lc-04-v10}
life_expectancy
life_expectancy_tidy
```
