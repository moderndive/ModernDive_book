<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>C Tips and Tricks | Statistical Inference via Data Science</title>
<meta name="author" content="Chester Ismay, Albert Y. Kim, and Arturo Valdivia   Foreword by Kelly S. McConville">
<meta name="description" content="Needed packages Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). Recall from our discussion in Section 4.4 that loading the tidyverse package by...">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="C Tips and Tricks | Statistical Inference via Data Science">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/logos/book_cover.png">
<meta property="og:description" content="Needed packages Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). Recall from our discussion in Section 4.4 that loading the tidyverse package by...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="C Tips and Tricks | Statistical Inference via Data Science">
<meta name="twitter:site" content="@ModernDive">
<meta name="twitter:description" content="Needed packages Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). Recall from our discussion in Section 4.4 that loading the tidyverse package by...">
<meta name="twitter:image" content="/images/logos/book_cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YVFBK9P73R"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-YVFBK9P73R');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="A ModernDive into R and the Tidyverse &lt;br&gt; (Second Edition)">Statistical Inference via Data Science</a>:
        <small class="text-muted">A ModernDive into R and the Tidyverse <br> (Second Edition)</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to ModernDive (v2)</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="about-the-authors.html">About the authors</a></li>
<li><a class="" href="getting-started.html"><span class="header-section-number">1</span> Getting Started with Data in R</a></li>
<li class="book-part">Data Science with tidyverse</li>
<li><a class="" href="viz.html"><span class="header-section-number">2</span> Data Visualization</a></li>
<li><a class="" href="wrangling.html"><span class="header-section-number">3</span> Data Wrangling</a></li>
<li><a class="" href="tidy.html"><span class="header-section-number">4</span> Data Importing and Tidy Data</a></li>
<li class="book-part">Statistical Modeling with moderndive</li>
<li><a class="" href="regression.html"><span class="header-section-number">5</span> Simple Linear Regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">6</span> Multiple Regression</a></li>
<li class="book-part">Statistical Inference with infer</li>
<li><a class="" href="sampling.html"><span class="header-section-number">7</span> Sampling</a></li>
<li><a class="" href="confidence-intervals.html"><span class="header-section-number">8</span> Estimation, Confidence Intervals, and Bootstrapping</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">9</span> Hypothesis Testing</a></li>
<li><a class="" href="inference-for-regression.html"><span class="header-section-number">10</span> Inference for Regression</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="thinking-with-data.html"><span class="header-section-number">11</span> Tell Your Story with Data</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="appendixA.html"><span class="header-section-number">A</span> Statistical Background</a></li>
<li><a class="" href="appendixB.html"><span class="header-section-number">B</span> Inference Examples</a></li>
<li><a class="active" href="appendixC.html"><span class="header-section-number">C</span> Tips and Tricks</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><img src="https://moderndive.com/wide_format.png" alt="ModernDive" style="max-width: 550px; display: block; margin: 0 auto; padding-top: 10px;"><div id="appendixC" class="section level1" number="14">
<h1>
<span class="header-section-number">C</span> Tips and Tricks<a class="anchor" aria-label="anchor" href="#appendixC"><i class="fas fa-link"></i></a>
</h1>
<div id="needed-packages-2" class="section level3 unnumbered">
<h3>Needed packages<a class="anchor" aria-label="anchor" href="#needed-packages-2"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). Recall from our discussion in Section <a href="tidy.html#tidyverse-package">4.4</a> that loading the <code>tidyverse</code> package by running <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code> loads the following commonly used data science packages all at once:</p>
<ul>
<li>
<code>ggplot2</code> for data visualization</li>
<li>
<code>dplyr</code> for data wrangling</li>
<li>
<code>tidyr</code> for converting data to “tidy” format</li>
<li>
<code>readr</code> for importing spreadsheet data into R</li>
<li>As well as the more advanced <code>purrr</code>, <code>tibble</code>, <code>stringr</code>, and <code>forcats</code> packages.</li>
</ul>
<p>If needed, read Section <a href="getting-started.html#packages">1.3</a> for information on how to install and load R packages.</p>
<div class="sourceCode" id="cb688"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/dygraphs">dygraphs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/nycflights23/">nycflights23</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div id="data-wrangling" class="section level2" number="14.1">
<h2>
<span class="header-section-number">C.1</span> Data wrangling<a class="anchor" aria-label="anchor" href="#data-wrangling"><i class="fas fa-link"></i></a>
</h2>
<p>In this Section, we address some of the most common data wrangling questions we’ve encountered in student projects (shout out to <a href="https://www.scsparkscience.org/fellow/jennifer-smetzer/">Dr. Jenny Smetzer</a> for her work setting this up!):</p>
<ul>
<li>
<a href="appendixC.html#appendix-missing-values">C.1.1</a>: Dealing with missing values</li>
<li>
<a href="appendixC.html#appendix-reordering-bars">C.1.2</a>: Reordering bars in a barplot</li>
<li>
<a href="appendixC.html#appendix-money-on-axis">C.1.3</a>: Showing money on an axis</li>
<li>
<a href="appendixC.html#appendix-changing-values">C.1.4</a>: Changing values inside cells</li>
<li>
<a href="appendixC.html#appendix-convert-numerical-categorical">C.1.5</a>: Converting a numerical variable to a categorical one</li>
<li>
<a href="appendixC.html#appendix-prop">C.1.6</a>: Computing proportions</li>
<li>
<a href="appendixC.html#appendix-commas">C.1.7</a>: Dealing with %, commas, and $</li>
</ul>
<div class="inline-figure"><img src="images/data_ninja1.png" style="width:30.0%"></div>
<p>Let’s load an example movies dataset, pare down the rows and columns a bit, and then show the first 10 rows using <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice()</a></code>.</p>
<div class="sourceCode" id="cb689"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://moderndive.com/data/movies.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"action"</span>, <span class="st">"comedy"</span>, <span class="st">"drama"</span>, <span class="st">"animated"</span>, <span class="st">"fantasy"</span>, <span class="st">"rom comedy"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">over200</span><span class="op">)</span></span>
<span></span>
<span><span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 10 × 5
   name               score rating type        millions
   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;
 1 2 Fast 2 Furious 48.9000 PG-13  action      NA      
 2 A Guy Thing      39.5    PG-13  rom comedy  15.545  
 3 A Man Apart      42.9000 R      action      26.2480 
 4 A Mighty Wind    79.9000 PG-13  comedy      17.781  
 5 Agent Cody Banks 57.9000 PG     action      47.8110 
 6 Alex &amp; Emma      35.1000 PG-13  rom comedy  14.219  
 7 American Wedding 50.7000 R      comedy     104.441  
 8 Anger Management 62.6000 PG-13  comedy     134.404  
 9 Anything Else    63.3000 R      rom comedy   3.21200
10 Bad Boys II      38.1000 R      action     138.397  </code></pre>
<div id="appendix-missing-values" class="section level3" number="14.1.1">
<h3>
<span class="header-section-number">C.1.1</span> Dealing with missing values<a class="anchor" aria-label="anchor" href="#appendix-missing-values"><i class="fas fa-link"></i></a>
</h3>
<p>You see the revenue in <code>million</code>s value for the movie “2 Fast 2 Furious” is <code>NA</code> (missing). So the following occurs when computing the median revenue:</p>
<div class="sourceCode" id="cb691"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">millions</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  mean_profit
        &lt;dbl&gt;
1          NA</code></pre>
<p>You should always think about why a data value might be missing and what that missingness may mean. For example, imagine you are conducting a study on the effects of smoking on lung cancer and a lot of your patients’ data is missing because they died of lung cancer. If you just “sweep these patients under the rug” and ignore them, you are clearly biasing the results.</p>
<p>While there are statistical methods to deal with missing data they are beyond the reach of this class. The easiest thing to do is to remove all missing cases, but <strong>you should always at the very least report to the reader if you do so, as by removing the missing values you may be biasing your results.</strong></p>
<p>You can do this with a <code>na.rm = TRUE</code> argument like so:</p>
<div class="sourceCode" id="cb693"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_profit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">millions</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  mean_profit
        &lt;dbl&gt;
1     43.4270</code></pre>
<p>If you decide you want to remove the row with the missing data, you can use the filter function like so:</p>
<div class="sourceCode" id="cb695"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_no_missing</span> <span class="op">&lt;-</span> <span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">millions</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">movies_no_missing</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 10 × 5
   name               score rating type        millions
   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;
 1 A Guy Thing      39.5    PG-13  rom comedy  15.545  
 2 A Man Apart      42.9000 R      action      26.2480 
 3 A Mighty Wind    79.9000 PG-13  comedy      17.781  
 4 Agent Cody Banks 57.9000 PG     action      47.8110 
 5 Alex &amp; Emma      35.1000 PG-13  rom comedy  14.219  
 6 American Wedding 50.7000 R      comedy     104.441  
 7 Anger Management 62.6000 PG-13  comedy     134.404  
 8 Anything Else    63.3000 R      rom comedy   3.21200
 9 Bad Boys II      38.1000 R      action     138.397  
10 Bad Santa        75.8000 R      comedy      59.5230 </code></pre>
<p>We see “2 Fast 2 Furious” is now gone.</p>
</div>
<div id="appendix-reordering-bars" class="section level3" number="14.1.2">
<h3>
<span class="header-section-number">C.1.2</span> Reordering bars in a barplot<a class="anchor" aria-label="anchor" href="#appendix-reordering-bars"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s compute the total revenue for each movie type and plot a barplot.</p>
<div class="sourceCode" id="cb697"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">revenue_by_type</span> <span class="op">&lt;-</span> <span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>total_revenue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">millions</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">revenue_by_type</span></span></code></pre></div>
<pre><code># A tibble: 6 × 2
  type       total_revenue
  &lt;chr&gt;              &lt;dbl&gt;
1 action            NA    
2 animated         561.306
3 comedy          2286.81 
4 drama            840.038
5 fantasy          508.580
6 rom comedy       492.282</code></pre>
<div class="sourceCode" id="cb699"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">revenue_by_type</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">total_revenue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Movie genre"</span>, y <span class="op">=</span> <span class="st">"Total box office revenue (in millions of $)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-714-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>Say we want to reorder the categorical variable <code>type</code> so that the bars show in a different order. We can reorder the bars by manually defining the order of the <code>levels</code> in the <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> command:</p>
<div class="sourceCode" id="cb700"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">type_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rom comedy"</span>, <span class="st">"action"</span>, <span class="st">"drama"</span>, <span class="st">"animated"</span>, <span class="st">"comedy"</span>, <span class="st">"fantasy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">revenue_by_type</span> <span class="op">&lt;-</span> <span class="va">revenue_by_type</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">type</span>, levels <span class="op">=</span> <span class="va">type_levels</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">revenue_by_type</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">total_revenue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Movie genre"</span>, y <span class="op">=</span> <span class="st">"Total boxoffice revenue (in millions of $)"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-715-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>Or if you want to reorder <code>type</code> in ascending order of <code>total_revenue</code>, we use <code><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder()</a></code>:</p>
<div class="sourceCode" id="cb701"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">revenue_by_type</span> <span class="op">&lt;-</span> <span class="va">revenue_by_type</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">total_revenue</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">revenue_by_type</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">total_revenue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Movie genre"</span>, y <span class="op">=</span> <span class="st">"Total boxoffice revenue (in millions of $)"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-716-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>Or if you want to reorder <code>type</code> in descending order of <code>total_revenue</code>, just put
a <code>-</code> sign in front of <code>-total_revenue</code> in <code><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder()</a></code>:</p>
<div class="sourceCode" id="cb702"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">revenue_by_type</span> <span class="op">&lt;-</span> <span class="va">revenue_by_type</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">type</span>, <span class="op">-</span><span class="va">total_revenue</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">revenue_by_type</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type</span>, y <span class="op">=</span> <span class="va">total_revenue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Movie genre"</span>, y <span class="op">=</span> <span class="st">"Total boxoffice revenue (in millions of $)"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-717-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>For more advanced categorical variable (i.e. factor) manipulations, check out
the <a href="https://forcats.tidyverse.org/" target="_blank"><code>forcats</code> package</a>. Note: <code>forcats</code> is an anagram of <code>factors</code>.</p>
<div class="inline-figure"><img src="https://github.com/tidyverse/forcats/blob/main/man/figures/logo.png?raw=true" style="width:20.0%"></div>
</div>
<div id="appendix-money-on-axis" class="section level3" number="14.1.3">
<h3>
<span class="header-section-number">C.1.3</span> Showing money on an axis<a class="anchor" aria-label="anchor" href="#appendix-money-on-axis"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb703"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_ex</span> <span class="op">&lt;-</span> <span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>revenue <span class="op">=</span> <span class="va">millions</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">movies_ex</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rating</span>, y <span class="op">=</span> <span class="va">revenue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"rating"</span>, y <span class="op">=</span> <span class="st">"Revenue in $"</span>, title <span class="op">=</span> <span class="st">"Profits for different movie ratings"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-718-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>Google “ggplot2 axis scale dollars” and click on the <a href="http://www.sthda.com/english/wiki/ggplot2-axis-scales-and-transformations">first link</a> and search for the word “dollars”. You’ll find:</p>
<div class="sourceCode" id="cb704"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Don't forget to load the scales package first!</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">movies_ex</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rating</span>, y <span class="op">=</span> <span class="va">revenue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"rating"</span>, y <span class="op">=</span> <span class="st">"Revenue in $"</span>, title <span class="op">=</span> <span class="st">"Profits for different movie ratings"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">dollar</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/unnamed-chunk-719-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
</div>
<div id="appendix-changing-values" class="section level3" number="14.1.4">
<h3>
<span class="header-section-number">C.1.4</span> Changing values inside cells<a class="anchor" aria-label="anchor" href="#appendix-changing-values"><i class="fas fa-link"></i></a>
</h3>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> function in the <code>dplyr</code> package renames column/variable names. To “rename” values inside cells of a particular column, you need to <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> the column using one of the three functions below. There might be other ones too, but these are the three we’ve seen the most. In these examples, we’ll change values in the variable <code>type</code>.</p>
<ol style="list-style-type: decimal">
<li><code><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code></li>
<li><code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code></li>
</ol>
<div id="if_else" class="section level4 unnumbered">
<h4>
<code>if_else()</code><a class="anchor" aria-label="anchor" href="#if_else"><i class="fas fa-link"></i></a>
</h4>
<p>Switch all instances of <code>rom comedy</code> with <code>romantic comedy</code> using <code><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else()</a></code> from the <code>dplyr</code> package. If a particular row has <code>type == "rom comedy"</code>, then return <code>"romantic comedy"</code>, else return whatever was originally in <code>type</code>. Save everything in a new variable <code>type_new</code>:</p>
<div class="sourceCode" id="cb705"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type_new <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"rom comedy"</span>, <span class="st">"romantic comedy"</span>, <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 10 × 7
   name               score rating type        millions    revenue type_new     
   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;        
 1 2 Fast 2 Furious 48.9000 PG-13  action      NA              NA  action       
 2 A Guy Thing      39.5    PG-13  rom comedy  15.545    15545000  romantic com…
 3 A Man Apart      42.9000 R      action      26.2480   26247999  action       
 4 A Mighty Wind    79.9000 PG-13  comedy      17.781    17781000  comedy       
 5 Agent Cody Banks 57.9000 PG     action      47.8110   47811001  action       
 6 Alex &amp; Emma      35.1000 PG-13  rom comedy  14.219    14219000  romantic com…
 7 American Wedding 50.7000 R      comedy     104.441   104441000  comedy       
 8 Anger Management 62.6000 PG-13  comedy     134.404   134404010  comedy       
 9 Anything Else    63.3000 R      rom comedy   3.21200   3212000. romantic com…
10 Bad Boys II      38.1000 R      action     138.397   138397000  action       </code></pre>
<p>Do the same here, but return <code>"not romantic comedy"</code> if <code>type</code> is not <code>"rom comedy"</code> and this time overwrite the original <code>type</code> variable:</p>
<div class="sourceCode" id="cb707"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"rom comedy"</span>, <span class="st">"romantic comedy"</span>, <span class="st">"not romantic comedy"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 10 × 6
   name               score rating type                 millions    revenue
   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;                   &lt;dbl&gt;      &lt;dbl&gt;
 1 2 Fast 2 Furious 48.9000 PG-13  not romantic comedy  NA              NA 
 2 A Guy Thing      39.5    PG-13  romantic comedy      15.545    15545000 
 3 A Man Apart      42.9000 R      not romantic comedy  26.2480   26247999 
 4 A Mighty Wind    79.9000 PG-13  not romantic comedy  17.781    17781000 
 5 Agent Cody Banks 57.9000 PG     not romantic comedy  47.8110   47811001 
 6 Alex &amp; Emma      35.1000 PG-13  romantic comedy      14.219    14219000 
 7 American Wedding 50.7000 R      not romantic comedy 104.441   104441000 
 8 Anger Management 62.6000 PG-13  not romantic comedy 134.404   134404010 
 9 Anything Else    63.3000 R      romantic comedy       3.21200   3212000.
10 Bad Boys II      38.1000 R      not romantic comedy 138.397   138397000 </code></pre>
</div>
<div id="recode" class="section level4 unnumbered">
<h4>
<code>recode()</code><a class="anchor" aria-label="anchor" href="#recode"><i class="fas fa-link"></i></a>
</h4>
<p><code><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else()</a></code> is rather limited however. What if we want to “rename” all <code>type</code> so that they start with uppercase? Use <code><a href="https://dplyr.tidyverse.org/reference/recode.html">recode()</a></code>:</p>
<div class="sourceCode" id="cb709"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type_new <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">type</span>,</span>
<span>    <span class="st">"action"</span> <span class="op">=</span> <span class="st">"Action"</span>,</span>
<span>    <span class="st">"animated"</span> <span class="op">=</span> <span class="st">"Animated"</span>,</span>
<span>    <span class="st">"comedy"</span> <span class="op">=</span> <span class="st">"Comedy"</span>,</span>
<span>    <span class="st">"drama"</span> <span class="op">=</span> <span class="st">"Drama"</span>,</span>
<span>    <span class="st">"fantasy"</span> <span class="op">=</span> <span class="st">"Fantasy"</span>,</span>
<span>    <span class="st">"rom comedy"</span> <span class="op">=</span> <span class="st">"Romantic Comedy"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 10 × 7
   name               score rating type        millions    revenue type_new     
   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;        
 1 2 Fast 2 Furious 48.9000 PG-13  action      NA              NA  Action       
 2 A Guy Thing      39.5    PG-13  rom comedy  15.545    15545000  Romantic Com…
 3 A Man Apart      42.9000 R      action      26.2480   26247999  Action       
 4 A Mighty Wind    79.9000 PG-13  comedy      17.781    17781000  Comedy       
 5 Agent Cody Banks 57.9000 PG     action      47.8110   47811001  Action       
 6 Alex &amp; Emma      35.1000 PG-13  rom comedy  14.219    14219000  Romantic Com…
 7 American Wedding 50.7000 R      comedy     104.441   104441000  Comedy       
 8 Anger Management 62.6000 PG-13  comedy     134.404   134404010  Comedy       
 9 Anything Else    63.3000 R      rom comedy   3.21200   3212000. Romantic Com…
10 Bad Boys II      38.1000 R      action     138.397   138397000  Action       </code></pre>
</div>
<div id="case_when" class="section level4 unnumbered">
<h4>
<code>case_when()</code><a class="anchor" aria-label="anchor" href="#case_when"><i class="fas fa-link"></i></a>
</h4>
<p><code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> is a little trickier, but allows you to evaluate boolean operations using <code>==</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&amp;</code>, <code>|</code>, etc:</p>
<div class="sourceCode" id="cb711"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    type_new <span class="op">=</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">type</span> <span class="op">==</span> <span class="st">"action"</span> <span class="op">&amp;</span> <span class="va">millions</span> <span class="op">&gt;</span> <span class="fl">40</span> <span class="op">~</span> <span class="st">"Big budget action"</span>,</span>
<span>        <span class="va">type</span> <span class="op">==</span> <span class="st">"rom comedy"</span> <span class="op">&amp;</span> <span class="va">millions</span> <span class="op">&lt;</span> <span class="fl">40</span> <span class="op">~</span> <span class="st">"Small budget romcom"</span>,</span>
<span>        <span class="co"># Need this for everything else that aren't the two cases above:</span></span>
<span>        <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Rest"</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 108 × 7
   name               score rating type        millions    revenue type_new     
   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;        
 1 2 Fast 2 Furious 48.9000 PG-13  action      NA              NA  Rest         
 2 A Guy Thing      39.5    PG-13  rom comedy  15.545    15545000  Small budget…
 3 A Man Apart      42.9000 R      action      26.2480   26247999  Rest         
 4 A Mighty Wind    79.9000 PG-13  comedy      17.781    17781000  Rest         
 5 Agent Cody Banks 57.9000 PG     action      47.8110   47811001  Big budget a…
 6 Alex &amp; Emma      35.1000 PG-13  rom comedy  14.219    14219000  Small budget…
 7 American Wedding 50.7000 R      comedy     104.441   104441000  Rest         
 8 Anger Management 62.6000 PG-13  comedy     134.404   134404010  Rest         
 9 Anything Else    63.3000 R      rom comedy   3.21200   3212000. Small budget…
10 Bad Boys II      38.1000 R      action     138.397   138397000  Big budget a…
# ℹ 98 more rows</code></pre>
</div>
</div>
<div id="appendix-convert-numerical-categorical" class="section level3" number="14.1.5">
<h3>
<span class="header-section-number">C.1.5</span> Converting a numerical variable to a categorical one<a class="anchor" aria-label="anchor" href="#appendix-convert-numerical-categorical"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes we want to turn a numerical, continuous variable into a categorical variable. For instance, what if we wanted to have a variable that tells us if a movie made one hundred million dollars or more. That is to say, we can create a binary variable, which is the same thing as a categorical variable with 2 levels. We can again use the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function:</p>
<div class="sourceCode" id="cb713"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>big_budget <span class="op">=</span> <span class="va">millions</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 10 × 7
   name               score rating type        millions    revenue big_budget
   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt; &lt;lgl&gt;     
 1 2 Fast 2 Furious 48.9000 PG-13  action      NA              NA  NA        
 2 A Guy Thing      39.5    PG-13  rom comedy  15.545    15545000  FALSE     
 3 A Man Apart      42.9000 R      action      26.2480   26247999  FALSE     
 4 A Mighty Wind    79.9000 PG-13  comedy      17.781    17781000  FALSE     
 5 Agent Cody Banks 57.9000 PG     action      47.8110   47811001  FALSE     
 6 Alex &amp; Emma      35.1000 PG-13  rom comedy  14.219    14219000  FALSE     
 7 American Wedding 50.7000 R      comedy     104.441   104441000  TRUE      
 8 Anger Management 62.6000 PG-13  comedy     134.404   134404010  TRUE      
 9 Anything Else    63.3000 R      rom comedy   3.21200   3212000. FALSE     
10 Bad Boys II      38.1000 R      action     138.397   138397000  TRUE      </code></pre>
<p>What if you want to convert a numerical variable into a categorical variable with more than 2 levels? One way is to use the <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> command. For instance, below, we <code><a href="https://rdrr.io/r/base/cut.html">cut()</a></code> the <code>score</code> variable, to recode it into 4 categories:</p>
<ol style="list-style-type: decimal">
<li>0 - 40 = bad</li>
<li>40.1 - 60 = so-so</li>
<li>60.1 - 80 = good</li>
<li>80.1+ = great</li>
</ol>
<p>We set the breaking points for cutting the numerical variable with the <code>c(0, 40, 60, 80, 100)</code> part, and set the labels for each of these bins with the <code>labels = c("bad", "so-so", "good", "great")</code> part. All this action happens inside the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> command, so the new categorical variable <code>score_categ</code> is added to the data frame.</p>
<div class="sourceCode" id="cb715"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>score_categ <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">score</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bad"</span>, <span class="st">"so-so"</span>, <span class="st">"good"</span>, <span class="st">"great"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 10 × 7
   name               score rating type        millions    revenue score_categ
   &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt; &lt;fct&gt;      
 1 2 Fast 2 Furious 48.9000 PG-13  action      NA              NA  so-so      
 2 A Guy Thing      39.5    PG-13  rom comedy  15.545    15545000  bad        
 3 A Man Apart      42.9000 R      action      26.2480   26247999  so-so      
 4 A Mighty Wind    79.9000 PG-13  comedy      17.781    17781000  good       
 5 Agent Cody Banks 57.9000 PG     action      47.8110   47811001  so-so      
 6 Alex &amp; Emma      35.1000 PG-13  rom comedy  14.219    14219000  bad        
 7 American Wedding 50.7000 R      comedy     104.441   104441000  so-so      
 8 Anger Management 62.6000 PG-13  comedy     134.404   134404010  good       
 9 Anything Else    63.3000 R      rom comedy   3.21200   3212000. good       
10 Bad Boys II      38.1000 R      action     138.397   138397000  bad        </code></pre>
<p>Other options with the <code>cut</code> function:</p>
<ul>
<li>By default, if the value is exactly the upper bound of an interval, it’s
included in the lessor category (e.g. 60.0 is ‘so-so’ not ‘good’), to
flip this, include the argument <code>right = FALSE</code>.</li>
<li>You could also have R equally divide the variable into a balanced
number of groups. For example, specifying <code>breaks = 3</code> would create 3 groups with
approximately the same number of values in each group.</li>
</ul>
</div>
<div id="appendix-prop" class="section level3" number="14.1.6">
<h3>
<span class="header-section-number">C.1.6</span> Computing proportions<a class="anchor" aria-label="anchor" href="#appendix-prop"><i class="fas fa-link"></i></a>
</h3>
<p>By using a <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> followed not by a <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> as is often the case, but rather a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>. So say we compute the total revenue millions for each movie rating and type:</p>
<div class="sourceCode" id="cb717"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rating_by_type_millions</span> <span class="op">&lt;-</span> <span class="va">movies_ex</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">rating</span>, <span class="va">type</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>millions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">millions</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">rating</span>, <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rating_by_type_millions</span></span></code></pre></div>
<pre><code># A tibble: 15 × 3
# Groups:   rating [4]
   rating type        millions
   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;
 1 G      animated    495.594 
 2 PG     action       47.8110
 3 PG     animated     65.712 
 4 PG     comedy      829.616 
 5 PG     drama       160.873 
 6 PG     fantasy     147.461 
 7 PG-13  action       NA     
 8 PG-13  comedy     1208.31  
 9 PG-13  drama       306.26  
10 PG-13  fantasy     361.119 
11 PG-13  rom comedy  406.251 
12 R      action     1044.82  
13 R      comedy      248.876 
14 R      drama       372.905 
15 R      rom comedy   86.0310</code></pre>
<p>Say within each movie rating (G, PG, PG-13, R), we want to know the proportion of <code>total_millions</code> that made by each movie type (animated, action, comedy, etc). We can:</p>
<div class="sourceCode" id="cb719"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rating_by_type_millions</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">rating</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Compute a new column of the sum of millions split by rating:</span></span>
<span>    total_millions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">millions</span><span class="op">)</span>,</span>
<span>    <span class="co"># Compute the proportion within each rating:</span></span>
<span>    prop <span class="op">=</span> <span class="va">millions</span> <span class="op">/</span> <span class="va">total_millions</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 15 × 5
# Groups:   rating [4]
   rating type        millions total_millions       prop
   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
 1 G      animated    495.594         495.594  1        
 2 PG     action       47.8110       1251.47   0.0382038
 3 PG     animated     65.712        1251.47   0.0525077
 4 PG     comedy      829.616        1251.47   0.662912 
 5 PG     drama       160.873        1251.47   0.128547 
 6 PG     fantasy     147.461        1251.47   0.117830 
 7 PG-13  action       NA              NA     NA        
 8 PG-13  comedy     1208.31           NA     NA        
 9 PG-13  drama       306.26           NA     NA        
10 PG-13  fantasy     361.119          NA     NA        
11 PG-13  rom comedy  406.251          NA     NA        
12 R      action     1044.82         1752.63   0.596143 
13 R      comedy      248.876        1752.63   0.142001 
14 R      drama       372.905        1752.63   0.212769 
15 R      rom comedy   86.0310       1752.63   0.0490868</code></pre>
<p>So for example, the 4 proportions corresponding to R rated movies are 0.596 + 0.142 + 0.213 + 0.0491 = 1.</p>
</div>
<div id="appendix-commas" class="section level3" number="14.1.7">
<h3>
<span class="header-section-number">C.1.7</span> Dealing with %, commas, and $<a class="anchor" aria-label="anchor" href="#appendix-commas"><i class="fas fa-link"></i></a>
</h3>
<p>Say you have numerical data that are recorded as percentages, have commas, or are in dollar form and hence are character strings. How do you convert these to numerical values? Using the <code><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number()</a></code> function from the <code>readr</code> package inside a <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>! Shout out to <a href="https://stackoverflow.com/a/52965808/3674500" target="_blank">Stack Overflow</a>.</p>
<div class="sourceCode" id="cb721"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="st">"10.5%"</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 10.5</code></pre>
<div class="sourceCode" id="cb723"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="st">"145,897"</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 145897</code></pre>
<div class="sourceCode" id="cb725"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="st">"$1,234.5"</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 1234</code></pre>
<p>What about the other way around? Use the <code>scales</code> package!</p>
<div class="sourceCode" id="cb727"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">(</span><span class="fl">0.105</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "10%"</code></pre>
<div class="sourceCode" id="cb729"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">(</span><span class="fl">145897</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "145,897"</code></pre>
<div class="sourceCode" id="cb731"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://scales.r-lib.org/reference/dollar_format.html">dollar</a></span><span class="op">(</span><span class="fl">1234.5</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "$1,234.50"</code></pre>
<hr>
<p><strong>Congratulations. You are now an R Ninja!</strong></p>
<div class="inline-figure"><img src="images/Rninja.png" style="width:40.0%"></div>
<hr>
</div>
</div>
<div id="interactive-graphics" class="section level2" number="14.2">
<h2>
<span class="header-section-number">C.2</span> Interactive graphics<a class="anchor" aria-label="anchor" href="#interactive-graphics"><i class="fas fa-link"></i></a>
</h2>
<div id="interactive-linegraphs" class="section level3" number="14.2.1">
<h3>
<span class="header-section-number">C.2.1</span> Interactive linegraphs<a class="anchor" aria-label="anchor" href="#interactive-linegraphs"><i class="fas fa-link"></i></a>
</h3>
<p>Another useful tool for viewing linegraphs such as this is the <code>dygraph</code> function in the <code>dygraphs</code> package in combination with the <code>dyRangeSelector</code> function. This allows us to zoom in on a selected range and get an interactive plot for us to work with:</p>
<div class="sourceCode" id="cb733"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/dygraphs">dygraphs</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/nycflights23/">nycflights23</a></span><span class="op">)</span></span>
<span><span class="va">flights_day</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">flights</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">time_hour</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flights_summarized</span> <span class="op">&lt;-</span> <span class="va">flights_day</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>median_arr_delay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">arr_delay</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">flights_summarized</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">flights_summarized</span><span class="op">$</span><span class="va">date</span></span>
<span><span class="va">flights_summarized</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">flights_summarized</span>, <span class="op">-</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/dygraphs/man/dyRangeSelector.html">dyRangeSelector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/dygraphs/man/dygraph.html">dygraph</a></span><span class="op">(</span><span class="va">flights_summarized</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-e4806c1bb1490fee566b" style="width:100%;height:432px;"></div>
<script type="application/json" data-for="htmlwidget-e4806c1bb1490fee566b">{"x":{"attrs":{"labels":["day","median_arr_delay"],"legend":"auto","retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60}},"showRangeSelector":true,"rangeSelectorHeight":40,"rangeSelectorPlotFillColor":" #A7B1C4","rangeSelectorPlotStrokeColor":"#808FAB","interactionModel":"Dygraph.Interaction.defaultModel"},"scale":"daily","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2023-01-01T00:00:00.000Z","2023-01-02T00:00:00.000Z","2023-01-03T00:00:00.000Z","2023-01-04T00:00:00.000Z","2023-01-05T00:00:00.000Z","2023-01-06T00:00:00.000Z","2023-01-07T00:00:00.000Z","2023-01-08T00:00:00.000Z","2023-01-09T00:00:00.000Z","2023-01-10T00:00:00.000Z","2023-01-11T00:00:00.000Z","2023-01-12T00:00:00.000Z","2023-01-13T00:00:00.000Z","2023-01-14T00:00:00.000Z","2023-01-15T00:00:00.000Z","2023-01-16T00:00:00.000Z","2023-01-17T00:00:00.000Z","2023-01-18T00:00:00.000Z","2023-01-19T00:00:00.000Z","2023-01-20T00:00:00.000Z","2023-01-21T00:00:00.000Z","2023-01-22T00:00:00.000Z","2023-01-23T00:00:00.000Z","2023-01-24T00:00:00.000Z","2023-01-25T00:00:00.000Z","2023-01-26T00:00:00.000Z","2023-01-27T00:00:00.000Z","2023-01-28T00:00:00.000Z","2023-01-29T00:00:00.000Z","2023-01-30T00:00:00.000Z","2023-01-31T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-02-02T00:00:00.000Z","2023-02-03T00:00:00.000Z","2023-02-04T00:00:00.000Z","2023-02-05T00:00:00.000Z","2023-02-06T00:00:00.000Z","2023-02-07T00:00:00.000Z","2023-02-08T00:00:00.000Z","2023-02-09T00:00:00.000Z","2023-02-10T00:00:00.000Z","2023-02-11T00:00:00.000Z","2023-02-12T00:00:00.000Z","2023-02-13T00:00:00.000Z","2023-02-14T00:00:00.000Z","2023-02-15T00:00:00.000Z","2023-02-16T00:00:00.000Z","2023-02-17T00:00:00.000Z","2023-02-18T00:00:00.000Z","2023-02-19T00:00:00.000Z","2023-02-20T00:00:00.000Z","2023-02-21T00:00:00.000Z","2023-02-22T00:00:00.000Z","2023-02-23T00:00:00.000Z","2023-02-24T00:00:00.000Z","2023-02-25T00:00:00.000Z","2023-02-26T00:00:00.000Z","2023-02-27T00:00:00.000Z","2023-02-28T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-03-02T00:00:00.000Z","2023-03-03T00:00:00.000Z","2023-03-04T00:00:00.000Z","2023-03-05T00:00:00.000Z","2023-03-06T00:00:00.000Z","2023-03-07T00:00:00.000Z","2023-03-08T00:00:00.000Z","2023-03-09T00:00:00.000Z","2023-03-10T00:00:00.000Z","2023-03-11T00:00:00.000Z","2023-03-12T00:00:00.000Z","2023-03-13T00:00:00.000Z","2023-03-14T00:00:00.000Z","2023-03-15T00:00:00.000Z","2023-03-16T00:00:00.000Z","2023-03-17T00:00:00.000Z","2023-03-18T00:00:00.000Z","2023-03-19T00:00:00.000Z","2023-03-20T00:00:00.000Z","2023-03-21T00:00:00.000Z","2023-03-22T00:00:00.000Z","2023-03-23T00:00:00.000Z","2023-03-24T00:00:00.000Z","2023-03-25T00:00:00.000Z","2023-03-26T00:00:00.000Z","2023-03-27T00:00:00.000Z","2023-03-28T00:00:00.000Z","2023-03-29T00:00:00.000Z","2023-03-30T00:00:00.000Z","2023-03-31T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-04-02T00:00:00.000Z","2023-04-03T00:00:00.000Z","2023-04-04T00:00:00.000Z","2023-04-05T00:00:00.000Z","2023-04-06T00:00:00.000Z","2023-04-07T00:00:00.000Z","2023-04-08T00:00:00.000Z","2023-04-09T00:00:00.000Z","2023-04-10T00:00:00.000Z","2023-04-11T00:00:00.000Z","2023-04-12T00:00:00.000Z","2023-04-13T00:00:00.000Z","2023-04-14T00:00:00.000Z","2023-04-15T00:00:00.000Z","2023-04-16T00:00:00.000Z","2023-04-17T00:00:00.000Z","2023-04-18T00:00:00.000Z","2023-04-19T00:00:00.000Z","2023-04-20T00:00:00.000Z","2023-04-21T00:00:00.000Z","2023-04-22T00:00:00.000Z","2023-04-23T00:00:00.000Z","2023-04-24T00:00:00.000Z","2023-04-25T00:00:00.000Z","2023-04-26T00:00:00.000Z","2023-04-27T00:00:00.000Z","2023-04-28T00:00:00.000Z","2023-04-29T00:00:00.000Z","2023-04-30T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-05-02T00:00:00.000Z","2023-05-03T00:00:00.000Z","2023-05-04T00:00:00.000Z","2023-05-05T00:00:00.000Z","2023-05-06T00:00:00.000Z","2023-05-07T00:00:00.000Z","2023-05-08T00:00:00.000Z","2023-05-09T00:00:00.000Z","2023-05-10T00:00:00.000Z","2023-05-11T00:00:00.000Z","2023-05-12T00:00:00.000Z","2023-05-13T00:00:00.000Z","2023-05-14T00:00:00.000Z","2023-05-15T00:00:00.000Z","2023-05-16T00:00:00.000Z","2023-05-17T00:00:00.000Z","2023-05-18T00:00:00.000Z","2023-05-19T00:00:00.000Z","2023-05-20T00:00:00.000Z","2023-05-21T00:00:00.000Z","2023-05-22T00:00:00.000Z","2023-05-23T00:00:00.000Z","2023-05-24T00:00:00.000Z","2023-05-25T00:00:00.000Z","2023-05-26T00:00:00.000Z","2023-05-27T00:00:00.000Z","2023-05-28T00:00:00.000Z","2023-05-29T00:00:00.000Z","2023-05-30T00:00:00.000Z","2023-05-31T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-06-02T00:00:00.000Z","2023-06-03T00:00:00.000Z","2023-06-04T00:00:00.000Z","2023-06-05T00:00:00.000Z","2023-06-06T00:00:00.000Z","2023-06-07T00:00:00.000Z","2023-06-08T00:00:00.000Z","2023-06-09T00:00:00.000Z","2023-06-10T00:00:00.000Z","2023-06-11T00:00:00.000Z","2023-06-12T00:00:00.000Z","2023-06-13T00:00:00.000Z","2023-06-14T00:00:00.000Z","2023-06-15T00:00:00.000Z","2023-06-16T00:00:00.000Z","2023-06-17T00:00:00.000Z","2023-06-18T00:00:00.000Z","2023-06-19T00:00:00.000Z","2023-06-20T00:00:00.000Z","2023-06-21T00:00:00.000Z","2023-06-22T00:00:00.000Z","2023-06-23T00:00:00.000Z","2023-06-24T00:00:00.000Z","2023-06-25T00:00:00.000Z","2023-06-26T00:00:00.000Z","2023-06-27T00:00:00.000Z","2023-06-28T00:00:00.000Z","2023-06-29T00:00:00.000Z","2023-06-30T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-07-02T00:00:00.000Z","2023-07-03T00:00:00.000Z","2023-07-04T00:00:00.000Z","2023-07-05T00:00:00.000Z","2023-07-06T00:00:00.000Z","2023-07-07T00:00:00.000Z","2023-07-08T00:00:00.000Z","2023-07-09T00:00:00.000Z","2023-07-10T00:00:00.000Z","2023-07-11T00:00:00.000Z","2023-07-12T00:00:00.000Z","2023-07-13T00:00:00.000Z","2023-07-14T00:00:00.000Z","2023-07-15T00:00:00.000Z","2023-07-16T00:00:00.000Z","2023-07-17T00:00:00.000Z","2023-07-18T00:00:00.000Z","2023-07-19T00:00:00.000Z","2023-07-20T00:00:00.000Z","2023-07-21T00:00:00.000Z","2023-07-22T00:00:00.000Z","2023-07-23T00:00:00.000Z","2023-07-24T00:00:00.000Z","2023-07-25T00:00:00.000Z","2023-07-26T00:00:00.000Z","2023-07-27T00:00:00.000Z","2023-07-28T00:00:00.000Z","2023-07-29T00:00:00.000Z","2023-07-30T00:00:00.000Z","2023-07-31T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-08-02T00:00:00.000Z","2023-08-03T00:00:00.000Z","2023-08-04T00:00:00.000Z","2023-08-05T00:00:00.000Z","2023-08-06T00:00:00.000Z","2023-08-07T00:00:00.000Z","2023-08-08T00:00:00.000Z","2023-08-09T00:00:00.000Z","2023-08-10T00:00:00.000Z","2023-08-11T00:00:00.000Z","2023-08-12T00:00:00.000Z","2023-08-13T00:00:00.000Z","2023-08-14T00:00:00.000Z","2023-08-15T00:00:00.000Z","2023-08-16T00:00:00.000Z","2023-08-17T00:00:00.000Z","2023-08-18T00:00:00.000Z","2023-08-19T00:00:00.000Z","2023-08-20T00:00:00.000Z","2023-08-21T00:00:00.000Z","2023-08-22T00:00:00.000Z","2023-08-23T00:00:00.000Z","2023-08-24T00:00:00.000Z","2023-08-25T00:00:00.000Z","2023-08-26T00:00:00.000Z","2023-08-27T00:00:00.000Z","2023-08-28T00:00:00.000Z","2023-08-29T00:00:00.000Z","2023-08-30T00:00:00.000Z","2023-08-31T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-09-02T00:00:00.000Z","2023-09-03T00:00:00.000Z","2023-09-04T00:00:00.000Z","2023-09-05T00:00:00.000Z","2023-09-06T00:00:00.000Z","2023-09-07T00:00:00.000Z","2023-09-08T00:00:00.000Z","2023-09-09T00:00:00.000Z","2023-09-10T00:00:00.000Z","2023-09-11T00:00:00.000Z","2023-09-12T00:00:00.000Z","2023-09-13T00:00:00.000Z","2023-09-14T00:00:00.000Z","2023-09-15T00:00:00.000Z","2023-09-16T00:00:00.000Z","2023-09-17T00:00:00.000Z","2023-09-18T00:00:00.000Z","2023-09-19T00:00:00.000Z","2023-09-20T00:00:00.000Z","2023-09-21T00:00:00.000Z","2023-09-22T00:00:00.000Z","2023-09-23T00:00:00.000Z","2023-09-24T00:00:00.000Z","2023-09-25T00:00:00.000Z","2023-09-26T00:00:00.000Z","2023-09-27T00:00:00.000Z","2023-09-28T00:00:00.000Z","2023-09-29T00:00:00.000Z","2023-09-30T00:00:00.000Z","2023-10-01T00:00:00.000Z","2023-10-02T00:00:00.000Z","2023-10-03T00:00:00.000Z","2023-10-04T00:00:00.000Z","2023-10-05T00:00:00.000Z","2023-10-06T00:00:00.000Z","2023-10-07T00:00:00.000Z","2023-10-08T00:00:00.000Z","2023-10-09T00:00:00.000Z","2023-10-10T00:00:00.000Z","2023-10-11T00:00:00.000Z","2023-10-12T00:00:00.000Z","2023-10-13T00:00:00.000Z","2023-10-14T00:00:00.000Z","2023-10-15T00:00:00.000Z","2023-10-16T00:00:00.000Z","2023-10-17T00:00:00.000Z","2023-10-18T00:00:00.000Z","2023-10-19T00:00:00.000Z","2023-10-20T00:00:00.000Z","2023-10-21T00:00:00.000Z","2023-10-22T00:00:00.000Z","2023-10-23T00:00:00.000Z","2023-10-24T00:00:00.000Z","2023-10-25T00:00:00.000Z","2023-10-26T00:00:00.000Z","2023-10-27T00:00:00.000Z","2023-10-28T00:00:00.000Z","2023-10-29T00:00:00.000Z","2023-10-30T00:00:00.000Z","2023-10-31T00:00:00.000Z","2023-11-01T00:00:00.000Z","2023-11-02T00:00:00.000Z","2023-11-03T00:00:00.000Z","2023-11-04T00:00:00.000Z","2023-11-05T00:00:00.000Z","2023-11-06T00:00:00.000Z","2023-11-07T00:00:00.000Z","2023-11-08T00:00:00.000Z","2023-11-09T00:00:00.000Z","2023-11-10T00:00:00.000Z","2023-11-11T00:00:00.000Z","2023-11-12T00:00:00.000Z","2023-11-13T00:00:00.000Z","2023-11-14T00:00:00.000Z","2023-11-15T00:00:00.000Z","2023-11-16T00:00:00.000Z","2023-11-17T00:00:00.000Z","2023-11-18T00:00:00.000Z","2023-11-19T00:00:00.000Z","2023-11-20T00:00:00.000Z","2023-11-21T00:00:00.000Z","2023-11-22T00:00:00.000Z","2023-11-23T00:00:00.000Z","2023-11-24T00:00:00.000Z","2023-11-25T00:00:00.000Z","2023-11-26T00:00:00.000Z","2023-11-27T00:00:00.000Z","2023-11-28T00:00:00.000Z","2023-11-29T00:00:00.000Z","2023-11-30T00:00:00.000Z","2023-12-01T00:00:00.000Z","2023-12-02T00:00:00.000Z","2023-12-03T00:00:00.000Z","2023-12-04T00:00:00.000Z","2023-12-05T00:00:00.000Z","2023-12-06T00:00:00.000Z","2023-12-07T00:00:00.000Z","2023-12-08T00:00:00.000Z","2023-12-09T00:00:00.000Z","2023-12-10T00:00:00.000Z","2023-12-11T00:00:00.000Z","2023-12-12T00:00:00.000Z","2023-12-13T00:00:00.000Z","2023-12-14T00:00:00.000Z","2023-12-15T00:00:00.000Z","2023-12-16T00:00:00.000Z","2023-12-17T00:00:00.000Z","2023-12-18T00:00:00.000Z","2023-12-19T00:00:00.000Z","2023-12-20T00:00:00.000Z","2023-12-21T00:00:00.000Z","2023-12-22T00:00:00.000Z","2023-12-23T00:00:00.000Z","2023-12-24T00:00:00.000Z","2023-12-25T00:00:00.000Z","2023-12-26T00:00:00.000Z","2023-12-27T00:00:00.000Z","2023-12-28T00:00:00.000Z","2023-12-29T00:00:00.000Z","2023-12-30T00:00:00.000Z","2023-12-31T00:00:00.000Z"],[-10.5,-6,-6,-8,-5,-19,-18,-12,-16,-19,50,2,-7,-15,-17,-13,-18,-13,-6,-15,-16,-4,-3,-13,-1,-4,-8,-13,-6,-12,6,8,-6,7,-9,-11,-15,-19,-18,-17,-12,-15,-15,-18,-18,-11,-10,11,-11,-12,-10,-1,2,-2,17,-1,-2,-10,8,-7,7,-3,-5,-1,-6,5,-9,-6,-4,-8,-3,-1,19,4,-15,-8,-3,-4,-11,-13,-13,-2,-5,0,5,5,1,-7,-1,-3,22,0,-6,-11,5,3,-1,-9,-13,-15,-24,-22,-20,-13,8,6,10,-10,-16,-7,-10,4,-3,-9,-10,-8,-8,-7,6,32,-9,-16,-18,-13,-14,-18,-8,-10,-12,-17,-15,-18,-17,-11,-14,-17,-8,-14,-12,-9,-14,-12,-16,-14,-12,-10,-21,-21,-16,-15,-19,-17,-8,-9,-10,-14,-1,-6,-8.5,-14,-18,-12,-5,-13,3,-10,9,-9,-11,-13,-10,-7,-8,10,14,37,41.5,30,0.5,-5,-10,-5,-2,-9,-1,-6,-6,10,4.5,19,8,-15,-11,-2,52,13,39,-1,15,3,0,14,-10,-7,0,3,-7,-5,3,4.5,-6,-8,-9,-14,-13,-3,-12,-7,4,-8,-12,3,-13,2,-9,-8,-4,-13,-9,1,-15,-21,-22,-22,-17,-7,0,-14,-11,-12,-15,-3,-13,-13,-19,-25,-14,-20,-17,-3,9,10,34.5,17,-7,-9,-7,-11,-17,-10,-1,-15,-14,-9,-7.5,-3,0.5,12,-3,-12,-10,8,-17,-14,-15,-18,-18,-15,-9,-6,-16,-16,-17,-11,-5,-6,-8,-13,-18,-20,-21,-17,-9,-12,-12,-15,-17,-15,-14,-13,-11,2,-4,-8,-5,-12,-15,-18,-18,-14,-16,-14,-12,-10,-12,-12,-15,-16,-18,-16,-14,-17,-19,-14,-7,-7,-23,-16,-14,4,-6,-9,-19,-15,-10,-7,5,-11,-14,-22,-19,-19,-20,-3,-3,-18,-14,-24,-21,-16,-7,-6,-18,-19,-18,-20,-18,-23,-23,-13.5,-8,-12,-19,-25,-24]]},"evals":["attrs.interactionModel"],"jsHooks":[]}</script><p><br></p>
<p>The syntax here is a little different than what we have covered so far. The <code>dygraph</code> function is expecting for the dates to be given as the <code>rownames</code> of the object. We convert our data to a data frame (since tibbles don’t allow for easy row name manipulation), and then remove the <code>date</code> variable from the <code>flights_summarized</code> data frame since it is accounted for in the <code>rownames</code>. Lastly, we run the <code>dygraph</code> function on the new data frame that only contains the median arrival delay as a column and then provide the ability to have a selector to zoom in on the interactive plot via <code>dyRangeSelector</code>. (Note that this plot will only be interactive in the HTML version of this book.)</p>

</div>
</div>
<div id="the-theory-behind-the-bootstrap-method" class="section level2" number="14.3">
<h2>
<span class="header-section-number">C.3</span> The theory behind the bootstrap method<a class="anchor" aria-label="anchor" href="#the-theory-behind-the-bootstrap-method"><i class="fas fa-link"></i></a>
</h2>
<p>We explain the bootstrap method when use to construct an interval estimate for
<span class="math inline">\(\mu\)</span>, but the explanation can be easily generalized to confidence intervals for
other parameters. We let the letter <span class="math inline">\(F\)</span> represent the
population distribution. We can think of this distribution as the set of
possible values that can be observed and the probability or chance that those
values may appear in a sample taken from this population. Recall that a
histogram can be thought of as the visual representation of this distribution.
Moreover, imagine that <span class="math inline">\(\mu\)</span> is the parameter we wish to estimate. Observe that,
in general, we do not need to restrict our treatment to <span class="math inline">\(\mu\)</span> but any other
parameter or characteristic of this population.</p>
<p>We then take a sample of size
<span class="math inline">\(n\)</span> to estimate <span class="math inline">\(\mu\)</span>, and we construct an empirical distribution based on this
sample, by assigning a probability <span class="math inline">\(1/n\)</span> to each value in the sample.
We call this empirical distribution <span class="math inline">\(F_n\)</span>. We treat this empirical distribution
as if it would be an estimate of the population distribution.
For example, the population mean of this empirical distribution is precisely
the average of all the values in the sample, or the sample mean, but we call it
<span class="math inline">\(\mu_n\)</span> to emphasize that we are treating this as a population.</p>
<p>The bootstrap consists in using the empirical distribution only and nothing else
for the construction of estimates, confidence intervals, etc. We are not
introducing additional assumptions to the population distribution, or to the
structure of the sample, we are simply taking advantage of the sample we have
collected.</p>
<p>So now, <span class="math inline">\(F_n\)</span> is considered the population distribution, and as described in
Section <a href="confidence-intervals.html#simulation-based-CI">8.2</a> we obtain a
bootstrap sample by sampling, with replacement, a sample of size <span class="math inline">\(n\)</span> from this
empirical distribution. This bootstrap sample is now considered an empirical
distribution, and we call it <span class="math inline">\(F^*_n\)</span>.</p>
<p>Let’s recap. We want to study the population distribution <span class="math inline">\(F\)</span>, and we take a
sample of size <span class="math inline">\(n\)</span> from this distribution, call it <span class="math inline">\(F_n\)</span>, and use it as an
empirical distribution that estimates <span class="math inline">\(F\)</span>. We then let <span class="math inline">\(F_n\)</span> play
the role of the population distribution, take a bootstrap sample from <span class="math inline">\(F_n\)</span>
(also of size <span class="math inline">\(n\)</span>), call it <span class="math inline">\(F^*_n\)</span>, and use it as an empirical distribution that
estimates <span class="math inline">\(F_n\)</span>.</p>
<p>So, at the first stage we do not know anything about <span class="math inline">\(F\)</span> other than the sample
we have taken. At the second stage, we know everything about <span class="math inline">\(F_n\)</span>, and we can
study how <span class="math inline">\(F^*_n\)</span> behaves with respect to <span class="math inline">\(F_n\)</span>. The idea of bootstrap is to
translate whatever we learn from the relationship between <span class="math inline">\(F^*_n\)</span> and <span class="math inline">\(F_n\)</span> into
the possible relationship between <span class="math inline">\(F_n\)</span> and <span class="math inline">\(F\)</span>.</p>
<p>Furthermore, we could obtain every possible bootstrap sample <span class="math inline">\(F^*_n\)</span> from <span class="math inline">\(F_n\)</span>,
but this is a really large number, as discussed in Section
<a href="confidence-intervals.html#simulation-based-CI">8.2</a>. Instead, only a few thousand bootstrap samples are
used.</p>
<p>Let’s translate these ideas to parameters and estimators. We are interested in
estimating <span class="math inline">\(\mu\)</span> from <span class="math inline">\(F\)</span>. We have constructed <span class="math inline">\(\mu_n\)</span> from <span class="math inline">\(F_n\)</span>, that is, we
know what the mean is from our empirical distribution, it is just the sample
mean from the sample taken. Now, we can obtain the distribution of <span class="math inline">\(\mu^*_n\)</span>,
that is, the distribution of the sample means from all the bootstrap samples,
study how much variation they have to approximate the standard error, and use
this information to construct confidence intervals, perform hypothesis tests,
etc.</p>
<p>Hall (1992)<span class="citation">(<a href="references.html#ref-Hall1992">Hall 1992</a>)</span> has provided the theoretical justification to use
bootstrap confidence intervals using Edgeworth expansions. The description of
Edgeworth expansions are beyond the scope of this book, but in simple terms,
you can think of them as approximations to the population distribution and of
parameter estimates, that in certain context provide better approximations than
the central limit theorem.</p>
<p>In the next section we discuss bootstrap methods in the context of confidence
intervals and make comparisons between the theory-based approach and the
simulation-based approach using the percentile method and more advanced
bootstrap methods.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="appendixB.html"><span class="header-section-number">B</span> Inference Examples</a></div>
<div class="next"><a href="references.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#appendixC"><span class="header-section-number">C</span> Tips and Tricks</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#needed-packages-2">Needed packages</a></li></ul>
</li>
<li>
<a class="nav-link" href="#data-wrangling"><span class="header-section-number">C.1</span> Data wrangling</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#appendix-missing-values"><span class="header-section-number">C.1.1</span> Dealing with missing values</a></li>
<li><a class="nav-link" href="#appendix-reordering-bars"><span class="header-section-number">C.1.2</span> Reordering bars in a barplot</a></li>
<li><a class="nav-link" href="#appendix-money-on-axis"><span class="header-section-number">C.1.3</span> Showing money on an axis</a></li>
<li><a class="nav-link" href="#appendix-changing-values"><span class="header-section-number">C.1.4</span> Changing values inside cells</a></li>
<li><a class="nav-link" href="#appendix-convert-numerical-categorical"><span class="header-section-number">C.1.5</span> Converting a numerical variable to a categorical one</a></li>
<li><a class="nav-link" href="#appendix-prop"><span class="header-section-number">C.1.6</span> Computing proportions</a></li>
<li><a class="nav-link" href="#appendix-commas"><span class="header-section-number">C.1.7</span> Dealing with %, commas, and $</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#interactive-graphics"><span class="header-section-number">C.2</span> Interactive graphics</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#interactive-linegraphs"><span class="header-section-number">C.2.1</span> Interactive linegraphs</a></li></ul>
</li>
<li><a class="nav-link" href="#the-theory-behind-the-bootstrap-method"><span class="header-section-number">C.3</span> The theory behind the bootstrap method</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Statistical Inference via Data Science</strong>: A ModernDive into R and the Tidyverse <br> (Second Edition)" was written by Chester Ismay, Albert Y. Kim, and Arturo Valdivia <br> Foreword by Kelly S. McConville. It was last built on September 26, 2024.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
