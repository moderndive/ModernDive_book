<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A Statistical Background | Statistical Inference via Data Science</title>
<meta name="author" content="Chester Ismay, Albert Y. Kim, and Arturo Valdivia   Foreword by Kelly S. McConville">
<meta name="description" content="A.1 Basic statistical terms Note that all the following statistical terms apply only to numerical variables, except the distribution which can exist for both numerical and categorical variables. ...">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="A Statistical Background | Statistical Inference via Data Science">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/logos/v2/v2_cover_2024-09-29.png">
<meta property="og:description" content="A.1 Basic statistical terms Note that all the following statistical terms apply only to numerical variables, except the distribution which can exist for both numerical and categorical variables. ...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A Statistical Background | Statistical Inference via Data Science">
<meta name="twitter:site" content="@ModernDive">
<meta name="twitter:description" content="A.1 Basic statistical terms Note that all the following statistical terms apply only to numerical variables, except the distribution which can exist for both numerical and categorical variables. ...">
<meta name="twitter:image" content="/images/logos/v2/v2_cover_2024-09-29.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YVFBK9P73R"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-YVFBK9P73R');
    </script><!-- Open Graph Meta Tags --><meta property="og:title" content="ModernDive V2">
<meta property="og:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools.">
<meta property="og:image" content="https://moderndive.com/v2/images/logos/v2/v2_cover_2024-09-29.png">
<meta property="og:url" content="https://moderndive.com/v2/appendixA.html">
<meta name="twitter:card" content="summary_large_image">
<script>
      if (window.location.pathname === '/v2') {
        window.location.replace(window.location.pathname + '/');
      }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="A ModernDive into R and the Tidyverse &lt;br&gt; (Second Edition)">Statistical Inference via Data Science</a>:
        <small class="text-muted">A ModernDive into R and the Tidyverse <br> (Second Edition)</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to ModernDive (v2)</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="about-the-authors.html">About the authors</a></li>
<li><a class="" href="getting-started.html"><span class="header-section-number">1</span> Getting Started with Data in R</a></li>
<li class="book-part">Data Science with tidyverse</li>
<li><a class="" href="viz.html"><span class="header-section-number">2</span> Data Visualization</a></li>
<li><a class="" href="wrangling.html"><span class="header-section-number">3</span> Data Wrangling</a></li>
<li><a class="" href="tidy.html"><span class="header-section-number">4</span> Data Importing and Tidy Data</a></li>
<li class="book-part">Statistical Modeling with moderndive</li>
<li><a class="" href="regression.html"><span class="header-section-number">5</span> Simple Linear Regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">6</span> Multiple Regression</a></li>
<li class="book-part">Statistical Inference with infer</li>
<li><a class="" href="sampling.html"><span class="header-section-number">7</span> Sampling</a></li>
<li><a class="" href="confidence-intervals.html"><span class="header-section-number">8</span> Estimation, Confidence Intervals, and Bootstrapping</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">9</span> Hypothesis Testing</a></li>
<li><a class="" href="inference-for-regression.html"><span class="header-section-number">10</span> Inference for Regression</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="thinking-with-data.html"><span class="header-section-number">11</span> Tell Your Story with Data</a></li>
<li class="book-part">Appendix</li>
<li><a class="active" href="appendixA.html"><span class="header-section-number">A</span> Statistical Background</a></li>
<li><a class="" href="appendixB.html"><span class="header-section-number">B</span> Inference Examples</a></li>
<li><a class="" href="appendixC.html"><span class="header-section-number">C</span> Tips and Tricks</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/moderndive/ModernDive_book/">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><img src="https://moderndive.com/wide_format.png" alt="ModernDive" style="max-width: 100%; width: 100%; height: auto; display: block; margin: 0 auto; padding-top: 10px;"><div id="appendixA" class="section level1" number="12">
<h1>
<span class="header-section-number">A</span> Statistical Background<a class="anchor" aria-label="anchor" href="#appendixA"><i class="fas fa-link"></i></a>
</h1>
<div id="appendix-stat-terms" class="section level2" number="12.1">
<h2>
<span class="header-section-number">A.1</span> Basic statistical terms<a class="anchor" aria-label="anchor" href="#appendix-stat-terms"><i class="fas fa-link"></i></a>
</h2>
<p>Note that all the following statistical terms apply only to <em>numerical</em> variables, except the <em>distribution</em> which can exist for both numerical and categorical variables.</p>
<div id="mean" class="section level3" number="12.1.1">
<h3>
<span class="header-section-number">A.1.1</span> Mean<a class="anchor" aria-label="anchor" href="#mean"><i class="fas fa-link"></i></a>
</h3>
<p>The <em>mean</em> is the most commonly reported measure of center. It is commonly called the <em>average</em> though this term can be a little ambiguous. The mean is the sum of all of the data elements divided by how many elements there are. If we have <span class="math inline">\(n\)</span> data points, the mean is given by:</p>
<p><span class="math display">\[Mean = \frac{x_1 + x_2 + \cdots + x_n}{n}\]</span></p>
</div>
<div id="median" class="section level3" number="12.1.2">
<h3>
<span class="header-section-number">A.1.2</span> Median<a class="anchor" aria-label="anchor" href="#median"><i class="fas fa-link"></i></a>
</h3>
<p>The median is calculated by first sorting a variable’s data from smallest to largest. After sorting the data, the middle element in the list is the <em>median</em>. If the middle falls between two values, then the median is the mean of those two middle values.</p>
</div>
<div id="appendix-sd-variance" class="section level3" number="12.1.3">
<h3>
<span class="header-section-number">A.1.3</span> Standard deviation and variance<a class="anchor" aria-label="anchor" href="#appendix-sd-variance"><i class="fas fa-link"></i></a>
</h3>
<p>We will next discuss the <em>standard deviation</em> (<span class="math inline">\(sd\)</span>) of a variable. The formula can be a little intimidating at first but it is important to remember that it is essentially a measure of how far we expect a given data value will be from its mean:</p>
<p><span class="math display">\[sd = \sqrt{\frac{(x_1 - Mean)^2 + (x_2 - Mean)^2 + \cdots + (x_n - Mean)^2}{n - 1}}\]</span></p>
<p>The <em>variance</em> of a variable is merely the standard deviation squared.</p>
<p><span class="math display">\[variance = sd^2 = \frac{(x_1 - Mean)^2 + (x_2 - Mean)^2 + \cdots + (x_n - Mean)^2}{n - 1}\]</span></p>
</div>
<div id="five-number-summary" class="section level3" number="12.1.4">
<h3>
<span class="header-section-number">A.1.4</span> Five-number summary<a class="anchor" aria-label="anchor" href="#five-number-summary"><i class="fas fa-link"></i></a>
</h3>
<p>The <em>five-number summary</em> consists of five summary statistics: the minimum, the first quantile AKA 25th percentile, the second quantile AKA median or 50th percentile, the third quantile AKA 75th, and the maximum. The five-number summary of a variable is used when constructing boxplots, as seen in Section <a href="viz.html#boxplots">2.7</a>.</p>
<p>The quantiles are calculated as</p>
<ul>
<li>first quantile (<span class="math inline">\(Q_1\)</span>): the median of the first half of the sorted data</li>
<li>third quantile (<span class="math inline">\(Q_3\)</span>): the median of the second half of the sorted data</li>
</ul>
<p>The <em>interquartile range (IQR)</em> is defined as <span class="math inline">\(Q_3 - Q_1\)</span> and is a measure of how spread out the middle 50% of values are. The IQR corresponds to the length of the box in a boxplot.</p>
<p>The median and the IQR are not influenced by the presence of outliers in the ways that the mean and standard deviation are. They are, thus, recommended for skewed datasets. We say in this case that the median and IQR are more <em>robust to outliers</em>.</p>
</div>
<div id="distribution" class="section level3" number="12.1.5">
<h3>
<span class="header-section-number">A.1.5</span> Distribution<a class="anchor" aria-label="anchor" href="#distribution"><i class="fas fa-link"></i></a>
</h3>
<p>The <em>distribution</em> of a variable shows how frequently different values of a variable occur. Looking at the visualization of a distribution can show where the values are centered, show how the values vary, and give some information about where a typical value might fall. It can also alert you to the presence of outliers.</p>
<p>Recall from Chapter <a href="viz.html#viz">2</a> that we can visualize the distribution of a numerical variable using binning in a histogram and that we can visualize the distribution of a categorical variable using a barplot.</p>
</div>
<div id="outliers" class="section level3" number="12.1.6">
<h3>
<span class="header-section-number">A.1.6</span> Outliers<a class="anchor" aria-label="anchor" href="#outliers"><i class="fas fa-link"></i></a>
</h3>
<p><em>Outliers</em> correspond to values in the dataset that fall far outside the range of “ordinary” values. In the context of a boxplot, by default they correspond to values below <span class="math inline">\(Q_1 - (1.5 \cdot IQR)\)</span> or above <span class="math inline">\(Q_3 + (1.5 \cdot IQR)\)</span>.</p>
</div>
</div>
<div id="appendix-normal-curve" class="section level2" number="12.2">
<h2>
<span class="header-section-number">A.2</span> Normal distribution<a class="anchor" aria-label="anchor" href="#appendix-normal-curve"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s next discuss one particular kind of distribution: <em>normal distributions</em>. Such bell-shaped distributions are defined by two values: (1) the <em>mean</em> <span class="math inline">\(\mu\)</span> (“mu”) which locates the center of the distribution and (2) the <em>standard deviation</em> <span class="math inline">\(\sigma\)</span> (“sigma”) which determines the variation of the distribution. In Figure <a href="appendixA.html#fig:normal-curves2">A.1</a>, we plot three normal distributions where:</p>
<ol style="list-style-type: decimal">
<li>The solid normal curve has mean <span class="math inline">\(\mu = 5\)</span> &amp; standard deviation <span class="math inline">\(\sigma = 2\)</span>.</li>
<li>The dotted normal curve has mean <span class="math inline">\(\mu = 5\)</span> &amp; standard deviation <span class="math inline">\(\sigma = 5\)</span>.</li>
<li>The dashed normal curve has mean <span class="math inline">\(\mu = 15\)</span> &amp; standard deviation <span class="math inline">\(\sigma = 2\)</span>.</li>
</ol>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:normal-curves2"></span>
<img src="ModernDive_files/figure-html/normal-curves2-1.png" alt="Three normal distributions." width="90%"><p class="caption">
FIGURE A.1: Three normal distributions.
</p>
</div>
<p>Notice how the solid and dotted line normal curves have the same center due to their common mean <span class="math inline">\(\mu\)</span> = 5. However, the dotted line normal curve is wider due to its larger standard deviation of <span class="math inline">\(\sigma\)</span> = 5. On the other hand, the solid and dashed line normal curves have the same variation due to their common standard deviation <span class="math inline">\(\sigma\)</span> = 2. However, they are centered at different locations.</p>
<p>When the mean <span class="math inline">\(\mu\)</span> = 0 and the standard deviation <span class="math inline">\(\sigma\)</span> = 1, the normal distribution has a special name. It’s called the <em>standard normal distribution</em> or the <em><span class="math inline">\(z\)</span>-curve</em>.</p>
<p>Furthermore, if a variable follows a normal curve, there are <em>three rules of thumb</em> we can use:</p>
<ol style="list-style-type: decimal">
<li>68% of values will lie within <span class="math inline">\(\pm\)</span> 1 standard deviation of the mean.</li>
<li>95% of values will lie within <span class="math inline">\(\pm\)</span> 1.96 <span class="math inline">\(\approx\)</span> 2 standard deviations of the mean.</li>
<li>99.7% of values will lie within <span class="math inline">\(\pm\)</span> 3 standard deviations of the mean.</li>
</ol>
<p>Let’s illustrate this on a standard normal curve in Figure <a href="appendixA.html#fig:normal-rule-of-thumb">A.2</a>. The dashed lines are at -3, -1.96, -1, 0, 1, 1.96, and 3. These 7 lines cut up the x-axis into 8 segments. The areas under the normal curve for each of the 8 segments are marked and add up to 100%. For example:</p>
<ol style="list-style-type: decimal">
<li>The middle two segments represent the interval -1 to 1. The shaded area above this interval represents 34% + 34% = 68% of the area under the curve. In other words, 68% of values.</li>
<li>The middle four segments represent the interval -1.96 to 1.96. The shaded area above this interval represents 13.5% + 34% + 34% + 13.5% = 95% of the area under the curve. In other words, 95% of values.</li>
<li>The middle six segments represent the interval -3 to 3. The shaded area above this interval represents 2.35% + 13.5% + 34% + 34% + 13.5% + 2.35% = 99.7% of the area under the curve. In other words, 99.7% of values.</li>
</ol>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:normal-rule-of-thumb"></span>
<img src="ModernDive_files/figure-html/normal-rule-of-thumb-1.png" alt="Rules of thumb about areas under normal curves." width="80%"><p class="caption">
FIGURE A.2: Rules of thumb about areas under normal curves.
</p>
</div>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<!--
v2 TODO: Consider LC using this later on: <https://gallery.shinyapps.io/dist_calc/>
-->
<p>Say you have a normal distribution with mean <span class="math inline">\(\mu = 6\)</span> and standard deviation <span class="math inline">\(\sigma = 3\)</span>.</p>
<p><strong>(LCA.1)</strong> What proportion of the area under the normal curve is less than 3? Greater than 12? Between 0 and 12?</p>
<p><strong>(LCA.2)</strong> What is the 2.5th percentile of the area under the normal curve? The 97.5th percentile? The 100th percentile?</p>
<div class="learncheck">

</div>
<div id="additional-normal-calculations" class="section level3" number="12.2.1">
<h3>
<span class="header-section-number">A.2.1</span> Additional normal calculations<a class="anchor" aria-label="anchor" href="#additional-normal-calculations"><i class="fas fa-link"></i></a>
</h3>
<p>For a normal density curve, the probabilities or areas for any given interval can be obtained using the R function <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>. Think of the <code>p</code> in the name as __p__robability or __p__ercentage as this function finds the area under the curve to the left of any given value which is the probability of observing any number less than or equal to that value. It is possible to indicate the appropriate expected value and standard deviation as arguments in the function, but the default uses the standard normal values, <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma = 1\)</span>. For example, the probability of observing a value that is less than or equal to 1 in the standard normal curve is given by:</p>
<div class="sourceCode" id="cb571"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.841</code></pre>
<p>or 84%. This is the probability of observing a value that is less than or equal to one standard deviation above the mean.</p>
<p>Similarly, the probability of observing a standard value between -1 and 1 is given by subtracting the area to the left of -1 from the area to the left of 1. In R, we obtain this probability as follows:</p>
<div class="sourceCode" id="cb573"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.683</code></pre>
<p>The probability of getting a standard value between -1 and 1, or equivalently, the probability of observing a value within one standard deviation from the mean is about 68%. Similarly, the probability of getting a value within 2 standard deviations from the mean is given by</p>
<div class="sourceCode" id="cb575"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.954</code></pre>
<p>or about 95%.</p>
<p>Moreover, we do not need to restrict our study to areas within one or two standard deviations from the mean. We can find the number of standard deviations needed for any desired percentage around the mean using the R function <code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code>. The <code>q</code> in the name stands for <span class="math inline">\(quantile\)</span> and this function can be thought of as the inverse or complement of <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>. It finds the value of the random variable for a given area under the curve to the left of this value. When using the standard normal, the quantile also represents the number of standard deviations. For example, we learned that the area under the standard normal curve to the left of a standard value of 1 was approximately 84%. If instead, we want to find the standard value that corresponds to exactly an area of 84% under the curve to the left of this value, we can use the following syntax:</p>
<div class="sourceCode" id="cb577"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.84</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.994</code></pre>
<p>In other words, there is exactly an 84% chance that the observed standard value is less than or equal to 0.994. Similarly, to have exactly a 95% chance of obtaining a value within <code>q</code> number of standard deviations from the mean, we need to select the appropriate value for <code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code>.</p>
<div class="sourceCode" id="cb579"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"function"</span>, fun <span class="op">=</span> <span class="va">dnorm</span>, fill <span class="op">=</span> <span class="st">"grey100"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"function"</span>, fun <span class="op">=</span> <span class="va">dnorm</span>, fill <span class="op">=</span> <span class="st">"grey80"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"function"</span>, fun <span class="op">=</span> <span class="va">dnorm</span>, fill <span class="op">=</span> <span class="st">"grey100"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"z"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span>geom<span class="op">=</span><span class="st">"text"</span>, x<span class="op">=</span><span class="fl">2</span>, y<span class="op">=</span><span class="op">-</span><span class="fl">0.01</span>, label<span class="op">=</span><span class="st">"q"</span>,</span>
<span>           color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="ModernDive_files/figure-html/normal-curve-shaded-3-1.png" width="\textwidth" style="display: block; margin: auto;"></div>
<p>We want to find the standard value <code>q</code> such that the area in the middle is exactly 0.95 (or 95%). Before using <code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code> we need to provide the total area under the curve to the left of <code>q</code>. Since the total area under the normal density curve is 1, the curve is symmetric, and the area in the middle is 0.95, the total area on the tails is 1 - 0.95 = 0.05 (or 5%), and the area on each tail is 0.05/2 = 0.025 (or 2.5%). The total area under the curve to the left of <code>q</code> will be the area in the middle and the area on the left tail or 0.95 + 0.025 = 0.975. We can now obtain the standard value <code>q</code> by using <code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code>:</p>
<div class="sourceCode" id="cb580"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span></span>
<span><span class="va">q</span></span></code></pre></div>
<pre><code>[1] 1.96</code></pre>
<p>The probability of observing a value within 1.96 standard deviations from the mean is exactly 95%.</p>
<p>We can follow this method to obtain the number of standard deviations needed for any area, or probability, around the mean. For example, if we want an area of 98% around the mean, the area on the tails is 1 - 0.98 = 0.02, or 0.02/2 = 0.01 on each tail, the area under the curve to the left of the desired <code>q</code> value would be 0.98 + 0.01 = 0.99 so</p>
<div class="sourceCode" id="cb582"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.99</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 2.33</code></pre>
<p>The area within 2.33 standard deviations from the mean is 98%, or there is a 98% chance of choosing a value within 2.33 standard deviations from the mean. This information will be very useful to us.</p>
</div>
</div>
<div id="the-t-distribution-calculations" class="section level2" number="12.3">
<h2>
<span class="header-section-number">A.3</span> The t distribution calculations<a class="anchor" aria-label="anchor" href="#the-t-distribution-calculations"><i class="fas fa-link"></i></a>
</h2>
<p>The syntax in R for the <span class="math inline">\(t\)</span> distribution is analogous to the standard normal distribution. We use the function <code><a href="https://rdrr.io/r/stats/TDist.html">pt()</a></code> instead of <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code> and <code><a href="https://rdrr.io/r/stats/TDist.html">qt()</a></code> instead of <code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code>.
In addition, the <span class="math inline">\(t\)</span> distribution requires one additional parameter, the degrees of freedom. For the sample mean problems, the degrees of freedom needed are exactly <span class="math inline">\(n-1\)</span>, the size of the samples minus one.</p>
<p>We construct again a 95% confidence interval for the population mean, but this time using the sample standard deviation to estimate the standard error and the <span class="math inline">\(t\)</span> distribution to determine how wide the confidence interval should be.</p>
<p>We start by obtaining the sample statistics:</p>
<div class="sourceCode" id="cb584"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">almonds_sample_100</span> <span class="op">|&gt;</span> </span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span>,</span>
<span>sd_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span>,</span>
<span>sample_size <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 3
  mean_weight sd_weight sample_size
        &lt;dbl&gt;     &lt;dbl&gt;       &lt;int&gt;
1       3.682  0.362199         100</code></pre>
<p>To obtain the number of standard deviations on the <span class="math inline">\(t\)</span> distribution to account for 95% of the values, we proceed as we did in the normal case: the area in the middle is 0.95, so the area on the tails is 1-0.95 = 0.05. Since the <span class="math inline">\(t\)</span> distribution is also symmetric, the area on each tail is 0.05/2 - 0.025. The number of standard deviation around the center is given by the value <span class="math inline">\(q\)</span> such as the area under the <span class="math inline">\(t\)</span> curve to the left of <span class="math inline">\(q\)</span> is exactly <span class="math inline">\(0.95 + 0.025 = 0.975\)</span>. Using R we get:</p>
<div class="sourceCode" id="cb586"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, df <span class="op">=</span> <span class="fl">100</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 1.98</code></pre>
<p>So, in order to account for 95% of the observations around the mean, we need to take into account all the values within 1.98 standard deviation from the mean. Compare this number with the 1.96 obtained for the standard normal; the difference is due to the fact that the <span class="math inline">\(t\)</span> curve has thicker tails than the standard normal.
We can now construct the 95% confidence interval</p>
<div class="sourceCode" id="cb588"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fl">3.682</span> </span>
<span><span class="va">se_xbar</span> <span class="op">&lt;-</span> <span class="fl">0.362</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">lower_bound</span> <span class="op">&lt;-</span> <span class="va">xbar</span> <span class="op">-</span> <span class="fl">1.98</span> <span class="op">*</span>  <span class="va">se_xbar</span></span>
<span><span class="va">upper_bound</span> <span class="op">&lt;-</span> <span class="va">xbar</span> <span class="op">+</span> <span class="fl">1.98</span> <span class="op">*</span>  <span class="va">se_xbar</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lower_bound</span>, <span class="va">upper_bound</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 3.61 3.75</code></pre>
<p>We are 95% confident that the population mean weight of almonds is a number between 3.61 and 3.75 grams.</p>
</div>
<div id="appendix-log10-transformations" class="section level2" number="12.4">
<h2>
<span class="header-section-number">A.4</span> log10 transformations<a class="anchor" aria-label="anchor" href="#appendix-log10-transformations"><i class="fas fa-link"></i></a>
</h2>
<p>At its simplest, log10 transformations return base 10 <em>logarithms</em>. For example, since <span class="math inline">\(1000 = 10^3\)</span>, running <code>log10(1000)</code> returns <code>3</code> in R. To undo a log10 transformation, we raise 10 to this value. For example, to undo the previous log10 transformation and return the original value of 1000, we raise 10 to the power of 3 by running <code>10^(3) = 1000</code> in R. </p>
<p>Log transformations allow us to focus on changes in <em>orders of magnitude</em>. In other words, they allow us to focus on <em>multiplicative changes</em> instead of <em>additive ones</em>. Let’s illustrate this idea in Table <a href="appendixA.html#tab:logten">A.1</a> with examples of prices of consumer goods in 2019 US dollars.</p>
<!--
v2 TODO: Add text like:
We can also frame such changes as being relative percentage increases/decreases
instead of absolute increases/decreases.
-->
<div class="inline-table"><table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:logten">TABLE A.1: </span><span id="tab:logten">TABLE A.2: </span>log10 transformed prices, orders of magnitude, and examples
</caption>
<thead><tr>
<th style="text-align:left;">
Price
</th>
<th style="text-align:right;">
log10(Price)
</th>
<th style="text-align:left;">
Order of magnitude
</th>
<th style="text-align:left;">
Examples
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
$1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
Singles
</td>
<td style="text-align:left;">
Cups of coffee
</td>
</tr>
<tr>
<td style="text-align:left;">
$10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Tens
</td>
<td style="text-align:left;">
Books
</td>
</tr>
<tr>
<td style="text-align:left;">
$100
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Hundreds
</td>
<td style="text-align:left;">
Mobile phones
</td>
</tr>
<tr>
<td style="text-align:left;">
$1,000
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Thousands
</td>
<td style="text-align:left;">
High definition TVs
</td>
</tr>
<tr>
<td style="text-align:left;">
$10,000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Tens of thousands
</td>
<td style="text-align:left;">
Cars
</td>
</tr>
<tr>
<td style="text-align:left;">
$100,000
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
Hundreds of thousands
</td>
<td style="text-align:left;">
Luxury cars and houses
</td>
</tr>
<tr>
<td style="text-align:left;">
$1,000,000
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
Millions
</td>
<td style="text-align:left;">
Luxury houses
</td>
</tr>
</tbody>
</table></div>
<p>Let’s make some remarks about log10 transformations based on Table <a href="appendixA.html#tab:logten">A.1</a>:</p>
<ol style="list-style-type: decimal">
<li>When purchasing a cup of coffee, we tend to think of prices ranging in single dollars, such as $2 or $3. However, when purchasing a mobile phone, we don’t tend to think of their prices in units of single dollars such as $313 or $727. Instead, we tend to think of their prices in units of hundreds of dollars like $300 or $700. Thus, cups of coffee and mobile phones are of different <em>orders of magnitude</em> in price.</li>
<li>Let’s say we want to know the log10 transformed value of $76. This would be hard to compute exactly without a calculator. However, since $76 is between $10 and $100 and since log10(10) = 1 and log10(100) = 2, we know log10(76) will be between 1 and 2. In fact, log10(76) is 1.880814.</li>
<li>log10 transformations are <em>monotonic</em>, meaning they preserve orders. So if Price A is lower than Price B, then log10(Price A) will also be lower than log10(Price B).</li>
<li>Most importantly, increments of one in log10-scale correspond to <em>relative multiplicative changes</em> in the original scale and not <em>absolute additive changes</em>. For example, increasing a log10(Price) from 3 to 4 corresponds to a multiplicative increase by a factor of 10: $100 to $1000.</li>
</ol>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="thinking-with-data.html"><span class="header-section-number">11</span> Tell Your Story with Data</a></div>
<div class="next"><a href="appendixB.html"><span class="header-section-number">B</span> Inference Examples</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#appendixA"><span class="header-section-number">A</span> Statistical Background</a></li>
<li>
<a class="nav-link" href="#appendix-stat-terms"><span class="header-section-number">A.1</span> Basic statistical terms</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#mean"><span class="header-section-number">A.1.1</span> Mean</a></li>
<li><a class="nav-link" href="#median"><span class="header-section-number">A.1.2</span> Median</a></li>
<li><a class="nav-link" href="#appendix-sd-variance"><span class="header-section-number">A.1.3</span> Standard deviation and variance</a></li>
<li><a class="nav-link" href="#five-number-summary"><span class="header-section-number">A.1.4</span> Five-number summary</a></li>
<li><a class="nav-link" href="#distribution"><span class="header-section-number">A.1.5</span> Distribution</a></li>
<li><a class="nav-link" href="#outliers"><span class="header-section-number">A.1.6</span> Outliers</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#appendix-normal-curve"><span class="header-section-number">A.2</span> Normal distribution</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#additional-normal-calculations"><span class="header-section-number">A.2.1</span> Additional normal calculations</a></li></ul>
</li>
<li><a class="nav-link" href="#the-t-distribution-calculations"><span class="header-section-number">A.3</span> The t distribution calculations</a></li>
<li><a class="nav-link" href="#appendix-log10-transformations"><span class="header-section-number">A.4</span> log10 transformations</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/moderndive/ModernDive_book//blob/v2/91-appendixA.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/moderndive/ModernDive_book//edit/v2/91-appendixA.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Statistical Inference via Data Science</strong>: A ModernDive into R and the Tidyverse <br> (Second Edition)" was written by Chester Ismay, Albert Y. Kim, and Arturo Valdivia <br> Foreword by Kelly S. McConville. It was last built on October 01, 2024.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
