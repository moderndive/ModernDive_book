<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Bootstrapping and Confidence Intervals | Statistical Inference via Data Science</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Bootstrapping and Confidence Intervals | Statistical Inference via Data Science" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://moderndive.com/" />
  <meta property="og:image" content="https://moderndive.com//images/logos/book_cover.png" />
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="github-repo" content="moderndive/ModernDive_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Bootstrapping and Confidence Intervals | Statistical Inference via Data Science" />
  <meta name="twitter:site" content="@ModernDive" />
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="twitter:image" content="https://moderndive.com//images/logos/book_cover.png" />

<meta name="author" content="Chester Ismay and Albert Y. Kim   Foreword by Kelly S. McConville" />


<meta name="date" content="2021-08-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/logos/favicons/apple-touch-icon.png" />
  <link rel="shortcut icon" href="images/logos/favicons/favicon.ico" type="image/x-icon" />
<link rel="prev" href="7-sampling.html"/>
<link rel="next" href="9-hypothesis-testing.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to ModernDive</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-students"><i class="fa fa-check"></i>Introduction for students</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-we-hope-you-will-learn-from-this-book"><i class="fa fa-check"></i>What we hope you will learn from this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#datascience-pipeline"><i class="fa fa-check"></i>Data/science pipeline</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#reproducible-research"><i class="fa fa-check"></i>Reproducible research</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#final-note-for-students"><i class="fa fa-check"></i>Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-instructors"><i class="fa fa-check"></i>Introduction for instructors</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#why-did-we-write-this-book"><i class="fa fa-check"></i>Why did we write this book?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#who-is-this-book-for"><i class="fa fa-check"></i>Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#connect-and-contribute"><i class="fa fa-check"></i>Connect and contribute</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="1" data-path="1-getting-started.html"><a href="1-getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting Started with Data in R</a><ul>
<li class="chapter" data-level="1.1" data-path="1-getting-started.html"><a href="1-getting-started.html#r-rstudio"><i class="fa fa-check"></i><b>1.1</b> What are R and RStudio?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="1-getting-started.html"><a href="1-getting-started.html#installing"><i class="fa fa-check"></i><b>1.1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-getting-started.html"><a href="1-getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-getting-started.html"><a href="1-getting-started.html#code"><i class="fa fa-check"></i><b>1.2</b> How do I code in R?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="1-getting-started.html"><a href="1-getting-started.html#programming-concepts"><i class="fa fa-check"></i><b>1.2.1</b> Basic programming concepts and terminology</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-getting-started.html"><a href="1-getting-started.html#messages"><i class="fa fa-check"></i><b>1.2.2</b> Errors, warnings, and messages</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-getting-started.html"><a href="1-getting-started.html#tips-code"><i class="fa fa-check"></i><b>1.2.3</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-getting-started.html"><a href="1-getting-started.html#packages"><i class="fa fa-check"></i><b>1.3</b> What are R packages?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="1-getting-started.html"><a href="1-getting-started.html#package-installation"><i class="fa fa-check"></i><b>1.3.1</b> Package installation</a></li>
<li class="chapter" data-level="1.3.2" data-path="1-getting-started.html"><a href="1-getting-started.html#package-loading"><i class="fa fa-check"></i><b>1.3.2</b> Package loading</a></li>
<li class="chapter" data-level="1.3.3" data-path="1-getting-started.html"><a href="1-getting-started.html#package-use"><i class="fa fa-check"></i><b>1.3.3</b> Package use</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-getting-started.html"><a href="1-getting-started.html#nycflights13"><i class="fa fa-check"></i><b>1.4</b> Explore your first datasets</a><ul>
<li class="chapter" data-level="1.4.1" data-path="1-getting-started.html"><a href="1-getting-started.html#nycflights13-package"><i class="fa fa-check"></i><b>1.4.1</b> <code>nycflights13</code> package</a></li>
<li class="chapter" data-level="1.4.2" data-path="1-getting-started.html"><a href="1-getting-started.html#flights-data-frame"><i class="fa fa-check"></i><b>1.4.2</b> <code>flights</code> data frame</a></li>
<li class="chapter" data-level="1.4.3" data-path="1-getting-started.html"><a href="1-getting-started.html#exploredataframes"><i class="fa fa-check"></i><b>1.4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="1.4.4" data-path="1-getting-started.html"><a href="1-getting-started.html#identification-vs-measurement-variables"><i class="fa fa-check"></i><b>1.4.4</b> Identification and measurement variables</a></li>
<li class="chapter" data-level="1.4.5" data-path="1-getting-started.html"><a href="1-getting-started.html#help-files"><i class="fa fa-check"></i><b>1.4.5</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1-getting-started.html"><a href="1-getting-started.html#conclusion"><i class="fa fa-check"></i><b>1.5</b> Conclusion</a><ul>
<li class="chapter" data-level="1.5.1" data-path="1-getting-started.html"><a href="1-getting-started.html#additional-resources"><i class="fa fa-check"></i><b>1.5.1</b> Additional resources</a></li>
<li class="chapter" data-level="1.5.2" data-path="1-getting-started.html"><a href="1-getting-started.html#whats-to-come"><i class="fa fa-check"></i><b>1.5.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Science with tidyverse</b></span></li>
<li class="chapter" data-level="2" data-path="2-viz.html"><a href="2-viz.html"><i class="fa fa-check"></i><b>2</b> Data Visualization</a><ul>
<li class="chapter" data-level="" data-path="2-viz.html"><a href="2-viz.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="2.1" data-path="2-viz.html"><a href="2-viz.html#grammarofgraphics"><i class="fa fa-check"></i><b>2.1</b> The grammar of graphics</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-viz.html"><a href="2-viz.html#components-of-the-grammar"><i class="fa fa-check"></i><b>2.1.1</b> Components of the grammar</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-viz.html"><a href="2-viz.html#gapminder"><i class="fa fa-check"></i><b>2.1.2</b> Gapminder data</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-viz.html"><a href="2-viz.html#other-components"><i class="fa fa-check"></i><b>2.1.3</b> Other components</a></li>
<li class="chapter" data-level="2.1.4" data-path="2-viz.html"><a href="2-viz.html#ggplot2-package"><i class="fa fa-check"></i><b>2.1.4</b> ggplot2 package</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-viz.html"><a href="2-viz.html#FiveNG"><i class="fa fa-check"></i><b>2.2</b> Five named graphs - the 5NG</a></li>
<li class="chapter" data-level="2.3" data-path="2-viz.html"><a href="2-viz.html#scatterplots"><i class="fa fa-check"></i><b>2.3</b> 5NG#1: Scatterplots</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-viz.html"><a href="2-viz.html#geompoint"><i class="fa fa-check"></i><b>2.3.1</b> Scatterplots via <code>geom_point</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="2-viz.html"><a href="2-viz.html#overplotting"><i class="fa fa-check"></i><b>2.3.2</b> Overplotting</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-viz.html"><a href="2-viz.html#summary"><i class="fa fa-check"></i><b>2.3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-viz.html"><a href="2-viz.html#linegraphs"><i class="fa fa-check"></i><b>2.4</b> 5NG#2: Linegraphs</a><ul>
<li class="chapter" data-level="2.4.1" data-path="2-viz.html"><a href="2-viz.html#geomline"><i class="fa fa-check"></i><b>2.4.1</b> Linegraphs via <code>geom_line</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="2-viz.html"><a href="2-viz.html#summary-1"><i class="fa fa-check"></i><b>2.4.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-viz.html"><a href="2-viz.html#histograms"><i class="fa fa-check"></i><b>2.5</b> 5NG#3: Histograms</a><ul>
<li class="chapter" data-level="2.5.1" data-path="2-viz.html"><a href="2-viz.html#geomhistogram"><i class="fa fa-check"></i><b>2.5.1</b> Histograms via <code>geom_histogram</code></a></li>
<li class="chapter" data-level="2.5.2" data-path="2-viz.html"><a href="2-viz.html#adjustbins"><i class="fa fa-check"></i><b>2.5.2</b> Adjusting the bins</a></li>
<li class="chapter" data-level="2.5.3" data-path="2-viz.html"><a href="2-viz.html#summary-2"><i class="fa fa-check"></i><b>2.5.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-viz.html"><a href="2-viz.html#facets"><i class="fa fa-check"></i><b>2.6</b> Facets</a></li>
<li class="chapter" data-level="2.7" data-path="2-viz.html"><a href="2-viz.html#boxplots"><i class="fa fa-check"></i><b>2.7</b> 5NG#4: Boxplots</a><ul>
<li class="chapter" data-level="2.7.1" data-path="2-viz.html"><a href="2-viz.html#geomboxplot"><i class="fa fa-check"></i><b>2.7.1</b> Boxplots via <code>geom_boxplot</code></a></li>
<li class="chapter" data-level="2.7.2" data-path="2-viz.html"><a href="2-viz.html#summary-3"><i class="fa fa-check"></i><b>2.7.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="2-viz.html"><a href="2-viz.html#geombar"><i class="fa fa-check"></i><b>2.8</b> 5NG#5: Barplots</a><ul>
<li class="chapter" data-level="2.8.1" data-path="2-viz.html"><a href="2-viz.html#barplots-via-geom_bar-or-geom_col"><i class="fa fa-check"></i><b>2.8.1</b> Barplots via <code>geom_bar</code> or <code>geom_col</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="2-viz.html"><a href="2-viz.html#must-avoid-pie-charts"><i class="fa fa-check"></i><b>2.8.2</b> Must avoid pie charts!</a></li>
<li class="chapter" data-level="2.8.3" data-path="2-viz.html"><a href="2-viz.html#two-categ-barplot"><i class="fa fa-check"></i><b>2.8.3</b> Two categorical variables</a></li>
<li class="chapter" data-level="2.8.4" data-path="2-viz.html"><a href="2-viz.html#summary-4"><i class="fa fa-check"></i><b>2.8.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="2-viz.html"><a href="2-viz.html#data-vis-conclusion"><i class="fa fa-check"></i><b>2.9</b> Conclusion</a><ul>
<li class="chapter" data-level="2.9.1" data-path="2-viz.html"><a href="2-viz.html#summary-table"><i class="fa fa-check"></i><b>2.9.1</b> Summary table</a></li>
<li class="chapter" data-level="2.9.2" data-path="2-viz.html"><a href="2-viz.html#function-argument-specification"><i class="fa fa-check"></i><b>2.9.2</b> Function argument specification</a></li>
<li class="chapter" data-level="2.9.3" data-path="2-viz.html"><a href="2-viz.html#additional-resources-1"><i class="fa fa-check"></i><b>2.9.3</b> Additional resources</a></li>
<li class="chapter" data-level="2.9.4" data-path="2-viz.html"><a href="2-viz.html#whats-to-come-3"><i class="fa fa-check"></i><b>2.9.4</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-wrangling.html"><a href="3-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a><ul>
<li class="chapter" data-level="" data-path="3-wrangling.html"><a href="3-wrangling.html#wrangling-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="3.1" data-path="3-wrangling.html"><a href="3-wrangling.html#piping"><i class="fa fa-check"></i><b>3.1</b> The pipe operator: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.2" data-path="3-wrangling.html"><a href="3-wrangling.html#filter"><i class="fa fa-check"></i><b>3.2</b> <code>filter</code> rows</a></li>
<li class="chapter" data-level="3.3" data-path="3-wrangling.html"><a href="3-wrangling.html#summarize"><i class="fa fa-check"></i><b>3.3</b> <code>summarize</code> variables</a></li>
<li class="chapter" data-level="3.4" data-path="3-wrangling.html"><a href="3-wrangling.html#groupby"><i class="fa fa-check"></i><b>3.4</b> <code>group_by</code> rows</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-wrangling.html"><a href="3-wrangling.html#grouping-by-more-than-one-variable"><i class="fa fa-check"></i><b>3.4.1</b> Grouping by more than one variable</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-wrangling.html"><a href="3-wrangling.html#mutate"><i class="fa fa-check"></i><b>3.5</b> <code>mutate</code> existing variables</a></li>
<li class="chapter" data-level="3.6" data-path="3-wrangling.html"><a href="3-wrangling.html#arrange"><i class="fa fa-check"></i><b>3.6</b> <code>arrange</code> and sort rows</a></li>
<li class="chapter" data-level="3.7" data-path="3-wrangling.html"><a href="3-wrangling.html#joins"><i class="fa fa-check"></i><b>3.7</b> <code>join</code> data frames</a><ul>
<li class="chapter" data-level="3.7.1" data-path="3-wrangling.html"><a href="3-wrangling.html#matching-key-variable-names"><i class="fa fa-check"></i><b>3.7.1</b> Matching “key” variable names</a></li>
<li class="chapter" data-level="3.7.2" data-path="3-wrangling.html"><a href="3-wrangling.html#diff-key"><i class="fa fa-check"></i><b>3.7.2</b> Different “key” variable names</a></li>
<li class="chapter" data-level="3.7.3" data-path="3-wrangling.html"><a href="3-wrangling.html#multiple-key-variables"><i class="fa fa-check"></i><b>3.7.3</b> Multiple “key” variables</a></li>
<li class="chapter" data-level="3.7.4" data-path="3-wrangling.html"><a href="3-wrangling.html#normal-forms"><i class="fa fa-check"></i><b>3.7.4</b> Normal forms</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="3-wrangling.html"><a href="3-wrangling.html#other-verbs"><i class="fa fa-check"></i><b>3.8</b> Other verbs</a><ul>
<li class="chapter" data-level="3.8.1" data-path="3-wrangling.html"><a href="3-wrangling.html#select"><i class="fa fa-check"></i><b>3.8.1</b> <code>select</code> variables</a></li>
<li class="chapter" data-level="3.8.2" data-path="3-wrangling.html"><a href="3-wrangling.html#rename"><i class="fa fa-check"></i><b>3.8.2</b> <code>rename</code> variables</a></li>
<li class="chapter" data-level="3.8.3" data-path="3-wrangling.html"><a href="3-wrangling.html#top_n-values-of-a-variable"><i class="fa fa-check"></i><b>3.8.3</b> <code>top_n</code> values of a variable</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="3-wrangling.html"><a href="3-wrangling.html#wrangling-conclusion"><i class="fa fa-check"></i><b>3.9</b> Conclusion</a><ul>
<li class="chapter" data-level="3.9.1" data-path="3-wrangling.html"><a href="3-wrangling.html#summary-table-1"><i class="fa fa-check"></i><b>3.9.1</b> Summary table</a></li>
<li class="chapter" data-level="3.9.2" data-path="3-wrangling.html"><a href="3-wrangling.html#additional-resources-2"><i class="fa fa-check"></i><b>3.9.2</b> Additional resources</a></li>
<li class="chapter" data-level="3.9.3" data-path="3-wrangling.html"><a href="3-wrangling.html#whats-to-come-1"><i class="fa fa-check"></i><b>3.9.3</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-tidy.html"><a href="4-tidy.html"><i class="fa fa-check"></i><b>4</b> Data Importing and “Tidy” Data</a><ul>
<li class="chapter" data-level="" data-path="4-tidy.html"><a href="4-tidy.html#tidy-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.1" data-path="4-tidy.html"><a href="4-tidy.html#csv"><i class="fa fa-check"></i><b>4.1</b> Importing data</a><ul>
<li class="chapter" data-level="4.1.1" data-path="4-tidy.html"><a href="4-tidy.html#using-the-console"><i class="fa fa-check"></i><b>4.1.1</b> Using the console</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-tidy.html"><a href="4-tidy.html#using-rstudios-interface"><i class="fa fa-check"></i><b>4.1.2</b> Using RStudio’s interface</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-ex"><i class="fa fa-check"></i><b>4.2</b> “Tidy” data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="4-tidy.html"><a href="4-tidy.html#tidy-definition"><i class="fa fa-check"></i><b>4.2.1</b> Definition of “tidy” data</a></li>
<li class="chapter" data-level="4.2.2" data-path="4-tidy.html"><a href="4-tidy.html#converting-to-tidy-data"><i class="fa fa-check"></i><b>4.2.2</b> Converting to “tidy” data</a></li>
<li class="chapter" data-level="4.2.3" data-path="4-tidy.html"><a href="4-tidy.html#nycflights13-package-1"><i class="fa fa-check"></i><b>4.2.3</b> <code>nycflights13</code> package</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-tidy.html"><a href="4-tidy.html#case-study-tidy"><i class="fa fa-check"></i><b>4.3</b> Case study: Democracy in Guatemala</a></li>
<li class="chapter" data-level="4.4" data-path="4-tidy.html"><a href="4-tidy.html#tidyverse-package"><i class="fa fa-check"></i><b>4.4</b> <code>tidyverse</code> package</a></li>
<li class="chapter" data-level="4.5" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-conclusion"><i class="fa fa-check"></i><b>4.5</b> Conclusion</a><ul>
<li class="chapter" data-level="4.5.1" data-path="4-tidy.html"><a href="4-tidy.html#additional-resources-3"><i class="fa fa-check"></i><b>4.5.1</b> Additional resources</a></li>
<li class="chapter" data-level="4.5.2" data-path="4-tidy.html"><a href="4-tidy.html#whats-to-come-2"><i class="fa fa-check"></i><b>4.5.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data Modeling with moderndive</b></span></li>
<li class="chapter" data-level="5" data-path="5-regression.html"><a href="5-regression.html"><i class="fa fa-check"></i><b>5</b> Basic Regression</a><ul>
<li class="chapter" data-level="" data-path="5-regression.html"><a href="5-regression.html#reg-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="5.1" data-path="5-regression.html"><a href="5-regression.html#model1"><i class="fa fa-check"></i><b>5.1</b> One numerical explanatory variable</a><ul>
<li class="chapter" data-level="5.1.1" data-path="5-regression.html"><a href="5-regression.html#model1EDA"><i class="fa fa-check"></i><b>5.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-regression.html"><a href="5-regression.html#model1table"><i class="fa fa-check"></i><b>5.1.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-regression.html"><a href="5-regression.html#model1points"><i class="fa fa-check"></i><b>5.1.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-regression.html"><a href="5-regression.html#model2"><i class="fa fa-check"></i><b>5.2</b> One categorical explanatory variable</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-regression.html"><a href="5-regression.html#model2EDA"><i class="fa fa-check"></i><b>5.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-regression.html"><a href="5-regression.html#model2table"><i class="fa fa-check"></i><b>5.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-regression.html"><a href="5-regression.html#model2points"><i class="fa fa-check"></i><b>5.2.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-regression.html"><a href="5-regression.html#reg-related-topics"><i class="fa fa-check"></i><b>5.3</b> Related topics</a><ul>
<li class="chapter" data-level="5.3.1" data-path="5-regression.html"><a href="5-regression.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>5.3.1</b> Correlation is not necessarily causation</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-regression.html"><a href="5-regression.html#leastsquares"><i class="fa fa-check"></i><b>5.3.2</b> Best-fitting line</a></li>
<li class="chapter" data-level="5.3.3" data-path="5-regression.html"><a href="5-regression.html#underthehood"><i class="fa fa-check"></i><b>5.3.3</b> <code>get_regression_x()</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-regression.html"><a href="5-regression.html#reg-conclusion"><i class="fa fa-check"></i><b>5.4</b> Conclusion</a><ul>
<li class="chapter" data-level="5.4.1" data-path="5-regression.html"><a href="5-regression.html#additional-resources-basic-regression"><i class="fa fa-check"></i><b>5.4.1</b> Additional resources</a></li>
<li class="chapter" data-level="5.4.2" data-path="5-regression.html"><a href="5-regression.html#whats-to-come-4"><i class="fa fa-check"></i><b>5.4.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html"><i class="fa fa-check"></i><b>6</b> Multiple Regression</a><ul>
<li class="chapter" data-level="" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#mult-reg-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="6.1" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#model4"><i class="fa fa-check"></i><b>6.1</b> One numerical and one categorical explanatory variable</a><ul>
<li class="chapter" data-level="6.1.1" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#model4EDA"><i class="fa fa-check"></i><b>6.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#model4interactiontable"><i class="fa fa-check"></i><b>6.1.2</b> Interaction model</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#model4table"><i class="fa fa-check"></i><b>6.1.3</b> Parallel slopes model</a></li>
<li class="chapter" data-level="6.1.4" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#model4points"><i class="fa fa-check"></i><b>6.1.4</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#model3"><i class="fa fa-check"></i><b>6.2</b> Two numerical explanatory variables</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#model3EDA"><i class="fa fa-check"></i><b>6.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#model3table"><i class="fa fa-check"></i><b>6.2.2</b> Regression plane</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#model3points"><i class="fa fa-check"></i><b>6.2.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#mult-reg-related-topics"><i class="fa fa-check"></i><b>6.3</b> Related topics</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#model-selection"><i class="fa fa-check"></i><b>6.3.1</b> Model selection using visualizations</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#rsquared"><i class="fa fa-check"></i><b>6.3.2</b> Model selection using R-squared</a></li>
<li class="chapter" data-level="6.3.3" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#correlationcoefficient2"><i class="fa fa-check"></i><b>6.3.3</b> Correlation coefficient</a></li>
<li class="chapter" data-level="6.3.4" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#simpsonsparadox"><i class="fa fa-check"></i><b>6.3.4</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#mult-reg-conclusion"><i class="fa fa-check"></i><b>6.4</b> Conclusion</a><ul>
<li class="chapter" data-level="6.4.1" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#additional-resources-4"><i class="fa fa-check"></i><b>6.4.1</b> Additional resources</a></li>
<li class="chapter" data-level="6.4.2" data-path="6-multiple-regression.html"><a href="6-multiple-regression.html#whats-to-come-5"><i class="fa fa-check"></i><b>6.4.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Statistical Inference with infer</b></span></li>
<li class="chapter" data-level="7" data-path="7-sampling.html"><a href="7-sampling.html"><i class="fa fa-check"></i><b>7</b> Sampling</a><ul>
<li class="chapter" data-level="" data-path="7-sampling.html"><a href="7-sampling.html#sampling-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="7.1" data-path="7-sampling.html"><a href="7-sampling.html#sampling-activity"><i class="fa fa-check"></i><b>7.1</b> Sampling bowl activity</a><ul>
<li class="chapter" data-level="7.1.1" data-path="7-sampling.html"><a href="7-sampling.html#what-proportion-of-this-bowls-balls-are-red"><i class="fa fa-check"></i><b>7.1.1</b> What proportion of this bowl’s balls are red?</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-sampling.html"><a href="7-sampling.html#using-the-shovel-once"><i class="fa fa-check"></i><b>7.1.2</b> Using the shovel once</a></li>
<li class="chapter" data-level="7.1.3" data-path="7-sampling.html"><a href="7-sampling.html#student-shovels"><i class="fa fa-check"></i><b>7.1.3</b> Using the shovel 33 times</a></li>
<li class="chapter" data-level="7.1.4" data-path="7-sampling.html"><a href="7-sampling.html#sampling-what-did-we-just-do"><i class="fa fa-check"></i><b>7.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-sampling.html"><a href="7-sampling.html#sampling-simulation"><i class="fa fa-check"></i><b>7.2</b> Virtual sampling</a><ul>
<li class="chapter" data-level="7.2.1" data-path="7-sampling.html"><a href="7-sampling.html#using-the-virtual-shovel-once"><i class="fa fa-check"></i><b>7.2.1</b> Using the virtual shovel once</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7-sampling.html"><a href="7-sampling.html#sampling-framework"><i class="fa fa-check"></i><b>7.3</b> Sampling framework</a><ul>
<li class="chapter" data-level="7.3.1" data-path="7-sampling.html"><a href="7-sampling.html#terminology-and-notation"><i class="fa fa-check"></i><b>7.3.1</b> Terminology and notation</a></li>
<li class="chapter" data-level="7.3.2" data-path="7-sampling.html"><a href="7-sampling.html#sampling-definitions"><i class="fa fa-check"></i><b>7.3.2</b> Statistical definitions</a></li>
<li class="chapter" data-level="7.3.3" data-path="7-sampling.html"><a href="7-sampling.html#moral-of-the-story"><i class="fa fa-check"></i><b>7.3.3</b> The moral of the story</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7-sampling.html"><a href="7-sampling.html#sampling-case-study"><i class="fa fa-check"></i><b>7.4</b> Case study: Polls</a></li>
<li class="chapter" data-level="7.5" data-path="7-sampling.html"><a href="7-sampling.html#sampling-conclusion-central-limit-theorem"><i class="fa fa-check"></i><b>7.5</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="7.6" data-path="7-sampling.html"><a href="7-sampling.html#sampling-conclusion"><i class="fa fa-check"></i><b>7.6</b> Conclusion</a><ul>
<li class="chapter" data-level="7.6.1" data-path="7-sampling.html"><a href="7-sampling.html#sampling-conclusion-table"><i class="fa fa-check"></i><b>7.6.1</b> Sampling scenarios</a></li>
<li class="chapter" data-level="7.6.2" data-path="7-sampling.html"><a href="7-sampling.html#additional-resources-5"><i class="fa fa-check"></i><b>7.6.2</b> Additional resources</a></li>
<li class="chapter" data-level="7.6.3" data-path="7-sampling.html"><a href="7-sampling.html#whats-to-come-6"><i class="fa fa-check"></i><b>7.6.3</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html"><i class="fa fa-check"></i><b>8</b> Bootstrapping and Confidence Intervals</a><ul>
<li class="chapter" data-level="" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#CI-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="8.1" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#resampling-tactile"><i class="fa fa-check"></i><b>8.1</b> Pennies activity</a><ul>
<li class="chapter" data-level="8.1.1" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#what-is-the-average-year-on-us-pennies-in-2019"><i class="fa fa-check"></i><b>8.1.1</b> What is the average year on US pennies in 2019?</a></li>
<li class="chapter" data-level="8.1.2" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#resampling-once"><i class="fa fa-check"></i><b>8.1.2</b> Resampling once</a></li>
<li class="chapter" data-level="8.1.3" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#student-resamples"><i class="fa fa-check"></i><b>8.1.3</b> Resampling 35 times</a></li>
<li class="chapter" data-level="8.1.4" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#ci-what-did-we-just-do"><i class="fa fa-check"></i><b>8.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#resampling-simulation"><i class="fa fa-check"></i><b>8.2</b> Computer simulation of resampling</a><ul>
<li class="chapter" data-level="8.2.1" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#virtually-resampling-once"><i class="fa fa-check"></i><b>8.2.1</b> Virtually resampling once</a></li>
<li class="chapter" data-level="8.2.2" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#bootstrap-35-replicates"><i class="fa fa-check"></i><b>8.2.2</b> Virtually resampling 35 times</a></li>
<li class="chapter" data-level="8.2.3" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#bootstrap-1000-replicates"><i class="fa fa-check"></i><b>8.2.3</b> Virtually resampling 1000 times</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#ci-build-up"><i class="fa fa-check"></i><b>8.3</b> Understanding confidence intervals</a><ul>
<li class="chapter" data-level="8.3.1" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#percentile-method"><i class="fa fa-check"></i><b>8.3.1</b> Percentile method</a></li>
<li class="chapter" data-level="8.3.2" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#se-method"><i class="fa fa-check"></i><b>8.3.2</b> Standard error method</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#bootstrap-process"><i class="fa fa-check"></i><b>8.4</b> Constructing confidence intervals</a><ul>
<li class="chapter" data-level="8.4.1" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#original-workflow"><i class="fa fa-check"></i><b>8.4.1</b> Original workflow</a></li>
<li class="chapter" data-level="8.4.2" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#infer-workflow"><i class="fa fa-check"></i><b>8.4.2</b> <code>infer</code> package workflow</a></li>
<li class="chapter" data-level="8.4.3" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#percentile-method-infer"><i class="fa fa-check"></i><b>8.4.3</b> Percentile method with <code>infer</code></a></li>
<li class="chapter" data-level="8.4.4" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#infer-se"><i class="fa fa-check"></i><b>8.4.4</b> Standard error method with <code>infer</code></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#one-prop-ci"><i class="fa fa-check"></i><b>8.5</b> Interpreting confidence intervals</a><ul>
<li class="chapter" data-level="8.5.1" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#ilyas-yohan"><i class="fa fa-check"></i><b>8.5.1</b> Did the net capture the fish?</a></li>
<li class="chapter" data-level="8.5.2" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#shorthand"><i class="fa fa-check"></i><b>8.5.2</b> Precise and shorthand interpretation</a></li>
<li class="chapter" data-level="8.5.3" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#ci-width"><i class="fa fa-check"></i><b>8.5.3</b> Width of confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#case-study-two-prop-ci"><i class="fa fa-check"></i><b>8.6</b> Case study: Is yawning contagious?</a><ul>
<li class="chapter" data-level="8.6.1" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#mythbusters-study-data"><i class="fa fa-check"></i><b>8.6.1</b> <em>Mythbusters</em> study data</a></li>
<li class="chapter" data-level="8.6.2" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#sampling-scenario"><i class="fa fa-check"></i><b>8.6.2</b> Sampling scenario</a></li>
<li class="chapter" data-level="8.6.3" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#ci-build"><i class="fa fa-check"></i><b>8.6.3</b> Constructing the confidence interval</a></li>
<li class="chapter" data-level="8.6.4" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#interpreting-the-confidence-interval"><i class="fa fa-check"></i><b>8.6.4</b> Interpreting the confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#ci-conclusion"><i class="fa fa-check"></i><b>8.7</b> Conclusion</a><ul>
<li class="chapter" data-level="8.7.1" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#bootstrap-vs-sampling"><i class="fa fa-check"></i><b>8.7.1</b> Comparing bootstrap and sampling distributions</a></li>
<li class="chapter" data-level="8.7.2" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#theory-ci"><i class="fa fa-check"></i><b>8.7.2</b> Theory-based confidence intervals</a></li>
<li class="chapter" data-level="8.7.3" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#additional-resources-6"><i class="fa fa-check"></i><b>8.7.3</b> Additional resources</a></li>
<li class="chapter" data-level="8.7.4" data-path="8-confidence-intervals.html"><a href="8-confidence-intervals.html#whats-to-come-7"><i class="fa fa-check"></i><b>8.7.4</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html"><i class="fa fa-check"></i><b>9</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#nhst-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="9.1" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#ht-activity"><i class="fa fa-check"></i><b>9.1</b> Promotions activity</a><ul>
<li class="chapter" data-level="9.1.1" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#does-gender-affect-promotions-at-a-bank"><i class="fa fa-check"></i><b>9.1.1</b> Does gender affect promotions at a bank?</a></li>
<li class="chapter" data-level="9.1.2" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#shuffling-once"><i class="fa fa-check"></i><b>9.1.2</b> Shuffling once</a></li>
<li class="chapter" data-level="9.1.3" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#shuffling-16-times"><i class="fa fa-check"></i><b>9.1.3</b> Shuffling 16 times</a></li>
<li class="chapter" data-level="9.1.4" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#ht-what-did-we-just-do"><i class="fa fa-check"></i><b>9.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#understanding-ht"><i class="fa fa-check"></i><b>9.2</b> Understanding hypothesis tests</a></li>
<li class="chapter" data-level="9.3" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#ht-infer"><i class="fa fa-check"></i><b>9.3</b> Conducting hypothesis tests</a><ul>
<li class="chapter" data-level="9.3.1" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#infer-workflow-ht"><i class="fa fa-check"></i><b>9.3.1</b> <code>infer</code> package workflow</a></li>
<li class="chapter" data-level="9.3.2" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#comparing-infer-workflows"><i class="fa fa-check"></i><b>9.3.2</b> Comparison with confidence intervals</a></li>
<li class="chapter" data-level="9.3.3" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#only-one-test"><i class="fa fa-check"></i><b>9.3.3</b> “There is only one test”</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#ht-interpretation"><i class="fa fa-check"></i><b>9.4</b> Interpreting hypothesis tests</a><ul>
<li class="chapter" data-level="9.4.1" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#trial"><i class="fa fa-check"></i><b>9.4.1</b> Two possible outcomes</a></li>
<li class="chapter" data-level="9.4.2" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#types-of-errors"><i class="fa fa-check"></i><b>9.4.2</b> Types of errors</a></li>
<li class="chapter" data-level="9.4.3" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#choosing-alpha"><i class="fa fa-check"></i><b>9.4.3</b> How do we choose alpha?</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#ht-case-study"><i class="fa fa-check"></i><b>9.5</b> Case study: Are action or romance movies rated higher?</a><ul>
<li class="chapter" data-level="9.5.1" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#imdb-data"><i class="fa fa-check"></i><b>9.5.1</b> IMDb ratings data</a></li>
<li class="chapter" data-level="9.5.2" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#sampling-scenario-1"><i class="fa fa-check"></i><b>9.5.2</b> Sampling scenario</a></li>
<li class="chapter" data-level="9.5.3" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#conducting-the-hypothesis-test"><i class="fa fa-check"></i><b>9.5.3</b> Conducting the hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#nhst-conclusion"><i class="fa fa-check"></i><b>9.6</b> Conclusion</a><ul>
<li class="chapter" data-level="9.6.1" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#theory-hypo"><i class="fa fa-check"></i><b>9.6.1</b> Theory-based hypothesis tests</a></li>
<li class="chapter" data-level="9.6.2" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#when-inference-is-not-needed"><i class="fa fa-check"></i><b>9.6.2</b> When inference is not needed</a></li>
<li class="chapter" data-level="9.6.3" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#problems-with-p-values"><i class="fa fa-check"></i><b>9.6.3</b> Problems with p-values</a></li>
<li class="chapter" data-level="9.6.4" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6.4</b> Additional resources</a></li>
<li class="chapter" data-level="9.6.5" data-path="9-hypothesis-testing.html"><a href="9-hypothesis-testing.html#whats-to-come-8"><i class="fa fa-check"></i><b>9.6.5</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html"><i class="fa fa-check"></i><b>10</b> Inference for Regression</a><ul>
<li class="chapter" data-level="" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#inf-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="10.1" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#regression-refresher"><i class="fa fa-check"></i><b>10.1</b> Regression refresher</a><ul>
<li class="chapter" data-level="10.1.1" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#teaching-evaluations-analysis"><i class="fa fa-check"></i><b>10.1.1</b> Teaching evaluations analysis</a></li>
<li class="chapter" data-level="10.1.2" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#sampling-scenario-2"><i class="fa fa-check"></i><b>10.1.2</b> Sampling scenario</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#regression-interp"><i class="fa fa-check"></i><b>10.2</b> Interpreting regression tables</a><ul>
<li class="chapter" data-level="10.2.1" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#regression-se"><i class="fa fa-check"></i><b>10.2.1</b> Standard error</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#regression-test-statistic"><i class="fa fa-check"></i><b>10.2.2</b> Test statistic</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#p-value"><i class="fa fa-check"></i><b>10.2.3</b> p-value</a></li>
<li class="chapter" data-level="10.2.4" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#confidence-interval"><i class="fa fa-check"></i><b>10.2.4</b> Confidence interval</a></li>
<li class="chapter" data-level="10.2.5" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#regression-table-computation"><i class="fa fa-check"></i><b>10.2.5</b> How does R compute the table?</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#regression-conditions"><i class="fa fa-check"></i><b>10.3</b> Conditions for inference for regression</a><ul>
<li class="chapter" data-level="10.3.1" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#residuals-refresher"><i class="fa fa-check"></i><b>10.3.1</b> Residuals refresher</a></li>
<li class="chapter" data-level="10.3.2" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#linearity-of-relationship"><i class="fa fa-check"></i><b>10.3.2</b> Linearity of relationship</a></li>
<li class="chapter" data-level="10.3.3" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#independence-of-residuals"><i class="fa fa-check"></i><b>10.3.3</b> Independence of residuals</a></li>
<li class="chapter" data-level="10.3.4" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#normality-of-residuals"><i class="fa fa-check"></i><b>10.3.4</b> Normality of residuals</a></li>
<li class="chapter" data-level="10.3.5" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#equality-of-variance"><i class="fa fa-check"></i><b>10.3.5</b> Equality of variance</a></li>
<li class="chapter" data-level="10.3.6" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#what-is-the-conclusion"><i class="fa fa-check"></i><b>10.3.6</b> What’s the conclusion?</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#infer-regression"><i class="fa fa-check"></i><b>10.4</b> Simulation-based inference for regression</a><ul>
<li class="chapter" data-level="10.4.1" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#confidence-interval-for-slope"><i class="fa fa-check"></i><b>10.4.1</b> Confidence interval for slope</a></li>
<li class="chapter" data-level="10.4.2" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#hypothesis-test-for-slope"><i class="fa fa-check"></i><b>10.4.2</b> Hypothesis test for slope</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#inference-conclusion"><i class="fa fa-check"></i><b>10.5</b> Conclusion</a><ul>
<li class="chapter" data-level="10.5.1" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#theory-regression"><i class="fa fa-check"></i><b>10.5.1</b> Theory-based inference for regression</a></li>
<li class="chapter" data-level="10.5.2" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#summary-of-statistical-inference"><i class="fa fa-check"></i><b>10.5.2</b> Summary of statistical inference</a></li>
<li class="chapter" data-level="10.5.3" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5.3</b> Additional resources</a></li>
<li class="chapter" data-level="10.5.4" data-path="10-inference-for-regression.html"><a href="10-inference-for-regression.html#whats-to-come-9"><i class="fa fa-check"></i><b>10.5.4</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Conclusion</b></span></li>
<li class="chapter" data-level="11" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html"><i class="fa fa-check"></i><b>11</b> Tell Your Story with Data</a><ul>
<li class="chapter" data-level="11.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#review"><i class="fa fa-check"></i><b>11.1</b> Review</a><ul>
<li class="chapter" data-level="" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#story-packages"><i class="fa fa-check"></i>Needed packages</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#seattle-house-prices"><i class="fa fa-check"></i><b>11.2</b> Case study: Seattle house prices</a><ul>
<li class="chapter" data-level="11.2.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#house-prices-EDA-I"><i class="fa fa-check"></i><b>11.2.1</b> Exploratory data analysis: Part I</a></li>
<li class="chapter" data-level="11.2.2" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#house-prices-EDA-II"><i class="fa fa-check"></i><b>11.2.2</b> Exploratory data analysis: Part II</a></li>
<li class="chapter" data-level="11.2.3" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#house-prices-regression"><i class="fa fa-check"></i><b>11.2.3</b> Regression modeling</a></li>
<li class="chapter" data-level="11.2.4" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#house-prices-making-predictions"><i class="fa fa-check"></i><b>11.2.4</b> Making predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#data-journalism"><i class="fa fa-check"></i><b>11.3</b> Case study: Effective data storytelling</a><ul>
<li class="chapter" data-level="11.3.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#bechdel-test-for-hollywood-gender-representation"><i class="fa fa-check"></i><b>11.3.1</b> Bechdel test for Hollywood gender representation</a></li>
<li class="chapter" data-level="11.3.2" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#us-births-in-1999"><i class="fa fa-check"></i><b>11.3.2</b> US Births in 1999</a></li>
<li class="chapter" data-level="11.3.3" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#scripts-of-r-code"><i class="fa fa-check"></i><b>11.3.3</b> Scripts of R code</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#concluding-remarks"><i class="fa fa-check"></i>Concluding remarks</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-appendixA.html"><a href="A-appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a><ul>
<li class="chapter" data-level="A.1" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-stat-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a><ul>
<li class="chapter" data-level="A.1.1" data-path="A-appendixA.html"><a href="A-appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="A-appendixA.html"><a href="A-appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-sd-variance"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation and variance</a></li>
<li class="chapter" data-level="A.1.4" data-path="A-appendixA.html"><a href="A-appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="A-appendixA.html"><a href="A-appendixA.html#distribution"><i class="fa fa-check"></i><b>A.1.5</b> Distribution</a></li>
<li class="chapter" data-level="A.1.6" data-path="A-appendixA.html"><a href="A-appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.6</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-normal-curve"><i class="fa fa-check"></i><b>A.2</b> Normal distribution</a></li>
<li class="chapter" data-level="A.3" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-log10-transformations"><i class="fa fa-check"></i><b>A.3</b> log10 transformations</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-appendixB.html"><a href="B-appendixB.html"><i class="fa fa-check"></i><b>B</b> Inference Examples</a><ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#needed-packages-1"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="B.1" data-path="B-appendixB.html"><a href="B-appendixB.html#inference-mind-map"><i class="fa fa-check"></i><b>B.1</b> Inference mind map</a></li>
<li class="chapter" data-level="B.2" data-path="B-appendixB.html"><a href="B-appendixB.html#one-mean"><i class="fa fa-check"></i><b>B.2</b> One mean</a><ul>
<li class="chapter" data-level="B.2.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement"><i class="fa fa-check"></i><b>B.2.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.2.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses"><i class="fa fa-check"></i><b>B.2.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.2.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data"><i class="fa fa-check"></i><b>B.2.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.2.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods"><i class="fa fa-check"></i><b>B.2.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.2.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods"><i class="fa fa-check"></i><b>B.2.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.2.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results"><i class="fa fa-check"></i><b>B.2.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="B-appendixB.html"><a href="B-appendixB.html#one-proportion"><i class="fa fa-check"></i><b>B.3</b> One proportion</a><ul>
<li class="chapter" data-level="B.3.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-1"><i class="fa fa-check"></i><b>B.3.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.3.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-1"><i class="fa fa-check"></i><b>B.3.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.3.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-1"><i class="fa fa-check"></i><b>B.3.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.3.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-1"><i class="fa fa-check"></i><b>B.3.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-1"><i class="fa fa-check"></i><b>B.3.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.3.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-1"><i class="fa fa-check"></i><b>B.3.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="B-appendixB.html"><a href="B-appendixB.html#two-proportions"><i class="fa fa-check"></i><b>B.4</b> Two proportions</a><ul>
<li class="chapter" data-level="B.4.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-2"><i class="fa fa-check"></i><b>B.4.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.4.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-2"><i class="fa fa-check"></i><b>B.4.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.4.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-2"><i class="fa fa-check"></i><b>B.4.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.4.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-2"><i class="fa fa-check"></i><b>B.4.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.4.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-2"><i class="fa fa-check"></i><b>B.4.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.4.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-2"><i class="fa fa-check"></i><b>B.4.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.4.7" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-2"><i class="fa fa-check"></i><b>B.4.7</b> State conclusion</a></li>
<li class="chapter" data-level="B.4.8" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-2"><i class="fa fa-check"></i><b>B.4.8</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-independent-samples"><i class="fa fa-check"></i><b>B.5</b> Two means (independent samples)</a><ul>
<li class="chapter" data-level="B.5.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-3"><i class="fa fa-check"></i><b>B.5.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.5.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-3"><i class="fa fa-check"></i><b>B.5.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.5.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-3"><i class="fa fa-check"></i><b>B.5.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.5.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-3"><i class="fa fa-check"></i><b>B.5.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.5.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-3"><i class="fa fa-check"></i><b>B.5.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.5.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-3"><i class="fa fa-check"></i><b>B.5.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.5.7" data-path="B-appendixB.html"><a href="B-appendixB.html#compute-p-value-1"><i class="fa fa-check"></i><b>B.5.7</b> Compute <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="B.5.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-3"><i class="fa fa-check"></i><b>B.5.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.5.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-3"><i class="fa fa-check"></i><b>B.5.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-paired-samples"><i class="fa fa-check"></i><b>B.6</b> Two means (paired samples)</a><ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-4"><i class="fa fa-check"></i>Problem statement</a></li>
<li class="chapter" data-level="B.6.1" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-4"><i class="fa fa-check"></i><b>B.6.1</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.6.2" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-4"><i class="fa fa-check"></i><b>B.6.2</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.6.3" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-4"><i class="fa fa-check"></i><b>B.6.3</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.6.4" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-4"><i class="fa fa-check"></i><b>B.6.4</b> Traditional methods</a></li>
<li class="chapter" data-level="B.6.5" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-4"><i class="fa fa-check"></i><b>B.6.5</b> Comparing results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-appendixC.html"><a href="C-appendixC.html"><i class="fa fa-check"></i><b>C</b> Tips and Tricks</a><ul>
<li class="chapter" data-level="" data-path="C-appendixC.html"><a href="C-appendixC.html#needed-packages-2"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="C.1" data-path="C-appendixC.html"><a href="C-appendixC.html#data-wrangling"><i class="fa fa-check"></i><b>C.1</b> Data wrangling</a><ul>
<li class="chapter" data-level="C.1.1" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-missing-values"><i class="fa fa-check"></i><b>C.1.1</b> Dealing with missing values</a></li>
<li class="chapter" data-level="C.1.2" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-reordering-bars"><i class="fa fa-check"></i><b>C.1.2</b> Reordering bars in a barplot</a></li>
<li class="chapter" data-level="C.1.3" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-money-on-axis"><i class="fa fa-check"></i><b>C.1.3</b> Showing money on an axis</a></li>
<li class="chapter" data-level="C.1.4" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-changing-values"><i class="fa fa-check"></i><b>C.1.4</b> Changing values inside cells</a></li>
<li class="chapter" data-level="C.1.5" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-convert-numerical-categorical"><i class="fa fa-check"></i><b>C.1.5</b> Converting a numerical variable to a categorical one</a></li>
<li class="chapter" data-level="C.1.6" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-prop"><i class="fa fa-check"></i><b>C.1.6</b> Computing proportions</a></li>
<li class="chapter" data-level="C.1.7" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-commas"><i class="fa fa-check"></i><b>C.1.7</b> Dealing with %, commas, and $</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-graphics"><i class="fa fa-check"></i><b>C.2</b> Interactive graphics</a><ul>
<li class="chapter" data-level="C.2.1" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-linegraphs"><i class="fa fa-check"></i><b>C.2.1</b> Interactive linegraphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="D-appendixD.html"><a href="D-appendixD.html"><i class="fa fa-check"></i><b>D</b> Learning Check Solutions</a><ul>
<li class="chapter" data-level="D.1" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-1-solutions"><i class="fa fa-check"></i><b>D.1</b> Chapter 1 Solutions</a></li>
<li class="chapter" data-level="D.2" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-2-solutions"><i class="fa fa-check"></i><b>D.2</b> Chapter 2 Solutions</a></li>
<li class="chapter" data-level="D.3" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-3-solutions"><i class="fa fa-check"></i><b>D.3</b> Chapter 3 Solutions</a></li>
<li class="chapter" data-level="D.4" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-4-solutions"><i class="fa fa-check"></i><b>D.4</b> Chapter 4 Solutions</a></li>
<li class="chapter" data-level="D.5" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-5-solutions"><i class="fa fa-check"></i><b>D.5</b> Chapter 5 Solutions</a></li>
<li class="chapter" data-level="D.6" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-6-solutions"><i class="fa fa-check"></i><b>D.6</b> Chapter 6 Solutions</a></li>
<li class="chapter" data-level="D.7" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-7-solutions"><i class="fa fa-check"></i><b>D.7</b> Chapter 7 Solutions</a></li>
<li class="chapter" data-level="D.8" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-8-solutions"><i class="fa fa-check"></i><b>D.8</b> Chapter 8 Solutions</a></li>
<li class="chapter" data-level="D.9" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-9-solutions"><i class="fa fa-check"></i><b>D.9</b> Chapter 9 Solutions</a></li>
<li class="chapter" data-level="D.10" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-10-solutions"><i class="fa fa-check"></i><b>D.10</b> Chapter 10 Solutions</a></li>
<li class="chapter" data-level="D.11" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-11-solutions"><i class="fa fa-check"></i><b>D.11</b> Chapter 11 Solutions</a></li>
<li class="chapter" data-level="D.12" data-path="D-appendixD.html"><a href="D-appendixD.html#appendix-a2-solutions"><i class="fa fa-check"></i><b>D.12</b> Appendix A2 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="E-appendixE.html"><a href="E-appendixE.html"><i class="fa fa-check"></i><b>E</b> Versions of R Packages Used</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Inference via Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img src='https://moderndive.com/wide_format.png' alt="ModernDive">
</html>
<div id="confidence-intervals" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Bootstrapping and Confidence Intervals</h1>
<p>In Chapter <a href="7-sampling.html#sampling">7</a>, we studied sampling. We started with a “tactile” exercise where we wanted to know the proportion of balls in the sampling bowl in Figure <a href="7-sampling.html#fig:sampling-exercise-1">7.1</a> that are red. While we could have performed an exhaustive count, this would have been a tedious process. So instead, we used a shovel to extract a sample of 50 balls and used the resulting proportion that were red as an <em>estimate</em>. Furthermore, we made sure to mix the bowl’s contents before every use of the shovel. Because of the randomness created by the mixing, different uses of the shovel yielded different proportions red and hence different estimates of the proportion of the bowl’s balls that are red.</p>
<p>We then mimicked this “tactile” sampling exercise with an equivalent “virtual” sampling exercise performed on the computer. Using our computer’s random number generator, we quickly mimicked the above sampling procedure a large number of times. In Subsection <a href="#different-shovels"><strong>??</strong></a>, we quickly repeated this sampling procedure 1000 times, using three different “virtual” shovels with 25, 50, and 100 slots. We visualized these three sets of 1000 estimates in Figure <a href="7-sampling.html#fig:comparing-sampling-distributions-3">7.12</a> and saw that as the sample size increased, the variation in the estimates decreased.</p>
<p>In doing so, what we did was construct <em>sampling distributions</em>. The motivation for taking 1000 repeated samples and visualizing the resulting estimates was to study how these estimates varied from one sample to another; in other words, we wanted to study the effect of <em>sampling variation</em>. We quantified the variation of these estimates using their standard deviation, which has a special name: the <em>standard error</em>. In particular, we saw that as the sample size increased from 25 to 50 to 100, the standard error decreased and thus the sampling distributions narrowed. Larger sample sizes led to more <em>precise</em> estimates that varied less around the center.</p>
<p>We then tied these sampling exercises to terminology and mathematical notation related to sampling in Subsection <a href="7-sampling.html#terminology-and-notation">7.3.1</a>. Our <em>study population</em> was the large bowl with <span class="math inline">\(N\)</span> = 2400 balls, while the <em>population parameter</em>, the unknown quantity of interest, was the population proportion <span class="math inline">\(p\)</span> of the bowl’s balls that were red. Since performing a <em>census</em> would be expensive in terms of time and energy, we instead extracted a <em>sample</em> of size <span class="math inline">\(n\)</span> = 50. The <em>point estimate</em>, also known as a <em>sample statistic</em>, used to estimate <span class="math inline">\(p\)</span> was the sample proportion <span class="math inline">\(\widehat{p}\)</span> of these 50 sampled balls that were red. Furthermore, since the sample was obtained at <em>random</em>, it can be considered as <em>unbiased</em> and <em>representative</em> of the population. Thus any results based on the sample could be <em>generalized</em> to the population. Therefore, the proportion of the shovel’s balls that were red was a “good guess” of the proportion of the bowl’s balls that are red. In other words, we used the sample to <em>infer</em> about the population.</p>
<p>However, as described in Section <a href="7-sampling.html#sampling-simulation">7.2</a>, both the tactile and virtual sampling exercises are not what one would do in real life; this was merely an activity used to study the effects of sampling variation. In a real-life situation, we would not take 1000 samples of size <span class="math inline">\(n\)</span>, but rather take a <em>single</em> representative sample that’s as large as possible. Additionally, we knew that the true proportion of the bowl’s balls that were red was 37.5%. In a real-life situation, we will not know what this value is. Because if we did, then why would we take a sample to estimate it?</p>
<p>An example of a realistic sampling situation would be a poll, like the <a href="https://www.npr.org/sections/itsallpolitics/2013/12/04/248793753/poll-support-for-obama-among-young-americans-eroding">Obama poll</a> you saw in Section <a href="7-sampling.html#sampling-case-study">7.4</a>. Pollsters did not know the true proportion of <em>all</em> young Americans who supported President Obama in 2013, and thus they took a single sample of size <span class="math inline">\(n\)</span> = 2089 young Americans to estimate this value.</p>
<p>So how does one quantify the effects of sampling variation when you only have a <em>single sample</em> to work with? You cannot directly study the effects of sampling variation when you only have one sample. One common method to study this is <em>bootstrapping resampling</em>, which will be the focus of the earlier sections of this chapter.</p>
<p>Furthermore, what if we would like not only a single estimate of the unknown population parameter, but also a <em>range of highly plausible</em> values? Going back to the Obama poll article, it stated that the pollsters’ estimate of the proportion of all young Americans who supported President Obama was 41%. But in addition it stated that the poll’s “margin of error was plus or minus 2.1 percentage points.” This “plausible range” was [41% - 2.1%, 41% + 2.1%] = [38.9%, 43.1%]. This range of plausible values is what’s known as a <em>confidence interval</em>, which will be the focus of the later sections of this chapter.</p>
<div id="CI-packages" class="section level3 unnumbered">
<h3>Needed packages</h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). Recall from our discussion in Section <a href="4-tidy.html#tidyverse-package">4.4</a> that loading the <code>tidyverse</code> package by running <code>library(tidyverse)</code> loads the following commonly used data science packages all at once:</p>
<ul>
<li><code>ggplot2</code> for data visualization</li>
<li><code>dplyr</code> for data wrangling</li>
<li><code>tidyr</code> for converting data to tidy format</li>
<li><code>readr</code> for importing spreadsheet data into R</li>
<li>As well as the more advanced <code>purrr</code>, <code>tibble</code>, <code>stringr</code>, and <code>forcats</code> packages</li>
</ul>
<p>If needed, read Section <a href="1-getting-started.html#packages">1.3</a> for information on how to install and load R packages.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="8-confidence-intervals.html#cb235-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb235-2"><a href="8-confidence-intervals.html#cb235-2"></a><span class="kw">library</span>(moderndive)</span>
<span id="cb235-3"><a href="8-confidence-intervals.html#cb235-3"></a><span class="kw">library</span>(infer)</span></code></pre></div>
</div>
<div id="resampling-tactile" class="section level2">
<h2><span class="header-section-number">8.1</span> Pennies activity</h2>
<p>As we did in Chapter <a href="7-sampling.html#sampling">7</a>, we’ll begin with a hands-on tactile activity.</p>
<div id="what-is-the-average-year-on-us-pennies-in-2019" class="section level3">
<h3><span class="header-section-number">8.1.1</span> What is the average year on US pennies in 2019?</h3>
<p>Try to imagine all the pennies being used in the United States in 2019. That’s a lot of pennies! Now say we’re interested in the average year of minting of <em>all</em> these pennies. One way to compute this value would be to gather up all pennies being used in the US, record the year, and compute the average. However, this would be near impossible! So instead, let’s collect a <em>sample</em> of 50 pennies from a local bank in downtown Northampton, Massachusetts, USA as seen in Figure <a href="8-confidence-intervals.html#fig:resampling-exercise-a">8.1</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:resampling-exercise-a"></span>
<img src="images/sampling/pennies/bank.jpg" alt="Collecting a sample of 50 US pennies from a local bank." width="40%" /><img src="images/sampling/pennies/roll.jpg" alt="Collecting a sample of 50 US pennies from a local bank." width="40%" />
<p class="caption">
FIGURE 8.1: Collecting a sample of 50 US pennies from a local bank.
</p>
</div>
<p>An image of these 50 pennies can be seen in Figure <a href="8-confidence-intervals.html#fig:resampling-exercise-c">8.2</a>. For each of the 50 pennies starting in the top left, progressing row-by-row, and ending in the bottom right, we assigned an “ID” identification variable and marked the year of minting.</p>
<div class="figure" style="text-align: center"><span id="fig:resampling-exercise-c"></span>
<img src="images/sampling/pennies/deliverable/3.jpg" alt="50 US pennies labelled." width="100%" />
<p class="caption">
FIGURE 8.2: 50 US pennies labelled.
</p>
</div>
<p>The <code>moderndive</code>  package contains this data on our 50 sampled pennies in the <code>pennies_sample</code> data frame:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="8-confidence-intervals.html#cb236-1"></a>pennies_sample</span></code></pre></div>
<pre><code># A tibble: 50 × 2
      ID  year
   &lt;int&gt; &lt;dbl&gt;
 1     1  2002
 2     2  1986
 3     3  2017
 4     4  1988
 5     5  2008
 6     6  1983
 7     7  2008
 8     8  1996
 9     9  2004
10    10  2000
# … with 40 more rows</code></pre>
<p>The <code>pennies_sample</code> data frame has 50 rows corresponding to each penny with two variables. The first variable <code>ID</code> corresponds to the ID labels in Figure <a href="8-confidence-intervals.html#fig:resampling-exercise-c">8.2</a>, whereas the second variable <code>year</code> corresponds to the year of minting saved as a numeric variable, also known as a double (<code>dbl</code>).</p>
<p>Based on these 50 sampled pennies, what can we say about <em>all</em> US pennies in 2019? Let’s study some properties of our sample by performing an exploratory data analysis. Let’s first visualize the distribution of the year of these 50 pennies using our data visualization tools from Chapter <a href="2-viz.html#viz">2</a>. Since <code>year</code> is a numerical variable, we use a histogram in Figure <a href="8-confidence-intervals.html#fig:pennies-sample-histogram">8.3</a> to visualize its distribution.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="8-confidence-intervals.html#cb238-1"></a><span class="kw">ggplot</span>(pennies_sample, <span class="kw">aes</span>(<span class="dt">x =</span> year)) <span class="op">+</span></span>
<span id="cb238-2"><a href="8-confidence-intervals.html#cb238-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:pennies-sample-histogram"></span>
<img src="ModernDive_files/figure-html/pennies-sample-histogram-1.png" alt="Distribution of year on 50 US pennies." width="\textwidth" />
<p class="caption">
FIGURE 8.3: Distribution of year on 50 US pennies.
</p>
</div>
<p>Observe a slightly left-skewed  distribution, since most pennies fall between 1980 and 2010 with only a few pennies older than 1970. What is the average year for the 50 sampled pennies? Eyeballing the histogram it appears to be around 1990. Let’s now compute this value exactly using our data wrangling tools from Chapter <a href="3-wrangling.html#wrangling">3</a>.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="8-confidence-intervals.html#cb239-1"></a>x_bar &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb239-2"><a href="8-confidence-intervals.html#cb239-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span>
<span id="cb239-3"><a href="8-confidence-intervals.html#cb239-3"></a>x_bar</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  mean_year
      &lt;dbl&gt;
1   1995.44</code></pre>
<p>Thus, if we’re willing to assume that <code>pennies_sample</code> is a representative sample from <em>all</em> US pennies, a “good guess” of the average year of minting of all US pennies would be 1995.44. In other words, around 1995. This should all start sounding similar to what we did previously in Chapter <a href="7-sampling.html#sampling">7</a>!</p>
<p>In Chapter <a href="7-sampling.html#sampling">7</a>, our <em>study population</em> was the bowl of <span class="math inline">\(N\)</span> = 2400 balls. Our <em>population parameter</em> was the <em>population proportion</em> of these balls that were red, denoted by <span class="math inline">\(p\)</span>. In order to estimate <span class="math inline">\(p\)</span>, we extracted a sample of 50 balls using the shovel. We then computed the relevant <em>point estimate</em>: the <em>sample proportion</em> of these 50 balls that were red, denoted mathematically by <span class="math inline">\(\widehat{p}\)</span>.</p>
<p>Here our population is <span class="math inline">\(N\)</span> = whatever the number of pennies are being used in the US, a value which we don’t know and probably never will. The population parameter of interest is now the <em>population mean</em> year of all these pennies, a value denoted mathematically by the Greek letter <span class="math inline">\(\mu\)</span> (pronounced “mu”). In order to estimate <span class="math inline">\(\mu\)</span>, we went to the bank and obtained a sample of 50 pennies and computed the relevant point estimate: the <em>sample mean</em> year of these 50 pennies, denoted mathematically by <span class="math inline">\(\overline{x}\)</span> (pronounced “x-bar”). An alternative and more intuitive notation for the sample mean is <span class="math inline">\(\widehat{\mu}\)</span>. However, this is unfortunately not as commonly used, so in this book we’ll stick with convention and always denote the sample mean as <span class="math inline">\(\overline{x}\)</span>.</p>
<p>We summarize the correspondence between the sampling bowl exercise in Chapter <a href="7-sampling.html#sampling">7</a> and our pennies exercise in Table <a href="8-confidence-intervals.html#tab:table-ch8-b">8.1</a>, which are the first two rows of the previously seen Table <a href="7-sampling.html#tab:table-ch8">7.5</a>.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:table-ch8-b">TABLE 8.1: </span>Scenarios of sampling for inference
</caption>
<thead>
<tr>
<th style="text-align:right;">
Scenario
</th>
<th style="text-align:left;">
Population parameter
</th>
<th style="text-align:left;">
Notation
</th>
<th style="text-align:left;">
Point estimate
</th>
<th style="text-align:left;">
Symbol(s)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;width: 0.5in; ">
1
</td>
<td style="text-align:left;width: 0.7in; ">
Population proportion
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(p\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Sample proportion
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{p}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
2
</td>
<td style="text-align:left;width: 0.7in; ">
Population mean
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Sample mean
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\widehat{\mu}\)</span>
</td>
</tr>
</tbody>
</table>
<p>Going back to our 50 sampled pennies in Figure <a href="8-confidence-intervals.html#fig:resampling-exercise-c">8.2</a>, the point estimate of interest is the sample mean <span class="math inline">\(\overline{x}\)</span> of 1995.44. This quantity is an <em>estimate</em> of the population mean year of <em>all</em> US pennies <span class="math inline">\(\mu\)</span>.</p>
<p>Recall that we also saw in Chapter <a href="7-sampling.html#sampling">7</a> that such estimates are prone to <em>sampling variation</em>. For example, in this particular sample in Figure <a href="8-confidence-intervals.html#fig:resampling-exercise-c">8.2</a>, we observed three pennies with the year 1999. If we sampled another 50 pennies, would we observe exactly three pennies with the year 1999 again? More than likely not. We might observe none, one, two, or maybe even all 50! The same can be said for the other 26 unique years that are represented in our sample of 50 pennies.</p>
<p>To study the effects of <em>sampling variation</em> in Chapter <a href="7-sampling.html#sampling">7</a>, we took many samples, something we could easily do with our shovel. In our case with pennies, however, how would we obtain another sample? By going to the bank and getting another roll of 50 pennies.</p>
<p>Say we’re feeling lazy, however, and don’t want to go back to the bank. How can we study the effects of sampling variation using our <em>single sample</em>? We will do so using a technique known as <em>bootstrap resampling with replacement</em>, which we now illustrate.</p>
</div>
<div id="resampling-once" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Resampling once</h3>
<p><strong>Step 1</strong>: Let’s print out identically sized slips of paper representing our 50 pennies as seen in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-1">8.4</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:tactile-resampling-1"></span>
<img src="images/sampling/pennies/tactile_simulation/1_paper_slips.png" alt="Step 1: 50 slips of paper representing 50 US pennies." width="100%" />
<p class="caption">
FIGURE 8.4: Step 1: 50 slips of paper representing 50 US pennies.
</p>
</div>
<p><strong>Step 2</strong>: Put the 50 slips of paper into a hat or tuque as seen in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-2">8.5</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:tactile-resampling-2"></span>
<img src="images/sampling/pennies/tactile_simulation/2_insert_in_hat.png" alt="Step 2: Putting 50 slips of paper in a hat." width="60%" />
<p class="caption">
FIGURE 8.5: Step 2: Putting 50 slips of paper in a hat.
</p>
</div>
<p><strong>Step 3</strong>: Mix the hat’s contents and draw one slip of paper at random as seen in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-3">8.6</a>. Record the year.</p>
<div class="figure" style="text-align: center"><span id="fig:tactile-resampling-3"></span>
<img src="images/sampling/pennies/tactile_simulation/3_draw_at_random.png" alt="Step 3: Drawing one slip of paper at random." width="60%" />
<p class="caption">
FIGURE 8.6: Step 3: Drawing one slip of paper at random.
</p>
</div>
<p><strong>Step 4</strong>: Put the slip of paper back in the hat! In other words, replace it as seen in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-4">8.7</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:tactile-resampling-4"></span>
<img src="images/sampling/pennies/tactile_simulation/4_put_it_back.png" alt="Step 4: Replacing slip of paper." width="50%" />
<p class="caption">
FIGURE 8.7: Step 4: Replacing slip of paper.
</p>
</div>
<p><strong>Step 5</strong>: Repeat Steps 3 and 4 a total of 49 more times, resulting in 50 recorded years.</p>
<p>What we just performed was a <em>resampling</em>  of the original sample of 50 pennies. We are not sampling 50 pennies from the population of all US pennies as we did in our trip to the bank. Instead, we are mimicking this act by resampling 50 pennies from our original sample of 50 pennies.</p>
<p>Now ask yourselves, why did we replace our resampled slip of paper back into the hat in Step 4? Because if we left the slip of paper out of the hat each time we performed Step 4, we would end up with the same 50 original pennies! In other words, replacing the slips of paper induces <em>sampling variation</em>.</p>
<p>Being more precise with our terminology, we just performed a <em>resampling with replacement</em> from the original sample of 50 pennies. Had we left the slip of paper out of the hat each time we performed Step 4, this would be <em>resampling without replacement</em>.</p>
<p>Let’s study our 50 resampled pennies via an exploratory data analysis. First, let’s load the data into R by manually creating a data frame <code>pennies_resample</code> of our 50 resampled values. We’ll do this using the <code>tibble()</code> command from the <code>dplyr</code> package. Note that the 50 values you resample will almost certainly not be the same as ours given the inherent randomness.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="8-confidence-intervals.html#cb241-1"></a>pennies_resample &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb241-2"><a href="8-confidence-intervals.html#cb241-2"></a>  <span class="dt">year =</span> <span class="kw">c</span>(<span class="dv">1976</span>, <span class="dv">1962</span>, <span class="dv">1976</span>, <span class="dv">1983</span>, <span class="dv">2017</span>, <span class="dv">2015</span>, <span class="dv">2015</span>, <span class="dv">1962</span>, <span class="dv">2016</span>, <span class="dv">1976</span>, </span>
<span id="cb241-3"><a href="8-confidence-intervals.html#cb241-3"></a>           <span class="dv">2006</span>, <span class="dv">1997</span>, <span class="dv">1988</span>, <span class="dv">2015</span>, <span class="dv">2015</span>, <span class="dv">1988</span>, <span class="dv">2016</span>, <span class="dv">1978</span>, <span class="dv">1979</span>, <span class="dv">1997</span>, </span>
<span id="cb241-4"><a href="8-confidence-intervals.html#cb241-4"></a>           <span class="dv">1974</span>, <span class="dv">2013</span>, <span class="dv">1978</span>, <span class="dv">2015</span>, <span class="dv">2008</span>, <span class="dv">1982</span>, <span class="dv">1986</span>, <span class="dv">1979</span>, <span class="dv">1981</span>, <span class="dv">2004</span>, </span>
<span id="cb241-5"><a href="8-confidence-intervals.html#cb241-5"></a>           <span class="dv">2000</span>, <span class="dv">1995</span>, <span class="dv">1999</span>, <span class="dv">2006</span>, <span class="dv">1979</span>, <span class="dv">2015</span>, <span class="dv">1979</span>, <span class="dv">1998</span>, <span class="dv">1981</span>, <span class="dv">2015</span>, </span>
<span id="cb241-6"><a href="8-confidence-intervals.html#cb241-6"></a>           <span class="dv">2000</span>, <span class="dv">1999</span>, <span class="dv">1988</span>, <span class="dv">2017</span>, <span class="dv">1992</span>, <span class="dv">1997</span>, <span class="dv">1990</span>, <span class="dv">1988</span>, <span class="dv">2006</span>, <span class="dv">2000</span>)</span>
<span id="cb241-7"><a href="8-confidence-intervals.html#cb241-7"></a>)</span></code></pre></div>
<p>The 50 values of <code>year</code> in <code>pennies_resample</code> represent a resample of size 50 from the original sample of 50 pennies. We display the 50 resampled pennies in Figure <a href="8-confidence-intervals.html#fig:resampling-exercise-d">8.8</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:resampling-exercise-d"></span>
<img src="images/sampling/pennies/deliverable/4.jpg" alt="50 resampled US pennies labelled." width="100%" />
<p class="caption">
FIGURE 8.8: 50 resampled US pennies labelled.
</p>
</div>
<p>Let’s compare the distribution of the numerical variable <code>year</code> of our 50 resampled pennies with the distribution of the numerical variable <code>year</code> of our original sample of 50 pennies in Figure <a href="8-confidence-intervals.html#fig:origandresample">8.9</a>.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="8-confidence-intervals.html#cb242-1"></a><span class="kw">ggplot</span>(pennies_resample, <span class="kw">aes</span>(<span class="dt">x =</span> year)) <span class="op">+</span></span>
<span id="cb242-2"><a href="8-confidence-intervals.html#cb242-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb242-3"><a href="8-confidence-intervals.html#cb242-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Resample of 50 pennies&quot;</span>)</span>
<span id="cb242-4"><a href="8-confidence-intervals.html#cb242-4"></a><span class="kw">ggplot</span>(pennies_sample, <span class="kw">aes</span>(<span class="dt">x =</span> year)) <span class="op">+</span></span>
<span id="cb242-5"><a href="8-confidence-intervals.html#cb242-5"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb242-6"><a href="8-confidence-intervals.html#cb242-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Original sample of 50 pennies&quot;</span>)</span></code></pre></div>

<div class="figure" style="text-align: center"><span id="fig:origandresample"></span>
<img src="ModernDive_files/figure-html/origandresample-1.png" alt="Comparing year in the resampled pennies_resample with the original sample pennies_sample." width="\textwidth" />
<p class="caption">
FIGURE 8.9: Comparing <code>year</code> in the resampled <code>pennies_resample</code> with the original sample <code>pennies_sample</code>.
</p>
</div>
<p>Observe in Figure <a href="8-confidence-intervals.html#fig:origandresample">8.9</a> that while the general shapes of both distributions of <code>year</code> are roughly similar, they are not identical.</p>
<p>Recall from the previous section that the sample mean of the original sample of 50 pennies from the bank was 1995.44. What about for our resample? Any guesses? Let’s have <code>dplyr</code> help us out as before:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="8-confidence-intervals.html#cb243-1"></a>pennies_resample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb243-2"><a href="8-confidence-intervals.html#cb243-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  mean_year
      &lt;dbl&gt;
1      1996</code></pre>
<p>We obtained a different mean year of 1996. This variation is induced by the resampling <em>with replacement</em> we performed earlier.</p>
<p>What if we repeated this resampling exercise many times? Would we obtain the same mean <code>year</code> each time? In other words, would our guess at the mean year of all pennies in the US in 2019 be exactly 1996 every time? Just as we did in Chapter <a href="7-sampling.html#sampling">7</a>, let’s perform this resampling activity with the help of some of our friends: 35 friends in total.</p>
</div>
<div id="student-resamples" class="section level3">
<h3><span class="header-section-number">8.1.3</span> Resampling 35 times</h3>
<p>Each of our 35 friends will repeat the same five steps:</p>
<ol style="list-style-type: decimal">
<li>Start with 50 identically sized slips of paper representing the 50 pennies.</li>
<li>Put the 50 small pieces of paper into a hat or beanie cap.</li>
<li>Mix the hat’s contents and draw one slip of paper at random. Record the year in a spreadsheet.</li>
<li>Replace the slip of paper back in the hat!</li>
<li>Repeat Steps 3 and 4 a total of 49 more times, resulting in 50 recorded years.</li>
</ol>
<p>Since we had 35 of our friends perform this task, we ended up with <span class="math inline">\(35 \cdot 50 = 1750\)</span> values. We recorded these values in a <a href="https://docs.google.com/spreadsheets/d/1y3kOsU_wDrDd5eiJbEtLeHT9L5SvpZb_TrzwFBsouk0/">shared spreadsheet</a> with 50 rows (plus a header row) and 35 columns. We display a snapshot of the first 10 rows and five columns of this shared spreadsheet in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-5">8.10</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:tactile-resampling-5"></span>
<img src="images/sampling/pennies/tactile_simulation/5_shared_spreadsheet.png" alt="Snapshot of shared spreadsheet of resampled pennies." width="70%" />
<p class="caption">
FIGURE 8.10: Snapshot of shared spreadsheet of resampled pennies.
</p>
</div>
<p>For your convenience, we’ve taken these 35 <span class="math inline">\(\cdot\)</span> 50 = 1750 values and saved them in <code>pennies_resamples</code>, a “tidy” data frame included in the <code>moderndive</code> package. We saw what it means for a data frame to be “tidy” in Subsection <a href="4-tidy.html#tidy-definition">4.2.1</a>.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="8-confidence-intervals.html#cb245-1"></a>pennies_resamples</span></code></pre></div>
<pre><code># A tibble: 1,750 × 3
# Groups:   name [35]
   replicate name     year
       &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;
 1         1 Arianna  1988
 2         1 Arianna  2002
 3         1 Arianna  2015
 4         1 Arianna  1998
 5         1 Arianna  1979
 6         1 Arianna  1971
 7         1 Arianna  1971
 8         1 Arianna  2015
 9         1 Arianna  1988
10         1 Arianna  1979
# … with 1,740 more rows</code></pre>
<p>What did each of our 35 friends obtain as the mean year? Once again, <code>dplyr</code> to the rescue! After grouping the rows by <code>name</code>, we summarize each group of 50 rows by their mean <code>year</code>:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="8-confidence-intervals.html#cb247-1"></a>resampled_means &lt;-<span class="st"> </span>pennies_resamples <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb247-2"><a href="8-confidence-intervals.html#cb247-2"></a><span class="st">  </span><span class="kw">group_by</span>(name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb247-3"><a href="8-confidence-intervals.html#cb247-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span>
<span id="cb247-4"><a href="8-confidence-intervals.html#cb247-4"></a>resampled_means</span></code></pre></div>
<pre><code># A tibble: 35 × 2
   name      mean_year
   &lt;chr&gt;         &lt;dbl&gt;
 1 Arianna     1992.5 
 2 Artemis     1996.42
 3 Bea         1996.32
 4 Camryn      1996.9 
 5 Cassandra   1991.22
 6 Cindy       1995.48
 7 Claire      1995.52
 8 Dahlia      1998.48
 9 Dan         1993.86
10 Eindra      1993.56
# … with 25 more rows</code></pre>
<p>Observe that <code>resampled_means</code> has 35 rows corresponding to the 35 means based on the 35 resamples. Furthermore, observe the variation in the 35 values in the variable <code>mean_year</code>. Let’s visualize this variation using a histogram in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-6">8.11</a>. Recall that adding the argument <code>boundary = 1990</code> to the <code>geom_histogram()</code> sets the binning structure so that one of the bin boundaries is at 1990 exactly.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="8-confidence-intervals.html#cb249-1"></a><span class="kw">ggplot</span>(resampled_means, <span class="kw">aes</span>(<span class="dt">x =</span> mean_year)) <span class="op">+</span></span>
<span id="cb249-2"><a href="8-confidence-intervals.html#cb249-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">boundary =</span> <span class="dv">1990</span>) <span class="op">+</span></span>
<span id="cb249-3"><a href="8-confidence-intervals.html#cb249-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Sampled mean year&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:tactile-resampling-6"></span>
<img src="ModernDive_files/figure-html/tactile-resampling-6-1.png" alt="Distribution of 35 sample means from 35 resamples." width="\textwidth" />
<p class="caption">
FIGURE 8.11: Distribution of 35 sample means from 35 resamples.
</p>
</div>
<p>Observe in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-6">8.11</a> that the distribution looks roughly normal and that we rarely observe sample mean years less than 1992 or greater than 2000. Also observe how the distribution is roughly centered at 1995, which is close to the sample mean of 1995.44 of the <em>original sample</em> of 50 pennies from the bank.</p>
</div>
<div id="ci-what-did-we-just-do" class="section level3">
<h3><span class="header-section-number">8.1.4</span> What did we just do?</h3>
<p>What we just demonstrated in this activity is the statistical procedure known as  <em>bootstrap resampling with replacement</em>. We used <em>resampling</em> to mimic the sampling variation we studied in Chapter <a href="7-sampling.html#sampling">7</a> on sampling. However, in this case, we did so using only a <em>single</em> sample from the population.</p>
<p>In fact, the histogram of sample means from 35 resamples in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-6">8.11</a> is called the  <em>bootstrap distribution</em>. It is an <em>approximation</em> to the <em>sampling distribution</em> of the sample mean, in the sense that both distributions will have a similar shape and similar spread. In fact in the upcoming Section <a href="8-confidence-intervals.html#ci-conclusion">8.7</a>, we’ll show you that this is the case. Using this bootstrap distribution, we can study the effect of sampling variation on our estimates. In particular, we’ll study the typical “error” of our estimates, known as the  <em>standard error</em>.</p>
<p>In Section <a href="8-confidence-intervals.html#resampling-simulation">8.2</a> we’ll mimic our tactile resampling activity virtually on the computer, allowing us to quickly perform the resampling many more than 35 times. In Section <a href="8-confidence-intervals.html#ci-build-up">8.3</a> we’ll define the statistical concept of a <em>confidence interval</em>, which builds off the concept of bootstrap distributions.</p>
<p>In Section <a href="8-confidence-intervals.html#bootstrap-process">8.4</a>, we’ll construct confidence intervals using the <code>dplyr</code> package, as well as a new package: the <code>infer</code> package for “tidy” and transparent statistical inference. We’ll introduce the “tidy” statistical inference framework that was the motivation for the <code>infer</code> package pipeline. The <code>infer</code> package will be the driving package throughout the rest of this book.</p>
<p>As we did in Chapter <a href="7-sampling.html#sampling">7</a>, we’ll tie all these ideas together with a real-life case study in Section <a href="8-confidence-intervals.html#case-study-two-prop-ci">8.6</a>. This time we’ll look at data from an experiment about yawning from the US television show <em>Mythbusters</em>.</p>
</div>
</div>
<div id="resampling-simulation" class="section level2">
<h2><span class="header-section-number">8.2</span> Computer simulation of resampling</h2>
<p>Let’s now mimic our tactile resampling activity virtually with a computer.</p>
<div id="virtually-resampling-once" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Virtually resampling once</h3>
<p>First, let’s perform the virtual analog of resampling once. Recall that the <code>pennies_sample</code> data frame included in the <code>moderndive</code> package contains the years of our original sample of 50 pennies from the bank. Furthermore, recall in Chapter <a href="7-sampling.html#sampling">7</a> on sampling that we used the <code>rep_sample_n()</code> function as a virtual shovel to sample balls from our virtual bowl of 2400 balls as follows:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="8-confidence-intervals.html#cb250-1"></a>virtual_shovel &lt;-<span class="st"> </span>bowl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb250-2"><a href="8-confidence-intervals.html#cb250-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>)</span></code></pre></div>
<p>Let’s modify this code to perform the resampling with replacement of the 50 slips of paper representing our original sample 50 pennies:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="8-confidence-intervals.html#cb251-1"></a>virtual_resample &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb251-2"><a href="8-confidence-intervals.html#cb251-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Observe how we explicitly set the <code>replace</code> argument to <code>TRUE</code> in order to tell <code>rep_sample_n()</code> that we would like to sample pennies  <em>with</em> replacement. Had we not set <code>replace = TRUE</code>, the function would’ve assumed the default value of <code>FALSE</code> and hence done resampling <em>without</em> replacement. Additionally, since we didn’t specify the number of replicates via the <code>reps</code> argument, the function assumes the default of one replicate <code>reps = 1</code>. Lastly, observe also that the <code>size</code> argument is set to match the original sample size of 50 pennies.</p>
<p>Let’s look at only the first 10 out of 50 rows of <code>virtual_resample</code>:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="8-confidence-intervals.html#cb252-1"></a>virtual_resample</span></code></pre></div>
<pre><code># A tibble: 50 × 3
# Groups:   replicate [1]
   replicate    ID  year
       &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1         1    37  1962
 2         1     1  2002
 3         1    45  1997
 4         1    28  2006
 5         1    50  2017
 6         1    10  2000
 7         1    16  2015
 8         1    47  1982
 9         1    23  1998
10         1    44  2015
# … with 40 more rows</code></pre>
<p>The <code>replicate</code> variable only takes on the value of 1 corresponding to us only having <code>reps = 1</code>, the <code>ID</code> variable indicates which of the 50 pennies from <code>pennies_sample</code> was resampled, and <code>year</code> denotes the year of minting. Let’s now compute the mean <code>year</code> in our virtual resample of size 50 using data wrangling functions included in the <code>dplyr</code> package:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="8-confidence-intervals.html#cb254-1"></a>virtual_resample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb254-2"><a href="8-confidence-intervals.html#cb254-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">resample_mean =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<pre><code># A tibble: 1 × 2
  replicate resample_mean
      &lt;int&gt;         &lt;dbl&gt;
1         1          1996</code></pre>
<p>As we saw when we did our tactile resampling exercise, the resulting mean year is different than the mean year of our 50 originally sampled pennies of 1995.44.</p>
<!--
v2 TODO: Add discussion on why tidyverse opts for 3 sigfigs. For ex:

Note that tibbles will try to print as pretty as possible which may result in
numbers being rounded. In this chapter, we have set the default number of values
to be printed to six in tibbles with `options(pillar.sigfig = 6)`.

-->
</div>
<div id="bootstrap-35-replicates" class="section level3">
<h3><span class="header-section-number">8.2.2</span> Virtually resampling 35 times</h3>
<p>Let’s now perform the virtual analog of our 35 friends’ resampling. Using these results, we’ll be able to study the variability in the sample means from 35 resamples of size 50. Let’s first add a <code>reps = 35</code> argument to <code>rep_sample_n()</code>  to indicate we would like 35 replicates. Thus, we want to repeat the resampling with the replacement of 50 pennies 35 times.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="8-confidence-intervals.html#cb256-1"></a>virtual_resamples &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-2"><a href="8-confidence-intervals.html#cb256-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">35</span>)</span>
<span id="cb256-3"><a href="8-confidence-intervals.html#cb256-3"></a>virtual_resamples</span></code></pre></div>
<pre><code># A tibble: 1,750 × 3
# Groups:   replicate [35]
   replicate    ID  year
       &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1         1    21  1981
 2         1    34  1985
 3         1     4  1988
 4         1    11  1994
 5         1    26  1979
 6         1     8  1996
 7         1    19  1983
 8         1    21  1981
 9         1    49  2006
10         1     2  1986
# … with 1,740 more rows</code></pre>
<p>The resulting <code>virtual_resamples</code> data frame has 35 <span class="math inline">\(\cdot\)</span> 50 = 1750 rows corresponding to 35 resamples of 50 pennies. Let’s now compute the resulting 35 sample means using the same <code>dplyr</code> code as we did in the previous section, but this time adding a <code>group_by(replicate)</code>:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="8-confidence-intervals.html#cb258-1"></a>virtual_resampled_means &lt;-<span class="st"> </span>virtual_resamples <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb258-2"><a href="8-confidence-intervals.html#cb258-2"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb258-3"><a href="8-confidence-intervals.html#cb258-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span>
<span id="cb258-4"><a href="8-confidence-intervals.html#cb258-4"></a>virtual_resampled_means</span></code></pre></div>
<pre><code># A tibble: 35 × 2
   replicate mean_year
       &lt;int&gt;     &lt;dbl&gt;
 1         1   1995.58
 2         2   1999.74
 3         3   1993.7 
 4         4   1997.1 
 5         5   1999.42
 6         6   1995.12
 7         7   1994.94
 8         8   1997.78
 9         9   1991.26
10        10   1996.88
# … with 25 more rows</code></pre>
<p>Observe that <code>virtual_resampled_means</code> has 35 rows, corresponding to the 35 resampled means. Furthermore, observe that the values of <code>mean_year</code> vary. Let’s visualize this variation using a histogram in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-7">8.12</a>.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="8-confidence-intervals.html#cb260-1"></a><span class="kw">ggplot</span>(virtual_resampled_means, <span class="kw">aes</span>(<span class="dt">x =</span> mean_year)) <span class="op">+</span></span>
<span id="cb260-2"><a href="8-confidence-intervals.html#cb260-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">boundary =</span> <span class="dv">1990</span>) <span class="op">+</span></span>
<span id="cb260-3"><a href="8-confidence-intervals.html#cb260-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Resample mean year&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:tactile-resampling-7"></span>
<img src="ModernDive_files/figure-html/tactile-resampling-7-1.png" alt="Distribution of 35 sample means from 35 resamples." width="\textwidth" />
<p class="caption">
FIGURE 8.12: Distribution of 35 sample means from 35 resamples.
</p>
</div>
<p>Let’s compare our virtually constructed bootstrap distribution with the one our 35 friends constructed via our tactile resampling exercise in Figure <a href="8-confidence-intervals.html#fig:orig-and-resample-means">8.13</a>. Observe how they are somewhat similar, but not identical.</p>
<div class="figure" style="text-align: center"><span id="fig:orig-and-resample-means"></span>
<img src="ModernDive_files/figure-html/orig-and-resample-means-1.png" alt="Comparing distributions of means from resamples." width="\textwidth" />
<p class="caption">
FIGURE 8.13: Comparing distributions of means from resamples.
</p>
</div>
<p>Recall that in the “resampling with replacement” scenario we are illustrating here, both of these histograms have a special name: the <em>bootstrap distribution of the sample mean</em>. Furthermore, recall they are an approximation to the <em>sampling distribution</em> of the sample mean, a concept you saw in Chapter <a href="7-sampling.html#sampling">7</a> on sampling. These distributions allow us to study the effect of sampling variation on our estimates of the true population mean, in this case the true mean year for <em>all</em> US pennies. However, unlike in Chapter <a href="7-sampling.html#sampling">7</a> where we took multiple samples (something one would never do in practice), bootstrap distributions are constructed by taking multiple resamples from a <em>single</em> sample: in this case, the 50 original pennies from the bank.</p>
</div>
<div id="bootstrap-1000-replicates" class="section level3">
<h3><span class="header-section-number">8.2.3</span> Virtually resampling 1000 times</h3>
<p>Remember that one of the goals of resampling with replacement is to construct the bootstrap distribution, which is an approximation of the sampling distribution. However, the bootstrap distribution in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-7">8.12</a> is based only on 35 resamples and hence looks a little coarse. Let’s increase the number of resamples to 1000, so that we can hopefully better see the shape and the variability between different resamples.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="8-confidence-intervals.html#cb261-1"></a><span class="co"># Repeat resampling 1000 times</span></span>
<span id="cb261-2"><a href="8-confidence-intervals.html#cb261-2"></a>virtual_resamples &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb261-3"><a href="8-confidence-intervals.html#cb261-3"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)</span>
<span id="cb261-4"><a href="8-confidence-intervals.html#cb261-4"></a></span>
<span id="cb261-5"><a href="8-confidence-intervals.html#cb261-5"></a><span class="co"># Compute 1000 sample means</span></span>
<span id="cb261-6"><a href="8-confidence-intervals.html#cb261-6"></a>virtual_resampled_means &lt;-<span class="st"> </span>virtual_resamples <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb261-7"><a href="8-confidence-intervals.html#cb261-7"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb261-8"><a href="8-confidence-intervals.html#cb261-8"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<p>However, in the interest of brevity, going forward let’s combine these two operations into a single chain of pipe (<code>%&gt;%</code>) operators:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="8-confidence-intervals.html#cb262-1"></a>virtual_resampled_means &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb262-2"><a href="8-confidence-intervals.html#cb262-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb262-3"><a href="8-confidence-intervals.html#cb262-3"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb262-4"><a href="8-confidence-intervals.html#cb262-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span>
<span id="cb262-5"><a href="8-confidence-intervals.html#cb262-5"></a>virtual_resampled_means</span></code></pre></div>
<pre><code># A tibble: 1,000 × 2
   replicate mean_year
       &lt;int&gt;     &lt;dbl&gt;
 1         1   1992.6 
 2         2   1994.78
 3         3   1994.74
 4         4   1997.88
 5         5   1990   
 6         6   1999.48
 7         7   1990.26
 8         8   1993.2 
 9         9   1994.88
10        10   1996.3 
# … with 990 more rows</code></pre>
<p>In Figure <a href="8-confidence-intervals.html#fig:one-thousand-sample-means">8.14</a> let’s visualize the bootstrap distribution of these 1000 means based on 1000 virtual resamples:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="8-confidence-intervals.html#cb264-1"></a><span class="kw">ggplot</span>(virtual_resampled_means, <span class="kw">aes</span>(<span class="dt">x =</span> mean_year)) <span class="op">+</span></span>
<span id="cb264-2"><a href="8-confidence-intervals.html#cb264-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">boundary =</span> <span class="dv">1990</span>) <span class="op">+</span></span>
<span id="cb264-3"><a href="8-confidence-intervals.html#cb264-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;sample mean&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:one-thousand-sample-means"></span>
<img src="ModernDive_files/figure-html/one-thousand-sample-means-1.png" alt="Bootstrap resampling distribution based on 1000 resamples." width="\textwidth" />
<p class="caption">
FIGURE 8.14: Bootstrap resampling distribution based on 1000 resamples.
</p>
</div>
<p>Note here that the bell shape is starting to become much more apparent. We now have a general sense for the range of values that the sample mean may take on. But where is this histogram centered? Let’s compute the mean of the 1000 resample means:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="8-confidence-intervals.html#cb265-1"></a>virtual_resampled_means <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb265-2"><a href="8-confidence-intervals.html#cb265-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_of_means =</span> <span class="kw">mean</span>(mean_year))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  mean_of_means
          &lt;dbl&gt;
1       1995.36</code></pre>
<p>The mean of these 1000 means is 1995.36, which is quite close to the mean of our original sample of 50 pennies of 1995.44. This is the case since each of the 1000 resamples is based on the original sample of 50 pennies.</p>
<p>Congratulations! You’ve just constructed your first bootstrap distribution! In the next section, you’ll see how to use this bootstrap distribution to construct <em>confidence intervals</em>.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.1)</strong> What is the chief difference between a bootstrap distribution and a sampling distribution?</p>
<p><strong>(LC8.2)</strong> Looking at the bootstrap distribution for the sample mean in Figure <a href="8-confidence-intervals.html#fig:one-thousand-sample-means">8.14</a>, between what two values would you say <em>most</em> values lie?</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="ci-build-up" class="section level2">
<h2><span class="header-section-number">8.3</span> Understanding confidence intervals</h2>
<p>Let’s start this section with an analogy involving fishing. Say you are trying to catch a fish. On the one hand, you could use a spear, while on the other you could use a net. Using the net will probably allow you to catch more fish!</p>
<p>Now think back to our pennies exercise where you are trying to estimate the true population mean year <span class="math inline">\(\mu\)</span> of <em>all</em> US pennies.  Think of the value of <span class="math inline">\(\mu\)</span> as a fish.</p>
<p>On the one hand, we could use the appropriate <em>point estimate/sample statistic</em> to estimate <span class="math inline">\(\mu\)</span>, which we saw in Table <a href="8-confidence-intervals.html#tab:table-ch8-b">8.1</a> is the sample mean <span class="math inline">\(\overline{x}\)</span>. Based on our sample of 50 pennies from the bank, the sample mean was 1995.44. Think of using this value as “fishing with a spear.”</p>
<p>What would “fishing with a net” correspond to? Look at the bootstrap distribution in Figure <a href="8-confidence-intervals.html#fig:one-thousand-sample-means">8.14</a> once more. Between which two years would you say that “most” sample means lie? While this question is somewhat subjective, saying that most sample means lie between 1992 and 2000 would not be unreasonable. Think of this interval as the “net.”</p>
<p>What we’ve just illustrated is the concept of a <em>confidence interval</em>, which we’ll abbreviate with “CI” throughout this book. As opposed to a point estimate/sample statistic that estimates the value of an unknown population parameter with a single value, a <em>confidence interval</em>  gives what can be interpreted as a range of plausible values. Going back to our analogy, point estimates/sample statistics can be thought of as spears, whereas confidence intervals can be thought of as nets.</p>
<!--
Point estimate           |  Confidence interval
:-------------------------:|:-------------------------:
![](images/shutterstock/shutterstock_149730074_cropped.jpg){ height=2.5in } |  ![](images/shutterstock/shutterstock_176684936.jpg){ height=2.5in }
-->
<div class="figure" style="text-align: center"><span id="fig:point-estimate-vs-conf-int"></span>
<img src="images/shutterstock/point_estimate_vs_conf_int.png" alt="Analogy of difference between point estimates and confidence intervals." width="100%" />
<p class="caption">
FIGURE 8.15: Analogy of difference between point estimates and confidence intervals.
</p>
</div>
<p>Our proposed interval of 1992 to 2000 was constructed by eye and was thus somewhat subjective. We now introduce two methods for constructing such intervals in a more exact fashion: the <em>percentile method</em> and the <em>standard error method</em>.</p>
<p>Both methods for confidence interval construction share some commonalities. First, they are both constructed from a bootstrap distribution, as you constructed in Subsection <a href="8-confidence-intervals.html#bootstrap-1000-replicates">8.2.3</a> and visualized in Figure <a href="8-confidence-intervals.html#fig:one-thousand-sample-means">8.14</a>.</p>
<p>Second, they both require you to specify the  <em>confidence level</em>. Commonly used confidence levels include 90%, 95%, and 99%. All other things being equal, higher confidence levels correspond to wider confidence intervals, and lower confidence levels correspond to narrower confidence intervals. In this book, we’ll be mostly using 95% and hence constructing “95% confidence intervals for <span class="math inline">\(\mu\)</span>” for our pennies activity.</p>
<div id="percentile-method" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Percentile method</h3>
<p>One method to construct a confidence interval is to use the middle 95% of values of the bootstrap distribution. We can do this by computing the 2.5th and 97.5th percentiles, which are 1991.059 and 1999.283, respectively. This is known as the <em>percentile method</em> for constructing confidence intervals.</p>
<p>For now, let’s focus only on the concepts behind a percentile method constructed confidence interval; we’ll show you the code that computes these values in the next section.</p>
<p>Let’s mark these percentiles on the bootstrap distribution with vertical lines in Figure <a href="8-confidence-intervals.html#fig:percentile-method">8.16</a>. About 95% of the <code>mean_year</code> variable values in <code>virtual_resampled_means</code> fall between 1991.059 and 1999.283, with 2.5% to the left of the leftmost line and 2.5% to the right of the rightmost line.</p>

<div class="figure" style="text-align: center"><span id="fig:percentile-method"></span>
<img src="ModernDive_files/figure-html/percentile-method-1.png" alt="Percentile method 95% confidence interval. Interval endpoints marked by vertical lines." width="\textwidth" />
<p class="caption">
FIGURE 8.16: Percentile method 95% confidence interval. Interval endpoints marked by vertical lines.
</p>
</div>
</div>
<div id="se-method" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Standard error method</h3>
<p>Recall in Appendix <a href="A-appendixA.html#appendix-normal-curve">A.2</a>, we saw that if a numerical variable follows a normal distribution, or, in other words, the histogram of this variable is bell-shaped, then roughly 95% of values fall between <span class="math inline">\(\pm\)</span> 1.96 standard deviations of the mean. Given that our bootstrap distribution based on 1000 resamples with replacement in Figure <a href="8-confidence-intervals.html#fig:one-thousand-sample-means">8.14</a> is normally shaped, let’s use this fact about normal distributions to construct a confidence interval in a different way.</p>
<p>First, recall the bootstrap distribution has a mean equal to 1995.36. This value almost coincides exactly with the value of the sample mean <span class="math inline">\(\overline{x}\)</span> of our original 50 pennies of 1995.44. Second, let’s compute the standard deviation of the bootstrap distribution using the values of <code>mean_year</code> in the <code>virtual_resampled_means</code> data frame:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="8-confidence-intervals.html#cb267-1"></a>virtual_resampled_means <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb267-2"><a href="8-confidence-intervals.html#cb267-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">SE =</span> <span class="kw">sd</span>(mean_year))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
       SE
    &lt;dbl&gt;
1 2.15466</code></pre>
<p>What is this value? Recall that the bootstrap distribution is an approximation to the sampling distribution. Recall also that the standard deviation of a sampling distribution has a special name: the <em>standard error</em>. Putting these two facts together, we can say that 2.155 is an approximation of the standard error of <span class="math inline">\(\overline{x}\)</span>.</p>
<p>Thus, using our 95% rule of thumb about normal distributions from Appendix <a href="A-appendixA.html#appendix-normal-curve">A.2</a>, we can use the following formula to determine the lower and upper endpoints of a 95% confidence interval for <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\overline{x} \pm 1.96 \cdot SE &amp;= (\overline{x} - 1.96 \cdot SE, \overline{x} + 1.96 \cdot SE)\\
&amp;= (1995.44 - 1.96 \cdot 2.15, 1995.44 + 1.96 \cdot 2.15)\\
&amp;= (1991.15, 1999.73)
\end{aligned}
\]</span></p>
<p>Let’s now add the SE method confidence interval with dashed lines in Figure <a href="8-confidence-intervals.html#fig:percentile-and-se-method">8.17</a>.</p>

<div class="figure" style="text-align: center"><span id="fig:percentile-and-se-method"></span>
<img src="ModernDive_files/figure-html/percentile-and-se-method-1.png" alt="Comparing two 95% confidence interval methods." width="\textwidth" />
<p class="caption">
FIGURE 8.17: Comparing two 95% confidence interval methods.
</p>
</div>
<p>We see that both methods produce nearly identical 95% confidence intervals for <span class="math inline">\(\mu\)</span> with the percentile method yielding <span class="math inline">\((1991.06, 1999.28)\)</span> while the standard error method produces <span class="math inline">\((1991.22, 1999.66)\)</span>. However, recall that we can only use the standard error rule when the bootstrap distribution is roughly normally shaped.</p>
<p>Now that we’ve introduced the concept of confidence intervals and laid out the intuition behind two methods for constructing them, let’s explore the code that allows us to construct them.</p>
<!--
v2 TODO: Consider adding:

The variability of the sampling distribution may be approximated by the variability of the resampling distribution. Traditional theory-based methodologies for inference also have formulas for standard errors, assuming some conditions are met.

This is done by using the formula where $\bar{x}$ is our original sample mean and $SE$ stands for **standard error** and corresponds to the standard deviation of the resampling distribution.  The value of $multiplier$ here is the appropriate percentile of the standard normal distribution. We'll go into this further in Section \@ref(ci-conclusion).

These are automatically calculated when `level` is provided with `level = 0.95` being the default. (95% of the values in a standard normal distribution fall within 1.96 standard deviations of the mean, so $multiplier = 1.96$ for `level = 0.95`, for example.)  As mentioned, this formula assumes that the bootstrap distribution is symmetric and bell-shaped. This is often the case with bootstrap distributions, especially those in which the original distribution of the sample is not highly skewed.

This $\bar{x} \pm (multiplier * SE)$ formula is implemented in the `get_ci()` function as shown with our pennies problem using the bootstrap distribution's variability as an approximation for the sampling distribution's variability. We'll see more on this approximation shortly.

Note that the center of the confidence interval (the `point_estimate`) must be provided for the standard error confidence interval.


```r
standard_error_ci <- bootstrap_distribution %>% 
  get_ci(type = "se", point_estimate = x_bar)
standard_error_ci
```
-->
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.3)</strong> What condition about the bootstrap distribution must be met for us to be able to construct confidence intervals using the standard error method?</p>
<p><strong>(LC8.4)</strong> Say we wanted to construct a 68% confidence interval instead of a 95% confidence interval for <span class="math inline">\(\mu\)</span>. Describe what changes are needed to make this happen. Hint: we suggest you look at Appendix <a href="A-appendixA.html#appendix-normal-curve">A.2</a> on the normal distribution.</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="bootstrap-process" class="section level2">
<h2><span class="header-section-number">8.4</span> Constructing confidence intervals</h2>
<p>Recall that the process of resampling with replacement we performed by hand in Section <a href="8-confidence-intervals.html#resampling-tactile">8.1</a> and virtually in Section <a href="8-confidence-intervals.html#resampling-simulation">8.2</a> is known as  <em>bootstrapping</em>. The term bootstrapping originates in the expression of “pulling oneself up by their bootstraps,” meaning to <a href="https://en.wiktionary.org/wiki/pull_oneself_up_by_one%27s_bootstraps">“succeed only by one’s own efforts or abilities.”</a></p>
<p>From a statistical perspective, bootstrapping alludes to succeeding in being able to study the effects of sampling variation on estimates from the “effort” of a single sample. Or more precisely,  it refers to constructing an approximation to the sampling distribution using only one sample.</p>
<p>To perform this resampling with replacement virtually in Section <a href="8-confidence-intervals.html#resampling-simulation">8.2</a>, we used the <code>rep_sample_n()</code> function, making sure that the size of the resamples matched the original sample size of 50. In this section, we’ll build off these ideas to construct confidence intervals using a new package: the <code>infer</code> package for “tidy” and transparent statistical inference.</p>
<div id="original-workflow" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Original workflow</h3>
<p>Recall that in Section <a href="8-confidence-intervals.html#resampling-simulation">8.2</a>, we virtually performed bootstrap resampling with replacement to construct bootstrap distributions. Such distributions are approximations to the sampling distributions we saw in Chapter <a href="7-sampling.html#sampling">7</a>, but are constructed using only a single sample. Let’s revisit the original workflow using the <code>%&gt;%</code> pipe operator.</p>
<p>First, we used the <code>rep_sample_n()</code> function to resample <code>size = 50</code> pennies with replacement from the original sample of 50 pennies in <code>pennies_sample</code> by setting <code>replace = TRUE</code>. Furthermore, we repeated this resampling 1000 times by setting <code>reps = 1000</code>:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="8-confidence-intervals.html#cb269-1"></a>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb269-2"><a href="8-confidence-intervals.html#cb269-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)</span></code></pre></div>
<p>Second, since for each of our 1000 resamples of size 50, we wanted to compute a separate sample mean, we used the <code>dplyr</code> verb <code>group_by()</code> to group observations/rows together by the <code>replicate</code> variable…</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="8-confidence-intervals.html#cb270-1"></a>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb270-2"><a href="8-confidence-intervals.html#cb270-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb270-3"><a href="8-confidence-intervals.html#cb270-3"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) </span></code></pre></div>
<p>… followed by using <code>summarize()</code> to compute the sample <code>mean()</code> year for each <code>replicate</code> group:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="8-confidence-intervals.html#cb271-1"></a>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-2"><a href="8-confidence-intervals.html#cb271-2"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">reps =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-3"><a href="8-confidence-intervals.html#cb271-3"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-4"><a href="8-confidence-intervals.html#cb271-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_year =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<p>For this simple case, we can get by with using the <code>rep_sample_n()</code> function and a couple of <code>dplyr</code> verbs to construct the bootstrap distribution. However, using only <code>dplyr</code> verbs only provides us with a limited set of tools. For more complicated situations, we’ll need a little more firepower. Let’s repeat this using the <code>infer</code> package.</p>
</div>
<div id="infer-workflow" class="section level3">
<h3><span class="header-section-number">8.4.2</span> <code>infer</code> package workflow</h3>
<!--
v2 TODO: Using infer to compute observed point estimate

1. Showing `dplyr` code to compute observed point estimate
1. Showing `infer` verbs to compute observed point estimate. i.e. no generate()
step.
1. Only after these two steps, showing `infer` verb pipeline to construct
bootstrap distribution of point estimate. i.e. with generate() and showing
diagram.
-->
<p>The <code>infer</code> package is an R package for statistical inference. It makes efficient use of the <code>%&gt;%</code> pipe operator we introduced in Section <a href="3-wrangling.html#piping">3.1</a> to spell out the sequence of steps necessary to perform statistical inference in a “tidy” and transparent fashion. Furthermore, just as the <code>dplyr</code> package provides functions with verb-like names to perform data wrangling, the <code>infer</code> package provides functions with intuitive verb-like names to perform statistical inference.</p>
<p>Let’s go back to our pennies. Previously, we computed the value of the sample mean <span class="math inline">\(\overline{x}\)</span> using the <code>dplyr</code> function <code>summarize()</code>:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="8-confidence-intervals.html#cb272-1"></a>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb272-2"><a href="8-confidence-intervals.html#cb272-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">stat =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
<p>We’ll see that we can also do this using <code>infer</code> functions <code>specify()</code> and <code>calculate()</code>: </p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="8-confidence-intervals.html#cb273-1"></a>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb273-2"><a href="8-confidence-intervals.html#cb273-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb273-3"><a href="8-confidence-intervals.html#cb273-3"></a><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<p>You might be asking yourself: “Isn’t the <code>infer</code> code longer? Why would I use that code?”. While not immediately apparent, you’ll see that there are three chief benefits to the <code>infer</code> workflow as opposed to the <code>dplyr</code> workflow.</p>
<p>First, the <code>infer</code> verb names better align with the overall resampling framework you need to understand to construct confidence intervals and to conduct hypothesis tests (in Chapter <a href="9-hypothesis-testing.html#hypothesis-testing">9</a>). We’ll see flowchart diagrams of this framework in the upcoming Figure <a href="8-confidence-intervals.html#fig:infer-workflow-ci">8.23</a> and in Chapter <a href="9-hypothesis-testing.html#hypothesis-testing">9</a> with Figure <a href="9-hypothesis-testing.html#fig:htdowney">9.14</a>.</p>
<p>Second, you can jump back and forth seamlessly between confidence intervals and hypothesis testing with minimal changes to your code. This will become apparent in Subsection <a href="9-hypothesis-testing.html#comparing-infer-workflows">9.3.2</a> when we’ll compare the <code>infer</code> code for both of these inferential methods.</p>
<p>Third, the <code>infer</code> workflow is much simpler for conducting inference when you have <em>more than one variable</em>. We’ll see two such situations. We’ll first see situations of <em>two-sample</em> inference where the sample data is collected from two groups, such as in Section <a href="8-confidence-intervals.html#case-study-two-prop-ci">8.6</a> where we study the contagiousness of yawning and in Section <a href="9-hypothesis-testing.html#ht-activity">9.1</a> where we compare promotion rates of two groups at banks in the 1970s. Then in Section <a href="10-inference-for-regression.html#infer-regression">10.4</a>, we’ll see situations of <em>inference for regression</em> using the regression models you fit in Chapter <a href="5-regression.html#regression">5</a>.</p>
<p>Let’s now illustrate the sequence of verbs necessary to construct a confidence interval for <span class="math inline">\(\mu\)</span>, the population mean year of minting of all US pennies in 2019.</p>
<div id="specify-variables" class="section level4 unnumbered">
<h4>1. <code>specify</code> variables</h4>
<div class="figure" style="text-align: center"><span id="fig:infer-specify"></span>
<img src="images/flowcharts/infer/specify.png" alt="Diagram of the specify() verb." width="20%" height="20%" />
<p class="caption">
FIGURE 8.18: Diagram of the specify() verb.
</p>
</div>
<p>As shown in Figure <a href="8-confidence-intervals.html#fig:infer-specify">8.18</a>, the <code>specify()</code>  function is used to choose which variables in a data frame will be the focus of our statistical inference. We do this by <code>specify</code>ing the <code>response</code> argument. For example, in our <code>pennies_sample</code> data frame of the 50 pennies sampled from the bank, the variable of interest is <code>year</code>:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="8-confidence-intervals.html#cb274-1"></a>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb274-2"><a href="8-confidence-intervals.html#cb274-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> year)</span></code></pre></div>
<pre><code>Response: year (numeric)
# A tibble: 50 × 1
    year
   &lt;dbl&gt;
 1  2002
 2  1986
 3  2017
 4  1988
 5  2008
 6  1983
 7  2008
 8  1996
 9  2004
10  2000
# … with 40 more rows</code></pre>
<p>Notice how the data itself doesn’t change, but the <code>Response: year (numeric)</code> <em>meta-data</em> does. This is similar to how the <code>group_by()</code> verb from <code>dplyr</code> doesn’t change the data, but only adds “grouping” meta-data, as we saw in Section <a href="3-wrangling.html#groupby">3.4</a>.</p>
<p>We can also specify which variables will be the focus of our statistical inference using a <code>formula = y ~ x</code>. This is the same formula notation you saw in Chapters <a href="5-regression.html#regression">5</a> and <a href="6-multiple-regression.html#multiple-regression">6</a> on regression models: the response variable <code>y</code> is separated from the explanatory variable <code>x</code> by a <code>~</code> (“tilde”). The following use of <code>specify()</code> with the <code>formula</code> argument yields the same result seen previously:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="8-confidence-intervals.html#cb276-1"></a>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb276-2"><a href="8-confidence-intervals.html#cb276-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> year <span class="op">~</span><span class="st"> </span><span class="ot">NULL</span>)</span></code></pre></div>
<p>Since in the case of pennies we only have a response variable and no explanatory variable of interest, we set the <code>x</code> on the right-hand side of the <code>~</code> to be <code>NULL</code>.</p>
<p>While in the case of the pennies either specification works just fine, we’ll see examples later on where the <code>formula</code> specification is simpler. In particular, this comes up in the upcoming Section <a href="8-confidence-intervals.html#case-study-two-prop-ci">8.6</a> on comparing two proportions and Section <a href="10-inference-for-regression.html#infer-regression">10.4</a> on inference for regression.</p>
</div>
<div id="generate-replicates" class="section level4 unnumbered">
<h4>2. <code>generate</code> replicates</h4>
<div class="figure" style="text-align: center"><span id="fig:infer-generate"></span>
<img src="images/flowcharts/infer/generate.png" alt="Diagram of generate() replicates." width="60%" height="60%" />
<p class="caption">
FIGURE 8.19: Diagram of generate() replicates.
</p>
</div>
<p>After we <code>specify()</code> the variables of interest, we pipe the results into the <code>generate()</code> function to generate replicates. Figure <a href="8-confidence-intervals.html#fig:infer-generate">8.19</a> shows how this is combined with <code>specify()</code> to start the pipeline. In other words, repeat the resampling process a large number of times. Recall in Sections <a href="8-confidence-intervals.html#bootstrap-35-replicates">8.2.2</a> and <a href="8-confidence-intervals.html#bootstrap-1000-replicates">8.2.3</a> we did this 35 and 1000 times.</p>
<p>The <code>generate()</code>  function’s first argument is <code>reps</code>, which sets the number of replicates we would like to generate. Since we want to resample the 50 pennies in <code>pennies_sample</code> with replacement 1000 times, we set <code>reps = 1000</code>. The second argument <code>type</code> determines the type of computer simulation we’d like to perform. We set this to <code>type = "bootstrap"</code> indicating that we want to perform bootstrap resampling. You’ll see different options for <code>type</code> in Chapter <a href="9-hypothesis-testing.html#hypothesis-testing">9</a>.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="8-confidence-intervals.html#cb277-1"></a>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb277-2"><a href="8-confidence-intervals.html#cb277-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb277-3"><a href="8-confidence-intervals.html#cb277-3"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">type =</span> <span class="st">&quot;bootstrap&quot;</span>)</span></code></pre></div>
<pre><code>Response: year (numeric)
# A tibble: 50,000 × 2
# Groups:   replicate [1,000]
   replicate  year
       &lt;int&gt; &lt;dbl&gt;
 1         1  1981
 2         1  1988
 3         1  2006
 4         1  2016
 5         1  2002
 6         1  1985
 7         1  1979
 8         1  2000
 9         1  2006
10         1  2016
# … with 49,990 more rows</code></pre>
<p>Observe that the resulting data frame has 50,000 rows. This is because we performed resampling of 50 pennies with replacement 1000 times and 50,000 = 50 <span class="math inline">\(\cdot\)</span> 1000.</p>
<p>The variable <code>replicate</code> indicates which resample each row belongs to. So it has the value <code>1</code> 50 times, the value <code>2</code> 50 times, all the way through to the value <code>1000</code> 50 times. The default value of the <code>type</code> argument is <code>"bootstrap"</code> in this scenario, so if the last line was written as <code>generate(reps = 1000)</code>, we’d obtain the same results.</p>
<p><strong>Comparing with original workflow</strong>: Note that the steps of the <code>infer</code> workflow so far produce the same results as the original workflow using the <code>rep_sample_n()</code> function we saw earlier. In other words, the following two code chunks produce similar results:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="8-confidence-intervals.html#cb279-1"></a><span class="co"># infer workflow:                   # Original workflow:</span></span>
<span id="cb279-2"><a href="8-confidence-intervals.html#cb279-2"></a>pennies_sample <span class="op">%&gt;%</span><span class="st">                  </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb279-3"><a href="8-confidence-intervals.html#cb279-3"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> year) <span class="op">%&gt;%</span><span class="st">        </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, </span>
<span id="cb279-4"><a href="8-confidence-intervals.html#cb279-4"></a>  <span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>)                            <span class="dt">reps =</span> <span class="dv">1000</span>)              </span></code></pre></div>
</div>
<div id="calculate-summary-statistics" class="section level4 unnumbered">
<h4>3. <code>calculate</code> summary statistics</h4>
<div class="figure" style="text-align: center"><span id="fig:infer-calculate"></span>
<img src="images/flowcharts/infer/calculate.png" alt="Diagram of calculate() summary statistics." width="80%" height="80%" />
<p class="caption">
FIGURE 8.20: Diagram of calculate() summary statistics.
</p>
</div>
<p>After we <code>generate()</code> many replicates of bootstrap resampling with replacement, we next want to summarize each of the 1000 resamples of size 50 to a single sample statistic value. As seen in the diagram, the <code>calculate()</code>  function does this.</p>
<p>In our case, we want to calculate the mean <code>year</code> for each bootstrap resample of size 50. To do so, we set the <code>stat</code> argument to <code>"mean"</code>. You can also set the <code>stat</code> argument to a variety of other common summary statistics, like <code>"median"</code>, <code>"sum"</code>, <code>"sd"</code> (standard deviation), and <code>"prop"</code> (proportion). To see a list of all possible summary statistics you can use, type <code>?calculate</code> and read the help file.</p>
<p>Let’s save the result in a data frame called <code>bootstrap_distribution</code> and explore its contents:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="8-confidence-intervals.html#cb280-1"></a>bootstrap_distribution &lt;-<span class="st"> </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb280-2"><a href="8-confidence-intervals.html#cb280-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb280-3"><a href="8-confidence-intervals.html#cb280-3"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb280-4"><a href="8-confidence-intervals.html#cb280-4"></a><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;mean&quot;</span>)</span>
<span id="cb280-5"><a href="8-confidence-intervals.html#cb280-5"></a>bootstrap_distribution</span></code></pre></div>
<pre><code># A tibble: 1,000 × 2
   replicate    stat
       &lt;int&gt;   &lt;dbl&gt;
 1         1 1995.7 
 2         2 1994.04
 3         3 1993.62
 4         4 1994.5 
 5         5 1994.08
 6         6 1993.6 
 7         7 1995.26
 8         8 1996.64
 9         9 1994.3 
10        10 1995.94
# … with 990 more rows</code></pre>
<p>Observe that the resulting data frame has 1000 rows and 2 columns corresponding to the 1000 <code>replicate</code> values. It also has the mean year for each bootstrap resample saved in the variable <code>stat</code>.</p>
<p><strong>Comparing with original workflow</strong>: You may have recognized at this point that the <code>calculate()</code> step in the <code>infer</code> workflow produces the same output as the <code>group_by() %&gt;% summarize()</code> steps in the original workflow.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="8-confidence-intervals.html#cb282-1"></a><span class="co"># infer workflow:                   # Original workflow:</span></span>
<span id="cb282-2"><a href="8-confidence-intervals.html#cb282-2"></a>pennies_sample <span class="op">%&gt;%</span><span class="st">                  </span>pennies_sample <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb282-3"><a href="8-confidence-intervals.html#cb282-3"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> year) <span class="op">%&gt;%</span><span class="st">        </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, </span>
<span id="cb282-4"><a href="8-confidence-intervals.html#cb282-4"></a>  <span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st">                        </span><span class="dt">reps =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st">              </span></span>
<span id="cb282-5"><a href="8-confidence-intervals.html#cb282-5"></a><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;mean&quot;</span>)            <span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb282-6"><a href="8-confidence-intervals.html#cb282-6"></a><span class="st">                                      </span><span class="kw">summarize</span>(<span class="dt">stat =</span> <span class="kw">mean</span>(year))</span></code></pre></div>
</div>
<div id="visualize-the-results" class="section level4 unnumbered">
<h4>4. <code>visualize</code> the results</h4>
<div class="figure" style="text-align: center"><span id="fig:infer-visualize"></span>
<img src="images/flowcharts/infer/visualize.png" alt="Diagram of visualize() results." width="70%" />
<p class="caption">
FIGURE 8.21: Diagram of visualize() results.
</p>
</div>
<p>The <code>visualize()</code>  verb provides a quick way to visualize the bootstrap distribution as a histogram of the numerical <code>stat</code> variable’s values. The pipeline of the main <code>infer</code> verbs used for exploring bootstrap distribution results is shown in Figure <a href="8-confidence-intervals.html#fig:infer-visualize">8.21</a>.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="8-confidence-intervals.html#cb283-1"></a><span class="kw">visualize</span>(bootstrap_distribution)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:boostrap-distribution-infer"></span>
<img src="ModernDive_files/figure-html/boostrap-distribution-infer-1.png" alt="Bootstrap distribution." width="\textwidth" />
<p class="caption">
FIGURE 8.22: Bootstrap distribution.
</p>
</div>
<p><strong>Comparing with original workflow</strong>: In fact, <code>visualize()</code> is a <em>wrapper function</em> for the <code>ggplot()</code> function that uses a <code>geom_histogram()</code> layer. Recall that we illustrated the concept of a wrapper function in Figure <a href="5-regression.html#fig:moderndive-figure-wrapper">5.5</a> in Subsection <a href="5-regression.html#model1table">5.1.2</a>.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="8-confidence-intervals.html#cb284-1"></a><span class="co"># infer workflow:                    # Original workflow:</span></span>
<span id="cb284-2"><a href="8-confidence-intervals.html#cb284-2"></a><span class="kw">visualize</span>(bootstrap_distribution)    <span class="kw">ggplot</span>(bootstrap_distribution, </span>
<span id="cb284-3"><a href="8-confidence-intervals.html#cb284-3"></a>                                            <span class="kw">aes</span>(<span class="dt">x =</span> stat)) <span class="op">+</span></span>
<span id="cb284-4"><a href="8-confidence-intervals.html#cb284-4"></a><span class="st">                                       </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p>The <code>visualize()</code> function can take many other arguments which we’ll see momentarily to customize the plot further. It also works with helper functions to do the shading of the histogram values corresponding to the confidence interval values.</p>
<p>Let’s recap the steps of the <code>infer</code> workflow for constructing a bootstrap distribution and then visualizing it in Figure <a href="8-confidence-intervals.html#fig:infer-workflow-ci">8.23</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:infer-workflow-ci"></span>
<img src="images/flowcharts/infer/ci_diagram.png" alt="infer package workflow for confidence intervals." width="100%" />
<p class="caption">
FIGURE 8.23: infer package workflow for confidence intervals.
</p>
</div>
<p>Recall how we introduced two different methods for constructing 95% confidence intervals for an unknown population parameter in Section <a href="8-confidence-intervals.html#ci-build-up">8.3</a>: the <em>percentile method</em> and the <em>standard error method</em>. Let’s now check out the <code>infer</code> package code that explicitly constructs these. There are also some additional neat functions to visualize the resulting confidence intervals built-in to the <code>infer</code> package!</p>
</div>
</div>
<div id="percentile-method-infer" class="section level3">
<h3><span class="header-section-number">8.4.3</span> Percentile method with <code>infer</code></h3>
<p>Recall the percentile method for constructing 95% confidence intervals we introduced in Subsection <a href="8-confidence-intervals.html#percentile-method">8.3.1</a>. This method sets the lower endpoint of the confidence interval at the 2.5th percentile of the bootstrap distribution and similarly sets the upper endpoint at the 97.5th percentile. The resulting interval captures the middle 95% of the values of the sample mean in the bootstrap distribution.</p>
<p>We can compute the 95% confidence interval by piping <code>bootstrap_distribution</code> into the <code>get_confidence_interval()</code>  function from the <code>infer</code> package, with the confidence <code>level</code> set to 0.95 and the confidence interval <code>type</code> to be <code>"percentile"</code>. Let’s save the results in <code>percentile_ci</code>.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="8-confidence-intervals.html#cb285-1"></a>percentile_ci &lt;-<span class="st"> </span>bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb285-2"><a href="8-confidence-intervals.html#cb285-2"></a><span class="st">  </span><span class="kw">get_confidence_interval</span>(<span class="dt">level =</span> <span class="fl">0.95</span>, <span class="dt">type =</span> <span class="st">&quot;percentile&quot;</span>)</span>
<span id="cb285-3"><a href="8-confidence-intervals.html#cb285-3"></a>percentile_ci</span></code></pre></div>
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1  1991.24  1999.42</code></pre>
<p>Alternatively, we can visualize the interval (1991.24, 1999.42) by piping the <code>bootstrap_distribution</code> data frame into the <code>visualize()</code> function and adding a <code>shade_confidence_interval()</code>  layer. We set the <code>endpoints</code> argument to be <code>percentile_ci</code>.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="8-confidence-intervals.html#cb287-1"></a><span class="kw">visualize</span>(bootstrap_distribution) <span class="op">+</span><span class="st"> </span></span>
<span id="cb287-2"><a href="8-confidence-intervals.html#cb287-2"></a><span class="st">  </span><span class="kw">shade_confidence_interval</span>(<span class="dt">endpoints =</span> percentile_ci)</span></code></pre></div>

<div class="figure" style="text-align: center"><span id="fig:percentile-ci-viz"></span>
<img src="ModernDive_files/figure-html/percentile-ci-viz-1.png" alt="Percentile method 95% confidence interval shaded corresponding to potential values." width="\textwidth" />
<p class="caption">
FIGURE 8.24: Percentile method 95% confidence interval shaded corresponding to potential values.
</p>
</div>
<p>Observe in Figure <a href="8-confidence-intervals.html#fig:percentile-ci-viz">8.24</a> that 95% of the sample means stored in the <code>stat</code> variable in <code>bootstrap_distribution</code> fall between the two endpoints marked with the darker lines, with 2.5% of the sample means to the left of the shaded area and 2.5% of the sample means to the right. You also have the option to change the colors of the shading using the <code>color</code> and <code>fill</code> arguments.</p>
<p>You can also use the shorter named function <code>shade_ci()</code> and the results will be the same. This is for folks who don’t want to type out all of <code>confidence_interval</code> and prefer to type out <code>ci</code> instead. Try out the following code!</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="8-confidence-intervals.html#cb288-1"></a><span class="kw">visualize</span>(bootstrap_distribution) <span class="op">+</span><span class="st"> </span></span>
<span id="cb288-2"><a href="8-confidence-intervals.html#cb288-2"></a><span class="st">  </span><span class="kw">shade_ci</span>(<span class="dt">endpoints =</span> percentile_ci, <span class="dt">color =</span> <span class="st">&quot;hotpink&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;khaki&quot;</span>)</span></code></pre></div>
</div>
<div id="infer-se" class="section level3">
<h3><span class="header-section-number">8.4.4</span> Standard error method with <code>infer</code></h3>
<p>Recall the standard error method for constructing 95% confidence intervals we introduced in Subsection <a href="8-confidence-intervals.html#se-method">8.3.2</a>. For any distribution that is normally shaped, roughly 95% of the values lie within two standard deviations of the mean. In the case of the bootstrap distribution, the standard deviation has a special name: the <em>standard error</em>.</p>
<p>So in our case, 95% of values of the bootstrap distribution will lie within <span class="math inline">\(\pm 1.96\)</span> standard errors of <span class="math inline">\(\overline{x}\)</span>. Thus, a 95% confidence interval is</p>
<p><span class="math display">\[\overline{x} \pm 1.96 \cdot SE = (\overline{x} - 1.96 \cdot SE, \, \overline{x} + 1.96 \cdot SE).\]</span></p>
<p>Computation of the 95% confidence interval can once again be done by piping the <code>bootstrap_distribution</code> data frame we created into the <code>get_confidence_interval()</code> function. However, this time we set the first <code>type</code> argument to be <code>"se"</code>. Second, we must specify the <code>point_estimate</code> argument in order to set the center of the confidence interval. We set this to be the sample mean of the original sample of 50 pennies of 1995.44 we saved in <code>x_bar</code> earlier.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="8-confidence-intervals.html#cb289-1"></a>standard_error_ci &lt;-<span class="st"> </span>bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb289-2"><a href="8-confidence-intervals.html#cb289-2"></a><span class="st">  </span><span class="kw">get_confidence_interval</span>(<span class="dt">type =</span> <span class="st">&quot;se&quot;</span>, <span class="dt">point_estimate =</span> x_bar)</span></code></pre></div>
<pre><code>Using `level = 0.95` to compute confidence interval.</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="8-confidence-intervals.html#cb291-1"></a>standard_error_ci</span></code></pre></div>
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1  1991.35  1999.53</code></pre>
<p>If we would like to visualize the interval (1991.35, 1999.53), we can once again pipe the <code>bootstrap_distribution</code> data frame into the <code>visualize()</code> function and add a <code>shade_confidence_interval()</code> layer to our plot. We set the <code>endpoints</code> argument to be <code>standard_error_ci</code>. The resulting standard-error method based on a 95% confidence interval for <span class="math inline">\(\mu\)</span> can be seen in Figure <a href="8-confidence-intervals.html#fig:se-ci-viz">8.25</a>.</p>

<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="8-confidence-intervals.html#cb293-1"></a><span class="kw">visualize</span>(bootstrap_distribution) <span class="op">+</span><span class="st"> </span></span>
<span id="cb293-2"><a href="8-confidence-intervals.html#cb293-2"></a><span class="st">  </span><span class="kw">shade_confidence_interval</span>(<span class="dt">endpoints =</span> standard_error_ci)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:se-ci-viz"></span>
<img src="ModernDive_files/figure-html/se-ci-viz-1.png" alt="Standard-error-method 95% confidence interval." width="\textwidth" />
<p class="caption">
FIGURE 8.25: Standard-error-method 95% confidence interval.
</p>
</div>
<p>As noted in Section <a href="8-confidence-intervals.html#ci-build-up">8.3</a>, both methods produce similar confidence intervals:</p>
<ul>
<li>Percentile method: (1991.24, 1999.42)</li>
<li>Standard error method: (1991.35, 1999.53)</li>
</ul>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.5)</strong> Construct a 95% confidence interval for the <em>median</em> year of minting of <em>all</em> US pennies. Use the percentile method and, if appropriate, then use the standard-error method.</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="one-prop-ci" class="section level2">
<h2><span class="header-section-number">8.5</span> Interpreting confidence intervals</h2>
<p>Now that we’ve shown you how to construct confidence intervals using a sample drawn from a population, let’s now focus on how to interpret their effectiveness. The effectiveness of a confidence interval is judged by whether or not it contains the true value of the population parameter. Going back to our fishing analogy in Section <a href="8-confidence-intervals.html#ci-build-up">8.3</a>, this is like asking, “Did our net capture the fish?”.</p>
<p>So, for example, does our percentile-based confidence interval of (1991.24, 1999.42) “capture” the true mean year <span class="math inline">\(\mu\)</span> of <em>all</em> US pennies? Alas, we’ll never know, because we don’t know what the true value of <span class="math inline">\(\mu\)</span> is. After all, we’re sampling to estimate it!</p>
<p>In order to interpret a confidence interval’s effectiveness, we need to <em>know</em> what the value of the population parameter is. That way we can say whether or not a confidence interval “captured” this value.</p>
<p>Let’s revisit our sampling bowl from Chapter <a href="7-sampling.html#sampling">7</a>. What proportion of the bowl’s 2400 balls are red? Let’s compute this:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="8-confidence-intervals.html#cb294-1"></a>bowl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb294-2"><a href="8-confidence-intervals.html#cb294-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">p_red =</span> <span class="kw">mean</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_red
  &lt;dbl&gt;
1 0.375</code></pre>
<p>In this case, we <em>know</em> what the value of the population parameter is: we know that the population proportion <span class="math inline">\(p\)</span> is 0.375. In other words, we know that 37.5% of the bowl’s balls are red.</p>
<p>As we stated in Subsection <a href="7-sampling.html#moral-of-the-story">7.3.3</a>, the sampling bowl exercise doesn’t really reflect how sampling is done in real life, but rather was an <em>idealized</em> activity. In real life, we won’t know what the true value of the population parameter is, hence the need for estimation.</p>
<p>Let’s now construct confidence intervals for <span class="math inline">\(p\)</span> using our 33 groups of friends’ samples from the bowl in Chapter <a href="7-sampling.html#sampling">7</a>. We’ll then see if the confidence intervals “captured” the true value of <span class="math inline">\(p\)</span>, which we know to be 37.5%. That is to say, “Did the net capture the fish?”.</p>
<div id="ilyas-yohan" class="section level3">
<h3><span class="header-section-number">8.5.1</span> Did the net capture the fish?</h3>
<p>Recall that we had 33 groups of friends each take samples of size 50 from the bowl and then compute the sample proportion of red balls <span class="math inline">\(\widehat{p}\)</span>. This resulted in 33 such estimates of <span class="math inline">\(p\)</span>. Let’s focus on Ilyas and Yohan’s sample, which is saved in the <code>bowl_sample_1</code> data frame in the <code>moderndive</code> package:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="8-confidence-intervals.html#cb296-1"></a>bowl_sample_<span class="dv">1</span></span></code></pre></div>
<pre><code># A tibble: 50 × 1
   color
   &lt;chr&gt;
 1 white
 2 white
 3 red  
 4 red  
 5 white
 6 white
 7 red  
 8 white
 9 white
10 white
# … with 40 more rows</code></pre>
<p>They observed 21 red balls out of 50 and thus their sample proportion <span class="math inline">\(\widehat{p}\)</span> was 21/50 = 0.42 = 42%. Think of this as the “spear” from our fishing analogy.</p>
<p>Let’s now follow the <code>infer</code> package workflow from Subsection <a href="8-confidence-intervals.html#infer-workflow">8.4.2</a> to create a percentile-method-based 95% confidence interval for <span class="math inline">\(p\)</span> using Ilyas and Yohan’s sample. Think of this as the “net.”</p>
<div id="specify-variables-1" class="section level4 unnumbered">
<h4>1. <code>specify</code> variables</h4>
<p>First, we <code>specify()</code> the <code>response</code> variable of interest <code>color</code>:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="8-confidence-intervals.html#cb298-1"></a>bowl_sample_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb298-2"><a href="8-confidence-intervals.html#cb298-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> color)</span></code></pre></div>
<pre><code>Error: A level of the response variable `color` needs to be specified for the `success`
argument in `specify()`.</code></pre>
<p>Whoops! We need to define which event is of interest! <code>red</code> or <code>white</code> balls? Since we are interested in the proportion red, let’s set <code>success</code> to be <code>"red"</code>:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="8-confidence-intervals.html#cb300-1"></a>bowl_sample_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb300-2"><a href="8-confidence-intervals.html#cb300-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> color, <span class="dt">success =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>Response: color (factor)
# A tibble: 50 × 1
   color
   &lt;fct&gt;
 1 white
 2 white
 3 red  
 4 red  
 5 white
 6 white
 7 red  
 8 white
 9 white
10 white
# … with 40 more rows</code></pre>
</div>
<div id="generate-replicates-1" class="section level4 unnumbered">
<h4>2. <code>generate</code> replicates</h4>
<p>Second, we <code>generate()</code> 1000 replicates of <em>bootstrap resampling with replacement</em> from <code>bowl_sample_1</code> by setting <code>reps = 1000</code> and <code>type = "bootstrap"</code>.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="8-confidence-intervals.html#cb302-1"></a>bowl_sample_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb302-2"><a href="8-confidence-intervals.html#cb302-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> color, <span class="dt">success =</span> <span class="st">&quot;red&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb302-3"><a href="8-confidence-intervals.html#cb302-3"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">type =</span> <span class="st">&quot;bootstrap&quot;</span>)</span></code></pre></div>
<pre><code>Response: color (factor)
# A tibble: 50,000 × 2
# Groups:   replicate [1,000]
   replicate color
       &lt;int&gt; &lt;fct&gt;
 1         1 white
 2         1 white
 3         1 white
 4         1 white
 5         1 red  
 6         1 white
 7         1 white
 8         1 white
 9         1 white
10         1 red  
# … with 49,990 more rows</code></pre>
<p>Observe that the resulting data frame has 50,000 rows. This is because we performed resampling of 50 balls with replacement 1000 times and thus 50,000 = 50 <span class="math inline">\(\cdot\)</span> 1000. The variable <code>replicate</code> indicates which resample each row belongs to. So it has the value <code>1</code> 50 times, the value <code>2</code> 50 times, all the way through to the value <code>1000</code> 50 times.</p>
</div>
<div id="calculate-summary-statistics-1" class="section level4 unnumbered">
<h4>3. <code>calculate</code> summary statistics</h4>
<p>Third, we summarize each of the 1000 resamples of size 50 with the proportion of <em>successes</em>. In other words, the proportion of the balls that are <code>"red"</code>. We can set the summary statistic to be calculated as the proportion by setting the <code>stat</code> argument to be <code>"prop"</code>. Let’s save the result as <code>sample_1_bootstrap</code>:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="8-confidence-intervals.html#cb304-1"></a>sample_<span class="dv">1</span>_bootstrap &lt;-<span class="st"> </span>bowl_sample_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb304-2"><a href="8-confidence-intervals.html#cb304-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> color, <span class="dt">success =</span> <span class="st">&quot;red&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb304-3"><a href="8-confidence-intervals.html#cb304-3"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">type =</span> <span class="st">&quot;bootstrap&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb304-4"><a href="8-confidence-intervals.html#cb304-4"></a><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;prop&quot;</span>)</span>
<span id="cb304-5"><a href="8-confidence-intervals.html#cb304-5"></a>sample_<span class="dv">1</span>_bootstrap</span></code></pre></div>
<pre><code># A tibble: 1,000 × 2
   replicate  stat
       &lt;int&gt; &lt;dbl&gt;
 1         1  0.32
 2         2  0.42
 3         3  0.44
 4         4  0.4 
 5         5  0.44
 6         6  0.52
 7         7  0.38
 8         8  0.44
 9         9  0.34
10        10  0.42
# … with 990 more rows</code></pre>
<p>Observe there are 1000 rows in this data frame and thus 1000 values of the variable <code>stat</code>. These 1000 values of <code>stat</code> represent our 1000 replicated values of the proportion, each based on a different resample.</p>
</div>
<div id="visualize-the-results-1" class="section level4 unnumbered">
<h4>4. <code>visualize</code> the results</h4>
<p>Fourth and lastly, let’s compute the resulting 95% confidence interval.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="8-confidence-intervals.html#cb306-1"></a>percentile_ci_<span class="dv">1</span> &lt;-<span class="st"> </span>sample_<span class="dv">1</span>_bootstrap <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb306-2"><a href="8-confidence-intervals.html#cb306-2"></a><span class="st">  </span><span class="kw">get_confidence_interval</span>(<span class="dt">level =</span> <span class="fl">0.95</span>, <span class="dt">type =</span> <span class="st">&quot;percentile&quot;</span>)</span>
<span id="cb306-3"><a href="8-confidence-intervals.html#cb306-3"></a>percentile_ci_<span class="dv">1</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1      0.3     0.56</code></pre>
<p>Let’s visualize the bootstrap distribution along with the <code>percentile_ci_1</code> percentile-based 95% confidence interval for <span class="math inline">\(p\)</span> in Figure <a href="8-confidence-intervals.html#fig:shovel-bootstrap-1-infer">8.26</a>. We’ll adjust the number of bins to better see the resulting shape. Furthermore, we’ll add a dashed vertical line at Ilyas and Yohan’s observed <span class="math inline">\(\widehat{p}\)</span> = 21/50 = 0.42 = 42% using <code>geom_vline()</code>.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="8-confidence-intervals.html#cb308-1"></a>sample_<span class="dv">1</span>_bootstrap <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb308-2"><a href="8-confidence-intervals.html#cb308-2"></a><span class="st">  </span><span class="kw">visualize</span>(<span class="dt">bins =</span> <span class="dv">15</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb308-3"><a href="8-confidence-intervals.html#cb308-3"></a><span class="st">  </span><span class="kw">shade_confidence_interval</span>(<span class="dt">endpoints =</span> percentile_ci_<span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb308-4"><a href="8-confidence-intervals.html#cb308-4"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.42</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:shovel-bootstrap-1-infer"></span>
<img src="ModernDive_files/figure-html/shovel-bootstrap-1-infer-1.png" alt="Bootstrap distribution." width="\textwidth" />
<p class="caption">
FIGURE 8.26: Bootstrap distribution.
</p>
</div>
<p>Did Ilyas and Yohan’s net capture the fish? Did their 95% confidence interval for <span class="math inline">\(p\)</span> based on their sample contain the true value of <span class="math inline">\(p\)</span> of 0.375? Yes! 0.375 is between the endpoints of their confidence interval (0.3, 0.56).</p>
<p>However, will <em>every</em> 95% confidence interval for <span class="math inline">\(p\)</span> capture this value? In other words, if we had a different sample of 50 balls and constructed a different confidence interval, would it necessarily contain <span class="math inline">\(p\)</span> = 0.375 as well? Let’s see!</p>
<p>Let’s first take a different sample from the bowl, this time using the computer as we did in Chapter <a href="7-sampling.html#sampling">7</a>:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="8-confidence-intervals.html#cb309-1"></a>bowl_sample_<span class="dv">2</span> &lt;-<span class="st"> </span>bowl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>)</span>
<span id="cb309-2"><a href="8-confidence-intervals.html#cb309-2"></a>bowl_sample_<span class="dv">2</span></span></code></pre></div>
<pre><code># A tibble: 50 × 3
# Groups:   replicate [1]
   replicate ball_ID color
       &lt;int&gt;   &lt;int&gt; &lt;chr&gt;
 1         1    1665 red  
 2         1    1312 red  
 3         1    2105 red  
 4         1     810 white
 5         1     189 white
 6         1    1429 white
 7         1    2294 red  
 8         1    1233 white
 9         1    1951 white
10         1    2061 white
# … with 40 more rows</code></pre>
<p>Let’s reapply the same <code>infer</code> functions on <code>bowl_sample_2</code> to generate a different 95% confidence interval for <span class="math inline">\(p\)</span>. First, we create the new bootstrap distribution and save the results in <code>sample_2_bootstrap</code>:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="8-confidence-intervals.html#cb311-1"></a>sample_<span class="dv">2</span>_bootstrap &lt;-<span class="st"> </span>bowl_sample_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb311-2"><a href="8-confidence-intervals.html#cb311-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> color, </span>
<span id="cb311-3"><a href="8-confidence-intervals.html#cb311-3"></a>          <span class="dt">success =</span> <span class="st">&quot;red&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb311-4"><a href="8-confidence-intervals.html#cb311-4"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>, </span>
<span id="cb311-5"><a href="8-confidence-intervals.html#cb311-5"></a>           <span class="dt">type =</span> <span class="st">&quot;bootstrap&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb311-6"><a href="8-confidence-intervals.html#cb311-6"></a><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;prop&quot;</span>)</span>
<span id="cb311-7"><a href="8-confidence-intervals.html#cb311-7"></a>sample_<span class="dv">2</span>_bootstrap</span></code></pre></div>
<pre><code># A tibble: 1,000 × 2
   replicate  stat
       &lt;int&gt; &lt;dbl&gt;
 1         1  0.48
 2         2  0.38
 3         3  0.32
 4         4  0.32
 5         5  0.34
 6         6  0.26
 7         7  0.3 
 8         8  0.36
 9         9  0.44
10        10  0.36
# … with 990 more rows</code></pre>
<p>We once again compute a percentile-based 95% confidence interval for <span class="math inline">\(p\)</span>:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="8-confidence-intervals.html#cb313-1"></a>percentile_ci_<span class="dv">2</span> &lt;-<span class="st"> </span>sample_<span class="dv">2</span>_bootstrap <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb313-2"><a href="8-confidence-intervals.html#cb313-2"></a><span class="st">  </span><span class="kw">get_confidence_interval</span>(<span class="dt">level =</span> <span class="fl">0.95</span>, <span class="dt">type =</span> <span class="st">&quot;percentile&quot;</span>)</span>
<span id="cb313-3"><a href="8-confidence-intervals.html#cb313-3"></a>percentile_ci_<span class="dv">2</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1      0.2     0.48</code></pre>
<p>Does this new net capture the fish? In other words, does the 95% confidence interval for <span class="math inline">\(p\)</span> based on the new sample contain the true value of <span class="math inline">\(p\)</span> of 0.375? Yes again! 0.375 is between the endpoints of our confidence interval (0.2, 0.48).</p>
<p>Let’s now repeat this process 100 more times: we take 100 virtual samples from the bowl and construct 100 95% confidence intervals. Let’s visualize the results in Figure <a href="8-confidence-intervals.html#fig:reliable-percentile">8.27</a> where:</p>
<ol style="list-style-type: decimal">
<li>We mark the true value of <span class="math inline">\(p = 0.375\)</span> with a vertical line.</li>
<li>We mark each of the 100 95% confidence intervals with horizontal lines. These are the “nets.”</li>
<li>The horizontal line is colored grey if the confidence interval “captures” the true value of <span class="math inline">\(p\)</span> marked with the vertical line. The horizontal line is colored black otherwise.</li>
</ol>

<div class="figure" style="text-align: center"><span id="fig:reliable-percentile"></span>
<img src="ModernDive_files/figure-html/reliable-percentile-1.png" alt="100 percentile-based 95% confidence intervals for \(p\)." width="\textwidth" />
<p class="caption">
FIGURE 8.27: 100 percentile-based 95% confidence intervals for <span class="math inline">\(p\)</span>.
</p>
</div>
<p>Of the 100 95% confidence intervals, 95 of them captured the true value <span class="math inline">\(p = 0.375\)</span>, whereas 5 of them didn’t. In other words, 95 of our nets caught the fish, whereas 5 of our nets didn’t.</p>
<p>This is where the “95% confidence level” we defined in Section <a href="8-confidence-intervals.html#ci-build-up">8.3</a> comes into play: for every 100 95% confidence intervals, we <em>expect</em> that 95 of them will capture <span class="math inline">\(p\)</span> and that five of them won’t.</p>
<p>Note that “expect” is a probabilistic statement referring to a long-run average. In other words, for every 100 confidence intervals, we will observe <em>about</em> 95 confidence intervals that capture <span class="math inline">\(p\)</span>, but not necessarily exactly 95. In Figure <a href="8-confidence-intervals.html#fig:reliable-percentile">8.27</a> for example, 95 of the confidence intervals capture <span class="math inline">\(p\)</span>.</p>
<p>To further accentuate our point about confidence levels, let’s generate a figure similar to Figure <a href="8-confidence-intervals.html#fig:reliable-percentile">8.27</a>, but this time constructing 80% standard-error method based confidence intervals instead. Let’s visualize the results in Figure <a href="8-confidence-intervals.html#fig:reliable-se">8.28</a> with the scale on the x-axis being the same as in Figure <a href="8-confidence-intervals.html#fig:reliable-percentile">8.27</a> to make comparison easy. Furthermore, since all standard-error method confidence intervals for <span class="math inline">\(p\)</span> are centered at their respective point estimates <span class="math inline">\(\widehat{p}\)</span>, we mark this value on each line with dots.</p>

<div class="figure" style="text-align: center"><span id="fig:reliable-se"></span>
<img src="ModernDive_files/figure-html/reliable-se-1.png" alt="100 SE-based 80% confidence intervals for \(p\) with point estimate center marked with dots." width="\textwidth" />
<p class="caption">
FIGURE 8.28: 100 SE-based 80% confidence intervals for <span class="math inline">\(p\)</span> with point estimate center marked with dots.
</p>
</div>
<p>Observe how the 80% confidence intervals are narrower than the 95% confidence intervals, reflecting our lower degree of confidence. Think of this as using a smaller “net.” We’ll explore other determinants of confidence interval width in the upcoming Subsection <a href="8-confidence-intervals.html#ci-width">8.5.3</a>.</p>
<p>Furthermore, observe that of the 100 80% confidence intervals, 82 of them captured the population proportion <span class="math inline">\(p\)</span> = 0.375, whereas 18 of them did not. Since we lowered the confidence level from 95% to 80%, we now have a much larger number of confidence intervals that failed to “catch the fish.”</p>
</div>
</div>
<div id="shorthand" class="section level3">
<h3><span class="header-section-number">8.5.2</span> Precise and shorthand interpretation</h3>
<p></p>
<p>Let’s return our attention to 95% confidence intervals. The precise and mathematically correct interpretation of a 95% confidence interval is a little long-winded:</p>
<blockquote>
<p>Precise interpretation: If we repeated our sampling procedure a large number of times, we expect about 95% of the resulting confidence intervals to capture the value of the population parameter.</p>
</blockquote>
<p>This is what we observed in Figure <a href="8-confidence-intervals.html#fig:reliable-percentile">8.27</a>. Our confidence interval construction procedure is 95% <em>reliable</em>. That is to say, we can expect our confidence intervals to include the true population parameter about 95% of the time.</p>
<p>A common but incorrect interpretation is: “There is a 95% probability that the confidence interval contains <span class="math inline">\(p\)</span>.” Looking at Figure <a href="8-confidence-intervals.html#fig:reliable-percentile">8.27</a>, each of the confidence intervals either does or doesn’t contain <span class="math inline">\(p\)</span>. In other words, the probability is either a 1 or a 0.</p>
<p>So if the 95% confidence level only relates to the reliability of the confidence interval construction procedure and not to a given confidence interval itself, what insight can be derived from a given confidence interval? For example, going back to the pennies example, we found that the percentile method 95% confidence interval for <span class="math inline">\(\mu\)</span> was (1991.24, 1999.42), whereas the standard error method 95% confidence interval was (1991.35, 1999.53). What can be said about these two intervals?</p>
<p>Loosely speaking, we can think of these intervals as our “best guess” of a plausible range of values for the mean year <span class="math inline">\(\mu\)</span> of <em>all</em> US pennies. For the rest of this book, we’ll use the following shorthand summary of the precise interpretation.</p>
<blockquote>
<p>Short-hand interpretation: We are 95% “confident” that a 95% confidence interval captures the value of the population parameter.</p>
</blockquote>
<p>We use quotation marks around “confident” to emphasize that while 95% relates to the reliability of our confidence interval construction procedure, ultimately a constructed confidence interval is our best guess of an interval that contains the population parameter. In other words, it’s our best net.</p>
<p>So returning to our pennies example and focusing on the percentile method, we are 95% “confident” that the true mean year of pennies in circulation in 2019 is somewhere between 1991.24 and 1999.42.</p>
</div>
<div id="ci-width" class="section level3">
<h3><span class="header-section-number">8.5.3</span> Width of confidence intervals</h3>
<p>Now that we know how to interpret confidence intervals, let’s go over some factors that determine their width.</p>
<div id="impact-of-confidence-level" class="section level4 unnumbered">
<h4>Impact of confidence level</h4>
<p>One factor that determines confidence interval widths is the pre-specified confidence level. For example, in Figures <a href="8-confidence-intervals.html#fig:reliable-percentile">8.27</a> and <a href="8-confidence-intervals.html#fig:reliable-se">8.28</a>, we compared the widths of 95% and 80% confidence intervals and observed that the 95% confidence intervals were wider. The quantification of the confidence level should match what many expect of the word “confident.” In order to be more confident in our best guess of a range of values, we need to widen the range of values.</p>
<p>To elaborate on this, imagine we want to guess the forecasted high temperature in Seoul, South Korea on August 15th. Given Seoul’s temperate climate with four distinct seasons, we could say somewhat confidently that the high temperature would be between 50°F - 95°F (10°C - 35°C). However, if we wanted a temperature range we were <em>absolutely</em> confident about, we would need to widen it.</p>
<p>We need this wider range to allow for the possibility of anomalous weather, like a freak cold spell or an extreme heat wave. So a range of temperatures we could be near certain about would be between 32°F - 110°F (0°C - 43°C). On the other hand, if we could tolerate being a little less confident, we could narrow this range to between 70°F - 85°F (21°C - 30°C).</p>
<p>Let’s revisit our sampling bowl from Chapter <a href="7-sampling.html#sampling">7</a>. Let’s compare <span class="math inline">\(10 \cdot 3 = 30\)</span> confidence intervals for <span class="math inline">\(p\)</span> based on three different confidence levels: 80%, 95%, and 99%.</p>
<p>Specifically, we’ll first take 30 different random samples of size <span class="math inline">\(n\)</span> = 50 balls from the bowl. Then we’ll construct 10 percentile-based confidence intervals using each of the three different confidence levels.</p>
<p>Finally, we’ll compare the widths of these intervals. We visualize the resulting confidence intervals in Figure <a href="8-confidence-intervals.html#fig:reliable-percentile-80-95-99">8.29</a> along with a vertical line marking the true value of <span class="math inline">\(p\)</span> = 0.375.</p>
<!-- 
v2 TODO: Consider loading the perc_cis_by_level and percentile_cis_by_n data
frames into the moderndive package too so that readers can explore them a bit.
No need to include the code as well that generates them in the book.

However, making the code to replicate this process student-friendly is going to
take a lot of work and this chapter is getting rather large as is. For now, we
just show the resulting faceted plots comparing:

-For n=50, 80% + 95% + 99% confidence intervals
-For 95% confidence level, based on n = 25, 50, 100
-->
<!--
v2 TODO: Consider including

Let's take a look into what the `perc_cis_by_level` data frame looks like and
how a sample of 10 different confidence intervals each from the 80%, 95%, and
99% levels compare visually in terms of length. Then, we'll start computing some
widths of the confidence intervals. Then we'll head into calculating the mean
and median widths across the three different levels.



We see that the sample proportion of reds varies in the `point_estimate` column with varying `lower` and `upper` bounds as well depending on the variability of the bootstrap distribution. The width of the confidence intervals appears to increase from left to right going from 80% confidence levels to 95% and then to 99%. Let's now compute the confidence interval (CI) width for each of these intervals and then get the median and mean length.
-->

<div class="figure" style="text-align: center"><span id="fig:reliable-percentile-80-95-99"></span>
<img src="ModernDive_files/figure-html/reliable-percentile-80-95-99-1.png" alt="Ten 80, 95, and 99% confidence intervals for \(p\) based on \(n = 50\)." width="\textwidth" />
<p class="caption">
FIGURE 8.29: Ten 80, 95, and 99% confidence intervals for <span class="math inline">\(p\)</span> based on <span class="math inline">\(n = 50\)</span>.
</p>
</div>
<p>Observe that as the confidence level increases from 80% to 95% to 99%, the confidence intervals tend to get wider as seen in Table <a href="8-confidence-intervals.html#tab:perc-cis-average-width">8.2</a> where we compare their average widths.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:perc-cis-average-width">TABLE 8.2: </span>Average width of 80, 95, and 99% confidence intervals
</caption>
<thead>
<tr>
<th style="text-align:left;">
Confidence level
</th>
<th style="text-align:right;">
Mean width
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
80%
</td>
<td style="text-align:right;">
0.162
</td>
</tr>
<tr>
<td style="text-align:left;">
95%
</td>
<td style="text-align:right;">
0.262
</td>
</tr>
<tr>
<td style="text-align:left;">
99%
</td>
<td style="text-align:right;">
0.338
</td>
</tr>
</tbody>
</table>
<p>So in order to have a higher confidence level, our confidence intervals must be wider. Ideally, we would have both a high confidence level and narrow confidence intervals. However, we cannot have it both ways. If we want to <em>be more confident</em>, we need to allow for wider intervals. Conversely, if we would like a narrow interval, we must tolerate a lower confidence level.</p>
<p>The moral of the story is:  <strong>Higher confidence levels tend to produce wider confidence intervals.</strong> When looking at Figure <a href="8-confidence-intervals.html#fig:reliable-percentile-80-95-99">8.29</a> it is important to keep in mind that we kept the sample size fixed at <span class="math inline">\(n\)</span> = 50. Thus, all <span class="math inline">\(10 \cdot 3 = 30\)</span> random samples from the <code>bowl</code> had the same sample size. What happens if instead we took samples of different sizes? Recall that we did this in Subsection <a href="#different-shovels"><strong>??</strong></a> using virtual shovels with 25, 50, and 100 slots. <!-- We delve into this next. --></p>
</div>
<div id="impact-of-sample-size" class="section level4 unnumbered">
<h4>Impact of sample size</h4>
<p>This time, let’s fix the confidence level at 95%, but consider three different sample sizes for <span class="math inline">\(n\)</span>: 25, 50, and 100. Specifically, we’ll first take 10 different random samples of size 25, 10 different random samples of size 50, and 10 different random samples of size 100. We’ll then construct 95% percentile-based confidence intervals for each sample. Finally, we’ll compare the widths of these intervals. We visualize the resulting 30 confidence intervals in Figure <a href="8-confidence-intervals.html#fig:reliable-percentile-n-25-50-100">8.30</a>. Note also the vertical line marking the true value of <span class="math inline">\(p\)</span> = 0.375.</p>

<div class="figure" style="text-align: center"><span id="fig:reliable-percentile-n-25-50-100"></span>
<img src="ModernDive_files/figure-html/reliable-percentile-n-25-50-100-1.png" alt="Ten 95% confidence intervals for \(p\) with \(n = 25, 50,\) and \(100\)." width="\textwidth" />
<p class="caption">
FIGURE 8.30: Ten 95% confidence intervals for <span class="math inline">\(p\)</span> with <span class="math inline">\(n = 25, 50,\)</span> and <span class="math inline">\(100\)</span>.
</p>
</div>
<p>Observe that as the confidence intervals are constructed from larger and larger sample sizes, they tend to get narrower. Let’s compare the average widths in Table <a href="8-confidence-intervals.html#tab:perc-cis-average-width-2">8.3</a>.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:perc-cis-average-width-2">TABLE 8.3: </span>Average width of 95% confidence intervals based on <span class="math inline">\(n = 25\)</span>, <span class="math inline">\(50\)</span>, and <span class="math inline">\(100\)</span>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Sample size
</th>
<th style="text-align:right;">
Mean width
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
n = 25
</td>
<td style="text-align:right;">
0.380
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 50
</td>
<td style="text-align:right;">
0.268
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 100
</td>
<td style="text-align:right;">
0.189
</td>
</tr>
</tbody>
</table>
<p>The moral of the story is:  <strong>Larger sample sizes tend to produce narrower confidence intervals.</strong> Recall that this was a key message in Subsection <a href="7-sampling.html#moral-of-the-story">7.3.3</a>. As we used larger and larger shovels for our samples, the sample proportions red <span class="math inline">\(\widehat{p}\)</span> tended to vary less. In other words, our estimates got more and more <em>precise</em>.</p>
<p>Recall that we visualized these results in Figure <a href="7-sampling.html#fig:comparing-sampling-distributions-3">7.12</a>, where we compared the <em>sampling distributions</em> for <span class="math inline">\(\widehat{p}\)</span> based on samples of size <span class="math inline">\(n\)</span> equal 25, 50, and 100. We also quantified the sampling variation of these sampling distributions using their standard deviation, which has that special name: the <em>standard error</em>. So as the sample size increases, the standard error decreases.</p>
<p>In fact, the standard error is another related factor in determining confidence interval width. We’ll explore this fact in Subsection <a href="8-confidence-intervals.html#theory-ci">8.7.2</a> when we discuss theory-based methods for constructing confidence intervals using mathematical formulas. Such methods are an alternative to the computer-based methods we’ve been using so far.</p>
</div>
</div>
</div>
<div id="case-study-two-prop-ci" class="section level2">
<h2><span class="header-section-number">8.6</span> Case study: Is yawning contagious?</h2>
<p>Let’s apply our knowledge of confidence intervals to answer the question: “Is yawning contagious?”. If you see someone else yawn, are you more likely to yawn? In an episode of the US show <a href="http://www.discovery.com/tv-shows/mythbusters/mythbusters-database/yawning-contagious/"><em>Mythbusters</em></a>, the hosts conducted an experiment to answer this question. The episode is available to view in the United States on the Discovery Network website <a href="https://www.discovery.com/tv-shows/mythbusters/videos/is-yawning-contagious">here</a> and more information about the episode is also available on <a href="https://www.imdb.com/title/tt0768479/">IMDb</a>.</p>
<div id="mythbusters-study-data" class="section level3">
<h3><span class="header-section-number">8.6.1</span> <em>Mythbusters</em> study data</h3>
<p>Fifty adult participants who thought they were being considered for an appearance on the show were interviewed by a show recruiter. In the interview, the recruiter either yawned or did not. Participants then sat by themselves in a large van and were asked to wait. While in the van, the <em>Mythbusters</em> team watched the participants using a hidden camera to see if they yawned. The data frame containing the results of their experiment is available in the <code>mythbusters_yawn</code> data frame included in the <code>moderndive</code> package: </p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="8-confidence-intervals.html#cb315-1"></a>mythbusters_yawn</span></code></pre></div>
<pre><code># A tibble: 50 × 3
    subj group   yawn 
   &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;
 1     1 seed    yes  
 2     2 control yes  
 3     3 seed    no   
 4     4 seed    yes  
 5     5 seed    no   
 6     6 control no   
 7     7 seed    yes  
 8     8 control no   
 9     9 control no   
10    10 seed    no   
# … with 40 more rows</code></pre>
<p>The variables are:</p>
<ul>
<li><code>subj</code>: The participant ID with values 1 through 50.</li>
<li><code>group</code>: A binary <em>treatment</em> variable indicating whether the participant was exposed to yawning. <code>"seed"</code> indicates the participant was exposed to yawning while <code>"control"</code> indicates the participant was not.</li>
<li><code>yawn</code>: A binary <em>response</em> variable indicating whether the participant ultimately yawned.</li>
</ul>
<p>Recall that you learned about treatment and response variables in Subsection <a href="5-regression.html#correlation-is-not-causation">5.3.1</a> in our discussion on confounding variables. </p>
<p>Let’s use some data wrangling to obtain counts of the four possible outcomes:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="8-confidence-intervals.html#cb317-1"></a>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb317-2"><a href="8-confidence-intervals.html#cb317-2"></a><span class="st">  </span><span class="kw">group_by</span>(group, yawn) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb317-3"><a href="8-confidence-intervals.html#cb317-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count =</span> <span class="kw">n</span>())</span></code></pre></div>
<pre><code># A tibble: 4 × 3
# Groups:   group [2]
  group   yawn  count
  &lt;chr&gt;   &lt;chr&gt; &lt;int&gt;
1 control no       12
2 control yes       4
3 seed    no       24
4 seed    yes      10</code></pre>
<p>Let’s first focus on the <code>"control"</code> group participants who were not exposed to yawning. 12 such participants did not yawn, while 4 such participants did. So out of the 16 people who were not exposed to yawning, 4/16 = 0.25 = 25% did yawn.</p>
<p>Let’s now focus on the <code>"seed"</code> group participants who were exposed to yawning where 24 such participants did not yawn, while 10 such participants did yawn. So out of the 34 people who were exposed to yawning, 10/34 = 0.294 = 29.4% did yawn. Comparing these two percentages, the participants who were exposed to yawning yawned 29.4% - 25% = 4.4% more often than those who were not.</p>
</div>
<div id="sampling-scenario" class="section level3">
<h3><span class="header-section-number">8.6.2</span> Sampling scenario</h3>
<p>Let’s review the terminology and notation related to sampling we studied in Subsection <a href="7-sampling.html#terminology-and-notation">7.3.1</a>. In Chapter <a href="7-sampling.html#sampling">7</a> our <em>study population</em> was the bowl of <span class="math inline">\(N\)</span> = 2400 balls. Our <em>population parameter</em> of interest was the <em>population proportion</em> of these balls that were red, denoted mathematically by <span class="math inline">\(p\)</span>. In order to estimate <span class="math inline">\(p\)</span>, we extracted a sample of 50 balls using the shovel and computed the relevant <em>point estimate</em>: the <em>sample proportion</em> that were red, denoted mathematically by <span class="math inline">\(\widehat{p}\)</span>.</p>
<p>Who is the study population here? All humans? All the people who watch the show <em>Mythbusters</em>? It’s hard to say! This question can only be answered if we know how the show’s hosts recruited participants! In other words, what was the <em>sampling methodology</em> used by the <em>Mythbusters</em> to recruit participants? We alas are not provided with this information. Only for the purposes of this case study, however, we’ll <em>assume</em> that the 50 participants are a representative sample of all Americans given the popularity of this show. Thus, we’ll be assuming that any results of this experiment will generalize to all <span class="math inline">\(N\)</span> = 327 million Americans (2018 population).</p>
<p>Just like with our sampling bowl, the population parameter here will involve proportions. However, in this case it will be the <em>difference in population proportions</em> <span class="math inline">\(p_{seed} - p_{control}\)</span>, where <span class="math inline">\(p_{seed}\)</span> is the proportion of <em>all</em> Americans who if exposed to yawning will yawn themselves, and <span class="math inline">\(p_{control}\)</span> is the proportion of <em>all</em> Americans who if not exposed to yawning still yawn themselves. Correspondingly, the point estimate/sample statistic based the <em>Mythbusters</em>’ sample of participants will be the <em>difference in sample proportions</em> <span class="math inline">\(\widehat{p}_{seed} - \widehat{p}_{control}\)</span>. Let’s extend Table <a href="7-sampling.html#tab:table-ch8">7.5</a> of scenarios of sampling for inference to include our latest scenario.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:table-ch8-c">TABLE 8.4: </span>Scenarios of sampling for inference
</caption>
<thead>
<tr>
<th style="text-align:right;">
Scenario
</th>
<th style="text-align:left;">
Population parameter
</th>
<th style="text-align:left;">
Notation
</th>
<th style="text-align:left;">
Point estimate
</th>
<th style="text-align:left;">
Symbol(s)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;width: 0.5in; ">
1
</td>
<td style="text-align:left;width: 1.5in; ">
Population proportion
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(p\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Sample proportion
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\widehat{p}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
2
</td>
<td style="text-align:left;width: 1.5in; ">
Population mean
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Sample mean
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\widehat{\mu}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
3
</td>
<td style="text-align:left;width: 1.5in; ">
Difference in population proportions
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(p_1 - p_2\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Difference in sample proportions
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\widehat{p}_1 - \widehat{p}_2\)</span>
</td>
</tr>
</tbody>
</table>
<p>This is known as a <em>two-sample</em> inference situation since we have two separate samples. Based on their two-samples of size <span class="math inline">\(n_{seed}\)</span> = 34 and <span class="math inline">\(n_{control}\)</span> = 16, the point estimate is</p>
<p><span class="math display">\[
\widehat{p}_{seed} - \widehat{p}_{control} = \frac{24}{34} - \frac{12}{16} = 0.04411765 \approx 4.4\%
\]</span></p>
<p>However, say the <em>Mythbusters</em> repeated this experiment. In other words, say they recruited 50 new participants and exposed 34 of them to yawning and 16 not. Would they obtain the exact same estimated difference of 4.4%? Probably not, again, because of <em>sampling variation</em>.</p>
<p>How does this sampling variation affect their estimate of 4.4%? In other words, what would be a plausible range of values for this difference that accounts for this sampling variation? We can answer this question with confidence intervals! Furthermore, since the <em>Mythbusters</em> only have a single two-sample of 50 participants, they would have to construct a 95% confidence interval for <span class="math inline">\(p_{seed} - p_{control}\)</span> using <em>bootstrap resampling with replacement</em>.</p>
<p>We make a couple of important notes. First, for the comparison between the <code>"seed"</code> and <code>"control"</code> groups to make sense, however, both groups need to be <em>independent</em> from each other. Otherwise, they could influence each other’s results. This means that a participant being selected for the <code>"seed"</code> or <code>"control"</code> group has no influence on another participant being assigned to one of the two groups. As an example, if there were a mother and her child as participants in the study, they wouldn’t necessarily be in the same group. They would each be assigned randomly to one of the two groups of the explanatory variable.</p>
<p>Second, the order of the subtraction in the difference doesn’t matter so long as you are consistent and tailor your interpretations accordingly. In other words, using a point estimate of <span class="math inline">\(\widehat{p}_{seed} - \widehat{p}_{control}\)</span> or <span class="math inline">\(\widehat{p}_{control} - \widehat{p}_{seed}\)</span> does not make a material difference, you just need to stay consistent and interpret your results accordingly.</p>
</div>
<div id="ci-build" class="section level3">
<h3><span class="header-section-number">8.6.3</span> Constructing the confidence interval</h3>
<p>As we did in Subsection <a href="8-confidence-intervals.html#infer-workflow">8.4.2</a>, let’s first construct the bootstrap distribution for <span class="math inline">\(\widehat{p}_{seed} - \widehat{p}_{control}\)</span> and then use this to construct 95% confidence intervals for <span class="math inline">\(p_{seed} - p_{control}\)</span>. We’ll do this using the <code>infer</code> workflow again. However, since the difference in proportions is a new scenario for inference, we’ll need to use some new arguments in the <code>infer</code> functions along the way.</p>
<div id="specify-variables-2" class="section level4 unnumbered">
<h4>1. <code>specify</code> variables</h4>
<p>Let’s take our <code>mythbusters_yawn</code> data frame and <code>specify()</code> which variables are of interest using the <code>y ~ x</code> formula interface where:</p>
<ul>
<li>Our response variable is <code>yawn</code>: whether or not a participant yawned. It has levels <code>"yes"</code> and <code>"no"</code>.</li>
<li>The explanatory variable is <code>group</code>: whether or not a participant was exposed to yawning. It has levels <code>"seed"</code> (exposed to yawning) and <code>"control"</code> (not exposed to yawning).</li>
</ul>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="8-confidence-intervals.html#cb319-1"></a>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb319-2"><a href="8-confidence-intervals.html#cb319-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group)</span></code></pre></div>
<pre><code>Error: A level of the response variable `yawn` needs to be 
specified for the `success` argument in `specify()`.</code></pre>
<p>Alas, we got an error message similar to the one from Subsection <a href="8-confidence-intervals.html#ilyas-yohan">8.5.1</a>: <code>infer</code> is telling us that one of the levels of the categorical variable <code>yawn</code> needs to be defined as the <code>success</code>. Recall that we define <code>success</code> to be the event of interest we are trying to count and compute proportions of. Are we interested in those participants who <code>"yes"</code> yawned or those who <code>"no"</code> didn’t yawn? This isn’t clear to R or someone just picking up the code and results for the first time, so we need to set the <code>success</code> argument to <code>"yes"</code> as follows to improve the transparency of the code:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="8-confidence-intervals.html#cb321-1"></a>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb321-2"><a href="8-confidence-intervals.html#cb321-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group, <span class="dt">success =</span> <span class="st">&quot;yes&quot;</span>)</span></code></pre></div>
<pre><code>Response: yawn (factor)
Explanatory: group (factor)
# A tibble: 50 × 2
   yawn  group  
   &lt;fct&gt; &lt;fct&gt;  
 1 yes   seed   
 2 yes   control
 3 no    seed   
 4 yes   seed   
 5 no    seed   
 6 no    control
 7 yes   seed   
 8 no    control
 9 no    control
10 no    seed   
# … with 40 more rows</code></pre>
</div>
<div id="generate-replicates-2" class="section level4 unnumbered">
<h4>2. <code>generate</code> replicates</h4>
<p>Our next step is to perform <em>bootstrap resampling with replacement</em> like we did with the slips of paper in our pennies activity in Section <a href="8-confidence-intervals.html#resampling-tactile">8.1</a>. We saw how it works with both a single variable in computing bootstrap means in Section <a href="8-confidence-intervals.html#bootstrap-process">8.4</a> and in computing bootstrap proportions in Section <a href="8-confidence-intervals.html#one-prop-ci">8.5</a>, but we haven’t yet worked with bootstrapping involving multiple variables.</p>
<p>In the <code>infer</code> package, bootstrapping with multiple variables means that each <em>row</em> is potentially resampled. Let’s investigate this by focusing only on the first six rows of <code>mythbusters_yawn</code>:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="8-confidence-intervals.html#cb323-1"></a>first_six_rows &lt;-<span class="st"> </span><span class="kw">head</span>(mythbusters_yawn)</span>
<span id="cb323-2"><a href="8-confidence-intervals.html#cb323-2"></a>first_six_rows</span></code></pre></div>
<pre><code># A tibble: 6 × 3
   subj group   yawn 
  &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;
1     1 seed    yes  
2     2 control yes  
3     3 seed    no   
4     4 seed    yes  
5     5 seed    no   
6     6 control no   </code></pre>
<p>When we bootstrap this data, we are potentially pulling the subject’s readings multiple times. Thus, we could see the entries of <code>"seed"</code> for <code>group</code> and <code>"no"</code> for <code>yawn</code> together in a new row in a bootstrap sample. This is further seen by exploring the <code>sample_n()</code> function in <code>dplyr</code> on this smaller 6-row data frame comprised of <code>head(mythbusters_yawn)</code>. The <code>sample_n()</code> function can perform this bootstrapping procedure and is similar to the <code>rep_sample_n()</code> function in <code>infer</code>, except that it is not repeated, but rather only performs one sample with or without replacement.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="8-confidence-intervals.html#cb325-1"></a>first_six_rows <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb325-2"><a href="8-confidence-intervals.html#cb325-2"></a><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> <span class="dv">6</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 3
   subj group   yawn 
  &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;
1     1 seed    yes  
2     6 control no   
3     1 seed    yes  
4     5 seed    no   
5     4 seed    yes  
6     4 seed    yes  </code></pre>
<p>We can see that in this bootstrap sample generated from the first six rows of <code>mythbusters_yawn</code>, we have some rows repeated. The same is true when we perform the <code>generate()</code> step in <code>infer</code> as done in what follows. Using this fact, we <code>generate</code> 1000 replicates, or, in other words, we bootstrap resample the 50 participants with replacement 1000 times.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="8-confidence-intervals.html#cb327-1"></a>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb327-2"><a href="8-confidence-intervals.html#cb327-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group, <span class="dt">success =</span> <span class="st">&quot;yes&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb327-3"><a href="8-confidence-intervals.html#cb327-3"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">type =</span> <span class="st">&quot;bootstrap&quot;</span>)</span></code></pre></div>
<pre><code>Response: yawn (factor)
Explanatory: group (factor)
# A tibble: 50,000 × 3
# Groups:   replicate [1,000]
   replicate yawn  group  
       &lt;int&gt; &lt;fct&gt; &lt;fct&gt;  
 1         1 yes   seed   
 2         1 yes   control
 3         1 no    control
 4         1 no    control
 5         1 yes   seed   
 6         1 yes   seed   
 7         1 yes   seed   
 8         1 yes   seed   
 9         1 no    seed   
10         1 yes   seed   
# … with 49,990 more rows</code></pre>
<p>Observe that the resulting data frame has 50,000 rows. This is because we performed resampling of 50 participants with replacement 1000 times and 50,000 = 1000 <span class="math inline">\(\cdot\)</span> 50. The variable <code>replicate</code> indicates which resample each row belongs to. So it has the value <code>1</code> 50 times, the value <code>2</code> 50 times, all the way through to the value <code>1000</code> 50 times.</p>
</div>
<div id="calculate-summary-statistics-2" class="section level4 unnumbered">
<h4>3. <code>calculate</code> summary statistics</h4>
<p>After we <code>generate()</code> many replicates of bootstrap resampling with replacement, we next want to summarize the bootstrap resamples of size 50 with a single summary statistic, the difference in proportions. We do this by setting the <code>stat</code> argument to <code>"diff in props"</code>:</p>
<!-- 
Chester: A challenging Learning check for those {dplyr} diehards is to get these values 
without using {infer}. It takes a double group_by() and some trickery, but could 
be a good exercise for those that don't quite see the power of {infer}.

Albert: Great idea!
-->
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="8-confidence-intervals.html#cb329-1"></a>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb329-2"><a href="8-confidence-intervals.html#cb329-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group, <span class="dt">success =</span> <span class="st">&quot;yes&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb329-3"><a href="8-confidence-intervals.html#cb329-3"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">type =</span> <span class="st">&quot;bootstrap&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb329-4"><a href="8-confidence-intervals.html#cb329-4"></a><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;diff in props&quot;</span>)</span></code></pre></div>
<pre><code>Error: Statistic is based on a difference; specify the `order` in which to
subtract the levels of the explanatory variable.</code></pre>
<p>We see another error here. We need to specify the order of the subtraction. Is it <span class="math inline">\(\widehat{p}_{seed} - \widehat{p}_{control}\)</span> or <span class="math inline">\(\widehat{p}_{control} - \widehat{p}_{seed}\)</span>. We specify it to be <span class="math inline">\(\widehat{p}_{seed} - \widehat{p}_{control}\)</span> by setting <code>order = c("seed", "control")</code>. Note that you could’ve also set <code>order = c("control", "seed")</code>. As we stated earlier, the order of the subtraction does not matter, so long as you stay consistent throughout your analysis and tailor your interpretations accordingly.</p>
<p>Let’s save the output in a data frame <code>bootstrap_distribution_yawning</code>:</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="8-confidence-intervals.html#cb331-1"></a>bootstrap_distribution_yawning &lt;-<span class="st"> </span>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb331-2"><a href="8-confidence-intervals.html#cb331-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group, <span class="dt">success =</span> <span class="st">&quot;yes&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb331-3"><a href="8-confidence-intervals.html#cb331-3"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">type =</span> <span class="st">&quot;bootstrap&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb331-4"><a href="8-confidence-intervals.html#cb331-4"></a><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;diff in props&quot;</span>, <span class="dt">order =</span> <span class="kw">c</span>(<span class="st">&quot;seed&quot;</span>, <span class="st">&quot;control&quot;</span>))</span>
<span id="cb331-5"><a href="8-confidence-intervals.html#cb331-5"></a>bootstrap_distribution_yawning</span></code></pre></div>
<pre><code># A tibble: 1,000 × 2
   replicate        stat
       &lt;int&gt;       &lt;dbl&gt;
 1         1  0.0357143 
 2         2  0.229167  
 3         3  0.00952381
 4         4  0.0106952 
 5         5  0.00483092
 6         6  0.00793651
 7         7 -0.0845588 
 8         8 -0.00466200
 9         9  0.164686  
10        10  0.124777  
# … with 990 more rows</code></pre>
<p>Observe that the resulting data frame has 1000 rows and 2 columns corresponding to the 1000 <code>replicate</code> ID’s and the 1000 differences in proportions for each bootstrap resample in <code>stat</code>.</p>
</div>
<div id="visualize-the-results-2" class="section level4 unnumbered">
<h4>4. <code>visualize</code> the results</h4>
<p>In Figure <a href="8-confidence-intervals.html#fig:bootstrap-distribution-mythbusters">8.31</a> we <code>visualize()</code> the resulting bootstrap resampling distribution. Let’s also add a vertical line at 0 by adding a <code>geom_vline()</code> layer.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="8-confidence-intervals.html#cb333-1"></a><span class="kw">visualize</span>(bootstrap_distribution_yawning) <span class="op">+</span></span>
<span id="cb333-2"><a href="8-confidence-intervals.html#cb333-2"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:bootstrap-distribution-mythbusters"></span>
<img src="ModernDive_files/figure-html/bootstrap-distribution-mythbusters-1.png" alt="Bootstrap distribution." width="\textwidth" />
<p class="caption">
FIGURE 8.31: Bootstrap distribution.
</p>
</div>
<p>First, let’s compute the 95% confidence interval for <span class="math inline">\(p_{seed} - p_{control}\)</span> using the percentile method, in other words, by identifying the 2.5th and 97.5th percentiles which include the middle 95% of values. Recall that this method does not require the bootstrap distribution to be normally shaped.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="8-confidence-intervals.html#cb334-1"></a>bootstrap_distribution_yawning <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb334-2"><a href="8-confidence-intervals.html#cb334-2"></a><span class="st">  </span><span class="kw">get_confidence_interval</span>(<span class="dt">type =</span> <span class="st">&quot;percentile&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 2
   lower_ci upper_ci
      &lt;dbl&gt;    &lt;dbl&gt;
1 -0.238276 0.302464</code></pre>
<p>Second, since the bootstrap distribution is roughly bell-shaped, we can construct a confidence interval using the standard error method as well. Recall that to construct a confidence interval using the standard error method, we need to specify the center of the interval using the <code>point_estimate</code> argument. In our case, we need to set it to be the difference in sample proportions of 4.4% that the <em>Mythbusters</em> observed.</p>
<p>We can also use the <code>infer</code> workflow to compute this value by excluding the <code>generate()</code> 1000 bootstrap replicates step. In other words, do not generate replicates, but rather use only the original sample data. We can achieve this by commenting out the <code>generate()</code> line, telling R to ignore it:</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="8-confidence-intervals.html#cb336-1"></a>obs_diff_in_props &lt;-<span class="st"> </span>mythbusters_yawn <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb336-2"><a href="8-confidence-intervals.html#cb336-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">formula =</span> yawn <span class="op">~</span><span class="st"> </span>group, <span class="dt">success =</span> <span class="st">&quot;yes&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb336-3"><a href="8-confidence-intervals.html#cb336-3"></a><span class="st">  </span><span class="co"># generate(reps = 1000, type = &quot;bootstrap&quot;) %&gt;% </span></span>
<span id="cb336-4"><a href="8-confidence-intervals.html#cb336-4"></a><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;diff in props&quot;</span>, <span class="dt">order =</span> <span class="kw">c</span>(<span class="st">&quot;seed&quot;</span>, <span class="st">&quot;control&quot;</span>))</span>
<span id="cb336-5"><a href="8-confidence-intervals.html#cb336-5"></a>obs_diff_in_props</span></code></pre></div>
<pre><code># A tibble: 1 × 1
       stat
      &lt;dbl&gt;
1 0.0441176</code></pre>
<p>We thus plug this value in as the <code>point_estimate</code> argument.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="8-confidence-intervals.html#cb338-1"></a>myth_ci_se &lt;-<span class="st"> </span>bootstrap_distribution_yawning <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb338-2"><a href="8-confidence-intervals.html#cb338-2"></a><span class="st">  </span><span class="kw">get_confidence_interval</span>(<span class="dt">type =</span> <span class="st">&quot;se&quot;</span>, <span class="dt">point_estimate =</span> obs_diff_in_props)</span></code></pre></div>
<pre><code>Using `level = 0.95` to compute confidence interval.</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="8-confidence-intervals.html#cb340-1"></a>myth_ci_se</span></code></pre></div>
<pre><code># A tibble: 1 × 2
   lower_ci upper_ci
      &lt;dbl&gt;    &lt;dbl&gt;
1 -0.227291 0.315526</code></pre>
<p>Let’s visualize both confidence intervals in Figure <a href="8-confidence-intervals.html#fig:bootstrap-distribution-mythbusters-CI">8.32</a>, with the percentile-method interval marked with black lines and the standard-error-method marked with grey lines. Observe that they are both similar to each other.</p>
<div class="figure" style="text-align: center"><span id="fig:bootstrap-distribution-mythbusters-CI"></span>
<img src="ModernDive_files/figure-html/bootstrap-distribution-mythbusters-CI-1.png" alt="Two 95\% confidence intervals: percentile method (black) and standard error method (grey)." width="\textwidth" />
<p class="caption">
FIGURE 8.32: Two 95% confidence intervals: percentile method (black) and standard error method (grey).
</p>
</div>
</div>
</div>
<div id="interpreting-the-confidence-interval" class="section level3">
<h3><span class="header-section-number">8.6.4</span> Interpreting the confidence interval</h3>
<p>Given that both confidence intervals are quite similar, let’s focus our interpretation to only the percentile-method confidence interval of (-0.238, 0.302). Recall from Subsection <a href="8-confidence-intervals.html#shorthand">8.5.2</a> that the precise statistical interpretation of a 95% confidence interval is: if this construction procedure is repeated 100 times, then we expect about 95 of the confidence intervals to capture the true value of <span class="math inline">\(p_{seed} - p_{control}\)</span>. In other words, if we gathered 100 samples of <span class="math inline">\(n\)</span> = 50 participants from a similar pool of people and constructed 100 confidence intervals each based on each of the 100 samples, about 95 of them will contain the true value of <span class="math inline">\(p_{seed} - p_{control}\)</span> while about five won’t. Given that this is a little long winded, we use the shorthand interpretation: we’re 95% “confident” that the true difference in proportions <span class="math inline">\(p_{seed} - p_{control}\)</span> is between (-0.238, 0.302).</p>
<p>There is one value of particular interest that this 95% confidence interval contains: zero. If <span class="math inline">\(p_{seed} - p_{control}\)</span> were equal to 0, then there would be no difference in proportion yawning between the two groups. This would suggest that there is no associated effect of being exposed to a yawning recruiter on whether you yawn yourself.</p>
<p>In our case, since the 95% confidence interval includes 0, we cannot conclusively say if either proportion is larger. Of our 1000 bootstrap resamples with replacement, sometimes <span class="math inline">\(\widehat{p}_{seed}\)</span> was higher and thus those exposed to yawning yawned themselves more often. At other times, the reverse happened.</p>
<p>Say, on the other hand, the 95% confidence interval was entirely above zero. This would suggest that <span class="math inline">\(p_{seed} - p_{control} &gt; 0\)</span>, or, in other words <span class="math inline">\(p_{seed} &gt; p_{control}\)</span>, and thus we’d have evidence suggesting those exposed to yawning do yawn more often.</p>
<!--
v2 TODO: Talk about randomized experiment nature of Mythbusters data

Add this back once we add a discussion on random assignment and 
randomized experiments in Conclusion of sampling chapter

Furthermore, if the 50 participants were randomly allocated to
the `"seed"` and `"control"` groups, then this would be suggestive that being
exposed to yawning doesn't not *cause* yawning. In other words, yawning is not
contagious. However, no information on how participants were assigned to be
exposed to yawning or not could be found, so we cannot make such a causal
statement.
-->
</div>
</div>
<div id="ci-conclusion" class="section level2">
<h2><span class="header-section-number">8.7</span> Conclusion</h2>
<div id="bootstrap-vs-sampling" class="section level3">
<h3><span class="header-section-number">8.7.1</span> Comparing bootstrap and sampling distributions</h3>
<p>Let’s talk more about the relationship between <em>sampling distributions</em> and <em>bootstrap distributions</em>.</p>
<p>Recall back in Subsection <a href="#shovel-1000-times"><strong>??</strong></a>, we took 1000 virtual samples from the <code>bowl</code> using a virtual shovel, computed 1000 values of the sample proportion red <span class="math inline">\(\widehat{p}\)</span>, then visualized their distribution in a histogram. Recall that this distribution is called the <em>sampling distribution of</em> <span class="math inline">\(\widehat{p}\)</span>. Furthermore, the standard deviation of the sampling distribution has a special name: the <em>standard error</em>.</p>
<p>We also mentioned that this sampling activity does not reflect how sampling is done in real life. Rather, it was an <em>idealized version</em> of sampling so that we could study the effects of sampling variation on estimates, like the proportion of the shovel’s balls that are red. In real life, however, one would take a single sample that’s as large as possible, much like in the Obama poll we saw in Section <a href="7-sampling.html#sampling-case-study">7.4</a>. But how can we get a sense of the effect of sampling variation on estimates if we only have one sample and thus only one estimate? Don’t we need many samples and hence many estimates?</p>
<p>The workaround to having a <em>single</em> sample was to perform <em>bootstrap resampling with replacement</em> from the single sample. We did this in the resampling activity in Section <a href="8-confidence-intervals.html#resampling-tactile">8.1</a> where we focused on the mean year of minting of pennies. We used pieces of paper representing the original sample of 50 pennies from the bank and resampled them with replacement from a hat. We had 35 of our friends perform this activity and visualized the resulting 35 sample means <span class="math inline">\(\overline{x}\)</span> in a histogram in Figure <a href="8-confidence-intervals.html#fig:tactile-resampling-6">8.11</a>.</p>
<p>This distribution was called the <em>bootstrap distribution</em> of <span class="math inline">\(\overline{x}\)</span>. We stated at the time that the bootstrap distribution is an <em>approximation</em> to the sampling distribution of <span class="math inline">\(\overline{x}\)</span> in the sense that both distributions will have a similar shape and similar spread.  Thus the <em>standard error</em> of the bootstrap distribution can be used as an approximation to the <em>standard error</em> of the sampling distribution.</p>
<p>Let’s show you that this is the case by now comparing these two types of distributions. Specifically, we’ll compare</p>
<ol style="list-style-type: decimal">
<li>the sampling distribution of <span class="math inline">\(\widehat{p}\)</span> based on 1000 virtual samples from the <code>bowl</code> from Subsection <a href="#shovel-1000-times"><strong>??</strong></a> to</li>
<li>the bootstrap distribution of <span class="math inline">\(\widehat{p}\)</span> based on 1000 virtual resamples with replacement from Ilyas and Yohan’s single sample <code>bowl_sample_1</code> from Subsection <a href="8-confidence-intervals.html#ilyas-yohan">8.5.1</a>.</li>
</ol>
<div id="sampling-distribution" class="section level4 unnumbered">
<h4>Sampling distribution</h4>
<p>Here is the code you saw in Subsection <a href="#shovel-1000-times"><strong>??</strong></a> to construct the sampling distribution of <span class="math inline">\(\widehat{p}\)</span> shown again in Figure <a href="8-confidence-intervals.html#fig:sampling-distribution-part-deux">8.33</a>, with some changes to incorporate the statistical terminology relating to sampling from Subsection <a href="7-sampling.html#terminology-and-notation">7.3.1</a>.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="8-confidence-intervals.html#cb342-1"></a><span class="co"># Take 1000 virtual samples of size 50 from the bowl:</span></span>
<span id="cb342-2"><a href="8-confidence-intervals.html#cb342-2"></a>virtual_samples &lt;-<span class="st"> </span>bowl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb342-3"><a href="8-confidence-intervals.html#cb342-3"></a><span class="st">  </span><span class="kw">rep_sample_n</span>(<span class="dt">size =</span> <span class="dv">50</span>, <span class="dt">reps =</span> <span class="dv">1000</span>)</span>
<span id="cb342-4"><a href="8-confidence-intervals.html#cb342-4"></a><span class="co"># Compute the sampling distribution of 1000 values of p-hat</span></span>
<span id="cb342-5"><a href="8-confidence-intervals.html#cb342-5"></a>sampling_distribution &lt;-<span class="st"> </span>virtual_samples <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb342-6"><a href="8-confidence-intervals.html#cb342-6"></a><span class="st">  </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb342-7"><a href="8-confidence-intervals.html#cb342-7"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">red =</span> <span class="kw">sum</span>(color <span class="op">==</span><span class="st"> &quot;red&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb342-8"><a href="8-confidence-intervals.html#cb342-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_red =</span> red <span class="op">/</span><span class="st"> </span><span class="dv">50</span>)</span>
<span id="cb342-9"><a href="8-confidence-intervals.html#cb342-9"></a><span class="co"># Visualize sampling distribution of p-hat</span></span>
<span id="cb342-10"><a href="8-confidence-intervals.html#cb342-10"></a><span class="kw">ggplot</span>(sampling_distribution, <span class="kw">aes</span>(<span class="dt">x =</span> prop_red)) <span class="op">+</span></span>
<span id="cb342-11"><a href="8-confidence-intervals.html#cb342-11"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="dt">boundary =</span> <span class="fl">0.4</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb342-12"><a href="8-confidence-intervals.html#cb342-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Proportion of 50 balls that were red&quot;</span>, </span>
<span id="cb342-13"><a href="8-confidence-intervals.html#cb342-13"></a>       <span class="dt">title =</span> <span class="st">&quot;Sampling distribution&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:sampling-distribution-part-deux"></span>
<img src="ModernDive_files/figure-html/sampling-distribution-part-deux-1.png" alt="Previously seen sampling distribution of sample proportion red for $n = 1000$." width="\textwidth" />
<p class="caption">
FIGURE 8.33: Previously seen sampling distribution of sample proportion red for <span class="math inline">\(n = 1000\)</span>.
</p>
</div>
<p>An important thing to keep in mind is the default value for <code>replace</code> is <code>FALSE</code> when using <code>rep_sample_n()</code>. This is because when sampling 50 balls with a shovel, we are extracting 50 balls one-by-one <em>without</em> replacing them. This is in contrast to bootstrap resampling <em>with</em> replacement, where we resample a ball and put it back, and repeat this process 50 times.</p>
<p>Let’s quantify the variability in this sampling distribution by calculating the standard deviation of the <code>prop_red</code> variable representing 1000 values of the sample proportion <span class="math inline">\(\widehat{p}\)</span>. Remember that the standard deviation of the sampling distribution is the <em>standard error</em>, frequently denoted as <code>se</code>.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="8-confidence-intervals.html#cb343-1"></a>sampling_distribution <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">se =</span> <span class="kw">sd</span>(prop_red))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
         se
      &lt;dbl&gt;
1 0.0673987</code></pre>
</div>
<div id="bootstrap-distribution" class="section level4 unnumbered">
<h4>Bootstrap distribution</h4>
<p>Here is the code you previously saw in Subsection <a href="8-confidence-intervals.html#ilyas-yohan">8.5.1</a> to construct the bootstrap distribution of <span class="math inline">\(\widehat{p}\)</span> based on Ilyas and Yohan’s original sample of 50 balls saved in <code>bowl_sample_1</code>.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="8-confidence-intervals.html#cb345-1"></a>bootstrap_distribution &lt;-<span class="st"> </span>bowl_sample_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb345-2"><a href="8-confidence-intervals.html#cb345-2"></a><span class="st">  </span><span class="kw">specify</span>(<span class="dt">response =</span> color, <span class="dt">success =</span> <span class="st">&quot;red&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb345-3"><a href="8-confidence-intervals.html#cb345-3"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dt">reps =</span> <span class="dv">1000</span>, <span class="dt">type =</span> <span class="st">&quot;bootstrap&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb345-4"><a href="8-confidence-intervals.html#cb345-4"></a><span class="st">  </span><span class="kw">calculate</span>(<span class="dt">stat =</span> <span class="st">&quot;prop&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:bootstrap-distribution-part-deux"></span>
<img src="ModernDive_files/figure-html/bootstrap-distribution-part-deux-1.png" alt="Bootstrap distribution of proportion red for $n = 1000$." width="\textwidth" />
<p class="caption">
FIGURE 8.34: Bootstrap distribution of proportion red for <span class="math inline">\(n = 1000\)</span>.
</p>
</div>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="8-confidence-intervals.html#cb346-1"></a>bootstrap_distribution <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">se =</span> <span class="kw">sd</span>(stat))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
         se
      &lt;dbl&gt;
1 0.0712212</code></pre>
</div>
<div id="comparison" class="section level4 unnumbered">
<h4>Comparison</h4>
<p>Now that we have computed both the sampling distribution and the bootstrap distributions, let’s compare them side-by-side in Figure <a href="8-confidence-intervals.html#fig:side-by-side">8.35</a>. We’ll make both histograms have matching scales on the x- and y-axes to make them more comparable. Furthermore, we’ll add:</p>
<ol style="list-style-type: decimal">
<li>To the sampling distribution on the top: a solid line denoting the proportion of the bowl’s balls that are red <span class="math inline">\(p\)</span> = 0.375.</li>
<li>To the bootstrap distribution on the bottom: a dashed line at the sample proportion <span class="math inline">\(\widehat{p}\)</span> = 21/50 = 0.42 = 42% that Ilyas and Yohan observed.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:side-by-side"></span>
<img src="ModernDive_files/figure-html/side-by-side-1.png" alt="Comparing the sampling and bootstrap distributions of $\widehat{p}$." width="\textwidth" />
<p class="caption">
FIGURE 8.35: Comparing the sampling and bootstrap distributions of <span class="math inline">\(\widehat{p}\)</span>.
</p>
</div>
<p>There is a lot going on in Figure <a href="8-confidence-intervals.html#fig:side-by-side">8.35</a>, so let’s break down all the comparisons slowly. First, observe how the sampling distribution on top is centered at <span class="math inline">\(p\)</span> = 0.375. This is because the sampling is done at random and in an unbiased fashion. So the estimates <span class="math inline">\(\widehat{p}\)</span> are centered at the true value of <span class="math inline">\(p\)</span>.</p>
<p>However, this is not the case with the following bootstrap distribution. The bootstrap distribution is centered at 0.42, which is the proportion red of Ilyas and Yohan’s 50 sampled balls. This is because we are resampling from the same sample over and over again. Since the bootstrap distribution is centered at the original sample’s proportion, it doesn’t necessarily provide a better estimate of <span class="math inline">\(p\)</span> = 0.375. This leads us to our first lesson about bootstrapping:</p>
<blockquote>
<p>The bootstrap distribution will likely not have the same center as the sampling distribution. In other words, bootstrapping cannot improve the quality of an estimate.</p>
</blockquote>
<p>Second, let’s now compare the spread of the two distributions: they are somewhat similar. In the previous code, we computed the standard deviations of both distributions as well. Recall that such standard deviations have a special name: <em>standard errors</em>. Let’s compare them in Table <a href="8-confidence-intervals.html#tab:comparing-se">8.5</a>.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:comparing-se">TABLE 8.5: </span>Comparing standard errors
</caption>
<thead>
<tr>
<th style="text-align:left;">
Distribution type
</th>
<th style="text-align:right;">
Standard error
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sampling distribution
</td>
<td style="text-align:right;">
0.067
</td>
</tr>
<tr>
<td style="text-align:left;">
Bootstrap distribution
</td>
<td style="text-align:right;">
0.071
</td>
</tr>
</tbody>
</table>
<p>Notice that the bootstrap distribution’s standard error is a rather good <em>approximation</em> to the sampling distribution’s standard error. This leads us to our second lesson about bootstrapping:</p>
<blockquote>
<p>Even if the bootstrap distribution might not have the same center as the sampling distribution, it will likely have very similar shape and spread. In other words, bootstrapping will give you a good estimate of the <em>standard error</em>.</p>
</blockquote>
<p>Thus, using the fact that the bootstrap distribution and sampling distributions have similar spreads, we can build confidence intervals using bootstrapping as we’ve done all throughout this chapter!</p>
</div>
</div>
<div id="theory-ci" class="section level3">
<h3><span class="header-section-number">8.7.2</span> Theory-based confidence intervals</h3>
<p>So far in this chapter, we’ve constructed confidence intervals using two methods: the percentile method and the standard error method. Recall also from Subsection <a href="8-confidence-intervals.html#se-method">8.3.2</a> that we can only use the standard-error method if the bootstrap distribution is bell-shaped (i.e., normally distributed).</p>
<p>In a similar vein, if the sampling distribution is normally shaped, there is another method for constructing confidence intervals that does not involve using your computer. You can use a <em>theory-based method</em> involving mathematical formulas!</p>
<p>The formula uses the rule of thumb we saw in Appendix <a href="A-appendixA.html#appendix-normal-curve">A.2</a> that 95% of values in a normal distribution are within <span class="math inline">\(\pm 1.96\)</span> standard deviations of the mean. In the case of sampling and bootstrap distributions, recall that the standard deviation has a special name: the <em>standard error</em>.</p>
<div id="theory-based-method-for-computing-standard-errors" class="section level4 unnumbered">
<h4>Theory-based method for computing standard errors</h4>
<p>There exists in many cases a formula that approximates the standard error! In the case of our <code>bowl</code> where we used the sample proportion red <span class="math inline">\(\widehat{p}\)</span> to estimate the proportion of the bowl’s balls that are red, the formula that approximates the standard error is:</p>
<p><span class="math display">\[\text{SE}_{\widehat{p}} \approx \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}\]</span></p>
<p>For example, recall from <code>bowl_sample_1</code> that Yohan and Ilyas sampled <span class="math inline">\(n = 50\)</span> balls and observed a sample proportion <span class="math inline">\(\widehat{p}\)</span> of 21/50 = 0.42. So, using the formula, an approximation of the standard error of <span class="math inline">\(\widehat{p}\)</span> is</p>
<p><span class="math display">\[\text{SE}_{\widehat{p}} \approx \sqrt{\frac{0.42(1-0.42)}{50}} = \sqrt{0.004872} = 0.0698 \approx 0.070\]</span></p>
<p>The key observation to make here is that there is an <span class="math inline">\(n\)</span> in the denominator. So as the sample size <span class="math inline">\(n\)</span> increases, the standard error decreases. We’ve demonstrated this fact using our virtual shovels in Subsection <a href="7-sampling.html#moral-of-the-story">7.3.3</a>. If you don’t recall this demonstration, we highly recommend you go back and read that subsection.</p>
<p>Let’s compare this theory-based standard error to the standard error of the sampling and bootstrap distributions you computed previously in Subsection <a href="8-confidence-intervals.html#bootstrap-vs-sampling">8.7.1</a> in Table <a href="8-confidence-intervals.html#tab:comparing-se-2">8.6</a>. Notice how they are all similar!</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:comparing-se-2">TABLE 8.6: </span>Comparing standard errors
</caption>
<thead>
<tr>
<th style="text-align:left;">
Distribution type
</th>
<th style="text-align:right;">
Standard error
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sampling distribution
</td>
<td style="text-align:right;">
0.067
</td>
</tr>
<tr>
<td style="text-align:left;">
Bootstrap distribution
</td>
<td style="text-align:right;">
0.071
</td>
</tr>
<tr>
<td style="text-align:left;">
Formula approximation
</td>
<td style="text-align:right;">
0.070
</td>
</tr>
</tbody>
</table>
<p>Going back to Yohan and Ilyas’ sample proportion of <span class="math inline">\(\widehat{p}\)</span> of 21/50 = 0.42, say this were based on a sample of size <span class="math inline">\(n\)</span> = 100 instead of 50. Then the standard error would be:</p>
<p><span class="math display">\[\text{SE}_{\widehat{p}} \approx \sqrt{\frac{0.42(1-0.42)}{100}} = \sqrt{0.002436} = 0.0494\]</span></p>
<p>Observe that the standard error has gone down from 0.0698 to 0.0494. In other words, the “typical” error of our estimates using <span class="math inline">\(n\)</span> = 100 will go down and hence be more <em>precise</em>. Recall that we illustrated the difference between accuracy and precision of estimates in Figure <a href="7-sampling.html#fig:accuracy-vs-precision">7.13</a>.</p>
<p>Why is this formula true? Unfortunately, we don’t have the tools at this point to prove this; you’ll need to take a more advanced course in probability and statistics. (It is related to the concepts of Bernoulli and Binomial Distributions. You can read more about its derivation <a href="http://onlinestatbook.com/2/sampling_distributions/samp_dist_p.html">here</a> if you like.)</p>
</div>
<div id="theory-based-method-for-constructing-confidence-intervals" class="section level4 unnumbered">
<h4>Theory-based method for constructing confidence intervals</h4>
<p>Using these theory-based standard errors, let’s present a theory-based method for constructing 95% confidence intervals that does not involve using a computer, but rather mathematical formulas. Note that this theory-based method only holds if the sampling distribution is normally shaped, so that we can use the 95% rule of thumb about normal distributions discussed in Appendix <a href="A-appendixA.html#appendix-normal-curve">A.2</a>.</p>
<ol style="list-style-type: decimal">
<li>Collect a single representative sample of size <span class="math inline">\(n\)</span> that’s as large as possible.</li>
<li>Compute the <em>point estimate</em>: the <em>sample proportion</em> <span class="math inline">\(\widehat{p}\)</span>. Think of this as the center of your “net.”</li>
<li>Compute the approximation to the standard error</li>
</ol>
<p><span class="math display">\[\text{SE}_{\widehat{p}} \approx \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Compute a quantity known as the <em>margin of error</em> (more on this later after we list the five steps):</li>
</ol>
<p><span class="math display">\[\text{MoE}_{\widehat{p}} = 1.96 \cdot \text{SE}_{\widehat{p}} =  1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}\]</span></p>
<ol start="5" style="list-style-type: decimal">
<li>Compute both endpoints of the confidence interval.
<ul>
<li><p>The lower end-point. Think of this as the left end-point of the net:
<span class="math display">\[\widehat{p} - \text{MoE}_{\widehat{p}} = \widehat{p} - 1.96 \cdot \text{SE}_{\widehat{p}} = \widehat{p} - 1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}\]</span></p></li>
<li><p>The upper endpoint. Think of this as the right end-point of the net:
<span class="math display">\[\widehat{p} + \text{MoE}_{\widehat{p}} = \widehat{p} + 1.96 \cdot \text{SE}_{\widehat{p}} = \widehat{p} + 1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}\]</span></p></li>
<li><p>Alternatively, you can succinctly summarize a 95% confidence interval for <span class="math inline">\(p\)</span> using the <span class="math inline">\(\pm\)</span> symbol:</p></li>
</ul>
<span class="math display">\[\widehat{p} \pm \text{MoE}_{\widehat{p}} = \widehat{p} \pm (1.96 \cdot \text{SE}_{\widehat{p}}) = \widehat{p} \pm \left( 1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}} \right)\]</span></li>
</ol>
<p>So going back to Yohan and Ilyas’ sample of <span class="math inline">\(n = 50\)</span> balls that had 21 red balls, the 95% confidence interval for <span class="math inline">\(p\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
0.41 \pm 1.96 \cdot 0.0698 &amp;= 0.41 \, \pm \, 0.137 \\ &amp;= (0.41 - 0.137, \, 0.41 + 0.137) \\ &amp;= (0.273, \, 0.547).
\end{aligned}
\]</span></p>
<p>Yohan and Ilyas are 95% “confident” that the true proportion red of the bowl’s balls is between 28.3% and 55.7%. Given that the true population proportion <span class="math inline">\(p\)</span> was 0.375, in this case they successfully captured the fish.</p>
<p>In Step 4, we defined a statistical quantity known as the <em>margin of error</em>. You can think of this quantity as how much the net extends to the left and to the right of the center of our net. The 1.96 multiplier is rooted in the 95% rule of thumb we introduced earlier and the fact that we want the confidence level to be 95%. The value of the margin of error entirely determines the width of the confidence interval. Recall from Subsection <a href="8-confidence-intervals.html#ci-width">8.5.3</a> that confidence interval widths are determined by an interplay of the confidence level, the sample size <span class="math inline">\(n\)</span>, and the standard error.</p>
<p>Let’s revisit the poll of President Obama’s approval rating among young Americans aged 18-29 which we introduced in Section <a href="7-sampling.html#sampling-case-study">7.4</a>. Pollsters found that based on a representative sample of <span class="math inline">\(n\)</span> = 2089 young Americans, <span class="math inline">\(\widehat{p}\)</span> = 0.41 = 41% supported President Obama.</p>
<p>If you look towards the end of the article, it also states: “The poll’s margin of error was plus or minus 2.1 percentage points.” This is precisely the <span class="math inline">\(\text{MoE}\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\text{MoE} &amp;= 1.96 \cdot \text{SE} =  1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}} = 1.96 \cdot \sqrt{\frac{0.41(1-0.41)}{2089}} \\
&amp;= 1.96 \cdot 0.0108 = 0.021 = 2.1\%
\end{aligned}
\]</span></p>
<p>Their poll results are based on a confidence level of 95% and the resulting 95% confidence interval for the proportion of all young Americans who support Obama is:</p>
<p><span class="math display">\[\widehat{p} \pm \text{MoE} = 0.41 \pm 0.021 = (0.389, \, 0.431) = (38.9\%, \, 43.1\%).\]</span></p>
</div>
<div id="confidence-intervals-based-on-33-tactile-samples" class="section level4 unnumbered">
<h4>Confidence intervals based on 33 tactile samples</h4>
<p>Let’s revisit our 33 friends’ samples from the <code>bowl</code> from Subsection <a href="7-sampling.html#student-shovels">7.1.3</a>. We’ll use their 33 samples to construct 33 theory-based 95% confidence intervals for <span class="math inline">\(p\)</span>. Recall this data was saved in the <code>tactile_prop_red</code> data frame included in the <code>moderndive</code> package:</p>
<ol style="list-style-type: decimal">
<li><code>rename()</code> the variable <code>prop_red</code> to <code>p_hat</code>, the statistical name of the sample proportion <span class="math inline">\(\widehat{p}\)</span>.</li>
<li><code>mutate()</code> a new variable <code>n</code> making explicit the sample size of 50.</li>
<li><code>mutate()</code> other new variables computing:
<ul>
<li>The standard error <code>SE</code> for <span class="math inline">\(\widehat{p}\)</span> using the previous formula.</li>
<li>The margin of error <code>MoE</code> by multiplying the <code>SE</code> by 1.96</li>
<li>The left endpoint of the confidence interval <code>lower_ci</code></li>
<li>The right endpoint of the confidence interval <code>upper_ci</code></li>
</ul></li>
</ol>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="8-confidence-intervals.html#cb348-1"></a>conf_ints &lt;-<span class="st"> </span>tactile_prop_red <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb348-2"><a href="8-confidence-intervals.html#cb348-2"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">p_hat =</span> prop_red) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb348-3"><a href="8-confidence-intervals.html#cb348-3"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb348-4"><a href="8-confidence-intervals.html#cb348-4"></a>    <span class="dt">n =</span> <span class="dv">50</span>,</span>
<span id="cb348-5"><a href="8-confidence-intervals.html#cb348-5"></a>    <span class="dt">SE =</span> <span class="kw">sqrt</span>(p_hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_hat) <span class="op">/</span><span class="st"> </span>n),</span>
<span id="cb348-6"><a href="8-confidence-intervals.html#cb348-6"></a>    <span class="dt">MoE =</span> <span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>SE,</span>
<span id="cb348-7"><a href="8-confidence-intervals.html#cb348-7"></a>    <span class="dt">lower_ci =</span> p_hat <span class="op">-</span><span class="st"> </span>MoE,</span>
<span id="cb348-8"><a href="8-confidence-intervals.html#cb348-8"></a>    <span class="dt">upper_ci =</span> p_hat <span class="op">+</span><span class="st"> </span>MoE</span>
<span id="cb348-9"><a href="8-confidence-intervals.html#cb348-9"></a>  )</span></code></pre></div>
<pre><code># A tibble: 33 × 9
   group    replicate red_balls p_hat     n        SE      MoE lower_ci upper_ci
   &lt;chr&gt;        &lt;int&gt;     &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 Ilyas, …         1        21  0.42    50 0.0697997 0.136807 0.283193 0.556807
 2 Morgan,…         2        17  0.34    50 0.0669925 0.131305 0.208695 0.471305
 3 Martin,…         3        21  0.42    50 0.0697997 0.136807 0.283193 0.556807
 4 Clark, …         4        21  0.42    50 0.0697997 0.136807 0.283193 0.556807
 5 Riddhi,…         5        18  0.36    50 0.0678823 0.133049 0.226951 0.493049
 6 Andrew,…         6        19  0.38    50 0.0686440 0.134542 0.245458 0.514542
 7 Julia            7        19  0.38    50 0.0686440 0.134542 0.245458 0.514542
 8 Rachel,…         8        11  0.22    50 0.0585833 0.114823 0.105177 0.334823
 9 Daniel,…         9        15  0.3     50 0.0648074 0.127023 0.172977 0.427023
10 Josh, M…        10        17  0.34    50 0.0669925 0.131305 0.208695 0.471305
# … with 23 more rows</code></pre>
<p>In Figure <a href="8-confidence-intervals.html#fig:tactile-conf-int">8.36</a>, let’s plot the 33 confidence intervals for <span class="math inline">\(p\)</span> saved in <code>conf_ints</code> along with a vertical line at <span class="math inline">\(p\)</span> = 0.375 indicating the true proportion of the <code>bowl</code>’s balls that are red. Furthermore, let’s mark the sample proportions <span class="math inline">\(\widehat{p}\)</span> with dots since they represent the centers of these confidence intervals.</p>
<div class="figure" style="text-align: center"><span id="fig:tactile-conf-int"></span>
<img src="ModernDive_files/figure-html/tactile-conf-int-1.png" alt="33 confidence intervals at the 95\% level based on 33 tactile samples of size $n = 50$." width="\textwidth" />
<p class="caption">
FIGURE 8.36: 33 confidence intervals at the 95% level based on 33 tactile samples of size <span class="math inline">\(n = 50\)</span>.
</p>
</div>
<p>Observe that 31 of the 33 confidence intervals “captured” the true value of <span class="math inline">\(p\)</span>, for a success rate of 31 / 33 = 93.94%. While this is not quite 95%, recall that we <em>expect</em> about 95% of such confidence intervals to capture <span class="math inline">\(p\)</span>. The actual observed success rate will vary slightly.</p>
<p>Theory-based methods like this have largely been used in the past because we didn’t have the computing power to perform simulation-based methods such as bootstrapping. They are still commonly used, however, and if the sampling distribution is normally distributed, we have access to an alternative method for constructing confidence intervals as well as performing hypothesis tests as we will see in Chapter <a href="9-hypothesis-testing.html#hypothesis-testing">9</a>.</p>
<p>The kind of computer-based statistical inference we’ve seen so far has a particular name in the field of statistics: <em>simulation-based inference</em>. This is because we are performing statistical inference using computer simulations. In our opinion, two large benefits of simulation-based methods over theory-based methods are that (1) they are easier for people new to statistical inference to understand and (2) they also work in situations where theory-based methods and mathematical formulas don’t exist.</p>
<!--
v2 TODO: Consider adding:

#### Confidence intervals based on 100 virtual samples {-}

Let's say, however, we repeated this 100 times, not tactilely, but virtually. Let's do this only 100 times instead of 1000 like we did before so that the results can fit on the screen. Again, the steps for compute a 95% confidence interval for $p$ are:

1. Collect a sample of size $n = 50$ as we did in Chapter \@ref(sampling)
1. Compute $\widehat{p}$: the sample proportion red of these $n$ = 50 balls
1. Compute the standard error $\text{SE} = \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}$
1. Compute the margin of error $\text{MoE} = 1.96 \cdot \text{SE} =  1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}$
1. Compute both end points of the confidence interval:
    + `lower_ci`: $\widehat{p} - \text{MoE} = \widehat{p} - 1.96 \cdot \text{SE} = \widehat{p} - 1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}$
    + `upper_ci`: $\widehat{p} + \text{MoE} = \widehat{p} + 1.96 \cdot \text{SE} = \widehat{p} +1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}$

Run the following three steps, being sure to `View()` the resulting data frame after each step so you can convince yourself of what's going on:


```r
# First: Take 100 virtual samples of n=50 balls
virtual_samples <- bowl %>% 
  rep_sample_n(size = 50, reps = 100)

# Second: For each virtual sample compute the proportion red
virtual_prop_red <- virtual_samples %>% 
  group_by(replicate) %>% 
  summarize(red = sum(color == "red")) %>% 
  mutate(prop_red = red / 50)

# Third: Compute the 95% confidence interval as before
virtual_prop_red <- virtual_prop_red %>% 
  rename(p_hat = prop_red) %>% 
  mutate(
    n = 50,
    SE = sqrt(p_hat*(1-p_hat)/n),
    MoE = 1.96 * SE,
    lower_ci = p_hat - MoE,
    upper_ci = p_hat + MoE
  )
```

Here are the results:



We see that of our 100 confidence intervals based on samples of size $n$ = 50, `sum(virtual_prop_red[["captured"]])` of them captured the true $p = 900/2400$, whereas `100 - sum(virtual_prop_red[["captured"]])` of them missed. As we create more and more confidence intervals based on more and more samples, about 95% of these intervals will capture. In other words, our procedure is "95% reliable." 
-->
</div>
</div>
<div id="additional-resources-6" class="section level3">
<h3><span class="header-section-number">8.7.3</span> Additional resources</h3>
<p>An R script file of all R code used in this chapter is available <a href="scripts/08-confidence-intervals.R">here</a>.</p>
<p>If you want more examples of the <code>infer</code> workflow to construct confidence intervals, we suggest you check out the <code>infer</code> package homepage, in particular, a series of example analyses available at <a href="https://infer.netlify.app/articles/" class="uri">https://infer.netlify.app/articles/</a>.</p>
</div>
<div id="whats-to-come-7" class="section level3">
<h3><span class="header-section-number">8.7.4</span> What’s to come?</h3>
<p>Now that we’ve equipped ourselves with confidence intervals, in Chapter <a href="9-hypothesis-testing.html#hypothesis-testing">9</a> we’ll cover the other common tool for statistical inference: hypothesis testing. Just like confidence intervals, hypothesis tests are used to infer about a population using a sample. However, we’ll see that the framework for making such inferences is slightly different.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="7-sampling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="9-hypothesis-testing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/moderndive/moderndive_book/edit/master/08-confidence-intervals.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
