<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Sampling | Statistical Inference via Data Science</title>
<meta name="author" content="Chester Ismay, Albert Y. Kim, and Arturo Valdivia   Foreword by Kelly S. McConville">
<meta name="description" content="The third portion of this book introduces statistical inference. This chapter is about sampling. Sampling involves drawing repeated random samples from a population. In Section 7.1 we illustrate...">
<meta name="generator" content="bookdown 0.40 with bs4_book()">
<meta property="og:title" content="Chapter 7 Sampling | Statistical Inference via Data Science">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/logos/book_cover.png">
<meta property="og:description" content="The third portion of this book introduces statistical inference. This chapter is about sampling. Sampling involves drawing repeated random samples from a population. In Section 7.1 we illustrate...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Sampling | Statistical Inference via Data Science">
<meta name="twitter:site" content="@ModernDive">
<meta name="twitter:description" content="The third portion of this book introduces statistical inference. This chapter is about sampling. Sampling involves drawing repeated random samples from a population. In Section 7.1 we illustrate...">
<meta name="twitter:image" content="/images/logos/book_cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script><script src="libs/dygraphs-1.1.1/shapes.js"></script><script src="libs/moment-2.8.4/moment.js"></script><script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script><script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script><script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YVFBK9P73R"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-YVFBK9P73R');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 0em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="A ModernDive into R and the Tidyverse &lt;br&gt; (Second Edition)">Statistical Inference via Data Science</a>:
        <small class="text-muted">A ModernDive into R and the Tidyverse <br> (Second Edition)</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome to ModernDive</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="about-the-authors.html">About the authors</a></li>
<li><a class="" href="getting-started.html"><span class="header-section-number">1</span> Getting Started with Data in R</a></li>
<li class="book-part">Data Science with tidyverse</li>
<li><a class="" href="viz.html"><span class="header-section-number">2</span> Data Visualization</a></li>
<li><a class="" href="wrangling.html"><span class="header-section-number">3</span> Data Wrangling</a></li>
<li><a class="" href="tidy.html"><span class="header-section-number">4</span> Data Importing and Tidy Data</a></li>
<li class="book-part">Statistical Modeling with moderndive</li>
<li><a class="" href="regression.html"><span class="header-section-number">5</span> Simple Linear Regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">6</span> Multiple Regression</a></li>
<li class="book-part">Statistical Inference with infer</li>
<li><a class="active" href="sampling.html"><span class="header-section-number">7</span> Sampling</a></li>
<li><a class="" href="confidence-intervals.html"><span class="header-section-number">8</span> Estimation, Confidence Intervals, and Bootstrapping</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">9</span> Hypothesis Testing</a></li>
<li><a class="" href="inference-for-regression.html"><span class="header-section-number">10</span> Inference for Regression</a></li>
<li class="book-part">Conclusion</li>
<li><a class="" href="thinking-with-data.html"><span class="header-section-number">11</span> Tell Your Story with Data</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="appendixA.html"><span class="header-section-number">A</span> Statistical Background</a></li>
<li><a class="" href="appendixB.html"><span class="header-section-number">B</span> Inference Examples</a></li>
<li><a class="" href="appendixC.html"><span class="header-section-number">C</span> Tips and Tricks</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><img src="https://moderndive.com/wide_format.png" alt="ModernDive" style="max-width: 550px; display: block; margin: 0 auto; padding-top: 10px;"><div id="sampling" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Sampling<a class="anchor" aria-label="anchor" href="#sampling"><i class="fas fa-link"></i></a>
</h1>
<p>The third portion of this book introduces statistical inference. This chapter is about <em>sampling</em>. Sampling involves drawing repeated random samples from a population. In Section <a href="sampling.html#sampling-activity">7.1</a> we illustrate sampling by working with samples of white and red balls and the proportion of red balls in these samples. In Section <a href="sampling.html#sampling-framework">7.2</a> we present a theoretical framework and define what is the sampling distribution. We introduce one of the fundamental theoretical results in Statistics: the <em>Central Limit Theorem</em> in Section <a href="sampling.html#central-limit-theorem">7.3</a>. In Section <a href="sampling.html#sampling-activity-mean">7.4</a> we present a second sampling activity, this time working with samples of chocolate-covered almonds and the average weight of these samples. In Section <a href="sampling.html#sampling-other-scenarios">7.5</a> we present the sampling distribution in other scenarios. The concepts behind <em>sampling</em> form the basis of inferential methods, in particular confidence intervals and hypothesis tests; methods that are studied in Chapters <a href="confidence-intervals.html#confidence-intervals">8</a> and <a href="hypothesis-testing.html#hypothesis-testing">9</a>.</p>
<div id="sampling-packages" class="section level2 unnumbered">
<h2>Needed packages<a class="anchor" aria-label="anchor" href="#sampling-packages"><i class="fas fa-link"></i></a>
</h2>
<p>If needed, read Section <a href="getting-started.html#packages">1.3</a> for information on how to install and load R packages.</p>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://moderndive.github.io/moderndive/">moderndive</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></span></code></pre></div>
<p>Recall that loading the <code>tidyverse</code> package loads many packages that we have encountered earlier. For details refer to Section <a href="tidy.html#tidyverse-package">4.4</a>. The packages <code>moderndive</code> and <code>infer</code> contain functions and data frames that will be used in this chapter.</p>
</div>
<div id="sampling-activity" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> First activity: red balls<a class="anchor" aria-label="anchor" href="#sampling-activity"><i class="fas fa-link"></i></a>
</h2>
<p>Take a look at the bowl in Figure <a href="sampling.html#fig:sampling-exercise-1">7.1</a>. It has red and white balls of equal size. The balls have been mixed beforehand and there does not seem to be any particular pattern for the location of red and white balls inside the bowl.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sampling-exercise-1"></span>
<img src="images/sampling/balls/sampling_bowl_1.jpg" alt="A bowl with red and white balls." width="95%"><p class="caption">
FIGURE 7.1: A bowl with red and white balls.
</p>
</div>
<div id="population-proportion" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> The proportion of red balls in the bowl<a class="anchor" aria-label="anchor" href="#population-proportion"><i class="fas fa-link"></i></a>
</h3>
<p>We are interested in finding the proportion of red balls in the bowl. To find this proportion, we could count the number of red balls and divide this number by the total number of balls. The bowl seen in Figure <a href="sampling.html#fig:sampling-exercise-1">7.1</a> is represented virtually by the data frame <code>bowl</code> included in the <code>moderndive</code> package. The first ten rows are shown here for illustration purposes:</p>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bowl</span></span></code></pre></div>
<pre><code># A tibble: 2,400 × 2
   ball_ID color
     &lt;int&gt; &lt;chr&gt;
 1       1 white
 2       2 white
 3       3 white
 4       4 red  
 5       5 white
 6       6 white
 7       7 red  
 8       8 white
 9       9 red  
10      10 white
# ℹ 2,390 more rows</code></pre>
<p>The <code>bowl</code> has 2400 rows representing the 2400 balls in the bowl shown in Figure <a href="sampling.html#fig:sampling-exercise-1">7.1</a>. You can view and scroll through the entire contents of the <code>bowl</code> in RStudio’s data viewer by running <code>View(bowl)</code>. The first variable <code>ball_ID</code> is used as an <em>identification variable</em> as discussed in Subsection <a href="getting-started.html#identification-vs-measurement-variables">1.4.4</a>; none of the balls in the actual bowl are marked with numbers.</p>
<p>The second variable <code>color</code> indicates whether a particular virtual ball is red or white. We compute the proportion of red balls in the bowl using the <code>dplyr</code> data wrangling verbs presented in Chapter <a href="wrangling.html#wrangling">3</a>. A few steps are needed in order to determine this proportion. We present these steps separately to remind you how they work but later introduce all the steps together and simplify some of the code. First, for each of the balls, we identify if it is red or not using a test for equality with the logical operator <code>==</code>. We do this by using the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function from Section <a href="wrangling.html#mutate">3.5</a> that allows us to create a new Boolean variable called <code>is_red</code>.</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>is_red <span class="op">=</span> <span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 2,400 × 3
   ball_ID color is_red
     &lt;int&gt; &lt;chr&gt; &lt;lgl&gt; 
 1       1 white FALSE 
 2       2 white FALSE 
 3       3 white FALSE 
 4       4 red   TRUE  
 5       5 white FALSE 
 6       6 white FALSE 
 7       7 red   TRUE  
 8       8 white FALSE 
 9       9 red   TRUE  
10      10 white FALSE 
# ℹ 2,390 more rows</code></pre>
<p>The variable <code>is_red</code> returns the Boolean (logical) value <code>TRUE</code> for each row where <code>color == "red"</code> and <code>FALSE</code> for every row where <code>color</code> is not equal to <code>"red"</code>. Since R treats <code>TRUE</code> like the number <code>1</code> and <code>FALSE</code> like the number <code>0</code>, accounting for <code>TRUE</code>s and <code>FALSE</code>s is equivalent to working with <code>1</code>’s and <code>0</code>’s. In particular, adding all the <code>1</code>’s and <code>0</code>’s is equivalent to counting how many red balls are in the bowl.</p>
<p>We compute this using the <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> function inside the <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> function. Recall from Section <a href="wrangling.html#summarize">3.3</a> that <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> takes a data frame with many rows and returns a data frame with a single row containing summary statistics such as the <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>:</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>is_red <span class="op">=</span> <span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>num_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">is_red</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  num_red
    &lt;int&gt;
1     900</code></pre>
<p>The <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> has added all the <code>1</code>’s and <code>0</code>’s and has effectively counted the number of red balls. There are 900 red balls in the bowl. Since the bowl contains 2400 balls, the proportion of red balls is 900/2400 = 0.375. We could ask R to find the proportion directly by replacing the <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> for the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function inside <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>. The average of <code>1</code>’s and <code>0</code>’s is precisely the proportion of red balls in the bowl:</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>is_red <span class="op">=</span> <span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">is_red</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  prop_red
     &lt;dbl&gt;
1    0.375</code></pre>
<p>This code works well but can be simplified once more. Instead of creating a new Boolean variable <code>is_red</code> before finding the proportion, we could write both steps simultaneously in a single line of code:</p>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  prop_red
     &lt;dbl&gt;
1    0.375</code></pre>
<p>This type of calculation will be used often in the next subsections.</p>
</div>
<div id="sampling-manual" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Manual sampling<a class="anchor" aria-label="anchor" href="#sampling-manual"><i class="fas fa-link"></i></a>
</h3>
<p>In the previous subsection we were able to find the proportion of red balls in the bowl using R only because we had the information of the entire bowl as a data frame. Otherwise, we would have to retrieve this manually. If the bowl contained a large number of balls, this could be a long and tedious process. How long do you think it would take to do this manually if the bowl had tens of thousands of balls? Or millions? Or even more?</p>
<p>In real-life situations, we are often interested in finding the proportion of a very large number of objects, or subjects, and performing an exhaustive count could be tedious, costly, impractical, or even impossible. Because of these limitations, we typically do not perform exhaustive counts. Rather, for this balls example, we randomly select a sample of balls from the bowl, find the proportion of red balls in this sample, and use this proportion to learn more about the proportion of red balls in the entire bowl.</p>
<div id="one-sample" class="section level4 unnumbered">
<h4>One sample<a class="anchor" aria-label="anchor" href="#one-sample"><i class="fas fa-link"></i></a>
</h4>
<p>We start by inserting a shovel into the bowl as seen in Figure <a href="sampling.html#fig:sampling-exercise-2">7.2</a> and collect <span class="math inline">\(5 \cdot 10 = 50\)</span> balls as shown in Figure <a href="sampling.html#fig:sampling-exercise-3">7.3</a>. The set of balls retrieved is called a <em>sample</em>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sampling-exercise-2"></span>
<img src="images/sampling/balls/sampling_bowl_2.jpg" alt="Inserting a shovel into the bowl." width="100%"><p class="caption">
FIGURE 7.2: Inserting a shovel into the bowl.
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sampling-exercise-3"></span>
<img src="images/sampling/balls/sampling_bowl_3_cropped.jpg" alt="Taking a sample of 50 balls from the bowl." width="80%"><p class="caption">
FIGURE 7.3: Taking a sample of 50 balls from the bowl.
</p>
</div>
<p>Observe that 17 of the balls are red, and thus the proportion of red balls in the sample is 17/50 = 0.34 or 34%. Compare this to the proportion of red balls in the entire bowl, 0.375, that we found in Subsection <a href="sampling.html#population-proportion">7.1.1</a>. The proportion from the sample seems actually pretty good, and it did not take much time or energy to get. But, was this approximate proportion just a lucky outcome? Could we be this lucky the next time we take a sample from the bowl? Next we take more samples from the bowl and calculate the proportions of red balls.</p>
</div>
<div id="thirty-three-samples" class="section level4 unnumbered">
<h4>Thirty-three samples<a class="anchor" aria-label="anchor" href="#thirty-three-samples"><i class="fas fa-link"></i></a>
</h4>
<p>We now take many more random samples as shown in Figure <a href="sampling.html#fig:sampling-exercise-3b">7.4</a>. Each time we do the following:</p>
<ul>
<li>Return the 50 balls used earlier back into the bowl and mix the contents of the bowl to ensure that each new sample is not influenced by the previous sample.</li>
<li>Take a new sample with the shovel and determine a new proportion of red balls.</li>
</ul>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sampling-exercise-3b"></span>
<img src="images/sampling/balls/tactile_2_a.jpg" alt="Repeating sampling activity." width="25%"><img src="images/sampling/balls/tactile_2_b.jpg" alt="Repeating sampling activity." width="25%"><img src="images/sampling/balls/tactile_2_c.jpg" alt="Repeating sampling activity." width="25%"><p class="caption">
FIGURE 7.4: Repeating sampling activity.
</p>
</div>
<p>When we perform this activity many times, we observe that different samples may produce different proportions of red balls. A proportion of red balls from a sample is called a <em>sample proportion</em>. A group of 33 students performed this activity previously and drew a histogram using blocks to represent sample proportions of red balls. Figure <a href="sampling.html#fig:sampling-exercise-4">7.5</a> shows students working on the histogram with two blocks drawn already representing the first two sample proportions found and the third about to be added.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sampling-exercise-4"></span>
<img src="images/sampling/balls/tactile_3_a.jpg" alt="Students drawing a histogram of sample proportions." width="60%"><p class="caption">
FIGURE 7.5: Students drawing a histogram of sample proportions.
</p>
</div>
<p>Recall from Section <a href="viz.html#histograms">2.5</a> that histograms help us visualize the <em>distribution</em> of a numerical variable. In particular, where the center of the values falls and how the values vary. A histogram of the first 10 sample proportions can be seen in Figure <a href="sampling.html#fig:sampling-exercise-5">7.6</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sampling-exercise-5"></span>
<img src="images/sampling/balls/tactile_3_c-2e.png" alt="Hand-drawn histogram of 10 sample proportions." width="\textwidth" height="30%"><p class="caption">
FIGURE 7.6: Hand-drawn histogram of 10 sample proportions.
</p>
</div>
<p>By looking at the histogram, we observe that the lowest proportion of red balls was between 0.20 and 0.25 while the highest was between 0.45 and 0.5. More importantly, the most frequently occurring proportions were between 0.30 and 0.35.</p>
<p>This activity performed by 33 students has the results stored in the <code>tactile_prop_red</code> data frame included in the <code>moderndive</code> package. The first 10 rows are printed below:</p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tactile_prop_red</span></span></code></pre></div>
<pre><code># A tibble: 33 × 4
   group            replicate red_balls prop_red
   &lt;chr&gt;                &lt;int&gt;     &lt;int&gt;    &lt;dbl&gt;
 1 Ilyas, Yohan             1        21     0.42
 2 Morgan, Terrance         2        17     0.34
 3 Martin, Thomas           3        21     0.42
 4 Clark, Frank             4        21     0.42
 5 Riddhi, Karina           5        18     0.36
 6 Andrew, Tyler            6        19     0.38
 7 Julia                    7        19     0.38
 8 Rachel, Lauren           8        11     0.22
 9 Daniel, Caroline         9        15     0.3 
10 Josh, Maeve             10        17     0.34
# ℹ 23 more rows</code></pre>
<p>Observe that for each student <code>group</code> the data frame provides their names, the number of <code>red_balls</code> observed in the sample, and the calculated proportion of red balls in the sample, <code>prop_red</code>. We also have a <code>replicate</code> variable enumerating each of the 33 groups. We chose this name because each row can be viewed as one instance of a replicated (in other words “repeated”) activity.</p>
<p>Using again the R data visualization techniques introduced in Chapter <a href="viz.html#viz">2</a>, we construct the histogram for all 33 sample proportions as shown in Figure <a href="sampling.html#fig:samplingdistribution-tactile">7.7</a>. Recall that each student has a sample of 50 balls using the same procedure and has calculated the proportion of red balls in each sample. The histogram is built using only those sample proportions. We do not need the individual information of each student or the number of red balls found. We constructed the histogram using <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> with <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>. To align the bins in the computerized histogram version so it matches the hand-drawn histogram shown in Figure <a href="sampling.html#fig:sampling-exercise-5">7.6</a>, the arguments <code>boundary = 0.4</code> and <code>binwidth = 0.05</code> were used. The former indicates that we want a binning scheme, such that, one of the bins’ boundaries is at 0.4; the latter fixes the width of the bin to 0.05 units.</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">tactile_prop_red</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prop_red</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.05</span>, boundary <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Proportion of red balls in each sample"</span>, </span>
<span>       title <span class="op">=</span> <span class="st">"Histogram of 33 proportions"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:samplingdistribution-tactile"></span>
<img src="ModernDive_files/figure-html/samplingdistribution-tactile-1.png" alt="The distribution of sample proportions based on 33 random samples of size 50." width="\textwidth"><p class="caption">
FIGURE 7.7: The distribution of sample proportions based on 33 random samples of size 50.
</p>
</div>
<p>When studying the histogram we can see that some proportions are lower than 25% and others are greater than 45%, but most of the sample proportions are between 30% and 45%.</p>
<p>We can also use this activity to introduce some statistical terminology. The process of taking repeated <em>samples</em> of 50 balls and finding the corresponding <em>sample proportions</em> is called <em>sampling</em>. Since we returned the observed balls to the bowl before getting another sample, we say that we performed <em>sampling with replacement</em> and because we mixed the balls before taking a new sample, the samples were <em>randomly drawn</em> and are called <em>random samples</em>.</p>
<p>As shown in Figure <a href="sampling.html#fig:samplingdistribution-tactile">7.7</a>, different random samples produce different sample proportions. This phenomenon is called <em>sampling variation</em>. Furthermore, the histogram is a graphical representation of the <em>distribution</em> of sample proportions; it describes the sample proportions determined and how often they appear. The distribution of all possible sample proportions that can be found from random samples is called, appropriately, the <em>sampling distribution</em> of the sample proportion. The sampling distribution is central to the ideas we develop in this chapter.</p>
<!--
Need to review Learning checks AV 9-13-23
-->
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.1)</strong> Why is it important to mix the balls in the bowl before we take a new sample?</p>
<p><strong>(LC7.2)</strong> Why is it that students did not all have the same sample proportion of red balls?</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="sampling-simulation" class="section level3" number="7.1.3">
<h3>
<span class="header-section-number">7.1.3</span> Virtual sampling<a class="anchor" aria-label="anchor" href="#sampling-simulation"><i class="fas fa-link"></i></a>
</h3>
<p>In the previous Subsection <a href="sampling.html#sampling-manual">7.1.2</a>, we performed a <em>tactile</em> sampling activity: students took physical samples using a real shovel from a bowl with white and red balls by hand. We now extend the entire process using simulations on a computer, a sort of <em>virtual</em> sampling activity.</p>
<p>The use of simulations permits us to study not only 33 random samples but thousands, tens of thousands, or even more samples. When a large number of random samples is retrieved, we can gain a better understanding of the <em>sampling distribution</em> and the <em>sampling variation</em> of sample proportions. In addition, we are not limited by samples of 50 balls, as we can simulate sampling with any desired sample size. We are going to do all this in this subsection. We start by mimicking our manual activity.</p>
<div id="one-virtual-sample" class="section level4 unnumbered">
<h4>One virtual sample<a class="anchor" aria-label="anchor" href="#one-virtual-sample"><i class="fas fa-link"></i></a>
</h4>
<p>Recall that the bowl seen in Figure <a href="sampling.html#fig:sampling-exercise-1">7.1</a> is represented by the data frame <code>bowl</code> included in the <code>moderndive</code> package. The virtual analog to the 50-ball shovel seen in Figure <a href="sampling.html#fig:sampling-exercise-2">7.2</a> can be achieved using the <code><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample()</a></code> function included in the <code>moderndive</code> package. This function allows us to take <code>rep</code>eated (or <code>rep</code>licated) random <code>samples</code> of size <code>n</code>. We start by taking a single sample of 50 balls:</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_shovel</span> <span class="op">&lt;-</span> <span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">virtual_shovel</span></span></code></pre></div>
<pre><code># A tibble: 50 × 3
# Groups:   replicate [1]
   replicate ball_ID color
       &lt;int&gt;   &lt;int&gt; &lt;chr&gt;
 1         1    1970 white
 2         1     842 red  
 3         1    2287 white
 4         1     599 white
 5         1     108 white
 6         1     846 red  
 7         1     390 red  
 8         1     344 white
 9         1     910 white
10         1    1485 white
# ℹ 40 more rows</code></pre>
<p>Observe that <code>virtual_shovel</code> has 50 rows corresponding to our virtual sample of size 50. The <code>ball_ID</code> variable identifies which of the 2400 balls from <code>bowl</code> are included in our sample of 50 balls while <code>color</code> denotes whether its white or red. The <code>replicate</code> variable is equal to 1 for all 50 rows because we have decided to take only one sample right now. Later on, we take more samples, and <code>replicate</code> will take more values.</p>
<p>We compute the proportion of red balls in our virtual sample. The code we use is similar to the one used for finding the proportion of red balls in the entire bowl in Subsection <a href="sampling.html#population-proportion">7.1.1</a>:</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_shovel</span> <span class="op">|&gt;</span> </span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
  replicate prop_red
      &lt;int&gt;    &lt;dbl&gt;
1         1     0.24</code></pre>
<p>Based on this random sample, 24% of the <code>virtual_shovel</code>’s 50 balls were red! We proceed finding the sample proportion for more random samples.</p>
</div>
<div id="thirty-three-virtual-samples" class="section level4 unnumbered">
<h4>Thirty-three virtual samples<a class="anchor" aria-label="anchor" href="#thirty-three-virtual-samples"><i class="fas fa-link"></i></a>
</h4>
<p>In Section <a href="sampling.html#sampling-activity">7.1</a>, students got 33 samples and sample proportions. They repeated/replicated the sampling process 33 times. We do this virtually by again using the function <code><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample()</a></code> and this time adding the <code>reps = 33</code> argument as we want to retrieve 33 random samples. We save these samples in the data frame <code>virtual_samples</code>, as shown below, and then provide a preview of its first 10 rows. If you want to inspect the entire <code>virtual_samples</code> data frame, use RStudio’s data viewer by running <code>View(virtual_samples)</code>.</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_samples</span> <span class="op">&lt;-</span> <span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, reps <span class="op">=</span> <span class="fl">33</span><span class="op">)</span></span>
<span><span class="va">virtual_samples</span></span></code></pre></div>
<pre><code># A tibble: 1,650 × 3
# Groups:   replicate [33]
   replicate ball_ID color
       &lt;int&gt;   &lt;int&gt; &lt;chr&gt;
 1         1    1970 white
 2         1     842 red  
 3         1    2287 white
 4         1     599 white
 5         1     108 white
 6         1     846 red  
 7         1     390 red  
 8         1     344 white
 9         1     910 white
10         1    1485 white
# ℹ 1,640 more rows</code></pre>
<p>Observe in the data viewer that the first 50 rows of <code>replicate</code> are equal to <code>1</code>, the next 50 rows of <code>replicate</code> are equal to <code>2</code>, and so on. The first 50 rows correspond to the first sample of 50 balls while the next 50 rows correspond to the second sample of 50 balls. This pattern continues for all <code>reps = 33</code> replicates, and thus <code>virtual_samples</code> has 33 <span class="math inline">\(\cdot\)</span> 50 = 1650 rows.</p>
<p>Using <code>virtual_samples</code> we find the proportion of red balls for each replicate. We use the same <code>dplyr</code> verbs as before. In particular, we add <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> of the <code>replicate</code> variable. Recall from Section <a href="wrangling.html#groupby">3.4</a> that by assigning the grouping variable “meta-data” before <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>, we perform the calculations needed for each replicate separately. The other line of code, as explained in the case of one sample, calculates the sample proportion of red balls. A preview of the first 10 rows is presented below:</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_prop_red</span> <span class="op">&lt;-</span> <span class="va">virtual_samples</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">replicate</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">virtual_prop_red</span></span></code></pre></div>
<pre><code># A tibble: 33 × 2
   replicate prop_red
       &lt;int&gt;    &lt;dbl&gt;
 1         1     0.24
 2         2     0.46
 3         3     0.38
 4         4     0.36
 5         5     0.38
 6         6     0.3 
 7         7     0.42
 8         8     0.42
 9         9     0.32
10        10     0.48
# ℹ 23 more rows</code></pre>
<p>Actually, the function <code><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample()</a></code> already groups the data by replicate, so it is not necessary to include <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> in the code. Moreover, using <code>dplyr</code> pipes in R we could simplify the work and write everything at once:</p>
<ul>
<li>using <code><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample()</a></code>, we have 33 replicates (each being a random sample of 50 balls) and<br>
</li>
<li>using <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> with <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> on the Boolean values, we determine the proportion of red balls for each sample.</li>
</ul>
<p>We store these proportions on the data frame <code>virtual_prop_red</code> and print the first 10 sample proportions (for the first 10 samples) as an illustration:</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_prop_red</span> <span class="op">&lt;-</span> <span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, reps <span class="op">=</span> <span class="fl">33</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">virtual_prop_red</span></span></code></pre></div>
<pre><code># A tibble: 33 × 2
   replicate prop_red
       &lt;int&gt;    &lt;dbl&gt;
 1         1     0.24
 2         2     0.46
 3         3     0.38
 4         4     0.36
 5         5     0.38
 6         6     0.3 
 7         7     0.42
 8         8     0.42
 9         9     0.32
10        10     0.48
# ℹ 23 more rows</code></pre>
<p>As was the case in the tactile activity, there is sampling variation in the resulting 33 proportions from the virtual samples. As we did manually in Subsection <a href="sampling.html#sampling-simulation">7.1.3</a>, we construct a histogram with these sample proportions as shown in Figure <a href="sampling.html#fig:samplingdistribution-virtual">7.8</a>. The histogram helps us visualize the sampling distribution of the sample proportion. Observe again the histogram was constructed using <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>, and including the arguments <code>binwidth = 0.05</code> and <code>boundary = 0.4</code>.</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">virtual_prop_red</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prop_red</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.05</span>, boundary <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sample proportion"</span>, </span>
<span>       title <span class="op">=</span> <span class="st">"Histogram of 33 sample proportions"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:samplingdistribution-virtual"></span>
<img src="ModernDive_files/figure-html/samplingdistribution-virtual-1.png" alt="The distribution of 33 proportions based on 33 virtual samples of size 50." width="\textwidth"><p class="caption">
FIGURE 7.8: The distribution of 33 proportions based on 33 virtual samples of size 50.
</p>
</div>
<p>When observing the histogram we can see that some proportions are lower than 25% and others are greater than 45%. Also, the sample proportions observed more frequently are between 35% and 40% (for 11 out of 33 samples). We found similar results when sampling was done by hand in Subsection <a href="sampling.html#sampling-manual">7.1.2</a>, and the histogram was presented in Figure <a href="sampling.html#fig:samplingdistribution-tactile">7.7</a>. We present both histograms side by side in Figure <a href="sampling.html#fig:tactile-vs-virtual">7.9</a> for an easy comparison. Note that they are somewhat similar in their center and variation, although not identical. The differences are also due to <em>sampling variation</em>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tactile-vs-virtual"></span>
<img src="ModernDive_files/figure-html/tactile-vs-virtual-1.png" alt="The sampling distribution of the sample proportion and sampling variation:  showing a histogram for virtual sample proportions (left) and another histogram for tactile sample proportions (right)." width="\textwidth"><p class="caption">
FIGURE 7.9: The sampling distribution of the sample proportion and sampling variation: showing a histogram for virtual sample proportions (left) and another histogram for tactile sample proportions (right).
</p>
</div>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.3)</strong> Why couldn’t we study the effects of sampling variation when we used the virtual shovel only once? Why did we need to take more than one virtual sample (in our case, 33 virtual samples)?</p>
<div class="learncheck">

</div>
</div>
<div id="one-thousand-virtual-samples" class="section level4 unnumbered">
<h4>One thousand virtual samples<a class="anchor" aria-label="anchor" href="#one-thousand-virtual-samples"><i class="fas fa-link"></i></a>
</h4>
<p>It was helpful to observe how sampling variation affects sample proportions in 33 samples. It was also interesting to note that while the 33 virtual samples provide different sample proportions than the 33 physical samples, the overall patterns were fairly similar. Because the samples were taken at random in both cases, any other set of 33 samples, virtual or physical, would provide a different set of sample proportions due to sampling variation, but the overall patterns would still be similar. Still, 33 samples are not enough to fully understand these patterns.</p>
<p>This is why we now study the sampling distribution and the effects of sampling variation with 1000 random samples. Trying to do this manually could be impractical but getting virtual samples can be done quickly and efficiently. Additionally, we have already developed the tools for this. We repeat the steps performed earlier using the <code><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample()</a></code> function with a sample <code>size</code> set to be 50. This time however, we set the number of replicates <code>reps</code> to <code>1000</code>, and use <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> and <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> again on the Boolean values to calculate the sample proportions. We compute <code>virtual_prop_red</code> with the count of red balls and the corresponding sample proportion for all 1000 random samples. The proportions for the first 10 samples are shown below:</p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_prop_red</span> <span class="op">&lt;-</span> <span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">virtual_prop_red</span></span></code></pre></div>
<pre><code># A tibble: 1,000 × 2
   replicate prop_red
       &lt;int&gt;    &lt;dbl&gt;
 1         1     0.24
 2         2     0.46
 3         3     0.38
 4         4     0.36
 5         5     0.38
 6         6     0.3 
 7         7     0.42
 8         8     0.42
 9         9     0.32
10        10     0.48
# ℹ 990 more rows</code></pre>
<p>As done previously, a histogram for these 1000 sample proportions is given in Figure <a href="sampling.html#fig:samplingdistribution-virtual-1000">7.10</a>.</p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">virtual_prop_red</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prop_red</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.04</span>, boundary <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sample proportion"</span>, title <span class="op">=</span> <span class="st">"Histogram of 1000 sample proportions"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:samplingdistribution-virtual-1000"></span>
<img src="ModernDive_files/figure-html/samplingdistribution-virtual-1000-1.png" alt="The distribution of 1000 proportions based on 1000 random samples of size 50." width="\textwidth"><p class="caption">
FIGURE 7.10: The distribution of 1000 proportions based on 1000 random samples of size 50.
</p>
</div>
<p>The sample proportions represented by the histogram could be as low as 15% or as high as 60%, but those extreme proportions are rare. The most frequent proportions determined are those between 35% and 40%. Furthermore, the histogram now shows a symmetric and bell-shaped distribution that can be approximated well by a normal distribution.
Please read the “Normal distribution” section of (<a href="https://moderndive.com/v2/appendixa">Appendix A online</a>) for a brief discussion of this distribution and its properties.</p>
<!-- 
Learning checks need to be updated. AV 8/17/23
-->
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.4)</strong> Why did we not take 1000 samples of 50 balls by hand?</p>
<p><strong>(LC7.5)</strong> Looking at Figure <a href="sampling.html#fig:samplingdistribution-virtual-1000">7.10</a>, would you say that sampling 50 balls where 30% of them were red is likely or not? What about sampling 50 balls where 10% of them were red?</p>
<div class="learncheck">

</div>
</div>
<div id="different-sample-sizes" class="section level4 unnumbered">
<h4>Different sample sizes<a class="anchor" aria-label="anchor" href="#different-sample-sizes"><i class="fas fa-link"></i></a>
</h4>
<p>Another advantage of using simulations is that we can also study how the sampling distribution of the sample proportion changes if we find the sample proportions from samples smaller than or larger than 50 balls. We do need to be careful to not mix results though: we build the sampling distribution using sample proportions from samples of the <strong>same</strong> size, but the size chosen does not have to be 50 balls.</p>
<p>We must first decide the sample size we want to use, and then take samples using that size. As an illustration, we can perform the sampling activity three times, for each activity using a different sample size, think of having three shovels of sizes 25, 50, and 100 as shown in Figure <a href="sampling.html#fig:three-shovels">7.11</a>. Of course, we do this virtually: with each shovel size we gather many random samples, calculate the corresponding sample proportions, and plot those proportions in a histogram. Therefore we create three histograms, each one describing the sampling distribution for sample proportions from samples of size 25, 50, and 100, respectively. As we show later in this subsection, the size of the sample has a direct effect on the sampling distribution and the magnitude of its sampling variation.</p>
<!--
A shovel with 25 slots          |  A shovel with 50 slots  | A shovel with 100 slots
:-------------------------:|:-------------------------:|:-------------------------:
![](images/sampling/balls/shovel_025.jpg){ width=1.6in }  |  ![](images/sampling/balls/shovel_050.jpg){ width=1.6in } | ![](images/sampling/balls/shovel_100.jpg){ width=1.6in } 
-->
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:three-shovels"></span>
<img src="images/sampling/balls/three_shovels.png" alt="Three shovels to extract three different sample sizes." width="100%"><p class="caption">
FIGURE 7.11: Three shovels to extract three different sample sizes.
</p>
</div>
<p>We follow the same process performed previously: we generate 1000 samples, find the sample proportions, and use them to draw a histogram. We follow this process three different times, setting the <code>size</code> argument in the code equal to <code>25</code>, <code>50</code>, and <code>100</code>, respectively. We run each of the following code segments individually and then compare the resulting histograms.</p>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Segment 1: sample size = 25 ------------------------------</span></span>
<span><span class="co"># 1.a) Compute sample proportions for 1000 samples, each sample of size 25</span></span>
<span><span class="va">virtual_prop_red_25</span> <span class="op">&lt;-</span> <span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1.b) Plot a histogram to represent the distribution of the sample proportions</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">virtual_prop_red_25</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prop_red</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.05</span>, boundary <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Proportion of 25 balls that were red"</span>, title <span class="op">=</span> <span class="st">"25"</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="co"># Segment 2: sample size = 50 ------------------------------</span></span>
<span><span class="co"># 2.a) Compute sample proportions for 1000 samples, each sample of size 50</span></span>
<span><span class="va">virtual_prop_red_50</span> <span class="op">&lt;-</span> <span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2.b) Plot a histogram to represent the distribution of the sample proportions</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">virtual_prop_red_50</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prop_red</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.05</span>, boundary <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Proportion of 50 balls that were red"</span>, title <span class="op">=</span> <span class="st">"50"</span><span class="op">)</span>  </span>
<span></span>
<span></span>
<span><span class="co"># Segment 3: sample size = 100 ------------------------------</span></span>
<span><span class="co"># 2.a) Compute sample proportions for 1000 samples, each sample of size 100</span></span>
<span><span class="va">virtual_prop_red_100</span> <span class="op">&lt;-</span> <span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3.b) Plot a histogram to represent the distribution of the sample proportions</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">virtual_prop_red_100</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prop_red</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.05</span>, boundary <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Proportion of 100 balls that were red"</span>, title <span class="op">=</span> <span class="st">"100"</span><span class="op">)</span> </span></code></pre></div>
<p>For easy comparison, we present the three resulting histograms in a single row with matching <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> axes in Figure <a href="sampling.html#fig:comparing-sampling-distributions">7.12</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:comparing-sampling-distributions"></span>
<img src="ModernDive_files/figure-html/comparing-sampling-distributions-1.png" alt="Histograms of sample proportions for different sample sizes." width="\textwidth"><p class="caption">
FIGURE 7.12: Histograms of sample proportions for different sample sizes.
</p>
</div>
<p>Observe that all three histograms are:</p>
<ul>
<li>centered around the same middle value, which appears to be a value slightly below 0.4,</li>
<li>are somewhat bell-shaped, and</li>
<li>exhibit <em>sampling variation</em> that is different for each sample size. In particular, as the sample size increases from 25 to 50 to 100, the sample proportions do not vary as much and they seem to get closer to the middle value.</li>
</ul>
<p>These are important characteristic of the <em>sampling distribution</em> of the sample proportion: the first observation relates to the shape of the distribution, the second to the center of the distribution, and the last one to the <em>sampling variation</em> and how it is affected by the sample size. These results are not coincidental or isolated to the example of sample proportions of red balls in a bowl. In the next subsection, a theoretical framework is introduced that helps explain with precise mathematical equations the behavior of sample proportions coming from random samples.</p>
<!-- 
Learning checks need to be updated. AV 8/17/23
-->
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.6)</strong> As shown in Figure <a href="sampling.html#fig:comparing-sampling-distributions">7.12</a> the histograms of sample proportions are somewhat bell-shaped. What can you say about the center of the histograms?</p>
<ul>
<li>A. The smaller the sample size the more concentrated the center of the histogram.</li>
<li>B. The larger the sample size the smaller the center of the histogram.</li>
<li>C. The center of each histogram seems to be about the same, regardless of the sample size.</li>
</ul>
<p><strong>(LC7.7)</strong> As shown in Figure <a href="sampling.html#fig:comparing-sampling-distributions">7.12</a> as the sample size increases, the histogram gets narrower. What happens with the sample proportions?</p>
<ul>
<li>A. They vary less.</li>
<li>B. They vary by the same amount.</li>
<li>C. They vary more.</li>
</ul>
<p><strong>(LC7.8)</strong> Why do we use random sampling when constructing sampling distributions?</p>
<ul>
<li>A. To always get the same sample</li>
<li>B. To minimize bias and make inferences about the population</li>
<li>C. To make the process easier</li>
<li>D. To reduce the number of samples needed</li>
</ul>
<p><strong>(LC7.9)</strong> Why is it important to construct a histogram of sample means or proportions in a simulation study?</p>
<ul>
<li>A. To visualize the distribution and assess normality or other patterns</li>
<li>B. To increase the accuracy of the sample means</li>
<li>C. To ensure all sample means are exactly the same</li>
<li>D. To remove any outliers from the data</li>
</ul>
<div class="learncheck">

</div>
</div>
</div>
</div>
<div id="sampling-framework" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Sampling framework<a class="anchor" aria-label="anchor" href="#sampling-framework"><i class="fas fa-link"></i></a>
</h2>
<p>In Section <a href="sampling.html#sampling-activity">7.1</a> we gained some intuition about sampling and its characteristics. In this section we introduce some statistical definitions and terminology related to sampling. We conclude by introducing key characteristics that will be formally studied in the rest of the chapter.</p>
<div id="terminology-and-notation" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> Population, sample, and the sampling distribution<a class="anchor" aria-label="anchor" href="#terminology-and-notation"><i class="fas fa-link"></i></a>
</h3>
<p>A <strong>population</strong> or <strong>study population</strong> is a collection of all individuals or observations of interest. In the bowl activities the <strong>population</strong> is the collection of all the balls in the bowl. A <strong>sample</strong> is a subset of the population. <strong>Sampling</strong> is the act of collecting samples from the population. <strong>Simple random sampling</strong> is <em>sampling</em> where each member of the population has the same chance of being selected, for example, by using a shovel to select balls from a bowl. A <strong>random sample</strong> is a sample found using simple random sampling. In the bowl activities, physical and virtual, we use simple random sampling to get random samples from the bowl.</p>
<p>A <strong>population parameter</strong> (or simply a <strong>parameter</strong>) is a numerical summary (a number) that represents some characteristic of the population. A <strong>sample statistic</strong> (or simply a <strong>statistic</strong>) is a numerical summary computed from a sample. In the bowl activities the parameter of interest was the population proportion <span class="math inline">\(p=\)</span> 0.375. Similarly, previously a sample of 50 balls was taken and 17 were red. A statistic is the <em>sample proportion</em> which in this example was equal to <span class="math inline">\(\widehat{p}= 0.34\)</span>. Observe how we use <span class="math inline">\(p\)</span> to represent the population proportion (parameter) and <span class="math inline">\(\widehat{p}\)</span> for the sample proportion (statistic).</p>
<p>The <strong>distribution</strong> of a list of numbers is the set of the possible values in the list and how often they occur. The <strong>sampling distribution of the sample proportion</strong> is the <strong>distribution</strong> of sample proportions from <strong>each possible</strong> random samples of a given size. To illustrate this concept recall that in Subsection <a href="sampling.html#sampling-simulation">7.1.3</a> we drew three histograms shown in Figure <a href="sampling.html#fig:comparing-sampling-distributions">7.12</a>. The histogram on the left, for example, was constructed from taking 1000 random samples of size <span class="math inline">\(n=25\)</span>, then finding the sample proportion for each sample and using these proportions to draw the histogram. This histogram is a good visual approximation of the <strong>sampling distribution</strong> of the sample proportion.</p>
<p>The <em>sampling distribution</em> can be a difficult concept to grasp right away:</p>
<ul>
<li>The <em>sampling distribution of the sample proportion</em> is the distribution of <em>sample proportions</em>; it is constructed using exclusively <em>sample proportions</em>.</li>
<li>Be careful as people learning this terminology sometimes confuse the term <em>sampling distribution</em> with a <em>sample’s distribution</em>. The latter can be understood as the distribution of the values in a given sample.</li>
<li>A histogram from a simulation of sample proportions is only a visual approximation of the sampling distribution. It is not the exact distribution. Still, when the simulations produce a large number of sample proportions, the resulting histogram provides a good approximation of the sampling distribution. This was the case in Subsection <a href="sampling.html#sampling-simulation">7.1.3</a> and the three histograms shown in Figure <a href="sampling.html#fig:comparing-sampling-distributions">7.12</a>.</li>
</ul>
<p>The lessons we learned by performing the activities in Section <a href="sampling.html#sampling-activity">7.1</a> contribute to gaining insights about key characteristics of the <em>sampling distribution</em> of the <em>sample proportion</em>, namely:</p>
<ol style="list-style-type: decimal">
<li>The center of the <em>sampling distribution</em>
</li>
<li>The effect of <em>sampling variation</em> on the <em>sampling distribution</em> and the effect of the sample size on this <em>sampling variation</em>
</li>
<li>The shape of the <em>sampling distribution</em>
</li>
</ol>
<p>The first two points relate to measures of central tendency and dispersion, respectively. The last one provides a connection to one of the most important theorems in statistics: the Central Limit Theorem. In the next section, we formally study these characteristics.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.10)</strong> In the case of our bowl activity, what is the <em>population parameter</em>? Do we know its value? How can we know its value exactly?</p>
<p><strong>(LC7.11)</strong> How did we ensure that the samples collected with the shovel were random?</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="central-limit-theorem" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> The Central Limit Theorem<a class="anchor" aria-label="anchor" href="#central-limit-theorem"><i class="fas fa-link"></i></a>
</h2>
<p>A fascinating result in statistics is that, when retrieving random samples from any population, the corresponding sample means follow a typical behavior: their histogram is bell-shaped and has very unique features. This is true regardless of the distribution of the population values and forms the basis of what we know as the Central Limit Theorem. Before fully describing it, we introduce a theoretical framework to construct this and other characteristics related to sampling.</p>
<div id="random-variables" class="section level3" number="7.3.1">
<h3>
<span class="header-section-number">7.3.1</span> Random variables<a class="anchor" aria-label="anchor" href="#random-variables"><i class="fas fa-link"></i></a>
</h3>
<p>A simple theoretical framework can help us formalize important properties of the sampling distribution of the sample proportion. To do this we modify the bowl activity slightly. Instead of using a shovel to select all 25 balls at once, we randomly select one ball at a time, 25 times. If the ball is red we call it a success and record a 1 (one); if it is not red we call it a failure and record a 0 (zero). Then, we return the ball to the bowl so the proportion of red balls in the bowl doesn’t change.
This process is called a trial or a Bernoulli trial in honor of Jacob Bernoulli, a 17th-century mathematician who is among the first ones to work with these trials.
Getting a sample of 25 balls is running 25 trials and getting 25 numbers, ones or zeros, representing whether or not we have observed red balls on each trial, respectively.
The average of these 25 numbers (zeros or ones) represents precisely the proportion or red balls in a sample of 25 balls.</p>
<p>It is useful to represent a trial as a random variable. We use the uppercase letter <span class="math inline">\(X\)</span> and the subscript <span class="math inline">\(1\)</span> as <span class="math inline">\(X_1\)</span> to denote the random variable for the first trial. After the first trial is completed, so the color of the first ball is observed, the value of <span class="math inline">\(X_1\)</span> is realized as 1 if the ball is red or 0 if the ball is white. For example, if the first ball is red, we write <span class="math inline">\(X_1 = 1\)</span>. Similarly we use <span class="math inline">\(X_2\)</span> to represent the second trial. For example, if the second ball is white, <span class="math inline">\(X_2\)</span> is realized as <span class="math inline">\(X_2=0\)</span>, and so on. <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, <span class="math inline">\(\dots\)</span> are random variables only before the trials have been performed. After the trials, they are just the <em>ones</em> or <em>zeros</em> representing red or white balls, respectively.</p>
<p>Moreover, since our experiment is to perform 25 trials and then find the average of them, this average or mean, before the trials are carried out, can also be expressed as a random variable:</p>
<p><span class="math display">\[\overline X = \frac{X_1+X_2+\dots+X_{25}}{25}.\]</span></p>
<p>Here <span class="math inline">\(\overline X\)</span> is the random variable that represents the average, or mean, of these 25 trials. This is why we call <span class="math inline">\(\overline X\)</span> the <strong>sample mean</strong>. Again, <span class="math inline">\(\overline X\)</span> is a random variable before the 25 trials have been performed. After the trials, <span class="math inline">\(\overline X\)</span> is realized as the average of 25 zeros and ones.
For example, if the results of the trials are</p>
<p><span class="math display">\[\{0,0,0,1,0,1,0,1,0,0,1,0,0,1,1,0,0,0,1,1,0,1,0,0,0,1 \},\]</span></p>
<p>the observed value of <span class="math inline">\(\overline X\)</span> will be</p>
<p><span class="math display">\[\overline X = \frac{0+0+0+1+0+1+\dots+1+0+0+0+1}{25} = \frac{10}{25}=0.4.\]</span></p>
<p>So, for this particular example, the sample mean is <span class="math inline">\(\overline X = 0.4\)</span> which happens to be the sample proportion of red balls in this sample of 25 balls. In the context of Bernoulli trials, because we are finding averages of zeros and ones, these <strong>sample means</strong> are <strong>sample proportions</strong>! Connecting with the notation used earlier, observe that after the trials have been completed, <span class="math inline">\(\overline X = \widehat{p}\)</span>.</p>
</div>
<div id="the-sampling-distribution-using-random-variables" class="section level3" number="7.3.2">
<h3>
<span class="header-section-number">7.3.2</span> The sampling distribution using random variables<a class="anchor" aria-label="anchor" href="#the-sampling-distribution-using-random-variables"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose that we want to calculate the sample proportion for another random sample of 25 balls. In terms of the random variable <span class="math inline">\(\overline X\)</span>, this is performing 25 trials and finding another 25 values, ones and zeros, for <span class="math inline">\(X_1\)</span>, $X_2, <span class="math inline">\(\dots\)</span>, <span class="math inline">\(X_{25}\)</span> and finding their average. For example we might get:</p>
<p><span class="math display">\[\{1,0,0,1,0,0,0,1,0,0,1,0,1,0,1,1,0,0,0,1,0,1,0,0,0,0\}\]</span></p>
<p>Then, the realization of <span class="math inline">\(\overline X\)</span> will be <span class="math inline">\(\overline X = 9/25 = 0.36\)</span>. This sample proportion was different than the one found earlier, 0.4. The possible values of <span class="math inline">\(\overline X\)</span> are the possible proportions of red balls for a sample of 25 balls. In other words, the value that <span class="math inline">\(\overline X\)</span> takes after the trials have been completed is the sample proportion for the observed sample of red and white balls.</p>
<p>Moreover, while any given trial can result in choosing a red ball or not (1 or 0), the chances or getting a red ball are influenced by the proportion of red balls in the bowl. For example, if a bowl has more red balls than white, the chances of getting a red ball on any given trial are higher than getting a white ball. Because 1 is the realization of a trial when a red ball is observed, the sample proportion also would tend to be higher.</p>
<p>Sampling variation produces different sample proportions for different random samples, but they are influenced by the proportion of red and white balls in the bowl. This is why understanding the sampling distribution of the sample proportion is learning which sample proportions are possible and which proportions are more or less likely to be observed. Since the realization of <span class="math inline">\(\overline X\)</span> is the observed sample proportion, the sampling distribution of the sample proportion is precisely the distribution of <span class="math inline">\(\overline X\)</span>. In the rest of this section, we use both expressions interchangeably. Recall the key characteristics of the <em>sampling distribution</em> of the sample proportion, now given in terms of <span class="math inline">\(\overline X\)</span>:</p>
<ol style="list-style-type: decimal">
<li>The center of the <em>distribution</em> of <span class="math inline">\(\overline X\)</span>
</li>
<li>The effect of <em>sampling variation</em> on the <em>distribution</em> of <span class="math inline">\(\overline X\)</span> and the effect of the sample size on <em>sampling variation</em>
</li>
<li>The shape of the <em>distribution</em> of <span class="math inline">\(\overline X\)</span>
</li>
</ol>
<p>To address these points, we use simulations. Simulations seldom provide the exact structure of the distribution, because an infinite number of samples may be needed for this. A large number of replications often produces a really good approximation of the distribution though and can be used to understand well the distribution’s characteristics. Let’s use the output found in Subsection <a href="sampling.html#sampling-simulation">7.1.3</a>; namely, the sample proportions for samples of size 25, 50, and 100. If we focus on size 25, think of each sample proportion from samples of size 25 as a possible value of <span class="math inline">\(\overline X\)</span>. We now use these sample proportions to illustrate properties of the distribution of <span class="math inline">\(\overline X\)</span>, the sampling distribution of the sample proportion.</p>
</div>
<div id="the-center-of-the-distribution-the-expected-value" class="section level3" number="7.3.3">
<h3>
<span class="header-section-number">7.3.3</span> The center of the distribution: the expected value<a class="anchor" aria-label="anchor" href="#the-center-of-the-distribution-the-expected-value"><i class="fas fa-link"></i></a>
</h3>
<p>Since the distribution of <span class="math inline">\(\overline X\)</span> is composed of all the sample proportions that can be calculated for a given sample size, the center of this distribution can be understood as the average of all these proportions. This is the value we would <em>expect</em> to get, on average, from all these sample proportions. This is why the center value of the sampling distribution is called the <strong>expected value</strong> of the sample proportion, and we write <span class="math inline">\(E(\overline X)\)</span>. Based on probability theory, the mean of <span class="math inline">\(\overline X\)</span> happens to be equal to the population proportion of red balls in the bowl. In Subsection <a href="sampling.html#population-proportion">7.1.1</a> we determined that the population proportion was 900/2400 = 0.375, therefore</p>
<p><span class="math display">\[E(\overline X) = p = 0.375.\]</span></p>
<p>As an illustration, we noted in Subsection <a href="sampling.html#sampling-simulation">7.1.3</a> when looking at the histograms in Figure <a href="sampling.html#fig:comparing-sampling-distributions">7.12</a> that all three histograms were centered at some value between 0.35 and 0.4 (or between 35% and 40%). As we have established now, they are centered exactly at the expected value of <span class="math inline">\(\overline X\)</span>, which is the population proportion. Figure <a href="sampling.html#fig:comparing-sampling-distributions-3">7.13</a> displays these histograms again, but this time adds a vertical red line on each of them at the location of the population proportion value, <span class="math inline">\(p\)</span> = 0.375.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:comparing-sampling-distributions-3"></span>
<img src="ModernDive_files/figure-html/comparing-sampling-distributions-3-1.png" alt="Three sampling distributions with population proportion $p$ marked by vertical line." width="\textwidth"><p class="caption">
FIGURE 7.13: Three sampling distributions with population proportion <span class="math inline">\(p\)</span> marked by vertical line.
</p>
</div>
<p>The results shown seem to agree with the theory. We can further check, using the simulation results, by finding the average of the 1000 sample proportions. We start with the histogram on the left:</p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_prop_red_25</span></span></code></pre></div>
<pre><code># A tibble: 1,000 × 3
   replicate prop_red     n
       &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;
 1         1     0.32    25
 2         2     0.24    25
 3         3     0.16    25
 4         4     0.32    25
 5         5     0.44    25
 6         6     0.36    25
 7         7     0.32    25
 8         8     0.36    25
 9         9     0.2     25
10        10     0.32    25
# ℹ 990 more rows</code></pre>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_prop_red_25</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>E_Xbar_25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prop_red</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  E_Xbar_25
      &lt;dbl&gt;
1     0.377</code></pre>
<p>The variable <code>prop_red</code> in data frame <code>virtual_prop_red_25</code> contains the sample proportions for each of the 1000 samples taken. The average of these sample proportion is presented as object <code>E_Xbar_25</code> which represents the estimated expected value of <span class="math inline">\(\overline X\)</span>, by using the average of the 1000 sample proportions. Each of the sample proportions is calculated from random samples of 25 balls from the bowl. This average happens to be precisely the same as the population proportion.</p>
<p>It is worth spending a moment understanding this result. If we take one random sample of a given size, we know that the sample proportion from this sample would be somewhat different than the population proportion due to sampling variation; however, if we take many random samples of the same size, the average of the sample proportions are expected to be about the same as the population proportion.</p>
<p>We present the equivalent results with samples of size 50 and 100:</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_prop_red_50</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>E_Xbar_50 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prop_red</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">virtual_prop_red_100</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>E_Xbar_100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prop_red</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  E_Xbar_50
      &lt;dbl&gt;
1     0.379</code></pre>
<pre><code># A tibble: 1 × 1
  E_Xbar_100
       &lt;dbl&gt;
1      0.377</code></pre>
<p>Indeed, the results are about the same as the population proportion. Note that the average of 1000 sample proportions for samples of size 50 was actually 0.379 close to 0.375. This happens because the simulations only approximate the sampling distribution and the expected value. When using simulations we do not expect to achieve the exact theoretical results, rather values that are close enough to support our understanding of the theoretical results.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.12)</strong> What is the expected value of the sample mean in the context of sampling distributions?</p>
<ul>
<li>A. The observed value of the sample mean</li>
<li>B. The population mean</li>
<li>C. The median of the sample distribution</li>
<li>D. The midpoint of the range</li>
</ul>
<div class="learncheck">

</div>
</div>
<div id="sampling-variation" class="section level3" number="7.3.4">
<h3>
<span class="header-section-number">7.3.4</span> Sampling variation: standard deviation and standard error<a class="anchor" aria-label="anchor" href="#sampling-variation"><i class="fas fa-link"></i></a>
</h3>
<p>Another relevant characteristic observed in Figure <a href="sampling.html#fig:comparing-sampling-distributions-3">7.13</a> is how the amount of dispersion or <em>sampling variation</em> changes when the sample size changes. While all the histograms have a similar bell-shaped configuration and are centered at the same value, observe that when…</p>
<ul>
<li>the sample size is <span class="math inline">\(n=25\)</span> (left histogram) the observed sample proportions are about as low as 0.1 and as high as 0.65.</li>
<li>the sample size is <span class="math inline">\(n=50\)</span> (middle histogram) the observed sample proportions are about as low as 0.15 and as high as 0.55.</li>
<li>the sample size is <span class="math inline">\(n=100\)</span> (right histogram) the observed sample proportions are about as low as 0.20 and as high as 0.5.</li>
</ul>
<p>As the sample size <span class="math inline">\(n\)</span> increases from 25 to 50 to 100, the variation of the sampling distribution decreases. Thus, the values are clustered more and more tightly around the center of the distribution. In other words, the histogram on the left of Figure <a href="sampling.html#fig:comparing-sampling-distributions-3">7.13</a> is more spread out than the one in the middle, which in turn is more spread out than the one on the right.</p>
<p>We know that the center of the distribution is the expected value of <span class="math inline">\(\overline X\)</span>, which is the population proportion. From this, we can quantify this variation by calculating how far the sample proportions are, on average, from the population proportion. A well-known statistical measurement to quantify dispersion is the <em>standard deviation</em>. We discuss how it works before we continue with the sampling variation problem.</p>
<div id="the-standard-deviation" class="section level4 unnumbered">
<h4>The standard deviation<a class="anchor" aria-label="anchor" href="#the-standard-deviation"><i class="fas fa-link"></i></a>
</h4>
<p>We start with an example and introduce some special notation. As an illustration, given four values <span class="math inline">\(y_1=3\)</span>, <span class="math inline">\(y_2=-1\)</span>, <span class="math inline">\(y_3=5\)</span>, and <span class="math inline">\(y_4= 9\)</span>, their average is given by</p>
<p><span class="math display">\[\bar y = \frac14\sum_{i=1}^4y_i =\frac14 (y_1 + y_2 + y_3 + y_4)=  \frac{3-1+5+9}{4}= 2.\]</span></p>
<p>The capital Greek letter <span class="math inline">\(\Sigma\)</span> represents the summation of values, and it is useful when a large number of values need to be added. The letter <span class="math inline">\(i\)</span> underneath <span class="math inline">\(\Sigma\)</span> is the index of summation. It starts at <span class="math inline">\(i=1\)</span>, so the first value we are adding is <span class="math inline">\(y_{\bf 1} = 3\)</span>. Afterwards <span class="math inline">\(i=2\)</span>, so we add <span class="math inline">\(y_{\bf 2}=-1\)</span> to our previous result, an so on, as shown in the equation above. The summation symbol can be very useful when adding many numbers or making more complicated operations, such as defining the standard deviation.</p>
<p>To construct the standard deviation of a list of values, we</p>
<ul>
<li>first find the deviations of each value from their average,</li>
<li>then square those deviations,</li>
<li>then find the average of the squared deviations, and</li>
<li>take the square root of this average to finish.</li>
</ul>
<p>In our example, the standard deviation is given by</p>
<p><span class="math display">\[\begin{aligned}
SD &amp;= \sqrt{\frac14\sum_{i=1}^4(y_i - \bar y)^2} = \sqrt{\frac{(3-2)^2+(-1-2)^2+(5-2)^2+(9-2)^2}{4}} \\
   &amp;= \sqrt{\frac{1+9+9+49}{4}}=\sqrt{17} = 4.12
\end{aligned}\]</span></p>
<p>We present another example, this time using R. We use again our bowl activity with red and white balls in the bowl. We create a Boolean variable <code>is_red</code> that corresponds to <code>TRUE</code>s or <code>1</code>s for red balls and <code>FALSE</code>s or <code>0</code>s for white balls and using these numbers, we compute the proportion (average of <code>1</code>s and <code>0</code>s) using the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function and the standard deviation using the <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> function<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;The &lt;code&gt;sd()&lt;/code&gt; function actually calculates the sample standard deviation, which divides the sum of squared deviations by &lt;span class="math inline"&gt;\(n-1\)&lt;/span&gt; instead of &lt;span class="math inline"&gt;\(n\)&lt;/span&gt;. The difference is noticeable for small numbers of values but almost irrelevant, for practical purposes, when using a large number of values. It is used here for simplicity.&lt;/p&gt;'><sup>2</sup></a> inside <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>:</p>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>is_red <span class="op">=</span> <span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">is_red</span><span class="op">)</span>, st_dev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">is_red</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
      p st_dev
  &lt;dbl&gt;  &lt;dbl&gt;
1 0.375  0.484</code></pre>
<p>So, the proportion of red balls is 0.375 with a standard deviation of 0.484. The intuition behind the standard deviation can be expressed as follows: if you were to select many balls, with replacement, from the bowl, we would expect the proportion of red balls to be about 0.375 give or take 0.484.</p>
<p>In addition, when dealing with proportions, the formula for the standard deviation can be expressed directly in terms of the population proportion, <span class="math inline">\(p\)</span>, using the formula:</p>
<p><span class="math display">\[SD = \sqrt{p(1-p)}.\]</span></p>
<p>Here is the value of the standard deviation using this alternative formula in R:</p>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.375</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.484</code></pre>
<p>The value is the same as using the general formula. Now that we have gained a better understanding of the standard deviation, we can discuss the standard deviation in the context of sampling variation for the sample proportion.</p>
</div>
<div id="the-standard-error" class="section level4 unnumbered">
<h4>The standard error<a class="anchor" aria-label="anchor" href="#the-standard-error"><i class="fas fa-link"></i></a>
</h4>
<p>Recall that we want to measure the magnitude of the sampling variation for the distribution of <span class="math inline">\(\overline X\)</span> (the sampling distribution of the sample proportion) and want to use the standard deviation for this purpose. We have shown earlier that the center of the distribution of <span class="math inline">\(\overline X\)</span> is the expected value of <span class="math inline">\(\overline X\)</span>. In our case, this is the population proportion <span class="math inline">\(p = 0.375\)</span>. The standard deviation will then indicate how far, on average, each possible sample proportion roughly is from the population proportion. If we were to consider using a sample proportion as an estimate of the population proportion, this deviation could be considered the error in estimation. Because of this particular relationship, the standard deviation of the sampling distribution receives a special name: the <strong>standard error</strong>. Note that all <em>standard errors</em> are standard deviations but not all standard deviations are standard errors.</p>
<p>We work again with simulations and the bowl of red and white balls. We take 10,000 random samples of size <span class="math inline">\(n=100\)</span>, find the sample proportion for each sample, and calculate the average and standard deviation for these sample proportions. This simulation produces a histogram similar to the one presented on the right in Figure <a href="sampling.html#fig:comparing-sampling-distributions-3">7.13</a>. To produce this data we again use the <code><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample()</a></code> function and <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> and <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> function inside <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> to produce the desired results:</p>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bowl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, reps <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prop_red</span><span class="op">)</span>, SE_Xbar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">prop_red</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
      p SE_Xbar
  &lt;dbl&gt;   &lt;dbl&gt;
1 0.375  0.0479</code></pre>
<p>Observe that <code>p</code> is the estimated expected value and <code>SE_Xbar</code> is the estimated standard error based on the simulation of taking sample proportions for random samples of size <span class="math inline">\(n=100\)</span>. Compare this value with the standard deviation for the entire bowl, discovered earlier. It is one tenth the size! This is not a coincidence: the standard error of <span class="math inline">\(\overline X\)</span> is equal to the standard deviation of the population (the bowl) divided by the square root of the sample size. In the case of sample proportions, the standard error of <span class="math inline">\(\overline X\)</span> can also be determined using the formula:</p>
<p><span class="math display">\[SE_{\overline X} = \sqrt{\frac{p(1-p)}{n}}\]</span>
where <span class="math inline">\(p\)</span> is the population proportion and <span class="math inline">\(n\)</span> is the size of our sample. This formula shows that the standard error is inversely proportional to the square root of the sample size: as the sample size increases, the standard error decreases. In our example, the standard error is</p>
<p><span class="math display">\[SE_{\overline X} = \sqrt{\frac{0.375\cdot(1-0.375)}{100}} = 0.0484\]</span></p>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.375</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.0484</code></pre>
<p>This value is nearly identical to the result found on the simulation above. We repeat this exercise, this time finding the estimated standard error of <span class="math inline">\(\overline X\)</span> from the simulations done earlier. These simulations are stored in data frames <code>virtual_prop_red_25</code> and <code>virtual_prop_red_50</code>, when the sample sizes used are <span class="math inline">\(n=25\)</span> and <span class="math inline">\(n=50\)</span>, respectively:</p>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_prop_red_25</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>SE_Xbar_50 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">prop_red</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  SE_Xbar_50
       &lt;dbl&gt;
1     0.0971</code></pre>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_prop_red_50</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>SE_Xbar_100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">prop_red</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 1
  SE_Xbar_100
        &lt;dbl&gt;
1      0.0667</code></pre>
<p>The standard errors for these examples, based on the proportion of red balls in the bowl and the sample sizes, are given below:</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span> <span class="op">/</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.0968</code></pre>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span> <span class="op">/</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 0.0685</code></pre>
<p>The simulations support the standard errors derived using mathematical formulas. The simulations are used to check that in fact the results achieved agree with the theory. Observe also that the theoretical results are constructed based on the knowledge of the population proportion, <span class="math inline">\(p\)</span>; by contrast, the simulations produce samples based on the population of interest but produce results only based on information found from samples and sample proportions.</p>
<p>The formula for the standard error of the sample proportion given here can actually be derived using facts in probability theory, but its development goes beyond the scope of this book. To learn more about it, please consult more advanced treatments in probability and statistics such as <a href="http://onlinestatbook.com/2/sampling_distributions/samp_dist_p.html">this one</a>.</p>
</div>
<div id="the-sampling-distribution-of-the-sample-proportion" class="section level4 unnumbered">
<h4>The sampling distribution of the sample proportion<a class="anchor" aria-label="anchor" href="#the-sampling-distribution-of-the-sample-proportion"><i class="fas fa-link"></i></a>
</h4>
<p>So far we have shown some of the properties of the sampling distribution for the sampling proportion; namely, the expected value and standard error of <span class="math inline">\(\overline X\)</span>. We now turn our attention to the shape of the sampling distribution.</p>
<p>As mentioned before, histograms (such as those seen earlier) provide a good approximation of the sampling distribution of the sample proportion, the distribution of <span class="math inline">\(\overline X\)</span>. Since we are interested in the shape of the distribution, we redraw again the histograms using sample proportions from random samples of size <span class="math inline">\(n=25\)</span>, <span class="math inline">\(n=50\)</span>, and <span class="math inline">\(n=100\)</span>, but this time we add a smooth curve that appears to connect the top parts of each bar in the histogram. These histograms are presented in Figures <a href="sampling.html#fig:sample-proportion-25-with-normal-pdf">7.14</a>, <a href="sampling.html#fig:sample-proportion-50-with-normal-pdf">7.15</a>, and <a href="sampling.html#fig:sample-proportion-100-with-normal-pdf">7.16</a>. The figures represent density histograms where the area of each bar represents the percentage or proportion of observations for the corresponding bin and the total area of each histogram is 1 (or 100%). The ranges for the <span class="math inline">\(x-\)</span> and <span class="math inline">\(y-\)</span>axis on all these plots have been kept constant for appropriate comparisons among them.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sample-proportion-25-with-normal-pdf"></span>
<img src="ModernDive_files/figure-html/sample-proportion-25-with-normal-pdf-1.png" alt="Histogram of the distribution of the sample proportion and the normal curve (n=25)." width="\textwidth"><p class="caption">
FIGURE 7.14: Histogram of the distribution of the sample proportion and the normal curve (n=25).
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sample-proportion-50-with-normal-pdf"></span>
<img src="ModernDive_files/figure-html/sample-proportion-50-with-normal-pdf-1.png" alt="Histogram of the distribution of the sample proportion and the normal curve (n=50)." width="\textwidth"><p class="caption">
FIGURE 7.15: Histogram of the distribution of the sample proportion and the normal curve (n=50).
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sample-proportion-100-with-normal-pdf"></span>
<img src="ModernDive_files/figure-html/sample-proportion-100-with-normal-pdf-1.png" alt="Histogram of the sampling distribution of the sample proportion and the normal curve (n=100)." width="\textwidth"><p class="caption">
FIGURE 7.16: Histogram of the sampling distribution of the sample proportion and the normal curve (n=100).
</p>
</div>
<p>The curves in red seem to be a fairly good representation of the top bars of the histograms. However, we have not used the simulated data to draw these curves, these bell-shaped curves were extracted from the normal distribution with mean equal to <span class="math inline">\(p=0.375\)</span> and standard deviation equal to <span class="math inline">\(\sqrt{{p(1-p)/n}}\)</span> where <span class="math inline">\(n\)</span> changes for each histogram. This is a fascinating result due to an application of one of the most important results in Statistics: the Central Limit Theorem (CLT).</p>
<p>The CLT states that when the sample size, <span class="math inline">\(n\)</span>, tends to infinity, the distribution of <span class="math inline">\(\overline X\)</span> tends to the normal distribution (with the appropriate mean and standard deviation).
Moreover, it does not depend on the population distribution; the population can be a bowl with red and white balls or anything else.</p>
<p>The observant reader might have noticed that, in practice, we cannot take samples of size equal to infinity.
What makes the CLT even more relevant for practical purposes is that the distribution of <span class="math inline">\(\overline X\)</span> approximates normality even when the sample size used is fairly small. As you can see in Figure <a href="sampling.html#fig:sample-proportion-25-with-normal-pdf">7.14</a>, even when random samples of size <span class="math inline">\(n=25\)</span> are used, the distribution of <span class="math inline">\(\overline X\)</span> already seems to follow a normal distribution.</p>
<p>Observe also that all the curves follow the bell-shaped form of the normal curve but the spread is greater when a smaller sample size has been used and is consistent with the standard error for <span class="math inline">\(\overline X\)</span> found earlier for each case.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.13)</strong> What is the role of the Central Limit Theorem (CLT) in statistical inference?</p>
<ul>
<li>A. It provides the formula for calculating the standard deviation of any given sample, allowing for an understanding of the sample’s spread or variability.</li>
<li>B. It states that the sampling distribution of the sample mean will approach a normal distribution, regardless of the population’s distribution, as the sample size becomes large.</li>
<li>C. It determines the actual mean of the population directly by calculating it from a randomly selected sample, without needing additional data or assumptions.</li>
<li>D. It is a principle that applies strictly and exclusively to populations that are normally distributed, ensuring that only in such cases the sample means will follow a normal distribution pattern.</li>
</ul>
<p><strong>(LC7.14)</strong> What does the term “sampling variation” refer to?</p>
<ul>
<li>A. Variability in the population data.</li>
<li>B. Differences in sample statistics due to random sampling.</li>
<li>C. Changes in the population parameter over time.</li>
<li>D. Variation caused by errors in data collection.</li>
</ul>
<div class="learncheck">

</div>
</div>
</div>
<div id="summary-5" class="section level3" number="7.3.5">
<h3>
<span class="header-section-number">7.3.5</span> Summary<a class="anchor" aria-label="anchor" href="#summary-5"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s look at what we have learned about the sampling distribution of the sample proportion:</p>
<ol style="list-style-type: decimal">
<li>The mean of all the sample proportions will be exactly the same as the population proportion.</li>
<li>The standard deviation of the sample proportions, also called the standard error, is inversely proportional to the square root of the sample size: the larger the sample size used to calculate sample proportions, the closer those sample proportions will be from the population proportion, on average.</li>
<li>As long as the random samples used are large enough, the sampling distribution of the sample proportion, or simply the distribution of <span class="math inline">\(\overline X\)</span>, will approximate the normal distribution. This is true for sample proportions regardless of the structure of the underlying population distribution; that is, regardless of how many red and white balls are in the bowl, or whether you are performing any other experiment that deals with sample proportions.</li>
</ol>
<p>In case you want to reinforce these ideas a little more, Shuyi Chiou, Casey Dunn, and Pathikrit Bhattacharyya created a 3-minute and 38-second video at <a href="https://youtu.be/jvoxEYmQHNM" class="uri">https://youtu.be/jvoxEYmQHNM</a> explaining this crucial statistical theorem using the average weight of wild bunny rabbits and the average wingspan of dragons as examples. Figure <a href="sampling.html#fig:CLT-video-preview">7.17</a> shows a preview of this video.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:CLT-video-preview"></span>
<img src="images/copyright/CLT_video_preview.png" alt="Preview of Central Limit Theorem video." width="75%"><p class="caption">
FIGURE 7.17: Preview of Central Limit Theorem video.
</p>
</div>
</div>
</div>
<div id="sampling-activity-mean" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Second activity: chocolate-covered almonds<a class="anchor" aria-label="anchor" href="#sampling-activity-mean"><i class="fas fa-link"></i></a>
</h2>
<p>We want to extend the results achieve for the sample proportion to a more general case: the <strong>sample mean</strong>. In this section we show how
most of the results for sample proportions extend directly to sample means, but we also highlight important differences when working with the <strong>sampling distribution of the sample mean</strong>.</p>
<p>As we did with sample proportions, we start by illustrating these results with another activity: sampling from a bowl of chocolate-covered almonds, as seen in Figure <a href="sampling.html#fig:bowl-almond">7.18</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:bowl-almond"></span>
<img src="images/sampling/almonds/almond-bowl-aux.png" alt="A bowl of chocolate-covered almonds." width="40%"><p class="caption">
FIGURE 7.18: A bowl of chocolate-covered almonds.
</p>
</div>
<p>For ease of exposition we refer to each chocolate-covered almond simply as an almond. We are now interested in the average weight in grams of <em>all</em> the almonds in the bowl; this is the <em>population average</em> weight or <em>population mean</em> weight.</p>
<div id="population-mean" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> The population mean weight of almonds in the bowl<a class="anchor" aria-label="anchor" href="#population-mean"><i class="fas fa-link"></i></a>
</h3>
<p>The population of interest is given by all the almonds in the bowl. The bowl is represented virtually by the data frame <code>almonds_bowl</code> included in the <code>moderndive</code> package. The first ten rows are shown here for illustration purposes:</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">almonds_bowl</span></span></code></pre></div>
<pre><code># A tibble: 5,000 × 2
      ID weight
   &lt;int&gt;  &lt;dbl&gt;
 1     1    3.8
 2     2    4.2
 3     3    3.2
 4     4    3.1
 5     5    4.1
 6     6    3.9
 7     7    3.4
 8     8    4.2
 9     9    3.5
10    10    3.4
# ℹ 4,990 more rows</code></pre>
<p>The first variable <code>ID</code> represents a virtual ID number given to each almond, and the variable <code>weight</code> contains the weight in grams for each almond in the bowl. The <strong>population mean</strong> weight of almonds, a population parameter, can be calculated in R using again the <code>dplyr</code> data wrangling verbs presented in Chapter <a href="wrangling.html#wrangling">3</a>. Observe, in particular, inside the function <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> the use of the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> functions for the mean weight, the weight’s standard deviation<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;As explained earlier, this function produces the sample standard deviation, which divides the sum of square deviations by &lt;span class="math inline"&gt;\(n-1\)&lt;/span&gt; instead of &lt;span class="math inline"&gt;\(n\)&lt;/span&gt;, but for a list of 5000 observations the difference is not relevant, for practical purposes.&lt;/p&gt;'><sup>3</sup></a>, and the number of almonds in the bowl:</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">almonds_bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span>, </span>
<span>            sd_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span>, </span>
<span>            length <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 3
  mean_weight sd_weight length
        &lt;dbl&gt;     &lt;dbl&gt;  &lt;int&gt;
1        3.64     0.392   5000</code></pre>
<p>We have 5,000 almonds in the bowl, the population mean weight is 3.64 grams, and the weight’s standard deviation is 0.392 grams. We used R to compute the mean and standard deviation, but we could have used the formulas instead. If we call <span class="math inline">\(x_1\)</span> the first almond in the bowl, <span class="math inline">\(x_2\)</span> the second, and so on, the mean is given by</p>
<p><span class="math display">\[\mu = \sum_{i=1}^{5000}\frac{x_i}{5000}=3.64.\]</span></p>
<p>and the standard deviation is given by</p>
<p><span class="math display">\[\sigma = \sum_{i=1}^{5000} \frac{(x_i - \mu)^2}{5000}=0.392.\]</span></p>
<p>The Greek letters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are used to represent the population mean and population standard deviation (the parameters of interest). In addition, since we know the information of the entire bowl, we can draw the distribution of weights of the entire population (bowl) using a histogram:</p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">almonds_bowl</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:almonds-bowl-histogram"></span>
<img src="ModernDive_files/figure-html/almonds-bowl-histogram-1.png" alt="Distribution of weights for the entire bowl of almonds." width="\textwidth"><p class="caption">
FIGURE 7.19: Distribution of weights for the entire bowl of almonds.
</p>
</div>
<p>We can see that the weight of almonds ranges from 2.6 to 4.6 grams and the most common weights observed are between 3.6 and 4.0 grams, but the distribution is not symmetric and does not follow any typical pattern.</p>
<p>Now that we have a clear understanding of our population of interest and the parameters of interest, we can continue our exploration of the <strong>sampling distribution of the sample mean</strong> weights of almonds by constructing samples.</p>
</div>
<div id="resampling-tactile-bowl" class="section level3" number="7.4.2">
<h3>
<span class="header-section-number">7.4.2</span> Manual sampling and sample means<a class="anchor" aria-label="anchor" href="#resampling-tactile-bowl"><i class="fas fa-link"></i></a>
</h3>
<p>If we randomly select one almond from the bowl, we could determine its weight using a scale, as shown in Figure <a href="sampling.html#fig:one-almond">7.20</a>:</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:one-almond"></span>
<img src="images/sampling/almonds/one-almond.png" alt="One almond on a scale." width="40%"><p class="caption">
FIGURE 7.20: One almond on a scale.
</p>
</div>
<p>Let’s now take a random sample of 25 almonds, as shown in Figure <a href="sampling.html#fig:twenty-five-almonds">7.21</a>, and determine the sample average weight, or <em>sample mean</em> weight, in grams.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:twenty-five-almonds"></span>
<img src="images/sampling/almonds/twenty-five-almonds.png" alt="A random sample of 25 almonds on a scale." width="40%"><p class="caption">
FIGURE 7.21: A random sample of 25 almonds on a scale.
</p>
</div>
<p>Since the total weight is 88.6 grams, as shown in the Figure <a href="sampling.html#fig:twenty-five-almonds">7.21</a>, the sample mean weight will be <span class="math inline">\(88.6/25 = 3.544\)</span>. The <code>moderndive</code> package contains the information of this sample in the <code>almonds_sample</code> data frame. Here, we present the weight of the first 10 almonds in the sample:</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">almonds_sample</span> <span class="op">&lt;-</span> <span class="va">almonds_bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, reps <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">almonds_sample</span></span></code></pre></div>
<p>The <code>almonds_sample</code> data frame in the <code>moderndive</code> package has <span class="math inline">\(n=\)</span> 25 rows corresponding to each almond in the sample shown in Figure <a href="sampling.html#fig:twenty-five-almonds">7.21</a>.
The first variable <code>replicate</code> indicates this is the first and only replicate since it is a single sample. The second variable <code>ID</code> gives an identification to the particular almond. The third column <code>weight</code> gives the corresponding weight for each almond in grams as a numeric variable, also known as a double (<code>dbl</code>).</p>
<p>The distribution of the weights of these 25 are shown in the histogram in Figure <a href="sampling.html#fig:almonds-sample-histogram">7.22</a>.</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">almonds_sample</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:almonds-sample-histogram"></span>
<img src="ModernDive_files/figure-html/almonds-sample-histogram-1.png" alt="Distribution of weight for a sample of 25 almonds." width="\textwidth"><p class="caption">
FIGURE 7.22: Distribution of weight for a sample of 25 almonds.
</p>
</div>
<p>The weights of almonds in this sample range from 2.9 to 4.4 grams. There is not an obvious pattern in the distribution of this sample. We now compute the sample mean using our data wrangling tools from Chapter <a href="wrangling.html#wrangling">3</a>.</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">almonds_sample</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>sample_mean_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
  replicate sample_mean_weight
      &lt;int&gt;              &lt;dbl&gt;
1         1               3.67</code></pre>
<p>The sample mean weight was not too far from the population mean weight of 3.64 grams. The difference between the statistic (sample mean weight) and the parameter (population mean weight) was due to sampling variation.</p>
</div>
<div id="virtual-samples-mean-bowl" class="section level3" number="7.4.3">
<h3>
<span class="header-section-number">7.4.3</span> Virtual sampling<a class="anchor" aria-label="anchor" href="#virtual-samples-mean-bowl"><i class="fas fa-link"></i></a>
</h3>
<p>We now perform sampling virtually. The data frame <code>almonds_bowl</code> has 5000 rows, each representing an almond in the bowl. As we did in Section <a href="sampling.html#sampling-simulation">7.1.3</a> we use again the <code><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample()</a></code> function to retrieve 1000 random samples with a sample <code>size</code> set to be 25, and with the number of replicates <code>reps</code> set to <code>1000</code>. Be sure to scroll through the contents of <code>virtual_samples</code> in RStudio’s viewer.</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_samples_almonds</span> <span class="op">&lt;-</span> <span class="va">almonds_bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">virtual_samples_almonds</span></span></code></pre></div>
<pre><code># A tibble: 25,000 × 3
# Groups:   replicate [1,000]
   replicate    ID weight
       &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
 1         1  3467    3.7
 2         1  3784    4.2
 3         1  4653    4.2
 4         1  2216    4.1
 5         1    98    3.5
 6         1  2286    3.6
 7         1  4597    3.6
 8         1  2385    4.3
 9         1  3959    3.7
10         1  1497    3.9
# ℹ 24,990 more rows</code></pre>
<p>Observe that now <code>virtual_samples_almonds</code> has 1000 <span class="math inline">\(\cdot\)</span> 25 = 25,000 rows. Using the appropriate data wrangling code, the <code>virtual_mean_weight</code> data frame produces the sample mean almond weight for each random sample, a total of 1000 sample means.</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_mean_weight</span> <span class="op">&lt;-</span> <span class="va">virtual_samples_almonds</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">virtual_mean_weight</span></span></code></pre></div>
<pre><code># A tibble: 1,000 × 2
   replicate mean_weight
       &lt;int&gt;       &lt;dbl&gt;
 1         1        3.79
 2         2        3.45
 3         3        3.67
 4         4        3.5 
 5         5        3.67
 6         6        3.63
 7         7        3.62
 8         8        3.59
 9         9        3.56
10        10        3.78
# ℹ 990 more rows</code></pre>
<p>Figure <a href="sampling.html#fig:sampling-mean-virtual-1000">7.23</a> presents the histogram for these sample means:</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">virtual_mean_weight</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mean_weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.04</span>, boundary <span class="op">=</span> <span class="fl">3.5</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sample mean"</span>, title <span class="op">=</span> <span class="st">"Histogram of 1000 sample means"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sampling-mean-virtual-1000"></span>
<img src="ModernDive_files/figure-html/sampling-mean-virtual-1000-1.png" alt="The distribution of 1000 means based on 1000 random samples of size 25." width="\textwidth"><p class="caption">
FIGURE 7.23: The distribution of 1000 means based on 1000 random samples of size 25.
</p>
</div>
<p>The sample mean weights observed in the histogram appear to go below 3.4 grams and above 3.85 grams, but those extreme sample means are rare. The most frequent sample means found seem to be those above 3.5 or below 3.8 grams.
Furthermore, the histogram is almost symmetric and showing that bell-shaped form, although the left tail of the histogram appears to be slightly longer than the right tail. While we are dealing with sample means now, the conclusions are strikingly similar to those presented in Subsection <a href="sampling.html#resampling-tactile-bowl">7.4.2</a> when discussing the sampling distribution for the sample proportion.</p>
</div>
<div id="the-sampling-distribution-of-the-sample-mean" class="section level3" number="7.4.4">
<h3>
<span class="header-section-number">7.4.4</span> The sampling distribution of the sample mean<a class="anchor" aria-label="anchor" href="#the-sampling-distribution-of-the-sample-mean"><i class="fas fa-link"></i></a>
</h3>
<p>As we did in the case of the sample proportion, we are interested in learning key characteristics of the <strong>sampling distribution of the sample mean</strong>, namely:</p>
<ol style="list-style-type: decimal">
<li>The center of the <em>sampling distribution</em>
</li>
<li>The effect of <em>sampling variation</em> on the <em>sampling distribution</em> and the effect of the sample size on <em>sampling variation</em>
</li>
<li>The shape of the <em>sampling distribution</em>
</li>
</ol>
</div>
<div id="random-variable-sample-mean" class="section level3" number="7.4.5">
<h3>
<span class="header-section-number">7.4.5</span> Random variables<a class="anchor" aria-label="anchor" href="#random-variable-sample-mean"><i class="fas fa-link"></i></a>
</h3>
<p>Once again, we use random variable to formalize our understanding of the sample distribution of the sample mean. Instead of using Bernoulli trials as we did in the case of sample proportions, our trials will record the almond weights. We again modify the bowl activity slightly. In lieu of selecting a sample of almonds all at once, we randomly select one almond at a time, we record the weight of the almond and return it to the bowl before selecting another almond, so the configuration of weights and the chances of any of the almonds to be selected is the same every time we choose one.
Getting a sample of 25 almonds is performing these trials 25 times to get 25 weights. Then, the average of these 25 numbers is the average weight or mean weight of a sample of 25 almonds. This is what we call a sample mean.</p>
<p>Using random variables, we now let uppercase <span class="math inline">\(X_1\)</span> to be the random variable that represents the weight of the first almond before it has been selected, <span class="math inline">\(X_2\)</span> the weight of the second almond, and so on. These are random variables because they can take any possible almond weight value from the bowl.
After the first trial is completed, the value of <span class="math inline">\(X_1\)</span> is realized as the weight in grams of the first almond selected. We can represent this value by the lowercase <span class="math inline">\(x_1\)</span> as it is no longer a random variable but a number and we can write <span class="math inline">\(X_1 = x_1\)</span>. After the second trial is completed, <span class="math inline">\(X_2 = x_2\)</span>, where lowercase <span class="math inline">\(x_2\)</span> is the observe almond weight, and so on.
Since our experiment is to perform 25 trials and then find the average of them, this average or mean, before the trials are carried out, can also be expressed as a random variable:</p>
<p><span class="math display">\[\overline X = \frac{X_1+X_2+\dots+X_{25}}{25}.\]</span></p>
<p>Observe that <span class="math inline">\(\overline X\)</span> is the average, or mean, of these 25 trials. This is again why <span class="math inline">\(\overline X\)</span> is called the <strong>sample mean</strong>. Recall that when dealing with proportions, the trials are Bernoulli trials, represented only with zeros or ones. In this context, <strong>sample proportions</strong> are a special case of <strong>sample means</strong>. The trials we use now are not restricted to zeros and ones, and the sample means are no longer sample proportions.</p>
<p>For example, let’s focus on the sample of 25 almond weights used earlier and their sample mean:</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">almonds_sample</span></span></code></pre></div>
<pre><code># A tibble: 25 × 3
# Groups:   replicate [1]
   replicate    ID weight
       &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
 1         1  4645    3  
 2         1  3629    3.9
 3         1  4796    4  
 4         1  2669    3.8
 5         1  3488    4.3
 6         1   105    4.1
 7         1  1762    3.6
 8         1  1035    4.2
 9         1  4880    3.2
10         1   398    4  
# ℹ 15 more rows</code></pre>
<p>By looking at the weights in the data frame <code>almonds_sample</code>, observe that <span class="math inline">\(X_1 = 3.0\)</span> grams, <span class="math inline">\(X_2 = 3.9\)</span> grams, <span class="math inline">\(X_3 = 4.0\)</span> grams, and so on. If you view the entire data frame, for example running <code>View(almonds_sample)</code> in R, you could check that <span class="math inline">\(X_{23} = 3.3\)</span>, <span class="math inline">\(X_{24} = 4.4\)</span>, and <span class="math inline">\(X_{25} = 3.6\)</span>, so the sample mean would be</p>
<p><span class="math display">\[\overline X = \frac{3.0+3.9+4.0+\dots+3.3+4.4+3.6}{25} = \frac{91.8}{25}=3.67.\]</span></p>
<p>In R:</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">almonds_sample</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>sample_mean_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
  replicate sample_mean_weight
      &lt;int&gt;              &lt;dbl&gt;
1         1               3.67</code></pre>
<p>So, once this sample was observed, the random variable <span class="math inline">\(\overline X\)</span> was realized as <span class="math inline">\(\overline X = 3.67\)</span>, the <strong>sample mean</strong> was 3.67 grams.
Note that the possible values that <span class="math inline">\(\overline X\)</span> can take are all the possible sample means from samples of 25 almonds from the bowl. The chances of getting these sample means are determined by the configuration of almond weights in the bowl.</p>
<p>When <span class="math inline">\(\overline X\)</span> is constructed as the sample mean of a given random sample, the sampling distribution of the sample mean is precisely the distribution of <span class="math inline">\(\overline X\)</span>. In this context, recall what we are interested in determining:</p>
<ol style="list-style-type: decimal">
<li>The center of the <em>distribution</em> of <span class="math inline">\(\overline X\)</span>
</li>
<li>The effect of <em>sampling variation</em> on the <em>distribution</em> of <span class="math inline">\(\overline X\)</span> and the effect of the sample size on <em>sampling variation</em>
</li>
<li>The shape of the <em>distribution</em> of <span class="math inline">\(\overline X\)</span>
</li>
</ol>
<p>As we did when dealing with sample proportions, we use simulations again to produce good approximations of the distribution of <span class="math inline">\(\overline X\)</span>, the sample mean weight of almonds. We also work with samples of size 25, 50, and 100 to learn about changes in sample variation when the sample size changes.</p>
<p>This is the process we follow:</p>
<ul>
<li>we generate 1000 samples,</li>
<li>calculate the sample means of almond weights, and</li>
<li>use them to draw histograms.</li>
</ul>
<p>We do this three times with the <code>size</code> argument set to <code>25</code>, <code>50</code>, and <code>100</code>, respectively. We run each of the following code segments individually and then compare the resulting histograms.</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Segment 1: sample size = 25 ------------------------------</span></span>
<span><span class="co"># 1.a) Calculating the 1000 sample means, each from random samples of size 25</span></span>
<span><span class="va">virtual_mean_weight_25</span> <span class="op">&lt;-</span> <span class="va">almonds_bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1.b) Plot distribution via a histogram</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">virtual_mean_weight_25</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mean_weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.02</span>, boundary <span class="op">=</span> <span class="fl">3.6</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sample mean weights for random samples of 25 almonds"</span>, title <span class="op">=</span> <span class="st">"25"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Segment 2: sample size = 50 ------------------------------</span></span>
<span><span class="co"># 2.a) Calculating the 1000 sample means, each from random samples of size 50</span></span>
<span><span class="va">virtual_mean_weight_50</span> <span class="op">&lt;-</span> <span class="va">almonds_bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2.b) Plot distribution via a histogram</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">virtual_mean_weight_50</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mean_weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.02</span>, boundary <span class="op">=</span> <span class="fl">3.6</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sample mean weights for random samples of 50 almonds"</span>, title <span class="op">=</span> <span class="st">"50"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Segment 3: sample size = 100 ------------------------------</span></span>
<span><span class="co"># 3.a) Calculating the 1000 sample means, each from random samples of size 100</span></span>
<span><span class="va">virtual_mean_weight_100</span> <span class="op">&lt;-</span> <span class="va">almonds_bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3.b) Plot distribution via a histogram</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">virtual_mean_weight_100</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mean_weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.02</span>, boundary <span class="op">=</span> <span class="fl">3.6</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sample mean weights for random samples of 100 almonds"</span>, title <span class="op">=</span> <span class="st">"100"</span><span class="op">)</span> </span></code></pre></div>
<p>We present the three resulting histograms in a single row with matching x and y axes in Figure <a href="sampling.html#fig:comparing-sampling-distributions-means">7.24</a> so the comparison among them is clear.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:comparing-sampling-distributions-means"></span>
<img src="ModernDive_files/figure-html/comparing-sampling-distributions-means-1.png" alt="Comparing histograms of sample means when using different sample sizes." width="\textwidth"><p class="caption">
FIGURE 7.24: Comparing histograms of sample means when using different sample sizes.
</p>
</div>
<p>Observe that all three histograms are bell-shaped and appear to center around the same middle value highlighted by the line at the middle. In addition, the magnitude of the sampling variation decreases when the sample size increases. As it happened with the sampling distribution of the sample proportion, the measures of center and dispersion of these distributions are directly related to the parameters of the population: the population mean, <span class="math inline">\(\mu\)</span>, and the population standard deviation, <span class="math inline">\(\sigma\)</span>. We print these parameters one more time here:</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">almonds_bowl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code># A tibble: 1 × 2
     mu sigma
  &lt;dbl&gt; &lt;dbl&gt;
1  3.64 0.392</code></pre>
<p>And we do the same for our simulations next. Recall that the expected value of <span class="math inline">\(\overline X\)</span> is the value we would expect to observe, on average, when we take many sample means from random samples of a given size. It is located at the center of the distribution of <span class="math inline">\(\overline X\)</span>. Similarly, the standard error of <span class="math inline">\(\overline X\)</span> is the measure of dispersion or magnitude of sampling variation. It is the standard deviation of the sample means calculated from all possible random samples of a given size. Using the data wrangling code <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> and <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> functions inside <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> and applied to our simulation values, we can estimate the expected value and standard error of <span class="math inline">\(\overline X\)</span>. Three sets of values are found, one for each of the corresponding sample sizes and presented in Table <a href="sampling.html#tab:comparing-n1">7.1</a>.</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># n = 25</span></span>
<span><span class="va">virtual_mean_weight_25</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>E_Xbar_25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_weight</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mean_weight</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># n = 50</span></span>
<span><span class="va">virtual_mean_weight_50</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>E_Xbar_50 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_weight</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mean_weight</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># n = 100</span></span>
<span><span class="va">virtual_mean_weight_100</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>E_Xbar_100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mean_weight</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mean_weight</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:comparing-n1">TABLE 7.1: </span>Comparing expected values and standard errors for three different sample sizes
</caption>
<thead><tr>
<th style="text-align:right;">
Sample size
</th>
<th style="text-align:right;">
Expected Value
</th>
<th style="text-align:right;">
Standard Error
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
3.65
</td>
<td style="text-align:right;">
0.077
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
3.65
</td>
<td style="text-align:right;">
0.053
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
3.65
</td>
<td style="text-align:right;">
0.038
</td>
</tr>
</tbody>
</table></div>
<p>In summary:</p>
<ol style="list-style-type: decimal">
<li>The estimated expected value was either 3.65 or 3.64. This is either near or equal to <span class="math inline">\(\mu = 3.64\)</span>, the population mean weight of almonds in the entire bowl.</li>
<li>The standard error decreases when the sample size increases. If we focus on the result for <span class="math inline">\(n=100\)</span>, the standard error was 0.038. When compared with the population standard deviation <span class="math inline">\(\sigma = 0.392\)</span> this standard error is about one tenth the value of <span class="math inline">\(\sigma\)</span>. Similarly when <span class="math inline">\(n=25\)</span> the standard error 0.077 is about one fifth the value of <span class="math inline">\(\sigma\)</span> and that pattern also holds when <span class="math inline">\(n=50\)</span>. As was the case for the sample proportion, the standard error is inversely proportional to the squared sample size used to construct the distribution of <span class="math inline">\(\overline X\)</span>. This is also a theoretical result that can be expressed as:</li>
</ol>
<p><span class="math display">\[SE_{\overline X} = \frac{\sigma}{\sqrt {n}}\]</span>
where <span class="math inline">\(n\)</span> is the sample size and <span class="math inline">\(\sigma\)</span> is the population standard deviation.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.15)</strong> How does increasing the sample size affect the standard error of the sample mean?</p>
<ul>
<li>A. It increases the standard error</li>
<li>B. It decreases the standard error</li>
<li>C. It has no effect on the standard error</li>
<li>D. It only affects the standard deviation</li>
</ul>
<div class="learncheck">

</div>
</div>
<div id="CLT-mean" class="section level3" number="7.4.6">
<h3>
<span class="header-section-number">7.4.6</span> The Central Limit Theorem revisited<a class="anchor" aria-label="anchor" href="#CLT-mean"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, observe that the shapes of the histograms in Figure <a href="sampling.html#fig:comparing-sampling-distributions-means">7.24</a> are bell-shaped and seem to approximate the normal distribution. As we did with proportions, in Figures <a href="sampling.html#fig:sample-mean-25-with-normal">7.25</a> and <a href="sampling.html#fig:sample-mean-100-with-normal">7.26</a> we compare our histograms with the theoretical curve for the normal distribution.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sample-mean-25-with-normal"></span>
<img src="ModernDive_files/figure-html/sample-mean-25-with-normal-1.png" alt="The distribution of the sample mean (n=25)." width="\textwidth"><p class="caption">
FIGURE 7.25: The distribution of the sample mean (n=25).
</p>
</div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sample-mean-100-with-normal"></span>
<img src="ModernDive_files/figure-html/sample-mean-100-with-normal-1.png" alt="The distribution of the sample mean (n=100)." width="\textwidth"><p class="caption">
FIGURE 7.26: The distribution of the sample mean (n=100).
</p>
</div>
<p>We conclude that the distribution of <span class="math inline">\(\overline X\)</span>, that is, the sampling distribution of the sample mean, when the sample size is large enough, follows approximately a normal distribution with mean equal to the population mean, <span class="math inline">\(\mu\)</span>, and standard deviation equal to the population standard deviation divided by the square root of the sample size, <span class="math inline">\(\sigma/\sqrt{n}\)</span>. We can write this as</p>
<p><span class="math display">\[\overline X \sim Normal \left(\mu, \frac{\sigma}{\sqrt n}\right)\]</span></p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.16)</strong> For each of the following cases, explain whether the sampling distribution of the sample mean approximates a normal distribution.</p>
<ul>
<li>When the population distribution is normal.</li>
<li>When the sample size is very large.</li>
<li>When the sample size is sufficiently large, regardless of the population distribution.</li>
<li>When the population distribution is uniform.</li>
</ul>
<div class="learncheck">

</div>
</div>
</div>
<div id="sampling-other-scenarios" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> The sampling distribution in other scenarios<a class="anchor" aria-label="anchor" href="#sampling-other-scenarios"><i class="fas fa-link"></i></a>
</h2>
<p>In Sections <a href="sampling.html#sampling-activity">7.1</a>, <a href="sampling.html#central-limit-theorem">7.3</a>, and <a href="sampling.html#sampling-activity-mean">7.4</a>, we have provided information about the expected value, the standard error, and the shape of the sampling distribution when the statistic of interest are sample proportions or sample means. It is possible to study the sampling distribution of other statistics. In this section we explore some of them.</p>
<div id="sampling-distribution-for-two-samples" class="section level3" number="7.5.1">
<h3>
<span class="header-section-number">7.5.1</span> Sampling distribution for two samples<a class="anchor" aria-label="anchor" href="#sampling-distribution-for-two-samples"><i class="fas fa-link"></i></a>
</h3>
<p>Assume that we would like to compare the parameters of two populations, for example the means or proportion of those populations. To do this a random sample is taken from the first population and another random sample, independent from the first, is retrieved from the second population. Then we can use a statistic from each sample, such as the sample mean or sample proportion, and use them to produce sampling distributions that depend on two independent samples. We provide two examples to illustrate how the sampling distributions are affected.</p>
<div id="difference-in-sample-means" class="section level4 unnumbered">
<h4>Difference in sample means<a class="anchor" aria-label="anchor" href="#difference-in-sample-means"><i class="fas fa-link"></i></a>
</h4>
<p>The problem at hand could be that the chocolate-covered almonds’ weight for almonds in a bowl needs to be compared with the chocolate-covered coffee beans’ weight for coffee beans in a different bowl. The statistic we now consider is the difference in the sample means for samples taken from these two bowls. As it happens, most of the properties we have presented for a single sample mean or sample proportion can be extended directly to two-sample problems.</p>
<p>We now provide the mathematical details for this problem. We assume that for the chocolate-covered almonds’ weight the population mean and standard deviation are given by <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\sigma_1\)</span> and for the chocolate-covered coffee beans’ weight the population mean and standard deviation are given by <span class="math inline">\(\mu_2\)</span> and <span class="math inline">\(\sigma_2\)</span>.</p>
<p>Our sampling exercise has now two components. First, we take a random sample of size <span class="math inline">\(n_1\)</span> from the almonds’ bowl and find the sample mean. As we did before, we can let <span class="math inline">\(\overline X_1\)</span> represent the possible values that the sample mean can take for each possible sample. Second, we let <span class="math inline">\(n_2\)</span> represent the sample size used for samples from the coffee beans’ bowl and the random variable <span class="math inline">\(\overline X_2\)</span> represent the possible values that the sample mean can take for each possible sample. To compare these two sample means, we look at the difference, <span class="math inline">\(\overline X_1 - \overline X_2\)</span>. The distribution of <span class="math inline">\(\overline X_1 - \overline X_2\)</span> is the sampling distribution of the difference in sample means.</p>
<p>The expected value and standard error of <span class="math inline">\(\overline X_1 - \overline X_2\)</span> is given by <span class="math inline">\(\mu_1 - \mu_2\)</span> and</p>
<p><span class="math display">\[\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma^2_2}{n_2}},\]</span></p>
<p>respectively. If the distributions of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are approximately normal due to the CLT, so is the distribution of <span class="math inline">\(\overline X_1 - \overline X_2\)</span>. We can write all these properties at once:</p>
<p><span class="math display">\[\overline X - \overline Y \sim Normal \left(\mu_1 - \mu_2, \sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma^2_2}{n_2}} \right)\]</span></p>
<p>Observe how the standard deviation of the difference is the sum of squared standard deviations from each sample mean. The reason we add standard deviations instead of subtract is because whether you add or subtract statistics, you are effectively adding more uncertainty into your results and the dispersion increases because of it.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.17)</strong> In the context of comparing two samples, why do we add variances (squared standard deviations) instead of subtracting them when finding the standard error of the difference?</p>
<ul>
<li>A. Because variances always cancel each other out</li>
<li>B. Because adding variances reflects the total uncertainty from both samples</li>
<li>C. Because subtracting variances always gives negative results</li>
<li>D. Because variances are not related to the standard error</li>
</ul>
<div class="learncheck">

</div>
</div>
<div id="difference-in-sample-proportions" class="section level4 unnumbered">
<h4>Difference in sample proportions<a class="anchor" aria-label="anchor" href="#difference-in-sample-proportions"><i class="fas fa-link"></i></a>
</h4>
<p>Comparing two sample proportions can be very useful. We may be interested in comparing the proportion of patients that improve using one treatment versus the proportion of patients that improve using a different treatment, or the proportion of winter accidents on a highway using one type of tire versus another.</p>
<p>To illustrate how the sampling distribution works for the difference in sample proportions, we modify the examples used earlier.
Assume that we want to compare the proportion of red balls in the first bowl with the proportion of almonds that are heavier than 3.8 grams in the second bowl. This example shows one way to convert numeric data like almond weights into a Boolean result instead.
The statistic we now consider is the difference in these sample proportions for samples retrieved from these two bowls.
The samples from each bowl do not need to be of the same size; for example, we can take samples of size <span class="math inline">\(n_1 = 50\)</span> from the first bowl and samples of size <span class="math inline">\(n_2 = 60\)</span> from the second bowl.</p>
<p>We proceed by</p>
<ul>
<li>taking a random sample from the first bowl,</li>
<li>calculating the sample proportion of red balls,</li>
<li>getting a random sample from the second bowl,</li>
<li>calculating the proportion of almonds heavier than 3.8 grams, and</li>
<li>finding the difference in sample proportion of red balls minus the sample proportion of almonds greater than 3.8 grams (the resulting statistic).</li>
</ul>
<p>We can use R to produce the required virtual samples and differences. We then use them to approximate the sampling distribution of the difference in sample proportions.</p>
<p>Our sampling exercise has again two components. First, we take a random sample of <span class="math inline">\(n_1 = 50\)</span> balls from the bowl of red balls and calculate the sample proportion or red balls. As we did before, we let <span class="math inline">\(\overline X_1\)</span> represent the possible values that the sample proportion can take for each possible sample. Recall that <span class="math inline">\(\overline X_1\)</span> is the sample proportion in this context, which is also the sample mean of Bernoulli trials. Second, we let <span class="math inline">\(n_2 = 60\)</span> represent the sample size used for samples from the almonds’ bowl and the random variable <span class="math inline">\(\overline X_2\)</span> represent the possible values that the sample proportion of almonds greater than 3.8 grams can take for each possible sample.</p>
<p>To compare these two sample proportions, we find the difference, <span class="math inline">\(\overline X_1 - \overline X_2\)</span>. The distribution of <span class="math inline">\(\overline X_1 - \overline X_2\)</span> is the sampling distribution of the difference in sample proportions. We use virtual sampling to approximate this distribution. We use the <code>rep_slice_sample</code> and <code>summarize</code> functions to produce the random samples and the necessary sample proportions, respectively. A total of 1000 random samples and sample proportions are acquired from each bowl with the appropriate sample sizes, 50 and 60, respectively. Moreover, the <code>inner_join</code> function introduce in Section <a href="wrangling.html#joins">3.7</a> is used here to merge the sample proportions into a single data frame and the difference in these sample proportions is calculated for each replication.</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">virtual_prop_red</span> <span class="op">&lt;-</span> <span class="va">bowl</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_red <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">color</span> <span class="op">==</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">virtual_prop_almond</span> <span class="op">&lt;-</span> <span class="va">almonds_bowl</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">60</span>, reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>prop_almond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">&gt;</span> <span class="fl">3.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prop_joined</span> <span class="op">&lt;-</span> <span class="va">virtual_prop_red</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">virtual_prop_almond</span>, by <span class="op">=</span> <span class="st">"replicate"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prop_diff <span class="op">=</span> <span class="va">prop_red</span> <span class="op">-</span> <span class="va">prop_almond</span><span class="op">)</span></span></code></pre></div>
<p>The results are stored in the data frame <code>prop_joined</code>. The variable <code>prop_diff</code> in this data frame represents the difference in sample proportions. We present here the first 10 values of this data frame:</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prop_joined</span></span></code></pre></div>
<pre><code># A tibble: 1,000 × 4
   replicate prop_red prop_almond prop_diff
       &lt;int&gt;    &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1         1     0.24       0.45    -0.21  
 2         2     0.46       0.5     -0.0400
 3         3     0.38       0.35     0.0300
 4         4     0.36       0.433   -0.0733
 5         5     0.38       0.367    0.0133
 6         6     0.3        0.317   -0.0167
 7         7     0.42       0.383    0.0367
 8         8     0.42       0.483   -0.0633
 9         9     0.32       0.5     -0.18  
10        10     0.48       0.433    0.0467
# ℹ 990 more rows</code></pre>
<p>As we did before, we build a histogram for these 1000 differences in Figure <a href="sampling.html#fig:samplingdistribution-virtual-diff-1000">7.27</a>.</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">prop_joined</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">prop_diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.04</span>, boundary <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Difference in sample proportions"</span>, </span>
<span>       title <span class="op">=</span> <span class="st">"Histogram of 1000 differences in sample proportions"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:samplingdistribution-virtual-diff-1000"></span>
<img src="ModernDive_files/figure-html/samplingdistribution-virtual-diff-1000-1.png" alt="The distribution of 1000 differences in sample proportions based on 1000 random samples of size 50 from the first bowl and 1000 random sample of size 60 from the second bowl." width="\textwidth"><p class="caption">
FIGURE 7.27: The distribution of 1000 differences in sample proportions based on 1000 random samples of size 50 from the first bowl and 1000 random sample of size 60 from the second bowl.
</p>
</div>
<p>The sampling distribution of the difference in sample proportions also looks bell-shaped and it appears to be centered at some negative value somewhere around -0.05. As it happened with a single sample proportion or a sample mean, the sampling distribution of the difference in sample proportions also follows a normal distribution and the expected difference as well as the standard error rely on information from the population and the sample size.</p>
<p>Here are the mathematical details: <span class="math inline">\(\overline X_1\)</span> is the random variable that represents the sample proportion of red balls of size <span class="math inline">\(n_1 = 50\)</span>, <span class="math inline">\(\overline X_2\)</span> is the random variable that represents the sample proportion of almonds heavier than 3.8 grams, taken from samples of size <span class="math inline">\(n_2 = 60\)</span>. The proportion of red balls the population proportion and standard deviation are given by <span class="math inline">\(p_1\)</span> and <span class="math inline">\(\sigma_1 = \sqrt{p_1(1-p_1)}\)</span> and for the almonds’ weight the population proportion and standard deviation are given by <span class="math inline">\(p_2\)</span> and <span class="math inline">\(\sigma_2 = \sqrt{p_2(1-p_2)}\)</span>.</p>
<p>The expected value and standard error of the difference, <span class="math inline">\(\overline X_1 - \overline X_2\)</span>, is given by <span class="math inline">\(p_1 - p_2\)</span> and</p>
<p><span class="math display">\[\sqrt{\frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}},\]</span></p>
<p>respectively. If the distributions of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are approximately normal due to the CLT, so is the distribution of <span class="math inline">\(\overline X_1 - \overline X_2\)</span>. We can write all these properties at once:</p>
<span class="math display">\[\overline X_1 - \overline X_2 \sim Normal \left(p_1 - p_2, \sqrt{\frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}} \right)\]</span>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.18)</strong> What is the sampling distribution of the difference in sample proportions expected to look like if both samples are large enough?</p>
<ul>
<li>A. Uniform.</li>
<li>B. Bell-shaped, approximating a normal distribution.</li>
<li>C. Bimodal.</li>
<li>D. Skewed to the right.</li>
</ul>
<div class="learncheck">

</div>
</div>
</div>
</div>
<div id="sampling-final-remarks" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Summary and final remarks<a class="anchor" aria-label="anchor" href="#sampling-final-remarks"><i class="fas fa-link"></i></a>
</h2>
<div id="summary-of-scenarios" class="section level3" number="7.6.1">
<h3>
<span class="header-section-number">7.6.1</span> Summary of scenarios<a class="anchor" aria-label="anchor" href="#summary-of-scenarios"><i class="fas fa-link"></i></a>
</h3>
<p>These are not the only cases where the sampling distribution can be determined. For example, when performing linear regression, we can find the sampling distribution for the slope of the regression line and the behavior will be similar to what we have described here. We will discuss inference in the context of linear regression in Chapter <a href="inference-for-regression.html#inference-for-regression">10</a>. For now, we present a summary of the different scenarios presented in this chapter.</p>
<div class="inline-table"><table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:table-ch7">TABLE 7.2: </span>Scenarios of sampling for inference
</caption>
<thead><tr>
<th style="text-align:right;">
Scenario
</th>
<th style="text-align:left;">
Population parameter
</th>
<th style="text-align:left;">
Notation
</th>
<th style="text-align:left;">
Point estimate
</th>
<th style="text-align:left;">
Symbol(s)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;width: 0.8in; ">
1
</td>
<td style="text-align:left;width: 0.8in; ">
Population proportion
</td>
<td style="text-align:left;width: 0.8in; ">
<span class="math inline">\(p\)</span>
</td>
<td style="text-align:left;width: 0.8in; ">
Sample proportion
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{p}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.8in; ">
2
</td>
<td style="text-align:left;width: 0.8in; ">
Population mean
</td>
<td style="text-align:left;width: 0.8in; ">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;width: 0.8in; ">
Sample mean
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\widehat{\mu}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.8in; ">
3
</td>
<td style="text-align:left;width: 0.8in; ">
Difference in population proportions
</td>
<td style="text-align:left;width: 0.8in; ">
<span class="math inline">\(p_1 - p_2\)</span>
</td>
<td style="text-align:left;width: 0.8in; ">
Difference in sample proportions
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{p}_1 - \widehat{p}_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.8in; ">
4
</td>
<td style="text-align:left;width: 0.8in; ">
Difference in population means
</td>
<td style="text-align:left;width: 0.8in; ">
<span class="math inline">\(\mu_1 - \mu_2\)</span>
</td>
<td style="text-align:left;width: 0.8in; ">
Difference in sample means
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\overline{x}_1 - \overline{x}_2\)</span> or <span class="math inline">\(\widehat{\mu}_1 - \widehat{\mu}_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.8in; ">
5
</td>
<td style="text-align:left;width: 0.8in; ">
Population regression slope
</td>
<td style="text-align:left;width: 0.8in; ">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:left;width: 0.8in; ">
Fitted regression slope
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(b_1\)</span> or <span class="math inline">\(\widehat{\beta}_1\)</span>
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="additional-resources-5" class="section level3" number="7.6.2">
<h3>
<span class="header-section-number">7.6.2</span> Additional resources<a class="anchor" aria-label="anchor" href="#additional-resources-5"><i class="fas fa-link"></i></a>
</h3>
<p>An R script file of all R code used in this chapter is available <a href="scripts/07-sampling.R">here</a>.</p>
</div>
<div id="whats-to-come-6" class="section level3" number="7.6.3">
<h3>
<span class="header-section-number">7.6.3</span> What’s to come?<a class="anchor" aria-label="anchor" href="#whats-to-come-6"><i class="fas fa-link"></i></a>
</h3>
<p>In the upcoming Chapter <a href="confidence-intervals.html#confidence-intervals">8</a> we will delve deeper into the concept of statistical inference, building upon the foundations we have already established in this chapter on sampling. This chapter introduces us to the idea of estimating population parameters using sample data, a key aspect of inferential statistics.</p>
<p>We will explore how to construct and interpret confidence intervals, particularly focusing on understanding what they imply about population parameters. This involves grasping the concept of a confidence level and recognizing the limitations and proper usage of confidence intervals. The chapter is designed to enhance our practical understanding through examples and applications, enabling us to apply these concepts to real-world scenarios.</p>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="multiple-regression.html"><span class="header-section-number">6</span> Multiple Regression</a></div>
<div class="next"><a href="confidence-intervals.html"><span class="header-section-number">8</span> Estimation, Confidence Intervals, and Bootstrapping</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#sampling"><span class="header-section-number">7</span> Sampling</a></li>
<li><a class="nav-link" href="#sampling-packages">Needed packages</a></li>
<li>
<a class="nav-link" href="#sampling-activity"><span class="header-section-number">7.1</span> First activity: red balls</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#population-proportion"><span class="header-section-number">7.1.1</span> The proportion of red balls in the bowl</a></li>
<li><a class="nav-link" href="#sampling-manual"><span class="header-section-number">7.1.2</span> Manual sampling</a></li>
<li><a class="nav-link" href="#sampling-simulation"><span class="header-section-number">7.1.3</span> Virtual sampling</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sampling-framework"><span class="header-section-number">7.2</span> Sampling framework</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#terminology-and-notation"><span class="header-section-number">7.2.1</span> Population, sample, and the sampling distribution</a></li></ul>
</li>
<li>
<a class="nav-link" href="#central-limit-theorem"><span class="header-section-number">7.3</span> The Central Limit Theorem</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#random-variables"><span class="header-section-number">7.3.1</span> Random variables</a></li>
<li><a class="nav-link" href="#the-sampling-distribution-using-random-variables"><span class="header-section-number">7.3.2</span> The sampling distribution using random variables</a></li>
<li><a class="nav-link" href="#the-center-of-the-distribution-the-expected-value"><span class="header-section-number">7.3.3</span> The center of the distribution: the expected value</a></li>
<li><a class="nav-link" href="#sampling-variation"><span class="header-section-number">7.3.4</span> Sampling variation: standard deviation and standard error</a></li>
<li><a class="nav-link" href="#summary-5"><span class="header-section-number">7.3.5</span> Summary</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sampling-activity-mean"><span class="header-section-number">7.4</span> Second activity: chocolate-covered almonds</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#population-mean"><span class="header-section-number">7.4.1</span> The population mean weight of almonds in the bowl</a></li>
<li><a class="nav-link" href="#resampling-tactile-bowl"><span class="header-section-number">7.4.2</span> Manual sampling and sample means</a></li>
<li><a class="nav-link" href="#virtual-samples-mean-bowl"><span class="header-section-number">7.4.3</span> Virtual sampling</a></li>
<li><a class="nav-link" href="#the-sampling-distribution-of-the-sample-mean"><span class="header-section-number">7.4.4</span> The sampling distribution of the sample mean</a></li>
<li><a class="nav-link" href="#random-variable-sample-mean"><span class="header-section-number">7.4.5</span> Random variables</a></li>
<li><a class="nav-link" href="#CLT-mean"><span class="header-section-number">7.4.6</span> The Central Limit Theorem revisited</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sampling-other-scenarios"><span class="header-section-number">7.5</span> The sampling distribution in other scenarios</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#sampling-distribution-for-two-samples"><span class="header-section-number">7.5.1</span> Sampling distribution for two samples</a></li></ul>
</li>
<li>
<a class="nav-link" href="#sampling-final-remarks"><span class="header-section-number">7.6</span> Summary and final remarks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#summary-of-scenarios"><span class="header-section-number">7.6.1</span> Summary of scenarios</a></li>
<li><a class="nav-link" href="#additional-resources-5"><span class="header-section-number">7.6.2</span> Additional resources</a></li>
<li><a class="nav-link" href="#whats-to-come-6"><span class="header-section-number">7.6.3</span> What’s to come?</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Statistical Inference via Data Science</strong>: A ModernDive into R and the Tidyverse <br> (Second Edition)" was written by Chester Ismay, Albert Y. Kim, and Arturo Valdivia <br> Foreword by Kelly S. McConville. It was last built on September 25, 2024.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
