<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>ModernDive</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses.">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="ModernDive" />
  <meta property="og:type" content="book" />


  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses." />
  <meta name="github-repo" content="ismayc/moderndiver-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="ModernDive" />

  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook bridging the gap between traditional introductory statistics and data science courses." />


<meta name="author" content="Chester Ismay and Albert Y. Kim">


<meta name="date" content="2017-08-02">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">


<link rel="prev" href="7-sim.html">
<link rel="next" href="9-ci.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.4/dygraphs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#intro-for-students"><i class="fa fa-check"></i><b>1.1</b> Introduction for students</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#learning-goals"><i class="fa fa-check"></i><b>1.1.1</b> What you will learn from this book</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#pipeline"><i class="fa fa-check"></i><b>1.1.2</b> Data/science pipeline</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#reproducible"><i class="fa fa-check"></i><b>1.1.3</b> Reproducible research</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#final-note-for-students"><i class="fa fa-check"></i><b>1.1.4</b> Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#intro-instructors"><i class="fa fa-check"></i><b>1.2</b> Introduction for instructors</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>1.2.1</b> Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#connect-contribute"><i class="fa fa-check"></i><b>1.3</b> Connect and contribute</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#about-book"><i class="fa fa-check"></i><b>1.4</b> About this book</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i><b>1.4.1</b> Colophon</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-getting-started.html"><a href="2-getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a><ul>
<li class="chapter" data-level="2.1" data-path="2-getting-started.html"><a href="2-getting-started.html#what-are-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> What are R and RStudio?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-getting-started.html"><a href="2-getting-started.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-getting-started.html"><a href="2-getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>2.1.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-getting-started.html"><a href="2-getting-started.html#code"><i class="fa fa-check"></i><b>2.2</b> How do I code in R?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-getting-started.html"><a href="2-getting-started.html#programming-concepts"><i class="fa fa-check"></i><b>2.2.1</b> Basic programming concepts needed</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-getting-started.html"><a href="2-getting-started.html#tips-on-learning-to-code"><i class="fa fa-check"></i><b>2.2.2</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-getting-started.html"><a href="2-getting-started.html#packages"><i class="fa fa-check"></i><b>2.3</b> What are R packages?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-getting-started.html"><a href="2-getting-started.html#package-installation"><i class="fa fa-check"></i><b>2.3.1</b> Package installation</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-getting-started.html"><a href="2-getting-started.html#package-loading"><i class="fa fa-check"></i><b>2.3.2</b> Package loading</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-getting-started.html"><a href="2-getting-started.html#nycflights13"><i class="fa fa-check"></i><b>2.4</b> Putting it all together</a><ul>
<li class="chapter" data-level="2.4.1" data-path="2-getting-started.html"><a href="2-getting-started.html#nycflights13-package"><i class="fa fa-check"></i><b>2.4.1</b> nycflights13 package</a></li>
<li class="chapter" data-level="2.4.2" data-path="2-getting-started.html"><a href="2-getting-started.html#flights-data-frame"><i class="fa fa-check"></i><b>2.4.2</b> flights data frame</a></li>
<li class="chapter" data-level="2.4.3" data-path="2-getting-started.html"><a href="2-getting-started.html#explore-dataframes"><i class="fa fa-check"></i><b>2.4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="2.4.4" data-path="2-getting-started.html"><a href="2-getting-started.html#help-files"><i class="fa fa-check"></i><b>2.4.4</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-getting-started.html"><a href="2-getting-started.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a><ul>
<li class="chapter" data-level="2.5.1" data-path="2-getting-started.html"><a href="2-getting-started.html#whats-to-come"><i class="fa fa-check"></i><b>2.5.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Exploration via the tidyverse</b></span></li>
<li class="chapter" data-level="3" data-path="3-viz.html"><a href="3-viz.html"><i class="fa fa-check"></i><b>3</b> Data Visualization via ggplot2</a><ul>
<li class="chapter" data-level="" data-path="3-viz.html"><a href="3-viz.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="3.1" data-path="3-viz.html"><a href="3-viz.html#grammarofgraphics"><i class="fa fa-check"></i><b>3.1</b> The Grammar of Graphics</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-viz.html"><a href="3-viz.html#components-of-the-grammar"><i class="fa fa-check"></i><b>3.1.1</b> Components of the Grammar</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-viz.html"><a href="3-viz.html#gapminder"><i class="fa fa-check"></i><b>3.1.2</b> Gapminder</a></li>
<li class="chapter" data-level="3.1.3" data-path="3-viz.html"><a href="3-viz.html#other-components-of-the-grammar"><i class="fa fa-check"></i><b>3.1.3</b> Other components of the Grammar</a></li>
<li class="chapter" data-level="3.1.4" data-path="3-viz.html"><a href="3-viz.html#the-ggplot2-package"><i class="fa fa-check"></i><b>3.1.4</b> The ggplot2 package</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-viz.html"><a href="3-viz.html#FiveNG"><i class="fa fa-check"></i><b>3.2</b> Five Named Graphs - The 5NG</a></li>
<li class="chapter" data-level="3.3" data-path="3-viz.html"><a href="3-viz.html#scatterplots"><i class="fa fa-check"></i><b>3.3</b> 5NG#1: Scatterplots</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-viz.html"><a href="3-viz.html#geompoint"><i class="fa fa-check"></i><b>3.3.1</b> Scatterplots via geom_point</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-viz.html"><a href="3-viz.html#over-plotting"><i class="fa fa-check"></i><b>3.3.2</b> Over-plotting</a></li>
<li class="chapter" data-level="3.3.3" data-path="3-viz.html"><a href="3-viz.html#summary"><i class="fa fa-check"></i><b>3.3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-viz.html"><a href="3-viz.html#linegraphs"><i class="fa fa-check"></i><b>3.4</b> 5NG#2: Linegraphs</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-viz.html"><a href="3-viz.html#geomline"><i class="fa fa-check"></i><b>3.4.1</b> Linegraphs via geom_line</a></li>
<li class="chapter" data-level="3.4.2" data-path="3-viz.html"><a href="3-viz.html#summary-1"><i class="fa fa-check"></i><b>3.4.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-viz.html"><a href="3-viz.html#histograms"><i class="fa fa-check"></i><b>3.5</b> 5NG#3: Histograms</a><ul>
<li class="chapter" data-level="3.5.1" data-path="3-viz.html"><a href="3-viz.html#geomhistogram"><i class="fa fa-check"></i><b>3.5.1</b> Histograms via geom_histogram</a></li>
<li class="chapter" data-level="3.5.2" data-path="3-viz.html"><a href="3-viz.html#adjustbins"><i class="fa fa-check"></i><b>3.5.2</b> Adjusting the bins</a></li>
<li class="chapter" data-level="3.5.3" data-path="3-viz.html"><a href="3-viz.html#summary-2"><i class="fa fa-check"></i><b>3.5.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="3-viz.html"><a href="3-viz.html#facets"><i class="fa fa-check"></i><b>3.6</b> Facets</a></li>
<li class="chapter" data-level="3.7" data-path="3-viz.html"><a href="3-viz.html#boxplots"><i class="fa fa-check"></i><b>3.7</b> 5NG#4: Boxplots</a><ul>
<li class="chapter" data-level="3.7.1" data-path="3-viz.html"><a href="3-viz.html#geomboxplot"><i class="fa fa-check"></i><b>3.7.1</b> Boxplots via geom_boxplot</a></li>
<li class="chapter" data-level="3.7.2" data-path="3-viz.html"><a href="3-viz.html#summary-3"><i class="fa fa-check"></i><b>3.7.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="3-viz.html"><a href="3-viz.html#geombar"><i class="fa fa-check"></i><b>3.8</b> 5NG#5: Barplots</a><ul>
<li class="chapter" data-level="3.8.1" data-path="3-viz.html"><a href="3-viz.html#barplots-via-geom_bargeom_col"><i class="fa fa-check"></i><b>3.8.1</b> Barplots via geom_bar/geom_col</a></li>
<li class="chapter" data-level="3.8.2" data-path="3-viz.html"><a href="3-viz.html#must-avoid-pie-charts"><i class="fa fa-check"></i><b>3.8.2</b> Must avoid pie charts!</a></li>
<li class="chapter" data-level="3.8.3" data-path="3-viz.html"><a href="3-viz.html#using-barplots-to-compare-two-categorical-variables"><i class="fa fa-check"></i><b>3.8.3</b> Using barplots to compare two categorical variables</a></li>
<li class="chapter" data-level="3.8.4" data-path="3-viz.html"><a href="3-viz.html#summary-4"><i class="fa fa-check"></i><b>3.8.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="3-viz.html"><a href="3-viz.html#conclusion-1"><i class="fa fa-check"></i><b>3.9</b> Conclusion</a><ul>
<li class="chapter" data-level="3.9.1" data-path="3-viz.html"><a href="3-viz.html#review-questions"><i class="fa fa-check"></i><b>3.9.1</b> Review questions</a></li>
<li class="chapter" data-level="3.9.2" data-path="3-viz.html"><a href="3-viz.html#whats-to-come-1"><i class="fa fa-check"></i><b>3.9.2</b> What’s to come?</a></li>
<li class="chapter" data-level="3.9.3" data-path="3-viz.html"><a href="3-viz.html#resources"><i class="fa fa-check"></i><b>3.9.3</b> Resources</a></li>
<li class="chapter" data-level="3.9.4" data-path="3-viz.html"><a href="3-viz.html#script-of-r-code"><i class="fa fa-check"></i><b>3.9.4</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-tidy.html"><a href="4-tidy.html"><i class="fa fa-check"></i><b>4</b> Data Tidying via tidyr</a><ul>
<li class="chapter" data-level="" data-path="4-tidy.html"><a href="4-tidy.html#needed-packages-1"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.1" data-path="4-tidy.html"><a href="4-tidy.html#what-is-tidy-data"><i class="fa fa-check"></i><b>4.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="4.2" data-path="4-tidy.html"><a href="4-tidy.html#importing-csvs-via-readr"><i class="fa fa-check"></i><b>4.2</b> Importing CSVs via readr</a></li>
<li class="chapter" data-level="4.3" data-path="4-tidy.html"><a href="4-tidy.html#tidying"><i class="fa fa-check"></i><b>4.3</b> Converting from wide to long</a></li>
<li class="chapter" data-level="4.4" data-path="4-tidy.html"><a href="4-tidy.html#back-to-nycflights"><i class="fa fa-check"></i><b>4.4</b> Back to nycflights</a><ul>
<li class="chapter" data-level="4.4.1" data-path="4-tidy.html"><a href="4-tidy.html#observational-units"><i class="fa fa-check"></i><b>4.4.1</b> Observational units</a></li>
<li class="chapter" data-level="4.4.2" data-path="4-tidy.html"><a href="4-tidy.html#identification-vs-measurement-variables"><i class="fa fa-check"></i><b>4.4.2</b> Identification vs measurement variables</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="4-tidy.html"><a href="4-tidy.html#optional-normal-forms-of-data"><i class="fa fa-check"></i><b>4.5</b> Optional: Normal forms of data</a></li>
<li class="chapter" data-level="4.6" data-path="4-tidy.html"><a href="4-tidy.html#conclusion-2"><i class="fa fa-check"></i><b>4.6</b> Conclusion</a><ul>
<li class="chapter" data-level="4.6.1" data-path="4-tidy.html"><a href="4-tidy.html#review-questions-1"><i class="fa fa-check"></i><b>4.6.1</b> Review questions</a></li>
<li class="chapter" data-level="4.6.2" data-path="4-tidy.html"><a href="4-tidy.html#whats-to-come-2"><i class="fa fa-check"></i><b>4.6.2</b> What’s to come?</a></li>
<li class="chapter" data-level="4.6.3" data-path="4-tidy.html"><a href="4-tidy.html#script-of-r-code-1"><i class="fa fa-check"></i><b>4.6.3</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-wrangling.html"><a href="5-wrangling.html"><i class="fa fa-check"></i><b>5</b> Data Wrangling via dplyr</a><ul>
<li class="chapter" data-level="" data-path="5-wrangling.html"><a href="5-wrangling.html#needed-packages-2"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="5.1" data-path="5-wrangling.html"><a href="5-wrangling.html#the-pipe"><i class="fa fa-check"></i><b>5.1</b> The pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="5.2" data-path="5-wrangling.html"><a href="5-wrangling.html#five-main-verbs---the-5mv"><i class="fa fa-check"></i><b>5.2</b> Five Main Verbs - The 5MV</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-wrangling.html"><a href="5-wrangling.html#filter"><i class="fa fa-check"></i><b>5.2.1</b> 5MV#1: Filter observations using filter</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-wrangling.html"><a href="5-wrangling.html#mv2-summarize-variables-using-summarize"><i class="fa fa-check"></i><b>5.2.2</b> 5MV#2: Summarize variables using summarize</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-wrangling.html"><a href="5-wrangling.html#groupby"><i class="fa fa-check"></i><b>5.2.3</b> 5MV#3: Group rows using group_by</a></li>
<li class="chapter" data-level="5.2.4" data-path="5-wrangling.html"><a href="5-wrangling.html#mv4-create-new-variableschange-old-variables-using-mutate"><i class="fa fa-check"></i><b>5.2.4</b> 5MV#4: Create new variables/change old variables using mutate</a></li>
<li class="chapter" data-level="5.2.5" data-path="5-wrangling.html"><a href="5-wrangling.html#arrange"><i class="fa fa-check"></i><b>5.2.5</b> 5MV#5: Reorder the data frame using arrange</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-wrangling.html"><a href="5-wrangling.html#joins"><i class="fa fa-check"></i><b>5.3</b> Joining data frames</a><ul>
<li class="chapter" data-level="5.3.1" data-path="5-wrangling.html"><a href="5-wrangling.html#joining-by-key-variables"><i class="fa fa-check"></i><b>5.3.1</b> Joining by key variables</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-wrangling.html"><a href="5-wrangling.html#joining-by-key-variables-with-different-names"><i class="fa fa-check"></i><b>5.3.2</b> Joining by key variables with different names</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-wrangling.html"><a href="5-wrangling.html#other-verbs"><i class="fa fa-check"></i><b>5.4</b> Optional: Other verbs</a><ul>
<li class="chapter" data-level="5.4.1" data-path="5-wrangling.html"><a href="5-wrangling.html#select"><i class="fa fa-check"></i><b>5.4.1</b> Select variables using select</a></li>
<li class="chapter" data-level="5.4.2" data-path="5-wrangling.html"><a href="5-wrangling.html#rename"><i class="fa fa-check"></i><b>5.4.2</b> Rename variables using rename</a></li>
<li class="chapter" data-level="5.4.3" data-path="5-wrangling.html"><a href="5-wrangling.html#find-the-top-number-of-values-using-top_n"><i class="fa fa-check"></i><b>5.4.3</b> Find the top number of values using top_n</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="5-wrangling.html"><a href="5-wrangling.html#conclusion-3"><i class="fa fa-check"></i><b>5.5</b> Conclusion</a><ul>
<li class="chapter" data-level="5.5.1" data-path="5-wrangling.html"><a href="5-wrangling.html#review-questions-2"><i class="fa fa-check"></i><b>5.5.1</b> Review questions</a></li>
<li class="chapter" data-level="5.5.2" data-path="5-wrangling.html"><a href="5-wrangling.html#whats-to-come-3"><i class="fa fa-check"></i><b>5.5.2</b> What’s to come?</a></li>
<li class="chapter" data-level="5.5.3" data-path="5-wrangling.html"><a href="5-wrangling.html#resources-1"><i class="fa fa-check"></i><b>5.5.3</b> Resources</a></li>
<li class="chapter" data-level="5.5.4" data-path="5-wrangling.html"><a href="5-wrangling.html#script-of-r-code-2"><i class="fa fa-check"></i><b>5.5.4</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-regression.html"><a href="6-regression.html"><i class="fa fa-check"></i><b>6</b> Data Modeling using Regression via broom</a><ul>
<li class="chapter" data-level="" data-path="6-regression.html"><a href="6-regression.html#needed-packages-3"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="6.1" data-path="6-regression.html"><a href="6-regression.html#regdata"><i class="fa fa-check"></i><b>6.1</b> Data: Alaskan Airlines delays</a></li>
<li class="chapter" data-level="6.2" data-path="6-regression.html"><a href="6-regression.html#correlation"><i class="fa fa-check"></i><b>6.2</b> Correlation</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-regression.html"><a href="6-regression.html#correlation-does-not-imply-causation"><i class="fa fa-check"></i><b>6.2.1</b> Correlation does not imply causation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-regression.html"><a href="6-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.3</b> Simple linear regression</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-regression.html"><a href="6-regression.html#best-fitting-line"><i class="fa fa-check"></i><b>6.3.1</b> Best fitting line</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-regression.html"><a href="6-regression.html#regeq"><i class="fa fa-check"></i><b>6.4</b> Equation of the line</a><ul>
<li class="chapter" data-level="6.4.1" data-path="6-regression.html"><a href="6-regression.html#interpretation"><i class="fa fa-check"></i><b>6.4.1</b> Coefficient interpretation</a></li>
<li class="chapter" data-level="6.4.2" data-path="6-regression.html"><a href="6-regression.html#prediction"><i class="fa fa-check"></i><b>6.4.2</b> Predicting values</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6-regression.html"><a href="6-regression.html#conclusion-4"><i class="fa fa-check"></i><b>6.5</b> Conclusion</a><ul>
<li class="chapter" data-level="6.5.1" data-path="6-regression.html"><a href="6-regression.html#whats-to-come-4"><i class="fa fa-check"></i><b>6.5.1</b> What’s to come?</a></li>
<li class="chapter" data-level="6.5.2" data-path="6-regression.html"><a href="6-regression.html#script-of-r-code-3"><i class="fa fa-check"></i><b>6.5.2</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Inference</b></span></li>
<li class="chapter" data-level="7" data-path="7-sim.html"><a href="7-sim.html"><i class="fa fa-check"></i><b>7</b> Simulating Randomness</a><ul>
<li class="chapter" data-level="" data-path="7-sim.html"><a href="7-sim.html#needed-packages-4"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="7.1" data-path="7-sim.html"><a href="7-sim.html#random-sampling"><i class="fa fa-check"></i><b>7.1</b> Random sampling</a><ul>
<li class="chapter" data-level="7.1.1" data-path="7-sim.html"><a href="7-sim.html#tasting-soup"><i class="fa fa-check"></i><b>7.1.1</b> Tasting soup</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-sim.html"><a href="7-sim.html#common-terms"><i class="fa fa-check"></i><b>7.1.2</b> Common terms</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-sim.html"><a href="7-sim.html#vizsamp"><i class="fa fa-check"></i><b>7.2</b> Visualizing sampling</a><ul>
<li class="chapter" data-level="7.2.1" data-path="7-sim.html"><a href="7-sim.html#sampling-distribution"><i class="fa fa-check"></i><b>7.2.1</b> Sampling distribution</a></li>
<li class="chapter" data-level="7.2.2" data-path="7-sim.html"><a href="7-sim.html#repeated-sampling-via-do"><i class="fa fa-check"></i><b>7.2.2</b> Repeated sampling via <code>do</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7-sim.html"><a href="7-sim.html#simulation"><i class="fa fa-check"></i><b>7.3</b> Simulation</a></li>
<li class="chapter" data-level="7.4" data-path="7-sim.html"><a href="7-sim.html#review-of-mosaic-simulation-functions"><i class="fa fa-check"></i><b>7.4</b> Review of <code>mosaic</code> simulation functions</a></li>
<li class="chapter" data-level="7.5" data-path="7-sim.html"><a href="7-sim.html#conclusion-5"><i class="fa fa-check"></i><b>7.5</b> Conclusion</a><ul>
<li class="chapter" data-level="7.5.1" data-path="7-sim.html"><a href="7-sim.html#whats-to-come-5"><i class="fa fa-check"></i><b>7.5.1</b> What’s to come?</a></li>
<li class="chapter" data-level="7.5.2" data-path="7-sim.html"><a href="7-sim.html#script-of-r-code-4"><i class="fa fa-check"></i><b>7.5.2</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-hypo.html"><a href="8-hypo.html"><i class="fa fa-check"></i><b>8</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="" data-path="8-hypo.html"><a href="8-hypo.html#needed-packages-5"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="8.1" data-path="8-hypo.html"><a href="8-hypo.html#when-inference-is-not-needed"><i class="fa fa-check"></i><b>8.1</b> When inference is not needed</a></li>
<li class="chapter" data-level="8.2" data-path="8-hypo.html"><a href="8-hypo.html#basics-of-hypothesis-testing"><i class="fa fa-check"></i><b>8.2</b> Basics of hypothesis testing</a></li>
<li class="chapter" data-level="8.3" data-path="8-hypo.html"><a href="8-hypo.html#trial"><i class="fa fa-check"></i><b>8.3</b> Criminal trial analogy</a><ul>
<li class="chapter" data-level="8.3.1" data-path="8-hypo.html"><a href="8-hypo.html#two-possible-conclusions"><i class="fa fa-check"></i><b>8.3.1</b> Two possible conclusions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8-hypo.html"><a href="8-hypo.html#types-of-errors-in-hypothesis-testing"><i class="fa fa-check"></i><b>8.4</b> Types of errors in hypothesis testing</a><ul>
<li class="chapter" data-level="8.4.1" data-path="8-hypo.html"><a href="8-hypo.html#logic-of-hypothesis-testing"><i class="fa fa-check"></i><b>8.4.1</b> Logic of hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="8-hypo.html"><a href="8-hypo.html#statistical-significance"><i class="fa fa-check"></i><b>8.5</b> Statistical significance</a></li>
<li class="chapter" data-level="8.6" data-path="8-hypo.html"><a href="8-hypo.html#example-revisiting-the-lady-tasting-tea"><i class="fa fa-check"></i><b>8.6</b> Example: Revisiting the Lady Tasting Tea</a><ul>
<li class="chapter" data-level="8.6.1" data-path="8-hypo.html"><a href="8-hypo.html#data"><i class="fa fa-check"></i><b>8.6.1</b> Data</a></li>
<li class="chapter" data-level="8.6.2" data-path="8-hypo.html"><a href="8-hypo.html#test-statistic-delta"><i class="fa fa-check"></i><b>8.6.2</b> Test statistic <span class="math inline">\(\delta\)</span></a></li>
<li class="chapter" data-level="8.6.3" data-path="8-hypo.html"><a href="8-hypo.html#observed-effect-delta"><i class="fa fa-check"></i><b>8.6.3</b> Observed effect <span class="math inline">\(\delta^*\)</span></a></li>
<li class="chapter" data-level="8.6.4" data-path="8-hypo.html"><a href="8-hypo.html#model-of-h_0"><i class="fa fa-check"></i><b>8.6.4</b> Model of <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="8.6.5" data-path="8-hypo.html"><a href="8-hypo.html#simulated-data"><i class="fa fa-check"></i><b>8.6.5</b> Simulated data</a></li>
<li class="chapter" data-level="8.6.6" data-path="8-hypo.html"><a href="8-hypo.html#distribution-of-delta-under-h_0"><i class="fa fa-check"></i><b>8.6.6</b> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="8.6.7" data-path="8-hypo.html"><a href="8-hypo.html#the-p-value"><i class="fa fa-check"></i><b>8.6.7</b> The p-value</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="8-hypo.html"><a href="8-hypo.html#example-comparing-two-means"><i class="fa fa-check"></i><b>8.7</b> Example: Comparing two means</a><ul>
<li class="chapter" data-level="8.7.1" data-path="8-hypo.html"><a href="8-hypo.html#randomizationpermutation"><i class="fa fa-check"></i><b>8.7.1</b> Randomization/permutation</a></li>
<li class="chapter" data-level="8.7.2" data-path="8-hypo.html"><a href="8-hypo.html#comparing-action-and-romance-movies"><i class="fa fa-check"></i><b>8.7.2</b> Comparing action and romance movies</a></li>
<li class="chapter" data-level="8.7.3" data-path="8-hypo.html"><a href="8-hypo.html#sampling-rightarrow-randomization"><i class="fa fa-check"></i><b>8.7.3</b> Sampling <span class="math inline">\(\rightarrow\)</span> randomization</a></li>
<li class="chapter" data-level="8.7.4" data-path="8-hypo.html"><a href="8-hypo.html#data-1"><i class="fa fa-check"></i><b>8.7.4</b> Data</a></li>
<li class="chapter" data-level="8.7.5" data-path="8-hypo.html"><a href="8-hypo.html#model-of-h_0-1"><i class="fa fa-check"></i><b>8.7.5</b> Model of <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="8.7.6" data-path="8-hypo.html"><a href="8-hypo.html#test-statistic-delta-1"><i class="fa fa-check"></i><b>8.7.6</b> Test statistic <span class="math inline">\(\delta\)</span></a></li>
<li class="chapter" data-level="8.7.7" data-path="8-hypo.html"><a href="8-hypo.html#observed-effect-delta-1"><i class="fa fa-check"></i><b>8.7.7</b> Observed effect <span class="math inline">\(\delta^*\)</span></a></li>
<li class="chapter" data-level="8.7.8" data-path="8-hypo.html"><a href="8-hypo.html#simulated-data-1"><i class="fa fa-check"></i><b>8.7.8</b> Simulated data</a></li>
<li class="chapter" data-level="8.7.9" data-path="8-hypo.html"><a href="8-hypo.html#distribution-of-delta-under-h_0-1"><i class="fa fa-check"></i><b>8.7.9</b> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="8.7.10" data-path="8-hypo.html"><a href="8-hypo.html#the-p-value-1"><i class="fa fa-check"></i><b>8.7.10</b> The p-value</a></li>
<li class="chapter" data-level="8.7.11" data-path="8-hypo.html"><a href="8-hypo.html#summary-5"><i class="fa fa-check"></i><b>8.7.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="8-hypo.html"><a href="8-hypo.html#theory-hypo"><i class="fa fa-check"></i><b>8.8</b> Building theory-based methods using computation</a><ul>
<li class="chapter" data-level="8.8.1" data-path="8-hypo.html"><a href="8-hypo.html#example-t-test-for-two-independent-samples"><i class="fa fa-check"></i><b>8.8.1</b> Example: <span class="math inline">\(t\)</span>-test for two independent samples</a></li>
<li class="chapter" data-level="8.8.2" data-path="8-hypo.html"><a href="8-hypo.html#conditions-for-t-test"><i class="fa fa-check"></i><b>8.8.2</b> Conditions for t-test</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="8-hypo.html"><a href="8-hypo.html#resampling-based-inference-for-regression"><i class="fa fa-check"></i><b>8.9</b> Resampling-based inference for regression</a><ul>
<li class="chapter" data-level="8.9.1" data-path="8-hypo.html"><a href="8-hypo.html#data-2"><i class="fa fa-check"></i><b>8.9.1</b> Data</a></li>
<li class="chapter" data-level="8.9.2" data-path="8-hypo.html"><a href="8-hypo.html#test-statistic-delta-2"><i class="fa fa-check"></i><b>8.9.2</b> Test statistic <span class="math inline">\(\delta\)</span></a></li>
<li class="chapter" data-level="8.9.3" data-path="8-hypo.html"><a href="8-hypo.html#observed-effect-delta-2"><i class="fa fa-check"></i><b>8.9.3</b> Observed effect <span class="math inline">\(\delta^*\)</span></a></li>
<li class="chapter" data-level="8.9.4" data-path="8-hypo.html"><a href="8-hypo.html#model-of-h_0-2"><i class="fa fa-check"></i><b>8.9.4</b> Model of <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="8.9.5" data-path="8-hypo.html"><a href="8-hypo.html#simulated-data-2"><i class="fa fa-check"></i><b>8.9.5</b> Simulated data</a></li>
<li class="chapter" data-level="8.9.6" data-path="8-hypo.html"><a href="8-hypo.html#distribution-of-delta-under-h_0-2"><i class="fa fa-check"></i><b>8.9.6</b> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="8.9.7" data-path="8-hypo.html"><a href="8-hypo.html#the-p-value-2"><i class="fa fa-check"></i><b>8.9.7</b> The p-value</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="8-hypo.html"><a href="8-hypo.html#theoryreg"><i class="fa fa-check"></i><b>8.10</b> Theory-based inference for regression</a><ul>
<li class="chapter" data-level="8.10.1" data-path="8-hypo.html"><a href="8-hypo.html#conditions-for-regression"><i class="fa fa-check"></i><b>8.10.1</b> Conditions for regression</a></li>
<li class="chapter" data-level="8.10.2" data-path="8-hypo.html"><a href="8-hypo.html#resid"><i class="fa fa-check"></i><b>8.10.2</b> Residual analysis</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="8-hypo.html"><a href="8-hypo.html#conclusion-6"><i class="fa fa-check"></i><b>8.11</b> Conclusion</a><ul>
<li class="chapter" data-level="8.11.1" data-path="8-hypo.html"><a href="8-hypo.html#whats-to-come-6"><i class="fa fa-check"></i><b>8.11.1</b> What’s to come?</a></li>
<li class="chapter" data-level="8.11.2" data-path="8-hypo.html"><a href="8-hypo.html#script-of-r-code-5"><i class="fa fa-check"></i><b>8.11.2</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-ci.html"><a href="9-ci.html"><i class="fa fa-check"></i><b>9</b> Confidence Intervals</a><ul>
<li class="chapter" data-level="" data-path="9-ci.html"><a href="9-ci.html#needed-packages-6"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="9.1" data-path="9-ci.html"><a href="9-ci.html#bootstrapping"><i class="fa fa-check"></i><b>9.1</b> Bootstrapping</a><ul>
<li class="chapter" data-level="9.1.1" data-path="9-ci.html"><a href="9-ci.html#review-of-bootstrapping"><i class="fa fa-check"></i><b>9.1.1</b> Review of bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9-ci.html"><a href="9-ci.html#relation-to-hypothesis-testing"><i class="fa fa-check"></i><b>9.2</b> Relation to hypothesis testing</a></li>
<li class="chapter" data-level="9.3" data-path="9-ci.html"><a href="9-ci.html#effect-size"><i class="fa fa-check"></i><b>9.3</b> Effect size</a></li>
<li class="chapter" data-level="9.4" data-path="9-ci.html"><a href="9-ci.html#conclusion-7"><i class="fa fa-check"></i><b>9.4</b> Conclusion</a><ul>
<li class="chapter" data-level="9.4.1" data-path="9-ci.html"><a href="9-ci.html#whats-to-come-7"><i class="fa fa-check"></i><b>9.4.1</b> What’s to come?</a></li>
<li class="chapter" data-level="9.4.2" data-path="9-ci.html"><a href="9-ci.html#script-of-r-code-6"><i class="fa fa-check"></i><b>9.4.2</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Conclusion</b></span></li>
<li class="chapter" data-level="10" data-path="10-wrapping-up.html"><a href="10-wrapping-up.html"><i class="fa fa-check"></i><b>10</b> Wrapping Up</a><ul>
<li class="chapter" data-level="10.1" data-path="10-wrapping-up.html"><a href="10-wrapping-up.html#effective-data-storytelling"><i class="fa fa-check"></i><b>10.1</b> Effective Data Storytelling</a></li>
<li class="chapter" data-level="" data-path="10-wrapping-up.html"><a href="10-wrapping-up.html#concluding-remarks"><i class="fa fa-check"></i>Concluding remarks</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-appendixA.html"><a href="A-appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a><ul>
<li class="chapter" data-level="A.1" data-path="A-appendixA.html"><a href="A-appendixA.html#basic-statistical-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a><ul>
<li class="chapter" data-level="A.1.1" data-path="A-appendixA.html"><a href="A-appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="A-appendixA.html"><a href="A-appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="A-appendixA.html"><a href="A-appendixA.html#standard-deviation"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation</a></li>
<li class="chapter" data-level="A.1.4" data-path="A-appendixA.html"><a href="A-appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="A-appendixA.html"><a href="A-appendixA.html#distribution"><i class="fa fa-check"></i><b>A.1.5</b> Distribution</a></li>
<li class="chapter" data-level="A.1.6" data-path="A-appendixA.html"><a href="A-appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.6</b> Outliers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-appendixB.html"><a href="B-appendixB.html"><i class="fa fa-check"></i><b>B</b> Inference Examples</a><ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#needed-packages-7"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="B.1" data-path="B-appendixB.html"><a href="B-appendixB.html#inference-mind-map"><i class="fa fa-check"></i><b>B.1</b> Inference mind map</a></li>
<li class="chapter" data-level="B.2" data-path="B-appendixB.html"><a href="B-appendixB.html#one-mean"><i class="fa fa-check"></i><b>B.2</b> One mean</a><ul>
<li class="chapter" data-level="B.2.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement"><i class="fa fa-check"></i><b>B.2.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.2.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses"><i class="fa fa-check"></i><b>B.2.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.2.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data"><i class="fa fa-check"></i><b>B.2.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.2.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods"><i class="fa fa-check"></i><b>B.2.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.2.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods"><i class="fa fa-check"></i><b>B.2.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.2.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results"><i class="fa fa-check"></i><b>B.2.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="B-appendixB.html"><a href="B-appendixB.html#one-proportion"><i class="fa fa-check"></i><b>B.3</b> One proportion</a><ul>
<li class="chapter" data-level="B.3.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-1"><i class="fa fa-check"></i><b>B.3.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.3.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-1"><i class="fa fa-check"></i><b>B.3.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.3.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-1"><i class="fa fa-check"></i><b>B.3.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.3.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-1"><i class="fa fa-check"></i><b>B.3.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-1"><i class="fa fa-check"></i><b>B.3.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.3.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-1"><i class="fa fa-check"></i><b>B.3.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="B-appendixB.html"><a href="B-appendixB.html#two-proportions"><i class="fa fa-check"></i><b>B.4</b> Two proportions</a><ul>
<li class="chapter" data-level="B.4.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-2"><i class="fa fa-check"></i><b>B.4.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.4.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-2"><i class="fa fa-check"></i><b>B.4.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.4.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-2"><i class="fa fa-check"></i><b>B.4.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.4.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-2"><i class="fa fa-check"></i><b>B.4.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.4.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-2"><i class="fa fa-check"></i><b>B.4.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.4.6" data-path="B-appendixB.html"><a href="B-appendixB.html#check-conditions-2"><i class="fa fa-check"></i><b>B.4.6</b> Check conditions</a></li>
<li class="chapter" data-level="B.4.7" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-2"><i class="fa fa-check"></i><b>B.4.7</b> Test statistic</a></li>
<li class="chapter" data-level="B.4.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-2"><i class="fa fa-check"></i><b>B.4.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.4.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-2"><i class="fa fa-check"></i><b>B.4.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-independent-samples"><i class="fa fa-check"></i><b>B.5</b> Two means (independent samples)</a><ul>
<li class="chapter" data-level="B.5.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-3"><i class="fa fa-check"></i><b>B.5.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.5.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-3"><i class="fa fa-check"></i><b>B.5.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.5.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-3"><i class="fa fa-check"></i><b>B.5.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.5.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-3"><i class="fa fa-check"></i><b>B.5.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.5.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-3"><i class="fa fa-check"></i><b>B.5.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.5.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-3"><i class="fa fa-check"></i><b>B.5.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.5.7" data-path="B-appendixB.html"><a href="B-appendixB.html#compute-p-value-2"><i class="fa fa-check"></i><b>B.5.7</b> Compute <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="B.5.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-3"><i class="fa fa-check"></i><b>B.5.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.5.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-3"><i class="fa fa-check"></i><b>B.5.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-paired-samples"><i class="fa fa-check"></i><b>B.6</b> Two means (paired samples)</a><ul>
<li class="chapter" data-level="B.6.1" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-4"><i class="fa fa-check"></i><b>B.6.1</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.6.2" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-4"><i class="fa fa-check"></i><b>B.6.2</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.6.3" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-4"><i class="fa fa-check"></i><b>B.6.3</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.6.4" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-4"><i class="fa fa-check"></i><b>B.6.4</b> Traditional methods</a></li>
<li class="chapter" data-level="B.6.5" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-4"><i class="fa fa-check"></i><b>B.6.5</b> Comparing results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-appendixC.html"><a href="C-appendixC.html"><i class="fa fa-check"></i><b>C</b> Reach for the Stars</a><ul>
<li class="chapter" data-level="" data-path="C-appendixC.html"><a href="C-appendixC.html#needed-packages-8"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="C.1" data-path="C-appendixC.html"><a href="C-appendixC.html#sorted-barplots"><i class="fa fa-check"></i><b>C.1</b> Sorted barplots</a></li>
<li class="chapter" data-level="C.2" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-graphics"><i class="fa fa-check"></i><b>C.2</b> Interactive graphics</a><ul>
<li class="chapter" data-level="C.2.1" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-linegraphs"><i class="fa fa-check"></i><b>C.2.1</b> Interactive linegraphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ModernDive</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hypo" class="section level1">
<h1><span class="header-section-number">8</span> Hypothesis Testing</h1>
<p>We saw some of the main concepts of hypothesis testing introduced in Chapter <a href="7-sim.html#sim">7</a>. We will expand further on these ideas here and also provide a framework for understanding hypothesis tests in general. Instead of presenting you with lots of different formulas and scenarios, we hope to build a way to think about all hypothesis tests. You can then adapt to different scenarios as needed down the road when you encounter different statistical situations.</p>
<p>The same can be said for confidence intervals. There is one general framework that applies to all confidence intervals and we will elaborate on this further in Chapter <a href="9-ci.html#ci">9</a>. The specifics may change slightly for each variation, but the important idea is to understand the general framework so that you can apply it to more specific problems. We believe that this approach is much better in the long-term than teaching you specific tests and confidence intervals rigorously. You can find fully-worked out examples for five common hypothesis tests and their corresponding confidence intervals in Appendix <a href="B-appendixB.html#appendixB">B</a>.</p>
<p>We recommend that you carefully review these examples as they also cover how the general frameworks apply to traditional normal-based methodologies like the <span class="math inline">\(t\)</span>-test and normal-theory confidence intervals. You’ll see there that these methods are just approximations for the general computational frameworks, but require conditions to be met for their results to be valid. The general frameworks using randomization, simulation, and bootstrapping do not hold the same sorts of restrictions and further advance computational thinking, which is one big reason for their emphasis throughout this textbook.</p>
<div id="needed-packages-5" class="section level3 unnumbered">
<h3>Needed packages</h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). If needed, read Section <a href="2-getting-started.html#packages">2.3</a> for information on how to install and load R packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(mosaic)
<span class="kw">library</span>(knitr)
<span class="kw">library</span>(nycflights13)
<span class="kw">library</span>(ggplot2movies)
<span class="kw">library</span>(broom)</code></pre></div>
<hr />
</div>
<div id="when-inference-is-not-needed" class="section level2">
<h2><span class="header-section-number">8.1</span> When inference is not needed</h2>
<p>Before we delve into the two techniques of inference (hypothesis testing and confidence intervals), it’s good to remember that there are cases where you need not perform a rigorous statistical inference. An important and time-saving skill is to <strong>ALWAYS</strong> do exploratory data analysis using <code>dplyr</code> and <code>ggplot2</code> before thinking about running a hypothesis test. Let’s look at such an example selecting a sample of flights traveling to Boston and to San Francisco from New York City in the <code>flights</code> data frame in the <code>nycflights13</code> package. (We will remove flights with missing data first using <code>na.omit</code> and then sample 100 flights going to each of the two airports.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bos_sfo &lt;-<span class="st"> </span>flights %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">na.omit</span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(dest %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;BOS&quot;</span>, <span class="st">&quot;SFO&quot;</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(dest) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">100</span>)</code></pre></div>
<p>Suppose we were interested in seeing if the <code>air_time</code> to SFO in San Francisco was statistically greater than the <code>air_time</code> to BOS in Boston. As suggested, let’s begin with some exploratory data analysis to get a sense for how the two variables of <code>air_time</code> and <code>dest</code> relate for these two destination airports:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bos_sfo_summary &lt;-<span class="st"> </span>bos_sfo %&gt;%<span class="st"> </span><span class="kw">group_by</span>(dest) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_time =</span> <span class="kw">mean</span>(air_time),
            <span class="dt">sd_time =</span> <span class="kw">sd</span>(air_time))
<span class="kw">kable</span>(bos_sfo_summary)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">dest</th>
<th align="right">mean_time</th>
<th align="right">sd_time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">BOS</td>
<td align="right">39.48</td>
<td align="right">5.11</td>
</tr>
<tr class="even">
<td align="left">SFO</td>
<td align="right">345.33</td>
<td align="right">17.03</td>
</tr>
</tbody>
</table>
<p>Looking at these results, we can clearly see that SFO <code>air_time</code> is much larger than BOS <code>air_time</code>. The standard deviation is also extremely informative here.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.1)</strong> Could we make the same type of immediate conclusion that SFO had a statistically greater <code>air_time</code> if, say, its corresponding standard deviation was 200 minutes? What about 100 minutes? Explain.</p>
<div class="learncheck">

</div>
<p>To further understand just how different the <code>air_time</code> variable is for BOS and SFO, let’s look at a boxplot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bos_sfo, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dest, <span class="dt">y =</span> air_time)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-176-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>Since there is no overlap at all, we can conclude that the <code>air_time</code> for San Francisco flights is statistically greater (at any level of significance) than the <code>air_time</code> for Boston flights. This is a clear example of not needing to do anything more than some simple descriptive statistics to get an appropriate inferential conclusion. This is one reason why you should <strong>ALWAYS</strong> investigate the sample data first using <code>dplyr</code> and <code>ggplot2</code> via exploratory data analysis.</p>
<p>As you get more and more practice with hypothesis testing, you’ll be better able to determine in many cases whether or not the results will be statistically significant. There are circumstances where it is difficult to tell, but you should always try to make a guess FIRST about significance after you have completed your data exploration and before you actually begin the inferential techniques.</p>
</div>
<div id="basics-of-hypothesis-testing" class="section level2">
<h2><span class="header-section-number">8.2</span> Basics of hypothesis testing</h2>
<p>In a hypothesis test, we will use data from a sample to help us decide between two competing <em>hypotheses</em> about a population. We make these hypotheses more concrete by specifying them in terms of at least one <em>population parameter</em> of interest. We refer to the competing claims about the population as the <strong>null hypothesis</strong>, denoted by <span class="math inline">\(H_0\)</span>, and the <strong>alternative (or research) hypothesis</strong>, denoted by <span class="math inline">\(H_a\)</span>. The roles of these two hypotheses are NOT interchangeable.</p>
<ul>
<li>The claim for which we seek significant evidence is assigned to the alternative hypothesis. The alternative is usually what the experimenter or researcher wants to establish or find evidence for.</li>
<li>Usually, the null hypothesis is a claim that there really is “no effect” or “no difference.” In many cases, the null hypothesis represents the status quo or that nothing interesting is happening.<br />
</li>
<li>We assess the strength of evidence by assuming the null hypothesis is true and determining how unlikely it would be to see sample results/statistics as extreme (or more extreme) as those in the original sample.</li>
</ul>
<p>Hypothesis testing brings about many weird and incorrect notions in the scientific community and society at large. One reason for this is that statistics has traditionally been thought of as this magic box of algorithms and procedures to get to results and this has been readily apparent if you do a Google search of “flowchart statistics hypothesis tests”. There are so many different complex ways to determine which test is appropriate.</p>
<p>You’ll see that we don’t need to rely on these complicated series of assumptions and procedures to conduct a hypothesis test any longer. These methods were introduced in a time when computers weren’t powerful. Your cellphone (in 2016) has more power than the computers that sent NASA astronauts to the moon after all. We’ll see that ALL hypothesis tests can be broken down into the following framework given by Allen Downey <a href="http://allendowney.blogspot.com/2016/06/there-is-still-only-one-test.html">here</a>:</p>
<div class="figure" style="text-align: center"><span id="fig:htdowney"></span>
<img src="images/ht.png" alt="Hypothesis Testing Framework" width="\textwidth" />
<p class="caption">
Figure 8.1: Hypothesis Testing Framework
</p>
</div>
<p>Before we hop into this framework, we will provide another way to think about hypothesis testing that may be useful.</p>
<hr />
</div>
<div id="trial" class="section level2">
<h2><span class="header-section-number">8.3</span> Criminal trial analogy</h2>
<p>We can think of hypothesis testing in the same context as a criminal trial in the United States. A criminal trial in the United States is a familiar situation in which a choice between two contradictory claims must be made.</p>
<ol style="list-style-type: decimal">
<li><p>The accuser of the crime must be judged either guilty or not guilty.</p></li>
<li><p>Under the U.S. system of justice, the individual on trial is initially presumed not guilty.</p></li>
<li><p>Only STRONG EVIDENCE to the contrary causes the not guilty claim to be rejected in favor of a guilty verdict.</p></li>
<li><p>The phrase “beyond a reasonable doubt” is often used to set the cutoff value for when enough evidence has been given to convict.</p></li>
</ol>
<p>Theoretically, we should never say “The person is innocent.” but instead “There is not sufficient evidence to show that the person is guilty.”</p>
<p>Now let’s compare that to how we look at a hypothesis test.</p>
<ol style="list-style-type: decimal">
<li><p>The decision about the population parameter(s) must be judged to follow one of two hypotheses.</p></li>
<li><p>We initially assume that <span class="math inline">\(H_0\)</span> is true.</p></li>
<li><p>The null hypothesis <span class="math inline">\(H_0\)</span> will be rejected (in favor of <span class="math inline">\(H_a\)</span>) only if the sample evidence strongly suggests that <span class="math inline">\(H_0\)</span> is false. If the sample does not provide such evidence, <span class="math inline">\(H_0\)</span> will not be rejected.</p></li>
<li><p>The analogy to “beyond a reasonable doubt” in hypothesis testing is what is known as the <strong>significance level</strong>. This will be set before conducting the hypothesis test and is denoted as <span class="math inline">\(\alpha\)</span>. Common values for <span class="math inline">\(\alpha\)</span> are 0.1, 0.01, and 0.05.</p></li>
</ol>
<div id="two-possible-conclusions" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Two possible conclusions</h3>
<p>Therefore, we have two possible conclusions with hypothesis testing:</p>
<ul>
<li>Reject <span class="math inline">\(H_0\)</span><br />
</li>
<li>Fail to reject <span class="math inline">\(H_0\)</span></li>
</ul>
<p>Gut instinct says that “Fail to reject <span class="math inline">\(H_0\)</span>” should say “Accept <span class="math inline">\(H_0\)</span>” but this technically is not correct. Accepting <span class="math inline">\(H_0\)</span> is the same as saying that a person is innocent. We cannot show that a person is innocent; we can only say that there was not enough substantial evidence to find the person guilty.</p>
<p>When you run a hypothesis test, you are the jury of the trial. You decide whether there is enough evidence to convince yourself that <span class="math inline">\(H_a\)</span> is true (“the person is guilty”) or that there was not enough evidence to convince yourself <span class="math inline">\(H_a\)</span> is true (“the person is not guilty”). You must convince yourself (using statistical arguments) which hypothesis is the correct one given the sample information.</p>
<p><strong>Important note:</strong> Therefore, DO NOT WRITE “Accept <span class="math inline">\(H_0\)</span>” any time you conduct a hypothesis test. Instead write “Fail to reject <span class="math inline">\(H_0\)</span>.”</p>
<hr />
</div>
</div>
<div id="types-of-errors-in-hypothesis-testing" class="section level2">
<h2><span class="header-section-number">8.4</span> Types of errors in hypothesis testing</h2>
<p>Unfortunately, just as a jury or a judge can make an incorrect decision in regards to a criminal trial by reaching the wrong verdict, there is some chance we will reach the wrong conclusion via a hypothesis test about a population parameter. As with criminal trials, this comes from the fact that we don’t have complete information, but rather a sample from which to try to infer about a population.</p>
<p>The possible erroneous conclusions in a criminal trial are</p>
<ul>
<li>an innocent person is convicted (found guilty) or</li>
<li>a guilty person is set free (found not guilty).</li>
</ul>
<p>The possible errors in a hypothesis test are</p>
<ul>
<li>rejecting <span class="math inline">\(H_0\)</span> when in fact <span class="math inline">\(H_0\)</span> is true (Type I Error) or</li>
<li>failing to reject <span class="math inline">\(H_0\)</span> when in fact <span class="math inline">\(H_0\)</span> is false (Type II Error).</li>
</ul>
<p>The risk of error is the price researchers pay for basing an inference about a population on a sample. With any reasonable sample-based procedure, there is some chance that a Type I error will be made and some chance that a Type II error will occur.</p>
<p>To help understand the concepts of Type I error and Type II error, observe the following table:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-177"></span>
<img src="images/errors.png" alt="Type I and Type II errors" width="\textwidth" />
<p class="caption">
Figure 8.2: Type I and Type II errors
</p>
</div>
<p>If we are using sample data to make inferences about a parameter, we run the risk of making a mistake. Obviously, we want to minimize our chance of error; we want a small probability of drawing an incorrect conclusion.</p>
<ul>
<li>The probability of a Type I Error occurring is denoted by <span class="math inline">\(\alpha\)</span> and is called the <strong>significance level</strong> of a hypothesis test</li>
<li>The probability of a Type II Error is denoted by <span class="math inline">\(\beta\)</span>.</li>
</ul>
<p>Formally, we can define <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> in regards to the table above, but for hypothesis tests instead of a criminal trial.</p>
<ul>
<li><span class="math inline">\(\alpha\)</span> corresponds to the probability of rejecting <span class="math inline">\(H_0\)</span> when, in fact, <span class="math inline">\(H_0\)</span> is true.</li>
<li><span class="math inline">\(\beta\)</span> corresponds to the probability of failing to reject <span class="math inline">\(H_0\)</span> when, in fact, <span class="math inline">\(H_0\)</span> is false.</li>
</ul>
<p>Ideally, we want <span class="math inline">\(\alpha = 0\)</span> and <span class="math inline">\(\beta = 0\)</span>, meaning that the chance of making an error does not exist. When we have to use incomplete information (sample data), it is not possible to have both <span class="math inline">\(\alpha = 0\)</span> and <span class="math inline">\(\beta = 0\)</span>. We will always have the possibility of at least one error existing when we use sample data.</p>
<p>Usually, what is done is that <span class="math inline">\(\alpha\)</span> is set before the hypothesis test is conducted and then the evidence is judged against that significance level. Common values for <span class="math inline">\(\alpha\)</span> are 0.05, 0.01, and 0.10. If <span class="math inline">\(\alpha = 0.05\)</span>, we are using a testing procedure that, used over and over with different samples, rejects a TRUE null hypothesis five percent of the time.</p>
<p>So if we can set <span class="math inline">\(\alpha\)</span> to be whatever we want, why choose 0.05 instead of 0.01 or even better 0.0000000000000001? Well, a small <span class="math inline">\(\alpha\)</span> means the test procedure requires the evidence against <span class="math inline">\(H_0\)</span> to be <strong>very strong</strong> before we can reject <span class="math inline">\(H_0\)</span>. This means we will almost never reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(\alpha\)</span> is very small. If we almost never reject <span class="math inline">\(H_0\)</span>, the probability of a Type II Error – failing to reject <span class="math inline">\(H_0\)</span> when we should – will <em>increase</em>! Thus, as <span class="math inline">\(\alpha\)</span> decreases, <span class="math inline">\(\beta\)</span> increases and as <span class="math inline">\(\alpha\)</span> increases, <span class="math inline">\(\beta\)</span> decreases. We, therefore, need to strike a balance in <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> and the common values for <span class="math inline">\(\alpha\)</span> of 0.05, 0.01, and 0.10 usually lead to a nice balance.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.2)</strong> Reproduce the table above about errors, but for a hypothesis test, instead of the one provided for a criminal trial.</p>
<div class="learncheck">

</div>
<div id="logic-of-hypothesis-testing" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Logic of hypothesis testing</h3>
<ul>
<li>Take a random sample (or samples) from a population (or multiple populations)</li>
<li>If the sample data are consistent with the null hypothesis, do not reject the null hypothesis.</li>
<li>If the sample data are inconsistent with the null hypothesis (in the direction of the alternative hypothesis), reject the null hypothesis and conclude that there is evidence the alternative hypothesis is true (based on the particular sample collected).</li>
</ul>
<hr />
</div>
</div>
<div id="statistical-significance" class="section level2">
<h2><span class="header-section-number">8.5</span> Statistical significance</h2>
<p>The idea that sample results are more extreme than we would reasonably expect to see by random chance if the null hypothesis were true is the fundamental idea behind statistical hypothesis tests. If data at least as extreme would be very unlikely if the null hypothesis were true, we say the data are <strong>statistically significant</strong>. Statistically significant data provide convincing evidence against the null hypothesis in favor of the alternative, and allow us to generalize our sample results to the claim about the population.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.3)</strong> What is wrong about saying “The defendant is innocent.” based on the US system of criminal trials?</p>
<p><strong>(LC8.4)</strong> What is the purpose of hypothesis testing?</p>
<p><strong>(LC8.5)</strong> What are some flaws with hypothesis testing? How could we alleviate them?</p>
<div class="learncheck">

</div>
<hr />
</div>
<div id="example-revisiting-the-lady-tasting-tea" class="section level2">
<h2><span class="header-section-number">8.6</span> Example: Revisiting the Lady Tasting Tea</h2>
<p>Recall the “There is Only One Test” diagram from earlier:</p>
<div class="figure" style="text-align: center"><span id="fig:htdowney2"></span>
<img src="images/ht.png" alt="Hypothesis Testing Framework" width="\textwidth" />
<p class="caption">
Figure 8.3: Hypothesis Testing Framework
</p>
</div>
<p>We will now walk through how each of the steps to the diagram apply to determining whether the lady tasting tea was actually better than chance at determining whether or not milk was added first. We will see that the process of creating a null distribution is a statistical way to quantifying surprise.</p>
<div id="data" class="section level3">
<h3><span class="header-section-number">8.6.1</span> Data</h3>
<p>Let’s assume as we did in Chapter <a href="7-sim.html#sim">7</a> that the lady is correct in determining whether milk was added first or not in 9 out of 10 trials. Our data, therefore, may look something like</p>
<table>
<tbody>
<tr class="odd">
<td align="left">Correct</td>
</tr>
<tr class="even">
<td align="left">Correct</td>
</tr>
<tr class="odd">
<td align="left">Correct</td>
</tr>
<tr class="even">
<td align="left">Incorrect</td>
</tr>
<tr class="odd">
<td align="left">Correct</td>
</tr>
<tr class="even">
<td align="left">Correct</td>
</tr>
<tr class="odd">
<td align="left">Correct</td>
</tr>
<tr class="even">
<td align="left">Correct</td>
</tr>
<tr class="odd">
<td align="left">Correct</td>
</tr>
<tr class="even">
<td align="left">Correct</td>
</tr>
</tbody>
</table>
</div>
<div id="test-statistic-delta" class="section level3">
<h3><span class="header-section-number">8.6.2</span> Test statistic <span class="math inline">\(\delta\)</span></h3>
<p>We are interested in the number of <code>Correct</code> out of our 10 trials. We can denote this number of successes using the symbol <span class="math inline">\(t\)</span>, where <span class="math inline">\(t\)</span> corresponds to total. This is our test statistic <span class="math inline">\(\delta\)</span> in this case.</p>
</div>
<div id="observed-effect-delta" class="section level3">
<h3><span class="header-section-number">8.6.3</span> Observed effect <span class="math inline">\(\delta^*\)</span></h3>
<p>The actual observed value of the test statistic from our observed sample is <span class="math inline">\(\hat{t}_{obs} = 9\)</span>. Thus, <span class="math inline">\(\delta^* = 9\)</span>.</p>
</div>
<div id="model-of-h_0" class="section level3">
<h3><span class="header-section-number">8.6.4</span> Model of <span class="math inline">\(H_0\)</span></h3>
<p>Our null hypothesis is that the lady is only as good as chance at guessing correctly. Hypotheses always correspond to parameters and are denoted with Greek letters. Thus, symbolically, we have <span class="math inline">\(H_0: \tau = 5\)</span>. Since we are assuming chance and we have 10 flips with 0.5 probability of success of each flip, we have <span class="math inline">\(\tau = 10 \times 0.5 = 5\)</span>.</p>
</div>
<div id="simulated-data" class="section level3">
<h3><span class="header-section-number">8.6.5</span> Simulated data</h3>
<p>We now want to use this null hypothesis to simulate the test statistic assuming that the null hypothesis is true. Therefore, we want to figure out a way to simulate 10 trials, getting either the choice Correct or Incorrect, assuming that the probability of success (getting it Correct) in any given trial is 0.5.</p>
<p><strong>Tactile simulation</strong></p>
<p>When you are presented with a hypothesis testing problem, frequently the most challenging portion is setting up how to simulate the data assuming the null hypothesis is true. To facilitate with this, setting up a tactile, hands on experiment can help.</p>
<p>In this case, flipping a fair coin is a great way to simulate this process. This simulates how the sample could be collected assuming the null hypothesis is true. To simulate 10 trials, we could flip the fair coin and record Heads as Correct and Tails as Incorrect.</p>
<p>Some simulated data using this coin flipping procedure may look like the following. Note that this data frame is not tidy, but is a convenient way to look at the results of the simulation in this wide format. The numbers on the far left correspond to the number of the trial.</p>
<table>
<caption><span id="tab:sample-table">Table 8.1: </span>A table of three sets of 10 coin flips</caption>
<thead>
<tr class="header">
<th></th>
<th align="left">sample1</th>
<th align="left">sample2</th>
<th align="left">sample3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="left">Correct</td>
<td align="left">Correct</td>
<td align="left">Correct</td>
</tr>
<tr class="even">
<td>2</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
<td align="left">Incorrect</td>
</tr>
<tr class="odd">
<td>3</td>
<td align="left">Incorrect</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
</tr>
<tr class="even">
<td>4</td>
<td align="left">Incorrect</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
</tr>
<tr class="odd">
<td>5</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
<td align="left">Incorrect</td>
</tr>
<tr class="even">
<td>6</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
</tr>
<tr class="odd">
<td>7</td>
<td align="left">Incorrect</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
</tr>
<tr class="even">
<td>8</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
</tr>
<tr class="odd">
<td>9</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
</tr>
<tr class="even">
<td>10</td>
<td align="left">Incorrect</td>
<td align="left">Correct</td>
<td align="left">Incorrect</td>
</tr>
</tbody>
</table>
<p>We then use the formula for the <strong>Test Statistic</strong> to determine the simulated test statistic for each of these simulated samples. So in this case we have</p>
<p><span class="math inline">\(t_1 = 4\)</span>, <span class="math inline">\(t_2 = 4\)</span>, <span class="math inline">\(t_3 = 5\)</span></p>
</div>
<div id="distribution-of-delta-under-h_0" class="section level3">
<h3><span class="header-section-number">8.6.6</span> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></h3>
<p>We could continue this process, say, 5000 times by flipping a coin in sets of 10 for 5000 repetitions and counting and taking note of how many heads out of 10 we have for each set. It’s at this point that you surely realize that a computer can do this procedure much faster and more efficient than the tactile experiment with a coin.</p>
<p>Recall that we’ve already created the distribution of 5000 such coin flips and we’ve stored these values in the <code>heads</code> variable in the <code>simGuesses</code> data frame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> simGuesses, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(heads))) +
<span class="st">  </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-182-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
</div>
<div id="the-p-value" class="section level3">
<h3><span class="header-section-number">8.6.7</span> The p-value</h3>
<hr />
<p><strong>Definition: <span class="math inline">\(p\)</span>-value</strong>:</p>
<p>The <strong>p-value</strong> is the probability of observing a sample statistic as extreme or more extreme than what was observed, assuming that the null hypothesis of a by chance operation is true.</p>
<hr />
<p>This definition may be a little intimidating the first time you read it, but it’s important to come back to this “The Lady Tasting Tea” problem whenever you encounter <span class="math inline">\(p\)</span>-values as you begin to learn about the concept. Here the <span class="math inline">\(p\)</span>-value corresponds to how many times in our <strong>null distribution</strong> of <code>heads</code> 9 or more heads occurred.</p>
<p>We can use another neat feature of R to calculate the <span class="math inline">\(p\)</span>-value for this problem. Note that “more extreme” in this case corresponds to looking at values of 9 or greater since our alternative hypothesis invokes a right-tail test corresponding to a “greater than” hypothesis of <span class="math inline">\(H_a: \tau &gt; 5\)</span>. In other words, we are looking to see how likely it is for the lady to pick 9 or more correct instead of 9 or less correct. We’d like to go in the right direction.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pvalue_tea &lt;-<span class="st"> </span>simGuesses %&gt;%
<span class="st">  </span><span class="kw">filter</span>(heads &gt;=<span class="st"> </span><span class="dv">9</span>) %&gt;%
<span class="st">  </span><span class="kw">nrow</span>() /<span class="st"> </span><span class="kw">nrow</span>(simGuesses)</code></pre></div>
<p>Let’s walk through each step of this calculation:</p>
<ol style="list-style-type: decimal">
<li><p>First, <code>pvalue_tea</code> will be the name of our calculated <span class="math inline">\(p\)</span>-value and the assignment operator <code>&lt;-</code> directs us to this naming.</p></li>
<li>We are working with the <code>simGuesses</code> data frame here so that comes immediately before the pipe operator.<br />
</li>
<li><p>We would like to only focus on the rows in our <code>simGuesses</code> data frame that have <code>heads</code> values of 9 or 10. This represents simulated statistics “as extreme or more extreme” than what we observed (9 correct guesses out of 10). To get a glimpse of what we have up to this point, run <code>simGuesses %&gt;% filter(heads &gt;= 9) %&gt;% View()</code>.</p></li>
<li><p>Now that we have changed the focus to only those rows that have number of heads out of 10 flips corresponding to 9 or more, we count how many of those there are. The function <code>nrow</code> gives how many entries are in this filtered data frame and lastly we calculate the proportion that are at least as extreme as our observed value of 9 by dividing by the number of total simulations (5,000).</p></li>
</ol>
<p>We can see that the observed statistic of 9 correct guesses is not a likely outcome assuming the null hypothesis is true. Only around 1% of the outcomes in our 5000 simulations fall at or above 9 successes. We have evidence supporting the conclusion that the person is actually better than just guessing at random at determining whether milk has been added first or not. To better visualize this we can also make use of blue shading on the histogram corresponding to the <span class="math inline">\(p\)</span>-value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> simGuesses, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(heads), <span class="dt">fill =</span> (heads &gt;=<span class="st"> </span><span class="dv">9</span>))) +
<span class="st">  </span><span class="kw">geom_bar</span>() +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;heads&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-184"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-184-1.png" alt="Barplot of heads with p-value highlighted" width="\textwidth" />
<p class="caption">
Figure 8.4: Barplot of heads with p-value highlighted
</p>
</div>
<p>This helps us better see just how few of the values of <code>heads</code> are at our observed value or more extreme. This idea of a <span class="math inline">\(p\)</span>-value can be extended to the more traditional methods using normal and <span class="math inline">\(t\)</span> distributions in the traditional way that introductory statistics has been presented. These traditional methods were used because statisticians haven’t always been able to do 5000 simulations on the computer within seconds. We’ll elaborate on this more in a few sections.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.6)</strong> How could we make Table <a href="8-hypo.html#tab:sample-table">8.1</a> into a tidy data frame?</p>
<p><strong>(LC8.7)</strong> What is meant by “pseudo-random number generation?”</p>
<p><strong>(LC8.8)</strong> How can simulation be used to help us address the question of whether or not an observed result is statistically significant?</p>
<p><strong>(LC8.9)</strong> In Chapter <a href="3-viz.html#viz">3</a>, we noted that barplots should be used when creating a plot of categorical variables. Why are we using barplots to make a plot of a numerical variable <code>heads</code> in this chapter?</p>
<div class="learncheck">

</div>
<hr />
</div>
</div>
<div id="example-comparing-two-means" class="section level2">
<h2><span class="header-section-number">8.7</span> Example: Comparing two means</h2>
<div id="randomizationpermutation" class="section level3">
<h3><span class="header-section-number">8.7.1</span> Randomization/permutation</h3>
<p>We will now focus on building hypotheses looking at the difference between two population means in an example. We will denote population means using the Greek symbol <span class="math inline">\(\mu\)</span> (pronounced “mu”). Thus, we will be looking to see if one group “out-performs” another group. This is quite possibly the most common type of statistical inference and serves as a basis for many other types of analyses when comparing the relationship between two variables.</p>
<p>Our null hypothesis will be of the form <span class="math inline">\(H_0: \mu_1 = \mu_2\)</span>, which can also be written as <span class="math inline">\(H_0: \mu_1 - \mu_2 = 0\)</span>. Our alternative hypothesis will be of the form <span class="math inline">\(H_0: \mu_1 \star \mu_2\)</span> (or <span class="math inline">\(H_a: \mu_1 - \mu_2 \, \star \, 0\)</span>) where <span class="math inline">\(\star\)</span> = <span class="math inline">\(&lt;\)</span>, <span class="math inline">\(\ne\)</span>, or <span class="math inline">\(&gt;\)</span> depending on the context of the problem. You needn’t focus on these new symbols too much at this point. It will just be a shortcut way for us to describe our hypotheses.</p>
<p>As we saw earlier, simulation is a valuable tool when conducting inferences based on one population variable. We will see that the process of <strong>randomization</strong> (also known as <strong>permutation</strong>) will be valuable in conducting tests comparing quantitative values from two groups.</p>
</div>
<div id="comparing-action-and-romance-movies" class="section level3">
<h3><span class="header-section-number">8.7.2</span> Comparing action and romance movies</h3>
<p>The <code>movies</code> dataset in the <code>ggplot2movies</code> package contains information on a large number of movies that have been rated by users of IMDB.com <span class="citation">(Wickham 2015)</span>. We are interested in the question here of whether <code>Action</code> movies are rated higher on IMDB than <code>Romance</code> movies. We will first need to do a little bit of data wrangling using the ideas from Chapter <a href="5-wrangling.html#wrangling">5</a> to get the data in the form that we would like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(movies_trimmed &lt;-<span class="st"> </span>movies %&gt;%<span class="st"> </span><span class="kw">select</span>(title, year, rating, Action, Romance))</code></pre></div>
<pre><code># A tibble: 58,788 x 5
                      title  year rating Action Romance
                      &lt;chr&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;int&gt;   &lt;int&gt;
 1                        $  1971    6.4      0       0
 2        $1000 a Touchdown  1939    6.0      0       0
 3   $21 a Day Once a Month  1941    8.2      0       0
 4                  $40,000  1996    8.2      0       0
 5 $50,000 Climax Show, The  1975    3.4      0       0
 6                    $pent  2000    4.3      0       0
 7                  $windle  2002    5.3      1       0
 8                     &#39;15&#39;  2002    6.7      0       0
 9                      &#39;38  1987    6.6      0       0
10                  &#39;49-&#39;17  1917    6.0      0       0
# ... with 58,778 more rows</code></pre>
<p>Note that <code>Action</code> and <code>Romance</code> are binary variables here. To remove any overlap of movies (and potential confusion) that are both <code>Action</code> and <code>Romance</code>, we will remove them from our <em>population</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">movies_trimmed &lt;-<span class="st"> </span>movies_trimmed %&gt;%
<span class="st">  </span><span class="kw">filter</span>(!(Action ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>Romance ==<span class="st"> </span><span class="dv">1</span>))</code></pre></div>
<p>We will now create a new variable called <code>genre</code> that specifies whether a movie in our <code>movies_trimmed</code> data frame is an <code>&quot;Action&quot;</code> movie, a <code>&quot;Romance&quot;</code> movie, or <code>&quot;Neither&quot;</code>. We aren’t really interested in the <code>&quot;Neither&quot;</code> category here so we will exclude those rows as well. Lastly, the <code>Action</code> and <code>Romance</code> columns are not needed anymore since they are encoded in the <code>genre</code> column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">movies_trimmed &lt;-<span class="st"> </span>movies_trimmed %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">genre =</span> <span class="kw">ifelse</span>(Action ==<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Action&quot;</span>,
                        <span class="kw">ifelse</span>(Romance ==<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Romance&quot;</span>,
                               <span class="st">&quot;Neither&quot;</span>))) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(genre !=<span class="st"> &quot;Neither&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">select</span>(-Action, -Romance)</code></pre></div>
<p>We are left with 8878 movies in our <em>population</em> dataset that focuses on only <code>&quot;Action&quot;</code> and <code>&quot;Romance&quot;</code> movies.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.10)</strong> Why are the different genre variables stored as binary variables (1s and 0s) instead of just listing the <code>genre</code> as a column of values like “Action”, “Comedy”, etc.?</p>
<p><strong>(LC8.11)</strong> What complications could come above with us excluding action romance movies? Should we question the results of our hypothesis test? Explain.</p>
<div class="learncheck">

</div>
<p>Let’s now visualize the distributions of <code>rating</code> across both levels of <code>genre</code>. Think about what type(s) of plot is/are appropriate here before you proceed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> movies_trimmed, <span class="kw">aes</span>(<span class="dt">x =</span> genre, <span class="dt">y =</span> rating)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-190"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-190-1.png" alt="Rating vs genre in the population" width="\textwidth" />
<p class="caption">
Figure 8.5: Rating vs genre in the population
</p>
</div>
<p>We can see that the middle 50% of ratings for <code>&quot;Action&quot;</code> movies is more spread out than that of <code>&quot;Romance&quot;</code> movies in the population. <code>&quot;Romance&quot;</code> has outliers at both the top and bottoms of the scale though. We are initially interested in comparing the mean <code>rating</code> across these two groups so a faceted histogram may also be useful:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> movies_trimmed, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> rating)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;dodgerblue&quot;</span>) +
<span class="st">  </span><span class="kw">facet_grid</span>(genre ~<span class="st"> </span>.)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:movie-hist"></span>
<img src="ismaykim_files/figure-html/movie-hist-1.png" alt="Faceted histogram of genre vs rating" width="\textwidth" />
<p class="caption">
Figure 8.6: Faceted histogram of genre vs rating
</p>
</div>
<p><strong>Important note:</strong> Remember that we hardly ever have access to the population values as we do here. This example and the <code>nycflights13</code> dataset were used to create a common flow from chapter to chapter. In nearly all circumstances, we’ll be needing to use only a sample of the population to try to infer conclusions about the unknown population parameter values. These examples do show a nice relationship between statistics (where data is usually small and more focused on experimental settings) and data science (where data is frequently large and collected without experimental conditions).</p>
</div>
<div id="sampling-rightarrow-randomization" class="section level3">
<h3><span class="header-section-number">8.7.3</span> Sampling <span class="math inline">\(\rightarrow\)</span> randomization</h3>
<p>We can use hypothesis testing to investigate ways to determine, for example, whether a <strong>treatment</strong> has an effect over a <strong>control</strong> and other ways to statistically analyze if one group performs better than, worse than, or different than another. We will also use confidence intervals to determine the size of the effect, if it exists. You’ll see more on this in Chapter <a href="9-ci.html#ci">9</a>.</p>
<p>We are interested here in seeing how we can use a random sample of action movies and a random sample of romance movies from <code>movies</code> to determine if a statistical difference exists in the mean ratings of each group.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.12)</strong> Define the relevant parameters here in terms of the populations of movies.</p>
<div class="learncheck">

</div>
</div>
<div id="data-1" class="section level3">
<h3><span class="header-section-number">8.7.4</span> Data</h3>
<p>Let’s select a random sample of 34 action movies and a random sample of 34 romance movies. (The number 34 was chosen somewhat arbitrarily here.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2017</span>)
movies_genre_sample &lt;-<span class="st"> </span>movies_trimmed %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(genre) %&gt;%
<span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">34</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>()</code></pre></div>
<p><strong>Note</strong> the addition of the <code>ungroup()</code> function here. This will be useful shortly in allowing us to shuffle the values of <code>rating</code> across <code>genre</code>. Our analysis does not work without this <code>ungroup()</code> function since the data stays grouped by the levels of <code>genre</code> without it.</p>
<p>We can now observe the distributions of our two sample ratings for both groups. Remember that these plots should be rough approximations of our population distributions of movie ratings for <code>&quot;Action&quot;</code> and <code>&quot;Romance&quot;</code> in our population of all movies in the <code>movies</code> data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> movies_genre_sample, <span class="kw">aes</span>(<span class="dt">x =</span> genre, <span class="dt">y =</span> rating)) +
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-193"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-193-1.png" alt="Genre vs rating for our sample" width="\textwidth" />
<p class="caption">
Figure 8.7: Genre vs rating for our sample
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> movies_genre_sample, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> rating)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;dodgerblue&quot;</span>) +
<span class="st">  </span><span class="kw">facet_grid</span>(genre ~<span class="st"> </span>.)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-194"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-194-1.png" alt="Genre vs rating for our sample as faceted histogram" width="\textwidth" />
<p class="caption">
Figure 8.8: Genre vs rating for our sample as faceted histogram
</p>
</div>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.13)</strong> What single value could we change to improve the approximation using the sample distribution on the population distribution?</p>
<div class="learncheck">

</div>
<p>Do we have reason to believe, based on the sample distributions of <code>rating</code> over the two groups of <code>genre</code>, that there is a significant difference between the mean <code>rating</code> for action movies compared to romance movies? It’s hard to say just based on the plots. The boxplot does show that the median sample rating is higher for romance movies, but the histogram isn’t as clear. The two groups have somewhat differently shaped distributions but they are both over similar values of <code>rating</code>. It’s often useful to calculate the mean and standard deviation as well, conditioned on the two levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">summary_ratings &lt;-<span class="st"> </span>movies_genre_sample %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(genre) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(rating),
            <span class="dt">std_dev =</span> <span class="kw">sd</span>(rating),
            <span class="dt">n =</span> <span class="kw">n</span>())
summary_ratings %&gt;%<span class="st"> </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">genre</th>
<th align="right">mean</th>
<th align="right">std_dev</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Action</td>
<td align="right">5.112</td>
<td align="right">1.489</td>
<td align="right">34</td>
</tr>
<tr class="even">
<td align="left">Romance</td>
<td align="right">6.062</td>
<td align="right">1.149</td>
<td align="right">34</td>
</tr>
</tbody>
</table>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.14)</strong> Why did we not specify <code>na.rm = TRUE</code> here as we did in Chapter <a href="5-wrangling.html#wrangling">5</a>?</p>
<div class="learncheck">

</div>
<p>We see that the sample mean rating for romance movies, <span class="math inline">\(\bar{x}_{r}\)</span>, is greater than the similar measure for action movies, <span class="math inline">\(\bar{x}_a\)</span>. But is it statistically significantly greater (thus, leading us to conclude that the means are statistically different)? The standard deviation can provide some insight here but with these standard deviations being so similar it’s still hard to say for sure.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.15)</strong> Why might the standard deviation provide some insight about the means being statistically different or not?</p>
<div class="learncheck">

</div>
</div>
<div id="model-of-h_0-1" class="section level3">
<h3><span class="header-section-number">8.7.5</span> Model of <span class="math inline">\(H_0\)</span></h3>
<p>The hypotheses we specified can also be written in another form to better give us an idea of what we will be simulating to create our null distribution.</p>
<ul>
<li><span class="math inline">\(H_0: \mu_r - \mu_a = 0\)</span></li>
<li><span class="math inline">\(H_a: \mu_r - \mu_a \ne 0\)</span></li>
</ul>
</div>
<div id="test-statistic-delta-1" class="section level3">
<h3><span class="header-section-number">8.7.6</span> Test statistic <span class="math inline">\(\delta\)</span></h3>
<p>We are, therefore, interested in seeing whether the difference in the sample means, <span class="math inline">\(\bar{x}_r - \bar{x}_a\)</span>, is statistically different than 0. R has a built-in command that can calculate the difference in these two sample means.</p>
</div>
<div id="observed-effect-delta-1" class="section level3">
<h3><span class="header-section-number">8.7.7</span> Observed effect <span class="math inline">\(\delta^*\)</span></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean_ratings &lt;-<span class="st"> </span>movies_genre_sample %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(genre) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(rating))
obs_diff &lt;-<span class="st"> </span><span class="kw">diff</span>(mean_ratings$mean)</code></pre></div>
<p>We see here that the <code>diff</code> function calculates <span class="math inline">\(\bar{x}_r - \bar{x}_a = 6.0618 - 5.1118 = 0.95\)</span>. We will now proceed similarly to how we conducted the hypothesis test above for the Lady Tasting Tea using simulation. Our goal is figure out a random process with which to simulate the null hypothesis being true. Earlier in this chapter, we used flipping of a fair coin as the random process we were simulating with the null hypothesis being true (<span class="math inline">\(H_0: \tau = 5\)</span>).</p>
</div>
<div id="simulated-data-1" class="section level3">
<h3><span class="header-section-number">8.7.8</span> Simulated data</h3>
<p><strong>Tactile simulation</strong></p>
<p>Here, with us assuming the two population means are equal (<span class="math inline">\(H_0: \mu_r - \mu_a = 0\)</span>), we can look at this from a tactile point of view by using index cards. There are <span class="math inline">\(n_r = 34\)</span> data elements corresponding to romance movies and <span class="math inline">\(n_a = 34\)</span> for action movies. We can write the 34 ratings from our sample for romance movies on one set of 34 index cards and the 34 ratings for action movies on another set of 34 index cards. (Note that the sample sizes need not be the same.)</p>
<p>The next step is to put the two stacks of index cards together, creating a new set of 68 cards. If we assume that the two population means are equal, we are saying that there is no association between ratings and genre (romance vs action). We can use the index cards to create two <strong>new</strong> stacks for romance and action movies. First, we must shuffle all the cards thoroughly. After doing so, in this case with equal values of sample sizes, we split the deck in half.</p>
<p>We then calculate the new sample mean rating of the romance deck, and also the new sample mean rating of the action deck. This creates one simulation of the samples that were collected originally. We next want to calculate a statistic from these two samples. Instead of actually doing the calculation using index cards, we can use R as we have before to simulate this process.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">shuffled_ratings &lt;-<span class="st"> </span><span class="co">#movies_trimmed %&gt;%</span>
<span class="st">  </span>movies_genre_sample %&gt;%<span class="st"> </span>
<span class="st">     </span><span class="kw">mutate</span>(<span class="dt">genre =</span> <span class="kw">shuffle</span>(genre)) %&gt;%<span class="st"> </span>
<span class="st">     </span><span class="kw">group_by</span>(genre) %&gt;%
<span class="st">     </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(rating))
<span class="kw">diff</span>(shuffled_ratings$mean)</code></pre></div>
<pre><code>[1] -0.1324</code></pre>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.16)</strong> How would the tactile shuffling of index cards change if we had different samples of say 20 action movies and 60 romance movies? Describe each step that would change.</p>
<p><strong>(LC8.17)</strong> Why are we taking the difference in the means of the cards in the new shuffled decks?</p>
<div class="learncheck">

</div>
</div>
<div id="distribution-of-delta-under-h_0-1" class="section level3">
<h3><span class="header-section-number">8.7.9</span> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></h3>
<p>The only new command here is <code>shuffle</code> from the <code>mosaic</code> package, which does what we would expect it to do. It simulates a shuffling of the ratings between the two levels of <code>genre</code> just as we could have done with index cards. We can now proceed in a similar way to what we have done previously with the Lady Tasting Tea example by repeating this process many times to create a <em>null distribution</em> of simulated differences in sample means.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2017</span>)
many_shuffles &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">5000</span>) *<span class="st"> </span>
<span class="st">  </span>(movies_genre_sample %&gt;%<span class="st"> </span>
<span class="st">     </span><span class="kw">mutate</span>(<span class="dt">genre =</span> <span class="kw">shuffle</span>(genre)) %&gt;%<span class="st"> </span>
<span class="st">     </span><span class="kw">group_by</span>(genre) %&gt;%
<span class="st">     </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(rating))
   )</code></pre></div>
<p>It is a good idea here to <code>View</code> the <code>many_shuffles</code> data frame via <code>View(many_shuffles)</code>. We need to figure out a way to subtract the first value of <code>mean</code> from the second value of <code>mean</code> for each of the 5000 simulations. This is a little tricky but the <code>group_by</code> function comes to our rescue here:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rand_distn &lt;-<span class="st"> </span>many_shuffles %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(.index) %&gt;%
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">diffmean =</span> <span class="kw">diff</span>(mean))
<span class="kw">head</span>(rand_distn, <span class="dv">10</span>)</code></pre></div>
<pre><code># A tibble: 10 x 2
   .index  diffmean
    &lt;dbl&gt;     &lt;dbl&gt;
 1      1 -0.132353
 2      2 -0.197059
 3      3 -0.026471
 4      4  0.714706
 5      5 -0.473529
 6      6 -0.120588
 7      7 -0.173529
 8      8 -0.208824
 9      9 -0.008824
10     10 -0.332353</code></pre>
<p>We can now plot the distribution of these simulated differences in means:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rand_distn, <span class="kw">aes</span>(<span class="dt">x =</span> diffmean)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-205"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-205-1.png" alt="Simulated differences in means histogram" width="\textwidth" />
<p class="caption">
Figure 8.9: Simulated differences in means histogram
</p>
</div>
</div>
<div id="the-p-value-1" class="section level3">
<h3><span class="header-section-number">8.7.10</span> The p-value</h3>
<p>Remember that we are interested in seeing where our observed sample mean difference of 0.95 falls on this null/randomization distribution. We are interested in simply a difference here so “more extreme” corresponds to values in both tails on the distribution. Let’s shade our null distribution to show a visual representation of our <span class="math inline">\(p\)</span>-value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rand_distn, <span class="kw">aes</span>(<span class="dt">x =</span> diffmean, <span class="dt">fill =</span> (<span class="kw">abs</span>(diffmean) &gt;=<span class="st"> </span>obs_diff))) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-206"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-206-1.png" alt="Shaded histogram to show p-value" width="\textwidth" />
<p class="caption">
Figure 8.10: Shaded histogram to show p-value
</p>
</div>
<p>Remember that the observed difference in means was 0.95. We have shaded green all values at or above that value and also shaded green those values at or below its negative value (since this is a two-tailed test). We can add a vertical line to represent both the observed difference and its negative instead. To better estimate how large the <span class="math inline">\(p\)</span>-value will be, we also increase the number of bins to 100 here from 20:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rand_distn, <span class="kw">aes</span>(<span class="dt">x =</span> diffmean)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">100</span>) +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> obs_diff, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> -obs_diff, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-207"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-207-1.png" alt="Histogram with vertical lines corresponding to observed statistic" width="\textwidth" />
<p class="caption">
Figure 8.11: Histogram with vertical lines corresponding to observed statistic
</p>
</div>
<p>At this point, it is important to take a guess as to what the <span class="math inline">\(p\)</span>-value may be. We can see that there are only a few shuffled differences as extreme or more extreme than our observed effect (in both directions). Maybe we guess that this <span class="math inline">\(p\)</span>-value is somewhere around 2%, or maybe 3%, but certainly not 30% or more. **You’ll find yourself getting very strange results if you’ve messed up the signs in your calculation of the <span class="math inline">\(p\)</span>-value so you should always check first that you have a range of reasonable values after looking at the histogram for the <span class="math inline">\(p\)</span>-value. Lastly, we calculate the <span class="math inline">\(p\)</span>-value directly using <code>dplyr</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(pvalue_movies &lt;-<span class="st"> </span>rand_distn %&gt;%
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">abs</span>(diffmean) &gt;=<span class="st"> </span>obs_diff) %&gt;%
<span class="st">  </span><span class="kw">nrow</span>() /<span class="st"> </span><span class="kw">nrow</span>(rand_distn))</code></pre></div>
<pre><code>[1] 0.0042</code></pre>
<p>We have around 0.42% of values as extreme or more extreme than our observed effect in both directions. Assuming we are using a 5% significance level for <span class="math inline">\(\alpha\)</span>, we have evidence supporting the conclusion that the mean rating for romance movies is different from that of action movies. The next important idea is to better understand just how much higher of a mean rating can we expect the romance movies to have compared to that of action movies. This can be addressed by creating a 95% confidence interval as we will explore in Chapter <a href="9-ci.html#ci">9</a>.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.18)</strong> Conduct the same analysis comparing action movies versus romantic movies using the median rating instead of the mean rating? Make sure to use the <code>%&gt;%</code> as much as possible. What was different and what was the same?</p>
<p><strong>(LC8.19)</strong> What conclusions can you make from viewing the faceted histogram looking at <code>rating</code> versus <code>genre</code> that you couldn’t see when looking at the boxplot?</p>
<p><strong>(LC8.20)</strong> Describe in a paragraph how we used Allen Downey’s diagram to conclude if a statistical difference existed between mean movie ratings for action and romance movies.</p>
<p><strong>(LC8.21)</strong> Why are we relatively confident that the distributions of the sample ratings will be good approximations of the population distributions of ratings for the two genres?</p>
<p><strong>(LC8.22)</strong> Using the definition of “<span class="math inline">\(p\)</span>-value”, write in words what the <span class="math inline">\(p\)</span>-value represents for the hypothesis test above comparing the mean rating of romance to action movies.</p>
<p><strong>(LC8.23)</strong> What is the value of the <span class="math inline">\(p\)</span>-value for the hypothesis test comparing the mean rating of romance to action movies?</p>
<p><strong>(LC8.24)</strong> Do the results of the hypothesis test match up with the original plots we made looking at the population of movies? Why or why not?</p>
<div class="learncheck">

</div>
</div>
<div id="summary-5" class="section level3">
<h3><span class="header-section-number">8.7.11</span> Summary</h3>
<p>To review, these are the steps one would take whenever you’d like to do a hypothesis test comparing values from the distributions of two groups:</p>
<ul>
<li><p>Simulate many samples using a random process that matches the way the original data were collected and that <em>assumes the null hypothesis is true</em>.</p></li>
<li><p>Collect the values of a sample statistic for each sample created using this random process to build a <em>randomization distribution</em>.</p></li>
<li><p>Assess the significance of the <em>original</em> sample by determining where its sample statistic lies in the randomization distribution.</p></li>
<li><p>If the proportion of values as extreme or more extreme than the observed statistic in the randomization distribution is smaller than the pre-determined significance level <span class="math inline">\(\alpha\)</span>, we reject <span class="math inline">\(H_0\)</span>. Otherwise, we fail to reject <span class="math inline">\(H_0\)</span>. (If no significance level is given, one can assume <span class="math inline">\(\alpha = 0.05\)</span>.)</p></li>
</ul>
<hr />
</div>
</div>
<div id="theory-hypo" class="section level2">
<h2><span class="header-section-number">8.8</span> Building theory-based methods using computation</h2>
<p>As a point of reference, we will now discuss the traditional theory-based way to conduct the hypothesis test for determining if there is a statistically significant difference in the sample mean rating of Action movies versus Romance movies. This method and ones like it work very well when the assumptions are met in order to run the test. They are based on probability models and distributions such as the normal and <span class="math inline">\(t\)</span>-distributions.</p>
<p>These traditional methods have been used for many decades back to the time when researchers didn’t have access to computers that could run 5000 simulations in under a minute. They had to base their methods on probability theory instead. Many fields and researchers continue to use these methods and that is the biggest reason for their inclusion here. It’s important to remember that a <span class="math inline">\(t\)</span>-test or a <span class="math inline">\(z\)</span>-test is really just an approximation of what you have seen in this chapter already using simulation and randomization. The focus here is on understanding how the shape of the <span class="math inline">\(t\)</span>-curve comes about without digging big into the mathematical underpinnings.</p>
<div id="example-t-test-for-two-independent-samples" class="section level3">
<h3><span class="header-section-number">8.8.1</span> Example: <span class="math inline">\(t\)</span>-test for two independent samples</h3>
<p>What is commonly done in statistics is the process of normalization. What this entails is calculating the mean and standard deviation of a variable. Then you subtract the mean from each value of your variable and divide by the standard deviation. The most common normalization is known as the <span class="math inline">\(z\)</span>-score. The formula for a <span class="math inline">\(z\)</span>-score is <span class="math display">\[Z = \frac{x - \mu}{\sigma},\]</span> where <span class="math inline">\(x\)</span> represent the value of a variable, <span class="math inline">\(\mu\)</span> represents the mean of the variable, and <span class="math inline">\(\sigma\)</span> represents the standard deviation of the variable. Thus, if your variable has 10 elements, each one has a corresponding <span class="math inline">\(z\)</span>-score that gives how many standard deviations away that value is from its mean. <span class="math inline">\(z\)</span>-scores are normally distributed with mean 0 and standard deviation 1. They have the common, bell-shaped pattern seen below.</p>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-210-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>Recall, that we hardly ever know the mean and standard deviation of the population of interest. This is almost always the case when considering the means of two independent groups. To help account for us not knowing the population parameter values, we can use the sample statistics instead, but this comes with a bit of a price in terms of complexity.</p>
<p>Another form of normalization occurs when we need to use the sample standard deviations as estimates for the unknown population standard deviations. This normalization is often called the <span class="math inline">\(t\)</span>-score. For the two independent samples case like what we have for comparing action movies to romance movies, the formula is <span class="math display">\[T =\dfrac{ (\bar{x}_1 - \bar{x}_2) - (\mu_1 - \mu_2)}{ \sqrt{\dfrac{{s_1}^2}{n_1} + \dfrac{{s_2}^2}{n_2}}  }\]</span></p>
<p>There is a lot to try to unpack here.</p>
<ul>
<li><span class="math inline">\(\bar{x}_1\)</span> is the sample mean response of the first group</li>
<li><span class="math inline">\(\bar{x}_2\)</span> is the sample mean response of the second group</li>
<li><span class="math inline">\(\mu_1\)</span> is the population mean response of the first group</li>
<li><span class="math inline">\(\mu_2\)</span> is the population mean response of the second group</li>
<li><span class="math inline">\(s_1\)</span> is the sample standard deviation of the response of the first group</li>
<li><span class="math inline">\(s_2\)</span> is the sample standard deviation of the response of the second group</li>
<li><span class="math inline">\(n_1\)</span> is the sample size of the first group</li>
<li><span class="math inline">\(n_2\)</span> is the sample size of the second group</li>
</ul>
<p>Assuming that the null hypothesis is true (<span class="math inline">\(H_0: \mu_1 - \mu_2 = 0\)</span>), <span class="math inline">\(T\)</span> is said to be distributed following a <span class="math inline">\(t\)</span> distribution with degrees of freedom equal to the smaller value of <span class="math inline">\(n_1 - 1\)</span> and <span class="math inline">\(n_2 - 1\)</span>. The “degrees of freedom” can be thought of measuring how different the <span class="math inline">\(t\)</span> distribution will be as compared to a normal distribution. Small sample sizes lead to small degrees of freedom and, thus, <span class="math inline">\(t\)</span> distributions that have more values in the tails of their distributions. Large sample sizes lead to large degrees of freedom and, thus, <span class="math inline">\(t\)</span> distributions that closely align with the standard normal, bell-shaped curve.</p>
<p>So, assuming <span class="math inline">\(H_0\)</span> is true, our formula simplifies a bit:</p>
<p><span class="math display">\[T =\dfrac{ \bar{x}_1 - \bar{x}_2}{ \sqrt{\dfrac{{s_1}^2}{n_1} + \dfrac{{s_2}^2}{n_2}}  }.\]</span></p>
<p>We have already built an approximation for what we think the distribution of <span class="math inline">\(\delta = \bar{x}_1 - \bar{x}_2\)</span> looks like using randomization above. Recall this distribution:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rand_distn, <span class="kw">aes</span>(<span class="dt">x =</span> diffmean)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-211"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-211-1.png" alt="Simulated differences in means histogram" width="\textwidth" />
<p class="caption">
Figure 8.12: Simulated differences in means histogram
</p>
</div>
<p>If we’d like to have a guess as to what the distribution of <span class="math inline">\(T\)</span> might look like instead, we need only to divide every value in <code>rand_distn</code> by <span class="math display">\[\sqrt{\dfrac{{s_1}^2}{n_1} + \dfrac{{s_2}^2}{n_2}}.\]</span> As we did before, we will assign Romance to be group 1 and Action to be group 2. (This was done since Romance comes second alphabetically and the reason why we have a number mismatch below with 1 and 2.) Remember that we’ve already calculated these values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(summary_ratings)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">genre</th>
<th align="right">mean</th>
<th align="right">std_dev</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Action</td>
<td align="right">5.112</td>
<td align="right">1.489</td>
<td align="right">34</td>
</tr>
<tr class="even">
<td align="left">Romance</td>
<td align="right">6.062</td>
<td align="right">1.149</td>
<td align="right">34</td>
</tr>
</tbody>
</table>
<p>We will create some shortcuts here so you can see the value being calculated for the denominator of <span class="math inline">\(T\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s1 &lt;-<span class="st"> </span>summary_ratings$std_dev[<span class="dv">2</span>]
s2 &lt;-<span class="st"> </span>summary_ratings$std_dev[<span class="dv">1</span>]
n1 &lt;-<span class="st"> </span>summary_ratings$n[<span class="dv">2</span>]
n2 &lt;-<span class="st"> </span>summary_ratings$n[<span class="dv">1</span>]</code></pre></div>
<p>Here, we have <span class="math inline">\(s_1 = 1.1494\)</span>, <span class="math inline">\(s_2 = 1.4887\)</span>, <span class="math inline">\(n_1 = 34\)</span>, and <span class="math inline">\(n_2 = 34\)</span>.</p>
<p>We can calculate the denominator via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(denom_T &lt;-<span class="st"> </span><span class="kw">sqrt</span>( (s1^<span class="dv">2</span> /<span class="st"> </span>n1) +<span class="st"> </span>(s2^<span class="dv">2</span> /<span class="st"> </span>n2) ))</code></pre></div>
<pre><code>[1] 0.3226</code></pre>
<p>Now if we divide all of the values of <code>diffmean</code> in <code>rand_distn</code> by <code>denom_T</code> we can have a simulated distribution of <span class="math inline">\(T\)</span> test statistics instead:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rand_distn &lt;-<span class="st"> </span>rand_distn %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">t_stat =</span> diffmean /<span class="st"> </span>denom_T)
<span class="kw">ggplot</span>(<span class="dt">data =</span> rand_distn, <span class="kw">aes</span>(<span class="dt">x =</span> t_stat)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-215"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-215-1.png" alt="Simulated T statistics histogram" width="\textwidth" />
<p class="caption">
Figure 8.13: Simulated T statistics histogram
</p>
</div>
<p>We see that the shape of this distribution is the same as that of <code>diffmean</code>. The scale has changed though with <code>t_stat</code> having less spread than <code>diffmean</code>.</p>
<p>A traditional <span class="math inline">\(t\)</span>-test doesn’t look at this simulated distribution, but instead it looks at the <span class="math inline">\(t\)</span>-curve with degrees of freedom equal to 33 (the minimum of <span class="math inline">\(n_1 = 34 - 1 = 33\)</span> and <span class="math inline">\(n_2 = 34 - 1 = 33\)</span>). This curve is frequently called a <em>density</em> curve and this is the reason why we specify the use of <code>y = ..density..</code> here in the <code>geom_histogram</code>. We now overlay what this <span class="math inline">\(t\)</span>-curve looks like on top of the histogram showing the simulated <span class="math inline">\(T\)</span> statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rand_distn, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> t_stat)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">binwidth =</span> <span class="fl">0.3</span>) +
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dt,
    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">df =</span> <span class="kw">min</span>(n1 -<span class="st"> </span><span class="dv">1</span>, n2 -<span class="st"> </span><span class="dv">1</span>)),
    <span class="dt">color =</span> <span class="st">&quot;royalblue&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-216-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>We can see that the curve does a good job of approximating the randomization distribution here. (More on when to expect for this to be the case when we discuss conditions for the <span class="math inline">\(t\)</span>-test in a bit.) To calculate the <span class="math inline">\(p\)</span>-value in this case, we need to figure out how much of the total area under the <span class="math inline">\(t\)</span>-curve is at our observed <span class="math inline">\(T\)</span>-statistic or more, plus also adding the area under the curve at the negative value of the observed <span class="math inline">\(T\)</span>-statistic or below. (Remember this is a two-tailed test so we are looking for a difference–values in the tails of either direction.) Just as we converted all of the simulated values to <span class="math inline">\(T\)</span>-statistics, we must also do so for our observed effect <span class="math inline">\(\delta^*\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(t_obs &lt;-<span class="st"> </span>obs_diff /<span class="st"> </span>denom_T)</code></pre></div>
<pre><code>[1] 2.945</code></pre>
<p>So graphically we are interested in finding the percentage of values that are at or above 2.9452 or at or below -2.9452.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rand_distn, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> t_stat)) +
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dt,
    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">df =</span> <span class="kw">min</span>(n1 -<span class="st"> </span><span class="dv">1</span>, n2 -<span class="st"> </span><span class="dv">1</span>)),
    <span class="dt">color =</span> <span class="st">&quot;royalblue&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> t_obs, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> -t_obs, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-218-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>At this point, you should make a guess as to what a reasonable value may be for the <span class="math inline">\(p\)</span>-value. Let’s say the <span class="math inline">\(p\)</span>-value is 0.01 or so. To actually perform this calculation by hand, you’d need to do some calculus. Let’s have R do it for us instead using the <code>pt</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pt</span>(t_obs, <span class="dt">df =</span> <span class="kw">min</span>(n1 -<span class="st"> </span><span class="dv">1</span>, n2 -<span class="st"> </span><span class="dv">1</span>), <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>) +
<span class="st">  </span><span class="kw">pt</span>(-t_obs, <span class="dt">df =</span> <span class="kw">min</span>(n1 -<span class="st"> </span><span class="dv">1</span>, n2 -<span class="st"> </span><span class="dv">1</span>), <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] 0.005876</code></pre>
</div>
<div id="conditions-for-t-test" class="section level3">
<h3><span class="header-section-number">8.8.2</span> Conditions for t-test</h3>
<p>In order for the results of the <span class="math inline">\(t\)</span>-test to be valid, three conditions must be met:</p>
<ol style="list-style-type: decimal">
<li>Independent observations in both samples</li>
<li>Nearly normal populations OR large sample sizes (<span class="math inline">\(n \ge 30\)</span>)</li>
<li>Independently selected samples</li>
</ol>
<p>Condition 1: This is met since we sampled at random using R from our population.</p>
<p>Condition 2: Recall from Figure <a href="8-hypo.html#fig:movie-hist">8.6</a>, that we know how the populations are distributed. Both of them are close to normally distributed. If we are a little concerned about this assumption, we also do have samples of size larger than 30 (<span class="math inline">\(n_1 = n_2 = 34\)</span>).</p>
<p>Condition 3: This is met since there is no natural pairing of a movie in the Action group to a movie in the Romance group.</p>
<p>Since all three conditions are met, we can be reasonably certain that the theory-based test will match the results of the randomization-based test using shuffling. Remember that theory-based tests can produce some incorrect results in these assumptions are not carefully checked. The only assumption for randomization and computational-based methods is that the sample is selected at random. They are our preference and we strongly believe they should be yours as well, but it’s important to also see how the theory-based tests can be done and used as an approximation for the computational techniques until at least more researchers are using these techniques that utilize the power of computers.</p>
<hr />
</div>
</div>
<div id="resampling-based-inference-for-regression" class="section level2">
<h2><span class="header-section-number">8.9</span> Resampling-based inference for regression</h2>
<p>We can also use the concept of shuffling to determine the standard error of our null distribution and conduct a hypothesis test for a population slope. Let’s go back to our example on Alaskan flights that represent a sample of all Alaskan flights departing NYC in 2013 from Section <a href="6-regression.html#regdata">6.1</a>. Let’s test to see if we have evidence that a <em>positive</em> relationship exists between the departure delay and arrival delay for Alaskan flights. We will set up this hypothesis testing process as we have each before via the “There is Only One Test” diagram in Figure <a href="8-hypo.html#fig:htdowney">8.1</a>.</p>
<div id="data-2" class="section level3">
<h3><span class="header-section-number">8.9.1</span> Data</h3>
<p>Our data is stored in <code>alaska_flights</code> and we are focused on the 50 measurements of <code>dep_delay</code> and <code>arr_delay</code> there.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># To ensure the random sample of 50 flights is the same for</span>
<span class="co"># anyone using this code</span>
<span class="kw">set.seed</span>(<span class="dv">2017</span>)

<span class="co"># Load Alaska data, deleting rows that have missing departure delay</span>
<span class="co"># or arrival delay data</span>
alaska_flights &lt;-<span class="st"> </span>flights %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(carrier ==<span class="st"> &quot;AS&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(dep_delay) &amp;<span class="st"> </span>!<span class="kw">is.na</span>(arr_delay)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="co"># Select 50 flights that don&#39;t have missing delay data</span>
<span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">50</span>)</code></pre></div>
</div>
<div id="test-statistic-delta-2" class="section level3">
<h3><span class="header-section-number">8.9.2</span> Test statistic <span class="math inline">\(\delta\)</span></h3>
<p>Our test statistic here is the sample slope coefficient that we denote with <span class="math inline">\(b_1\)</span>.</p>
</div>
<div id="observed-effect-delta-2" class="section level3">
<h3><span class="header-section-number">8.9.3</span> Observed effect <span class="math inline">\(\delta^*\)</span></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(b1_obs &lt;-<span class="st"> </span><span class="kw">tidy</span>(delay_fit)$estimate[<span class="dv">2</span>])</code></pre></div>
<pre><code>[1] 1.218</code></pre>
<p>The calculated slope value from our observed sample is <span class="math inline">\(b_1 = 1.2177\)</span>.</p>
</div>
<div id="model-of-h_0-2" class="section level3">
<h3><span class="header-section-number">8.9.4</span> Model of <span class="math inline">\(H_0\)</span></h3>
<p>We are looking to see if a positive relationship exists so <span class="math inline">\(H_a: \beta_1 &gt; 0\)</span>. Our null hypothesis is always in terms of equality so we have <span class="math inline">\(H_0: \beta_1 = 0\)</span>.</p>
</div>
<div id="simulated-data-2" class="section level3">
<h3><span class="header-section-number">8.9.5</span> Simulated data</h3>
<p>Now to simulate the null hypothesis being true and recreating how our sample was created, we need to think about what it means for <span class="math inline">\(\beta_1\)</span> to be zero. If <span class="math inline">\(\beta_1 = 0\)</span>, we said above that there is no relationship between the departure delay and arrival delay. If there is no relationship, then any one of the arrival delay values could have just as likely occurred with any of the other departure delay values instead of the one that it actually did fall with. We, therefore, have another example of shuffling in our simulating of data.</p>
<p><strong>Tactile simulation</strong></p>
<p>We could use a deck of 100 note cards to create a tactile simulation of this shuffling process. We would write the 50 different values of departure delays on each of the 50 cards, one per card. We would then do the same thing for the 50 arrival delays putting them on one per card.</p>
<p>Next, we would lay out each of the 50 departure delay cards and we would shuffle the arrival delay deck. Then, after shuffling the deck well, we would disperse the cards one per each one of the departure delay cards. We would then enter these new values in for arrival delay and compute a sample slope based on this shuffling. We could repeat this process many times, keeping track of our sample slope after each shuffle.</p>
</div>
<div id="distribution-of-delta-under-h_0-2" class="section level3">
<h3><span class="header-section-number">8.9.6</span> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></h3>
<p>We can build our randomization distribution in much the same way we did before using the <code>do</code> and <code>shuffle</code> functions. Here we will take advantage of the <code>coef</code> function we saw earlier to extract the slope and intercept coefficients. (Our focus will be on the slope here though.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rand_slope_distn &lt;-<span class="st"> </span><span class="kw">do</span>(<span class="dv">5000</span>) *
<span class="st">  </span>(<span class="kw">lm</span>(<span class="dt">formula =</span> arr_delay ~<span class="st"> </span><span class="kw">shuffle</span>(dep_delay), <span class="dt">data =</span> alaska_flights) %&gt;%
<span class="st">     </span><span class="kw">coef</span>())</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(rand_slope_distn)</code></pre></div>
<pre><code>[1] &quot;Intercept&quot; &quot;dep_delay&quot;</code></pre>
<p>We see that the names of our columns are <code>Intercept</code> and <code>dep_delay</code>. We want to look at <code>dep_delay</code> since that corresponds to the slope coefficients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rand_slope_distn, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> dep_delay)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-224-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
</div>
<div id="the-p-value-2" class="section level3">
<h3><span class="header-section-number">8.9.7</span> The p-value</h3>
<p>Recall that we want to see where our observed sample slope <span class="math inline">\(\delta^* = 1.2177\)</span> falls on this distribution and then count all of the values to the right of it corresponding to <span class="math inline">\(H_a: \beta_0 &gt; 0\)</span>. To get a sense for where our values falls, we can shade all values at least as big as <span class="math inline">\(\delta^*\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> rand_slope_distn, <span class="kw">aes</span>(<span class="dt">x =</span> dep_delay, <span class="dt">fill =</span> (dep_delay &gt;=<span class="st"> </span>b1_obs))) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-225"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-225-1.png" alt="Shaded histogram to show p-value" width="\textwidth" />
<p class="caption">
Figure 8.14: Shaded histogram to show p-value
</p>
</div>
<p>Since 1.2177 falls far to the right of this plot, we can say that we have a <span class="math inline">\(p\)</span>-value of 0. We, thus, have evidence to reject the null hypothesis in support of there being a positive association between the departure delay and arrival delay of all Alaskan flights from NYC in 2013.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.25)</strong> Repeat the inference above but this time for the correlation coefficient instead of the slope.</p>
<!--
Omitted but potentially could be shifted to an example in the confidence interval chapter
**`paste0("(LC", chap, ".", (lc <- lc + 1), ")")`** Use bootstrapping (of points) to determine a range of possible values for the population slope comparing departure delays to arrival delays for Alaskan flights in 2013 from NYC.

-->
<div class="learncheck">

</div>
<hr />
</div>
</div>
<div id="theoryreg" class="section level2">
<h2><span class="header-section-number">8.10</span> Theory-based inference for regression</h2>
<p>Recall the regression output table from Section <a href="6-regression.html#regeq">6.4</a> with <code>delay_fit</code> being a least squares linear regression fit with <code>arr_delay</code> as the response and <code>dep_delay</code> as the predictor in the <code>alaska_flights</code> data frame created in Section <a href="6-regression.html#regdata">6.1</a>.</p>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-14.155</td>
<td align="right">2.809</td>
<td align="right">-5.038</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">dep_delay</td>
<td align="right">1.218</td>
<td align="right">0.136</td>
<td align="right">8.951</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<!--
We saw in Chapter \@ref(ci) when trying to estimate the true population mean $\mu$, the sample mean $\overline{x}$ will vary from sample to sample due to sampling variability.  We characterized this variability using the sampling distribution of $\overline{x}$, whose standard deviation is called the standard error. In other words, the standard error quantifies how much $\overline{x}$ varies from sample to sample and can be thought of as a measure of how precise our estimates are.
-->
<!--
All these notions apply in our regression example as well, as -->
<p>We saw in Section <a href="7-sim.html#vizsamp">7.2</a> that random samples have variability and, thus, statistics from those samples have variability as defined by the <strong>sampling distribution</strong>.<br />
Recall from Section <a href="6-regression.html#regdata">6.1</a> that <code>alaska_flights</code> represents only a random sample of 50 Alaska Airlines flights and not all flights. Hence if we repeated the analysis but with another random sample of 50 flights, the fitted line would likely change slightly due to sampling variability. In this case, there is a true population least squares line is defined by the formula <span class="math inline">\(y = \beta_0 + \beta_1 x + \epsilon\)</span> where</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span> is the true population intercept parameter</li>
<li><span class="math inline">\(\beta_1\)</span> is the true population slope parameter</li>
<li><span class="math inline">\(\epsilon\)</span> represents the error term</li>
</ul>
<p><span class="math inline">\(\epsilon\)</span> corresponds to the part of the response variable <span class="math inline">\(y\)</span> that remains unexplained after considering the predictor variable <span class="math inline">\(x\)</span>. We will see in Section <a href="8-hypo.html#resid">8.10.2</a> that ideally they should exhibit no systematic pattern in that they are normally distributed, have mean 0, and constant variance.</p>
<p>The values <span class="math inline">\(b_0 = -14.155\)</span> and <span class="math inline">\(b_1 = 1.218\)</span> are point estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, and thus the second column of the regression output table that has their values is called <code>estimate</code>. The third column <code>std.error</code> represents the standard errors for each estimate using a theory-based approach.</p>
<p>The rows of the fourth and fifth columns correspond to theory-based hypothesis tests testing <span class="math inline">\(H_0: \beta_0 = 0 \mbox{ vs. } H_1: \beta_0 \neq 0\)</span> and <span class="math inline">\(H_0: \beta_1 = 0 \mbox{ vs. } H_1: \beta_1 \neq 0\)</span>. Of particular interest is the second hypothesis test because if <span class="math inline">\(\beta_1 = 0\)</span> then <span class="math inline">\(y = \beta_0 + \epsilon\)</span>. Hence the value of <span class="math inline">\(y\)</span> does not depend on the value of <span class="math inline">\(x\)</span> at all, in other words there is no relationship between them. Recall that any hypothesis test involves 1) an observed test statistic and 2) a <span class="math inline">\(p\)</span>-value resulting from the comparison of the observed test statistic to a null distribution. The columns “statistic” and “p.value” correspond to these values.</p>
<p>In our example, since the <span class="math inline">\(p\)</span>-value corresponding to the hypothesis test <span class="math inline">\(H_0: \beta_1 = 0 \mbox{ vs. } H_1: \beta_1 \neq 0\)</span> is 0, for any value of <span class="math inline">\(\alpha\)</span> we would reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> and declare that there is a significant relationship between arrival delay and departure delay.</p>
<!--
**Confidence Intervals**: Similarly, the rows of the "conf.low" and "conf.high" columns correspond to the left and right end points of 95% confidence intervals for $\beta_0$ and $\beta_1$. Similarly to the case of a 95% confidence interval for the population mean $\mu \pm 2 * SE$, the 95% confidence intervals for $\beta_0$ and $\beta$ can be computed as $\mbox{estimate} \pm 2*SE$  Once again, focusing on the confidence interval (0.944, 1.491) for the slope coefficient $\beta_1$, we observe that it does not contain 0, suggesting again that departure delay and arrival delays have a significant relationship.

However, for the conclusions of the hypothesis tests and confidence intervals to be valid, there are certain conditions that must be met, in particular relating to the behavior of the residuals. We will address these assumptions in the upcoming Section \@ref(conditions-for-regression).

-->
<p>For the conclusions of the hypothesis tests for regression to be valid, there are certain conditions that must be met, in particular relating to the behavior of the residuals. We will address these assumptions in the upcoming Subsection <a href="8-hypo.html#conditions-for-regression">8.10.1</a>.</p>
<div id="conditions-for-regression" class="section level3">
<h3><span class="header-section-number">8.10.1</span> Conditions for regression</h3>
<p>In order for all inferences from regression to be valid (in particular the hypothesis tests from Subsection <a href="8-hypo.html#theoryreg">8.10</a>, certain conditions must roughly hold.</p>
<ol style="list-style-type: decimal">
<li>Nearly normal residuals with mean 0 and constant variance. (Check quantile-quantile plot of standardized residuals.)</li>
<li>Equal variances across explanatory variable. (Check residual plot for non-uniform patterns.)</li>
<li>Independent observations. (Check residual plot for no time series-like patterns.)</li>
</ol>
<p>As you can see the <em>residuals</em> will play a large role in determining whether the conditions are met. In particular, the first two conditions can be roughly interpreted as requiring that there being no systematic pattern to the residuals. The residuals <span class="math inline">\(\widehat{\epsilon}_i\)</span> are estimates for the error term <span class="math inline">\(\epsilon\)</span> we discussed with the true population regression line, and this is a big reason why they play an important role in validating regression assumptions.</p>
</div>
<div id="resid" class="section level3">
<h3><span class="header-section-number">8.10.2</span> Residual analysis</h3>
<p>The following diagram will help you to keep track of what is meant by a residual. Consider the observation marked by the blue dot:</p>
<p><img src="ismaykim_files/figure-html/unnamed-chunk-228-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>Recall that <span class="math inline">\(y_i\)</span> is the observed value of the <code>arr_delay</code> variable (y-position of blue dot), <span class="math inline">\(\widehat{y}_i\)</span> is the fitted value of the <code>arr_delay</code> (value that is being pointed to on the red line), and the residual is <span class="math inline">\(\widehat{\epsilon}_i = y_i - \hat{y}_i\)</span>. We can quickly extract the values of all 50 residuals by using the <code>augment()</code> function in the <code>broom</code> package. Specifically, we are interested in the <code>.fitted</code> and <code>.resid</code> variables. Let’s look at the residuals corresponding to the first six rows of data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">regression_points &lt;-<span class="st"> </span><span class="kw">augment</span>(delay_fit) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(arr_delay, dep_delay, .fitted, .resid)
regression_points %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">head</span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">arr_delay</th>
<th align="right">dep_delay</th>
<th align="right">.fitted</th>
<th align="right">.resid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-38</td>
<td align="right">-3</td>
<td align="right">-17.808</td>
<td align="right">-20.192</td>
</tr>
<tr class="even">
<td align="right">86</td>
<td align="right">69</td>
<td align="right">69.864</td>
<td align="right">16.136</td>
</tr>
<tr class="odd">
<td align="right">-38</td>
<td align="right">3</td>
<td align="right">-10.502</td>
<td align="right">-27.498</td>
</tr>
<tr class="even">
<td align="right">61</td>
<td align="right">53</td>
<td align="right">50.381</td>
<td align="right">10.619</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">12</td>
<td align="right">0.457</td>
<td align="right">2.543</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">2</td>
<td align="right">-11.720</td>
<td align="right">32.720</td>
</tr>
</tbody>
</table>
<p>Let’s begin by analyzing the distribution of the residuals. We would expect the shape of the distribution to be symmetric and roughly bell-shaped with a peak near zero and fewer and fewer values going into the tails on both the left and right sides.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> regression_points, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> .resid)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">10</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="ismaykim_files/figure-html/resid-histogram-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
<p>Next, we create a scatterplot looking at how the fitted values relate to the residual values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> regression_points, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .resid)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:resid-plot"></span>
<img src="ismaykim_files/figure-html/resid-plot-1.png" alt="Fitted versus Residuals plot" width="\textwidth" />
<p class="caption">
Figure 8.15: Fitted versus Residuals plot
</p>
</div>
<p>Lastly, we create a <strong>quantile-quantile</strong> plot that compares the residual values to what would be expected from a bell-shaped distribution (in particular, the normal distribution).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> regression_points, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">sample =</span> .resid)) +
<span class="st">  </span><span class="kw">stat_qq</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:qqplot1"></span>
<img src="ismaykim_files/figure-html/qqplot1-1.png" alt="QQ Plot of residuals" width="\textwidth" />
<p class="caption">
Figure 8.16: QQ Plot of residuals
</p>
</div>
<p><strong>Checking conditions</strong>:</p>
<ol style="list-style-type: decimal">
<li><p>We are looking to see if the points are scattered about the blue line at 0 relatively evenly as we look from left to right in Figure <a href="8-hypo.html#fig:resid-plot">8.15</a>. We have some reason for concern here as the large lump of values on the left are much more dispersed than those on the right.</p></li>
<li><p>The second condition is invalidated if there is a trigonometric pattern of up and down throughout the fitted by residual plot in Figure <a href="8-hypo.html#fig:resid-plot">8.15</a>. That is not the case here.</p></li>
<li><p>We look at the <em>quantile-quantile plot</em> (“Q-Q plot” for short) for the third condition in Figure <a href="8-hypo.html#fig:qqplot1">8.16</a>. We are looking to see if the residuals fall on a straight line with what we would expect if they were normally distributed. We see some curvature here as well. We should begin to wonder if regression was valid here with both condition 1 and condition 3 in question.</p></li>
</ol>
<p>We have reason to doubt whether a linear regression is valid here. Unfortunately, all too frequently regressions are run without checking these assumptions carefully. While small deviations from the assumptions can be OK, larger violations can completely invalidate the results and make any inferences improbable and questionable.</p>
<hr />
</div>
</div>
<div id="conclusion-6" class="section level2">
<h2><span class="header-section-number">8.11</span> Conclusion</h2>
<div id="whats-to-come-6" class="section level3">
<h3><span class="header-section-number">8.11.1</span> What’s to come?</h3>
<p>This chapter examined the basics of hypothesis testing with terminology and also an example of how to apply the “There is Only One Test” diagram to the Lady Tasting Tea example presented in Chapter <a href="7-sim.html#sim">7</a> and to an example on comparing the IMDB ratings of action movies and romance movies. Lastly, we looked at how to use resampling and theory-based methods on regression. We’ll see in Chapter <a href="9-ci.html#ci">9</a> how we can provide a range of possible values for an unknown population parameter instead of just running a Yes/No decision from a hypothesis test.</p>
</div>
<div id="script-of-r-code-5" class="section level3">
<h3><span class="header-section-number">8.11.2</span> Script of R code</h3>
<p>An R script file of all R code used in this chapter is available <a href="https://moderndive.com/scripts/08-hypo.R">here</a>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="7-sim.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="9-ci.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ismayc/moderndiver-book/edit/master/08-hypo.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
