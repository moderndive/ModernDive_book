<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 7 Multiple Regression | Statistical Inference via Data Science</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 7 Multiple Regression | Statistical Inference via Data Science" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://moderndive.com/" />
  <meta property="og:image" content="https://moderndive.com/images/logos/book_cover.png" />
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="github-repo" content="moderndive/moderndive_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Multiple Regression | Statistical Inference via Data Science" />
  
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="twitter:image" content="https://moderndive.com/images/logos/book_cover.png" />

<meta name="author" content="Chester Ismay and Albert Y. Kim">


<meta name="date" content="2019-02-24">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/logos/favicons/apple-touch-icon.png">
  <link rel="shortcut icon" href="images/logos/favicons/favicon.ico" type="image/x-icon">
<link rel="prev" href="6-regression.html">
<link rel="next" href="8-sampling.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#sec:intro-for-students"><i class="fa fa-check"></i><b>1.1</b> Introduction for students</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#subsec:learning-goals"><i class="fa fa-check"></i><b>1.1.1</b> What you will learn from this book</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#subsec:pipeline"><i class="fa fa-check"></i><b>1.1.2</b> Data/science pipeline</a></li>
<li class="chapter" data-level="1.1.3" data-path="index.html"><a href="index.html#subsec:reproducible"><i class="fa fa-check"></i><b>1.1.3</b> Reproducible research</a></li>
<li class="chapter" data-level="1.1.4" data-path="index.html"><a href="index.html#final-note-for-students"><i class="fa fa-check"></i><b>1.1.4</b> Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sec:intro-instructors"><i class="fa fa-check"></i><b>1.2</b> Introduction for instructors</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#who-is-this-book-for"><i class="fa fa-check"></i><b>1.2.1</b> Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#sec:connect-contribute"><i class="fa fa-check"></i><b>1.3</b> Connect and contribute</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#sec:about-book"><i class="fa fa-check"></i><b>1.4</b> About this book</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#sec:about-authors"><i class="fa fa-check"></i><b>1.5</b> About the authors</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-getting-started.html"><a href="2-getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting Started with Data in R</a><ul>
<li class="chapter" data-level="2.1" data-path="2-getting-started.html"><a href="2-getting-started.html#r-rstudio"><i class="fa fa-check"></i><b>2.1</b> What are R and RStudio?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-getting-started.html"><a href="2-getting-started.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-getting-started.html"><a href="2-getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>2.1.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-getting-started.html"><a href="2-getting-started.html#code"><i class="fa fa-check"></i><b>2.2</b> How do I code in R?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-getting-started.html"><a href="2-getting-started.html#programming-concepts"><i class="fa fa-check"></i><b>2.2.1</b> Basic programming concepts and terminology</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-getting-started.html"><a href="2-getting-started.html#errors-warnings-and-messages"><i class="fa fa-check"></i><b>2.2.2</b> Errors, warnings, and messages</a></li>
<li class="chapter" data-level="2.2.3" data-path="2-getting-started.html"><a href="2-getting-started.html#tips-on-learning-to-code"><i class="fa fa-check"></i><b>2.2.3</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-getting-started.html"><a href="2-getting-started.html#packages"><i class="fa fa-check"></i><b>2.3</b> What are R packages?</a><ul>
<li class="chapter" data-level="2.3.1" data-path="2-getting-started.html"><a href="2-getting-started.html#package-installation"><i class="fa fa-check"></i><b>2.3.1</b> Package installation</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-getting-started.html"><a href="2-getting-started.html#package-loading"><i class="fa fa-check"></i><b>2.3.2</b> Package loading</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-getting-started.html"><a href="2-getting-started.html#package-use"><i class="fa fa-check"></i><b>2.3.3</b> Package use</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-getting-started.html"><a href="2-getting-started.html#nycflights13"><i class="fa fa-check"></i><b>2.4</b> Explore your first datasets</a><ul>
<li class="chapter" data-level="2.4.1" data-path="2-getting-started.html"><a href="2-getting-started.html#nycflights13-package"><i class="fa fa-check"></i><b>2.4.1</b> <code>nycflights13</code> package</a></li>
<li class="chapter" data-level="2.4.2" data-path="2-getting-started.html"><a href="2-getting-started.html#flights-data-frame"><i class="fa fa-check"></i><b>2.4.2</b> <code>flights</code> data frame</a></li>
<li class="chapter" data-level="2.4.3" data-path="2-getting-started.html"><a href="2-getting-started.html#exploredataframes"><i class="fa fa-check"></i><b>2.4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="2.4.4" data-path="2-getting-started.html"><a href="2-getting-started.html#identification-vs-measurement-variables"><i class="fa fa-check"></i><b>2.4.4</b> Identification &amp; measurement variables</a></li>
<li class="chapter" data-level="2.4.5" data-path="2-getting-started.html"><a href="2-getting-started.html#help-files"><i class="fa fa-check"></i><b>2.4.5</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-getting-started.html"><a href="2-getting-started.html#conclusion"><i class="fa fa-check"></i><b>2.5</b> Conclusion</a><ul>
<li class="chapter" data-level="2.5.1" data-path="2-getting-started.html"><a href="2-getting-started.html#additional-resources"><i class="fa fa-check"></i><b>2.5.1</b> Additional resources</a></li>
<li class="chapter" data-level="2.5.2" data-path="2-getting-started.html"><a href="2-getting-started.html#whats-to-come"><i class="fa fa-check"></i><b>2.5.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Science via the tidyverse</b></span></li>
<li class="chapter" data-level="3" data-path="3-viz.html"><a href="3-viz.html"><i class="fa fa-check"></i><b>3</b> Data Visualization</a><ul>
<li class="chapter" data-level="" data-path="3-viz.html"><a href="3-viz.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="3.1" data-path="3-viz.html"><a href="3-viz.html#grammarofgraphics"><i class="fa fa-check"></i><b>3.1</b> The Grammar of Graphics</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-viz.html"><a href="3-viz.html#components-of-the-grammar"><i class="fa fa-check"></i><b>3.1.1</b> Components of the Grammar</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-viz.html"><a href="3-viz.html#gapminder"><i class="fa fa-check"></i><b>3.1.2</b> Gapminder data</a></li>
<li class="chapter" data-level="3.1.3" data-path="3-viz.html"><a href="3-viz.html#other-components"><i class="fa fa-check"></i><b>3.1.3</b> Other components</a></li>
<li class="chapter" data-level="3.1.4" data-path="3-viz.html"><a href="3-viz.html#ggplot2-package"><i class="fa fa-check"></i><b>3.1.4</b> ggplot2 package</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-viz.html"><a href="3-viz.html#FiveNG"><i class="fa fa-check"></i><b>3.2</b> Five Named Graphs - The 5NG</a></li>
<li class="chapter" data-level="3.3" data-path="3-viz.html"><a href="3-viz.html#scatterplots"><i class="fa fa-check"></i><b>3.3</b> 5NG#1: Scatterplots</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-viz.html"><a href="3-viz.html#geompoint"><i class="fa fa-check"></i><b>3.3.1</b> Scatterplots via geom_point</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-viz.html"><a href="3-viz.html#overplotting"><i class="fa fa-check"></i><b>3.3.2</b> Over-plotting</a></li>
<li class="chapter" data-level="3.3.3" data-path="3-viz.html"><a href="3-viz.html#summary"><i class="fa fa-check"></i><b>3.3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-viz.html"><a href="3-viz.html#linegraphs"><i class="fa fa-check"></i><b>3.4</b> 5NG#2: Linegraphs</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-viz.html"><a href="3-viz.html#geomline"><i class="fa fa-check"></i><b>3.4.1</b> Linegraphs via geom_line</a></li>
<li class="chapter" data-level="3.4.2" data-path="3-viz.html"><a href="3-viz.html#summary-1"><i class="fa fa-check"></i><b>3.4.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-viz.html"><a href="3-viz.html#histograms"><i class="fa fa-check"></i><b>3.5</b> 5NG#3: Histograms</a><ul>
<li class="chapter" data-level="3.5.1" data-path="3-viz.html"><a href="3-viz.html#geomhistogram"><i class="fa fa-check"></i><b>3.5.1</b> Histograms via geom_histogram</a></li>
<li class="chapter" data-level="3.5.2" data-path="3-viz.html"><a href="3-viz.html#adjustbins"><i class="fa fa-check"></i><b>3.5.2</b> Adjusting the bins</a></li>
<li class="chapter" data-level="3.5.3" data-path="3-viz.html"><a href="3-viz.html#summary-2"><i class="fa fa-check"></i><b>3.5.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="3-viz.html"><a href="3-viz.html#facets"><i class="fa fa-check"></i><b>3.6</b> Facets</a></li>
<li class="chapter" data-level="3.7" data-path="3-viz.html"><a href="3-viz.html#boxplots"><i class="fa fa-check"></i><b>3.7</b> 5NG#4: Boxplots</a><ul>
<li class="chapter" data-level="3.7.1" data-path="3-viz.html"><a href="3-viz.html#geomboxplot"><i class="fa fa-check"></i><b>3.7.1</b> Boxplots via geom_boxplot</a></li>
<li class="chapter" data-level="3.7.2" data-path="3-viz.html"><a href="3-viz.html#summary-3"><i class="fa fa-check"></i><b>3.7.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="3-viz.html"><a href="3-viz.html#geombar"><i class="fa fa-check"></i><b>3.8</b> 5NG#5: Barplots</a><ul>
<li class="chapter" data-level="3.8.1" data-path="3-viz.html"><a href="3-viz.html#barplots-via-geom_bar-or-geom_col"><i class="fa fa-check"></i><b>3.8.1</b> Barplots via geom_bar or geom_col</a></li>
<li class="chapter" data-level="3.8.2" data-path="3-viz.html"><a href="3-viz.html#must-avoid-pie-charts"><i class="fa fa-check"></i><b>3.8.2</b> Must avoid pie charts!</a></li>
<li class="chapter" data-level="3.8.3" data-path="3-viz.html"><a href="3-viz.html#two-categ-barplot"><i class="fa fa-check"></i><b>3.8.3</b> Two categorical variables</a></li>
<li class="chapter" data-level="3.8.4" data-path="3-viz.html"><a href="3-viz.html#summary-4"><i class="fa fa-check"></i><b>3.8.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="3-viz.html"><a href="3-viz.html#conclusion-1"><i class="fa fa-check"></i><b>3.9</b> Conclusion</a><ul>
<li class="chapter" data-level="3.9.1" data-path="3-viz.html"><a href="3-viz.html#summary-table"><i class="fa fa-check"></i><b>3.9.1</b> Summary table</a></li>
<li class="chapter" data-level="3.9.2" data-path="3-viz.html"><a href="3-viz.html#argument-specification"><i class="fa fa-check"></i><b>3.9.2</b> Argument specification</a></li>
<li class="chapter" data-level="3.9.3" data-path="3-viz.html"><a href="3-viz.html#additional-resources-1"><i class="fa fa-check"></i><b>3.9.3</b> Additional resources</a></li>
<li class="chapter" data-level="3.9.4" data-path="3-viz.html"><a href="3-viz.html#whats-to-come-3"><i class="fa fa-check"></i><b>3.9.4</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-wrangling.html"><a href="4-wrangling.html"><i class="fa fa-check"></i><b>4</b> Data Wrangling</a><ul>
<li class="chapter" data-level="" data-path="4-wrangling.html"><a href="4-wrangling.html#needed-packages-1"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.1" data-path="4-wrangling.html"><a href="4-wrangling.html#piping"><i class="fa fa-check"></i><b>4.1</b> The pipe operator: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.2" data-path="4-wrangling.html"><a href="4-wrangling.html#filter"><i class="fa fa-check"></i><b>4.2</b> <code>filter</code> rows</a></li>
<li class="chapter" data-level="4.3" data-path="4-wrangling.html"><a href="4-wrangling.html#summarize"><i class="fa fa-check"></i><b>4.3</b> <code>summarize</code> variables</a></li>
<li class="chapter" data-level="4.4" data-path="4-wrangling.html"><a href="4-wrangling.html#groupby"><i class="fa fa-check"></i><b>4.4</b> <code>group_by</code> rows</a><ul>
<li class="chapter" data-level="4.4.1" data-path="4-wrangling.html"><a href="4-wrangling.html#grouping-by-more-than-one-variable"><i class="fa fa-check"></i><b>4.4.1</b> Grouping by more than one variable</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="4-wrangling.html"><a href="4-wrangling.html#mutate"><i class="fa fa-check"></i><b>4.5</b> <code>mutate</code> existing variables</a></li>
<li class="chapter" data-level="4.6" data-path="4-wrangling.html"><a href="4-wrangling.html#arrange"><i class="fa fa-check"></i><b>4.6</b> <code>arrange</code> and sort rows</a></li>
<li class="chapter" data-level="4.7" data-path="4-wrangling.html"><a href="4-wrangling.html#joins"><i class="fa fa-check"></i><b>4.7</b> <code>join</code> data frames</a><ul>
<li class="chapter" data-level="4.7.1" data-path="4-wrangling.html"><a href="4-wrangling.html#matching-key-variable-names"><i class="fa fa-check"></i><b>4.7.1</b> Matching “key” variable names</a></li>
<li class="chapter" data-level="4.7.2" data-path="4-wrangling.html"><a href="4-wrangling.html#diff-key"><i class="fa fa-check"></i><b>4.7.2</b> Different “key” variable names</a></li>
<li class="chapter" data-level="4.7.3" data-path="4-wrangling.html"><a href="4-wrangling.html#multiple-key-variables"><i class="fa fa-check"></i><b>4.7.3</b> Multiple “key” variables</a></li>
<li class="chapter" data-level="4.7.4" data-path="4-wrangling.html"><a href="4-wrangling.html#normal-forms"><i class="fa fa-check"></i><b>4.7.4</b> Normal forms</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="4-wrangling.html"><a href="4-wrangling.html#other-verbs"><i class="fa fa-check"></i><b>4.8</b> Other verbs</a><ul>
<li class="chapter" data-level="4.8.1" data-path="4-wrangling.html"><a href="4-wrangling.html#select"><i class="fa fa-check"></i><b>4.8.1</b> <code>select</code> variables</a></li>
<li class="chapter" data-level="4.8.2" data-path="4-wrangling.html"><a href="4-wrangling.html#rename"><i class="fa fa-check"></i><b>4.8.2</b> <code>rename</code> variables</a></li>
<li class="chapter" data-level="4.8.3" data-path="4-wrangling.html"><a href="4-wrangling.html#top_n-values-of-a-variable"><i class="fa fa-check"></i><b>4.8.3</b> <code>top_n</code> values of a variable</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="4-wrangling.html"><a href="4-wrangling.html#conclusion-2"><i class="fa fa-check"></i><b>4.9</b> Conclusion</a><ul>
<li class="chapter" data-level="4.9.1" data-path="4-wrangling.html"><a href="4-wrangling.html#summary-table-1"><i class="fa fa-check"></i><b>4.9.1</b> Summary table</a></li>
<li class="chapter" data-level="4.9.2" data-path="4-wrangling.html"><a href="4-wrangling.html#additional-resources-2"><i class="fa fa-check"></i><b>4.9.2</b> Additional resources</a></li>
<li class="chapter" data-level="4.9.3" data-path="4-wrangling.html"><a href="4-wrangling.html#whats-to-come-1"><i class="fa fa-check"></i><b>4.9.3</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-tidy.html"><a href="5-tidy.html"><i class="fa fa-check"></i><b>5</b> Data Importing &amp; “Tidy” Data</a><ul>
<li class="chapter" data-level="" data-path="5-tidy.html"><a href="5-tidy.html#needed-packages-2"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="5.1" data-path="5-tidy.html"><a href="5-tidy.html#csv"><i class="fa fa-check"></i><b>5.1</b> Importing data</a><ul>
<li class="chapter" data-level="5.1.1" data-path="5-tidy.html"><a href="5-tidy.html#using-the-console"><i class="fa fa-check"></i><b>5.1.1</b> Using the console</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-tidy.html"><a href="5-tidy.html#using-rstudios-interface"><i class="fa fa-check"></i><b>5.1.2</b> Using RStudio’s interface</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-tidy.html"><a href="5-tidy.html#tidy-data-ex"><i class="fa fa-check"></i><b>5.2</b> Tidy data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-tidy.html"><a href="5-tidy.html#definition-of-tidy-data"><i class="fa fa-check"></i><b>5.2.1</b> Definition of “tidy” data</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-tidy.html"><a href="5-tidy.html#converting-to-tidy-data"><i class="fa fa-check"></i><b>5.2.2</b> Converting to “tidy” data</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-tidy.html"><a href="5-tidy.html#nycflights13-package-1"><i class="fa fa-check"></i><b>5.2.3</b> <code>nycflights13</code> package</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-tidy.html"><a href="5-tidy.html#case-study-tidy"><i class="fa fa-check"></i><b>5.3</b> Case study: Democracy in Guatemala</a></li>
<li class="chapter" data-level="5.4" data-path="5-tidy.html"><a href="5-tidy.html#conclusion-3"><i class="fa fa-check"></i><b>5.4</b> Conclusion</a><ul>
<li class="chapter" data-level="5.4.1" data-path="5-tidy.html"><a href="5-tidy.html#tidyverse-package"><i class="fa fa-check"></i><b>5.4.1</b> <code>tidyverse</code> package</a></li>
<li class="chapter" data-level="5.4.2" data-path="5-tidy.html"><a href="5-tidy.html#additional-resources-3"><i class="fa fa-check"></i><b>5.4.2</b> Additional resources</a></li>
<li class="chapter" data-level="5.4.3" data-path="5-tidy.html"><a href="5-tidy.html#whats-to-come-2"><i class="fa fa-check"></i><b>5.4.3</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data Modeling via moderndive</b></span></li>
<li class="chapter" data-level="6" data-path="6-regression.html"><a href="6-regression.html"><i class="fa fa-check"></i><b>6</b> Basic Regression</a><ul>
<li class="chapter" data-level="" data-path="6-regression.html"><a href="6-regression.html#needed-packages-3"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="6.1" data-path="6-regression.html"><a href="6-regression.html#model1"><i class="fa fa-check"></i><b>6.1</b> One numerical explanatory variable</a><ul>
<li class="chapter" data-level="6.1.1" data-path="6-regression.html"><a href="6-regression.html#model1EDA"><i class="fa fa-check"></i><b>6.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-regression.html"><a href="6-regression.html#model1table"><i class="fa fa-check"></i><b>6.1.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-regression.html"><a href="6-regression.html#model1points"><i class="fa fa-check"></i><b>6.1.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-regression.html"><a href="6-regression.html#model2"><i class="fa fa-check"></i><b>6.2</b> One categorical explanatory variable</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-regression.html"><a href="6-regression.html#model2EDA"><i class="fa fa-check"></i><b>6.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-regression.html"><a href="6-regression.html#model2table"><i class="fa fa-check"></i><b>6.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-regression.html"><a href="6-regression.html#model2points"><i class="fa fa-check"></i><b>6.2.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-regression.html"><a href="6-regression.html#related-topics"><i class="fa fa-check"></i><b>6.3</b> Related topics</a><ul>
<li class="chapter" data-level="6.3.1" data-path="6-regression.html"><a href="6-regression.html#correlationcoefficient"><i class="fa fa-check"></i><b>6.3.1</b> Correlation coefficient</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-regression.html"><a href="6-regression.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>6.3.2</b> Correlation is not necessarily causation</a></li>
<li class="chapter" data-level="6.3.3" data-path="6-regression.html"><a href="6-regression.html#leastsquares"><i class="fa fa-check"></i><b>6.3.3</b> Best fitting line</a></li>
<li class="chapter" data-level="6.3.4" data-path="6-regression.html"><a href="6-regression.html#underthehood"><i class="fa fa-check"></i><b>6.3.4</b> <code>get_regression_x()</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-regression.html"><a href="6-regression.html#conclusion-4"><i class="fa fa-check"></i><b>6.4</b> Conclusion</a><ul>
<li class="chapter" data-level="6.4.1" data-path="6-regression.html"><a href="6-regression.html#additional-resources-4"><i class="fa fa-check"></i><b>6.4.1</b> Additional resources</a></li>
<li class="chapter" data-level="6.4.2" data-path="6-regression.html"><a href="6-regression.html#whats-to-come-4"><i class="fa fa-check"></i><b>6.4.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html"><i class="fa fa-check"></i><b>7</b> Multiple Regression</a><ul>
<li class="chapter" data-level="" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#needed-packages-4"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="7.1" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#model3"><i class="fa fa-check"></i><b>7.1</b> Two numerical explanatory variables</a><ul>
<li class="chapter" data-level="7.1.1" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#model3EDA"><i class="fa fa-check"></i><b>7.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#model3table"><i class="fa fa-check"></i><b>7.1.2</b> Multiple regression</a></li>
<li class="chapter" data-level="7.1.3" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#model3points"><i class="fa fa-check"></i><b>7.1.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#model4"><i class="fa fa-check"></i><b>7.2</b> One numerical &amp; one categorical explanatory variable</a><ul>
<li class="chapter" data-level="7.2.1" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#model4EDA"><i class="fa fa-check"></i><b>7.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="7.2.2" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#model4table"><i class="fa fa-check"></i><b>7.2.2</b> Multiple regression: Parallel slopes model</a></li>
<li class="chapter" data-level="7.2.3" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#model4interactiontable"><i class="fa fa-check"></i><b>7.2.3</b> Multiple regression: Interaction model</a></li>
<li class="chapter" data-level="7.2.4" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#model4points"><i class="fa fa-check"></i><b>7.2.4</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#related-topics-1"><i class="fa fa-check"></i><b>7.3</b> Related topics</a><ul>
<li class="chapter" data-level="7.3.1" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#correlationcoefficient2"><i class="fa fa-check"></i><b>7.3.1</b> More on the correlation coefficient</a></li>
<li class="chapter" data-level="7.3.2" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#simpsonsparadox"><i class="fa fa-check"></i><b>7.3.2</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#conclusion-5"><i class="fa fa-check"></i><b>7.4</b> Conclusion</a><ul>
<li class="chapter" data-level="7.4.1" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#additional-resources-5"><i class="fa fa-check"></i><b>7.4.1</b> Additional resources</a></li>
<li class="chapter" data-level="7.4.2" data-path="7-multiple-regression.html"><a href="7-multiple-regression.html#whats-to-come-5"><i class="fa fa-check"></i><b>7.4.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Statistical inference via infer</b></span></li>
<li class="chapter" data-level="8" data-path="8-sampling.html"><a href="8-sampling.html"><i class="fa fa-check"></i><b>8</b> Sampling</a><ul>
<li class="chapter" data-level="" data-path="8-sampling.html"><a href="8-sampling.html#needed-packages-5"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="8.1" data-path="8-sampling.html"><a href="8-sampling.html#sampling-activity"><i class="fa fa-check"></i><b>8.1</b> Sampling activity</a><ul>
<li class="chapter" data-level="8.1.1" data-path="8-sampling.html"><a href="8-sampling.html#what-proportion-of-this-bowls-balls-are-red"><i class="fa fa-check"></i><b>8.1.1</b> What proportion of this bowl’s balls are red?</a></li>
<li class="chapter" data-level="8.1.2" data-path="8-sampling.html"><a href="8-sampling.html#using-the-shovel-once"><i class="fa fa-check"></i><b>8.1.2</b> Using the shovel once</a></li>
<li class="chapter" data-level="8.1.3" data-path="8-sampling.html"><a href="8-sampling.html#student-shovels"><i class="fa fa-check"></i><b>8.1.3</b> Using the shovel 33 times</a></li>
<li class="chapter" data-level="8.1.4" data-path="8-sampling.html"><a href="8-sampling.html#what-are-we-doing-here"><i class="fa fa-check"></i><b>8.1.4</b> What are we doing here?</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-sampling.html"><a href="8-sampling.html#sampling-simulation"><i class="fa fa-check"></i><b>8.2</b> Computer simulation</a><ul>
<li class="chapter" data-level="8.2.1" data-path="8-sampling.html"><a href="8-sampling.html#using-the-virtual-shovel-once"><i class="fa fa-check"></i><b>8.2.1</b> Using the virtual shovel once</a></li>
<li class="chapter" data-level="8.2.2" data-path="8-sampling.html"><a href="8-sampling.html#using-the-virtual-shovel-33-times"><i class="fa fa-check"></i><b>8.2.2</b> Using the virtual shovel 33 times</a></li>
<li class="chapter" data-level="8.2.3" data-path="8-sampling.html"><a href="8-sampling.html#using-the-virtual-shovel-1000-times"><i class="fa fa-check"></i><b>8.2.3</b> Using the virtual shovel 1000 times</a></li>
<li class="chapter" data-level="8.2.4" data-path="8-sampling.html"><a href="8-sampling.html#using-different-shovels"><i class="fa fa-check"></i><b>8.2.4</b> Using different shovels</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-sampling.html"><a href="8-sampling.html#sampling-framework"><i class="fa fa-check"></i><b>8.3</b> Sampling framework</a><ul>
<li class="chapter" data-level="8.3.1" data-path="8-sampling.html"><a href="8-sampling.html#terminology-notation"><i class="fa fa-check"></i><b>8.3.1</b> Terminology &amp; notation</a></li>
<li class="chapter" data-level="8.3.2" data-path="8-sampling.html"><a href="8-sampling.html#statistical-definitions"><i class="fa fa-check"></i><b>8.3.2</b> Statistical definitions</a></li>
<li class="chapter" data-level="8.3.3" data-path="8-sampling.html"><a href="8-sampling.html#the-moral-of-the-story"><i class="fa fa-check"></i><b>8.3.3</b> The moral of the story</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8-sampling.html"><a href="8-sampling.html#sampling-case-study"><i class="fa fa-check"></i><b>8.4</b> Case study: Polls</a></li>
<li class="chapter" data-level="8.5" data-path="8-sampling.html"><a href="8-sampling.html#sampling-conclusion"><i class="fa fa-check"></i><b>8.5</b> Conclusion</a><ul>
<li class="chapter" data-level="8.5.1" data-path="8-sampling.html"><a href="8-sampling.html#sampling-conclusion-central-limit-theorem"><i class="fa fa-check"></i><b>8.5.1</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="8.5.2" data-path="8-sampling.html"><a href="8-sampling.html#sampling-conclusion-table"><i class="fa fa-check"></i><b>8.5.2</b> Summary table</a></li>
<li class="chapter" data-level="8.5.3" data-path="8-sampling.html"><a href="8-sampling.html#additional-resources-6"><i class="fa fa-check"></i><b>8.5.3</b> Additional resources</a></li>
<li class="chapter" data-level="8.5.4" data-path="8-sampling.html"><a href="8-sampling.html#whats-to-come-6"><i class="fa fa-check"></i><b>8.5.4</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html"><i class="fa fa-check"></i><b>9</b> Confidence Intervals</a><ul>
<li class="chapter" data-level="" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#needed-packages-6"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="9.1" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#bootstrapping"><i class="fa fa-check"></i><b>9.1</b> Bootstrapping</a><ul>
<li class="chapter" data-level="9.1.1" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#data-explanation"><i class="fa fa-check"></i><b>9.1.1</b> Data explanation</a></li>
<li class="chapter" data-level="9.1.2" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>9.1.2</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="9.1.3" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#bootstrap-process"><i class="fa fa-check"></i><b>9.1.3</b> The Bootstrapping Process</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#the-infer-package-for-statistical-inference"><i class="fa fa-check"></i><b>9.2</b> The infer package for statistical inference</a><ul>
<li class="chapter" data-level="9.2.1" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#specify-variables"><i class="fa fa-check"></i><b>9.2.1</b> Specify variables</a></li>
<li class="chapter" data-level="9.2.2" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#generate-replicates"><i class="fa fa-check"></i><b>9.2.2</b> Generate replicates</a></li>
<li class="chapter" data-level="9.2.3" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#calculate-summary-statistics"><i class="fa fa-check"></i><b>9.2.3</b> Calculate summary statistics</a></li>
<li class="chapter" data-level="9.2.4" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#visualize-the-results"><i class="fa fa-check"></i><b>9.2.4</b> Visualize the results</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#now-to-confidence-intervals"><i class="fa fa-check"></i><b>9.3</b> Now to confidence intervals</a><ul>
<li class="chapter" data-level="9.3.1" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#percentile-method"><i class="fa fa-check"></i><b>9.3.1</b> The percentile method</a></li>
<li class="chapter" data-level="9.3.2" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#the-standard-error-method"><i class="fa fa-check"></i><b>9.3.2</b> The standard error method</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#comparing-bootstrap-and-sampling-distributions"><i class="fa fa-check"></i><b>9.4</b> Comparing bootstrap and sampling distributions</a></li>
<li class="chapter" data-level="9.5" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#interpreting-the-confidence-interval"><i class="fa fa-check"></i><b>9.5</b> Interpreting the confidence interval</a></li>
<li class="chapter" data-level="9.6" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#one-prop-ci"><i class="fa fa-check"></i><b>9.6</b> Example: One proportion</a><ul>
<li class="chapter" data-level="9.6.1" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#observed-statistic"><i class="fa fa-check"></i><b>9.6.1</b> Observed Statistic</a></li>
<li class="chapter" data-level="9.6.2" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#bootstrap-distribution-1"><i class="fa fa-check"></i><b>9.6.2</b> Bootstrap distribution</a></li>
<li class="chapter" data-level="9.6.3" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#theory-based-confidence-intervals"><i class="fa fa-check"></i><b>9.6.3</b> Theory-based confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#example-comparing-two-proportions"><i class="fa fa-check"></i><b>9.7</b> Example: Comparing two proportions</a><ul>
<li class="chapter" data-level="9.7.1" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#compute-the-point-estimate"><i class="fa fa-check"></i><b>9.7.1</b> Compute the point estimate</a></li>
<li class="chapter" data-level="9.7.2" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#bootstrap-distribution-2"><i class="fa fa-check"></i><b>9.7.2</b> Bootstrap distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#conclusion-6"><i class="fa fa-check"></i><b>9.8</b> Conclusion</a><ul>
<li class="chapter" data-level="9.8.1" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#whats-to-come-7"><i class="fa fa-check"></i><b>9.8.1</b> What’s to come?</a></li>
<li class="chapter" data-level="9.8.2" data-path="9-confidence-intervals.html"><a href="9-confidence-intervals.html#script-of-r-code"><i class="fa fa-check"></i><b>9.8.2</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html"><i class="fa fa-check"></i><b>10</b> Hypothesis Testing</a><ul>
<li class="chapter" data-level="" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#needed-packages-7"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#needed-packages-8"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="10.1" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#when-inference-is-not-needed"><i class="fa fa-check"></i><b>10.1</b> When inference is not needed</a></li>
<li class="chapter" data-level="10.2" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#ht-basics"><i class="fa fa-check"></i><b>10.2</b> Basics of hypothesis testing</a></li>
<li class="chapter" data-level="10.3" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#trial"><i class="fa fa-check"></i><b>10.3</b> Criminal trial analogy</a><ul>
<li class="chapter" data-level="10.3.1" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#two-possible-conclusions"><i class="fa fa-check"></i><b>10.3.1</b> Two possible conclusions</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#types-of-errors-in-hypothesis-testing"><i class="fa fa-check"></i><b>10.4</b> Types of errors in hypothesis testing</a><ul>
<li class="chapter" data-level="10.4.1" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#logic-of-hypothesis-testing"><i class="fa fa-check"></i><b>10.4.1</b> Logic of hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#statistical-significance"><i class="fa fa-check"></i><b>10.5</b> Statistical significance</a></li>
<li class="chapter" data-level="10.6" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#hypothesis-testing-with-infer"><i class="fa fa-check"></i><b>10.6</b> Hypothesis testing with infer</a></li>
<li class="chapter" data-level="10.7" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#example-comparing-two-means"><i class="fa fa-check"></i><b>10.7</b> Example: Comparing two means</a><ul>
<li class="chapter" data-level="10.7.1" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#randomizationpermutation"><i class="fa fa-check"></i><b>10.7.1</b> Randomization/permutation</a></li>
<li class="chapter" data-level="10.7.2" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#comparing-action-and-romance-movies"><i class="fa fa-check"></i><b>10.7.2</b> Comparing action and romance movies</a></li>
<li class="chapter" data-level="10.7.3" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#sampling-rightarrow-randomization"><i class="fa fa-check"></i><b>10.7.3</b> Sampling <span class="math inline">\(\rightarrow\)</span> randomization</a></li>
<li class="chapter" data-level="10.7.4" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#data"><i class="fa fa-check"></i><b>10.7.4</b> Data</a></li>
<li class="chapter" data-level="10.7.5" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#model-of-h_0"><i class="fa fa-check"></i><b>10.7.5</b> Model of <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="10.7.6" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#test-statistic-delta"><i class="fa fa-check"></i><b>10.7.6</b> Test statistic <span class="math inline">\(\delta\)</span></a></li>
<li class="chapter" data-level="10.7.7" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#observed-effect-delta"><i class="fa fa-check"></i><b>10.7.7</b> Observed effect <span class="math inline">\(\delta^*\)</span></a></li>
<li class="chapter" data-level="10.7.8" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#simulated-data"><i class="fa fa-check"></i><b>10.7.8</b> Simulated data</a></li>
<li class="chapter" data-level="10.7.9" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#distribution-of-delta-under-h_0"><i class="fa fa-check"></i><b>10.7.9</b> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="10.7.10" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#the-p-value"><i class="fa fa-check"></i><b>10.7.10</b> The p-value</a></li>
<li class="chapter" data-level="10.7.11" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#corresponding-confidence-interval"><i class="fa fa-check"></i><b>10.7.11</b> Corresponding confidence interval</a></li>
<li class="chapter" data-level="10.7.12" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#summary-5"><i class="fa fa-check"></i><b>10.7.12</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#theory-hypo"><i class="fa fa-check"></i><b>10.8</b> Building theory-based methods using computation</a><ul>
<li class="chapter" data-level="10.8.1" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#example-t-test-for-two-independent-samples"><i class="fa fa-check"></i><b>10.8.1</b> Example: <span class="math inline">\(t\)</span>-test for two independent samples</a></li>
<li class="chapter" data-level="10.8.2" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#conditions-for-t-test"><i class="fa fa-check"></i><b>10.8.2</b> Conditions for t-test</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#conclusion-7"><i class="fa fa-check"></i><b>10.9</b> Conclusion</a><ul>
<li class="chapter" data-level="10.9.1" data-path="10-hypothesis-testing.html"><a href="10-hypothesis-testing.html#script-of-r-code-1"><i class="fa fa-check"></i><b>10.9.1</b> Script of R code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html"><i class="fa fa-check"></i><b>11</b> Inference for Regression</a><ul>
<li class="chapter" data-level="" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#needed-packages-9"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="11.1" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#simulation-based-inference-for-regression"><i class="fa fa-check"></i><b>11.1</b> Simulation-based Inference for Regression</a><ul>
<li class="chapter" data-level="11.1.1" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#data-1"><i class="fa fa-check"></i><b>11.1.1</b> Data</a></li>
<li class="chapter" data-level="11.1.2" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#test-statistic-delta-1"><i class="fa fa-check"></i><b>11.1.2</b> Test statistic <span class="math inline">\(\delta\)</span></a></li>
<li class="chapter" data-level="11.1.3" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#observed-effect-delta-1"><i class="fa fa-check"></i><b>11.1.3</b> Observed effect <span class="math inline">\(\delta^*\)</span></a></li>
<li class="chapter" data-level="11.1.4" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#model-of-h_0-1"><i class="fa fa-check"></i><b>11.1.4</b> Model of <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="11.1.5" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#simulated-data-1"><i class="fa fa-check"></i><b>11.1.5</b> Simulated data</a></li>
<li class="chapter" data-level="11.1.6" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#distribution-of-delta-under-h_0-1"><i class="fa fa-check"></i><b>11.1.6</b> Distribution of <span class="math inline">\(\delta\)</span> under <span class="math inline">\(H_0\)</span></a></li>
<li class="chapter" data-level="11.1.7" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#the-p-value-1"><i class="fa fa-check"></i><b>11.1.7</b> The p-value</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#bootstrapping-for-the-regression-slope"><i class="fa fa-check"></i><b>11.2</b> Bootstrapping for the regression slope</a></li>
<li class="chapter" data-level="11.3" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#inference-for-multiple-regression"><i class="fa fa-check"></i><b>11.3</b> Inference for multiple regression</a><ul>
<li class="chapter" data-level="11.3.1" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#refresher-professor-evaluations-data"><i class="fa fa-check"></i><b>11.3.1</b> Refresher: Professor evaluations data</a></li>
<li class="chapter" data-level="11.3.2" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#refresher-visualizations"><i class="fa fa-check"></i><b>11.3.2</b> Refresher: Visualizations</a></li>
<li class="chapter" data-level="11.3.3" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#refresher-regression-tables"><i class="fa fa-check"></i><b>11.3.3</b> Refresher: Regression tables</a></li>
<li class="chapter" data-level="11.3.4" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#script-of-r-code-2"><i class="fa fa-check"></i><b>11.3.4</b> Script of R code</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#residual-analysis"><i class="fa fa-check"></i><b>11.4</b> Residual analysis</a><ul>
<li class="chapter" data-level="11.4.1" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#model1residuals"><i class="fa fa-check"></i><b>11.4.1</b> Residual analysis</a></li>
<li class="chapter" data-level="11.4.2" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#model2residuals"><i class="fa fa-check"></i><b>11.4.2</b> Residual analysis</a></li>
<li class="chapter" data-level="11.4.3" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#model3residuals"><i class="fa fa-check"></i><b>11.4.3</b> Residual analysis</a></li>
<li class="chapter" data-level="11.4.4" data-path="11-inference-for-regression.html"><a href="11-inference-for-regression.html#model4residuals"><i class="fa fa-check"></i><b>11.4.4</b> Residual analysis</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Conclusion</b></span></li>
<li class="chapter" data-level="12" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html"><i class="fa fa-check"></i><b>12</b> Thinking with Data</a><ul>
<li class="chapter" data-level="" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#needed-packages-10"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="12.1" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#seattle-house-prices"><i class="fa fa-check"></i><b>12.1</b> Case study: Seattle house prices</a><ul>
<li class="chapter" data-level="12.1.1" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#house-prices-EDA-I"><i class="fa fa-check"></i><b>12.1.1</b> Exploratory data analysis (EDA)</a></li>
<li class="chapter" data-level="12.1.2" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#log10-transformations"><i class="fa fa-check"></i><b>12.1.2</b> log10 transformations</a></li>
<li class="chapter" data-level="12.1.3" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#eda-part-ii"><i class="fa fa-check"></i><b>12.1.3</b> EDA Part II</a></li>
<li class="chapter" data-level="12.1.4" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#house-prices-regression"><i class="fa fa-check"></i><b>12.1.4</b> Regression modeling</a></li>
<li class="chapter" data-level="12.1.5" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#house-prices-making-predictions"><i class="fa fa-check"></i><b>12.1.5</b> Making predictions</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#data-journalism"><i class="fa fa-check"></i><b>12.2</b> Case study: Effective data storytelling</a><ul>
<li class="chapter" data-level="12.2.1" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#bechdel-test-for-hollywood-gender-representation"><i class="fa fa-check"></i><b>12.2.1</b> Bechdel test for Hollywood gender representation</a></li>
<li class="chapter" data-level="12.2.2" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#us-births-in-1999"><i class="fa fa-check"></i><b>12.2.2</b> US Births in 1999</a></li>
<li class="chapter" data-level="12.2.3" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#other-examples"><i class="fa fa-check"></i><b>12.2.3</b> Other examples</a></li>
<li class="chapter" data-level="12.2.4" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#script-of-r-code-3"><i class="fa fa-check"></i><b>12.2.4</b> Script of R code</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="12-thinking-with-data.html"><a href="12-thinking-with-data.html#concluding-remarks"><i class="fa fa-check"></i>Concluding remarks</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-appendixA.html"><a href="A-appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a><ul>
<li class="chapter" data-level="A.1" data-path="A-appendixA.html"><a href="A-appendixA.html#basic-statistical-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a><ul>
<li class="chapter" data-level="A.1.1" data-path="A-appendixA.html"><a href="A-appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="A-appendixA.html"><a href="A-appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="A-appendixA.html"><a href="A-appendixA.html#standard-deviation"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation</a></li>
<li class="chapter" data-level="A.1.4" data-path="A-appendixA.html"><a href="A-appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="A-appendixA.html"><a href="A-appendixA.html#distribution"><i class="fa fa-check"></i><b>A.1.5</b> Distribution</a></li>
<li class="chapter" data-level="A.1.6" data-path="A-appendixA.html"><a href="A-appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.6</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="A-appendixA.html"><a href="A-appendixA.html#normal-distribution-discussion"><i class="fa fa-check"></i><b>A.2</b> Normal distribution discussion</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-appendixB.html"><a href="B-appendixB.html"><i class="fa fa-check"></i><b>B</b> Inference Examples</a><ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#needed-packages-11"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="B.1" data-path="B-appendixB.html"><a href="B-appendixB.html#inference-mind-map"><i class="fa fa-check"></i><b>B.1</b> Inference mind map</a></li>
<li class="chapter" data-level="B.2" data-path="B-appendixB.html"><a href="B-appendixB.html#one-mean"><i class="fa fa-check"></i><b>B.2</b> One mean</a><ul>
<li class="chapter" data-level="B.2.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement"><i class="fa fa-check"></i><b>B.2.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.2.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses"><i class="fa fa-check"></i><b>B.2.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.2.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data"><i class="fa fa-check"></i><b>B.2.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.2.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods"><i class="fa fa-check"></i><b>B.2.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.2.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods"><i class="fa fa-check"></i><b>B.2.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.2.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results"><i class="fa fa-check"></i><b>B.2.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="B-appendixB.html"><a href="B-appendixB.html#one-proportion"><i class="fa fa-check"></i><b>B.3</b> One proportion</a><ul>
<li class="chapter" data-level="B.3.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-1"><i class="fa fa-check"></i><b>B.3.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.3.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-1"><i class="fa fa-check"></i><b>B.3.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.3.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-1"><i class="fa fa-check"></i><b>B.3.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.3.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-1"><i class="fa fa-check"></i><b>B.3.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-1"><i class="fa fa-check"></i><b>B.3.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.3.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-1"><i class="fa fa-check"></i><b>B.3.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="B-appendixB.html"><a href="B-appendixB.html#two-proportions"><i class="fa fa-check"></i><b>B.4</b> Two proportions</a><ul>
<li class="chapter" data-level="B.4.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-2"><i class="fa fa-check"></i><b>B.4.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.4.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-2"><i class="fa fa-check"></i><b>B.4.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.4.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-2"><i class="fa fa-check"></i><b>B.4.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.4.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-2"><i class="fa fa-check"></i><b>B.4.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.4.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-2"><i class="fa fa-check"></i><b>B.4.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.4.6" data-path="B-appendixB.html"><a href="B-appendixB.html#check-conditions-2"><i class="fa fa-check"></i><b>B.4.6</b> Check conditions</a></li>
<li class="chapter" data-level="B.4.7" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-2"><i class="fa fa-check"></i><b>B.4.7</b> Test statistic</a></li>
<li class="chapter" data-level="B.4.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-2"><i class="fa fa-check"></i><b>B.4.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.4.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-2"><i class="fa fa-check"></i><b>B.4.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-independent-samples"><i class="fa fa-check"></i><b>B.5</b> Two means (independent samples)</a><ul>
<li class="chapter" data-level="B.5.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-3"><i class="fa fa-check"></i><b>B.5.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.5.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-3"><i class="fa fa-check"></i><b>B.5.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.5.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-3"><i class="fa fa-check"></i><b>B.5.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.5.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-3"><i class="fa fa-check"></i><b>B.5.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.5.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-3"><i class="fa fa-check"></i><b>B.5.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.5.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-3"><i class="fa fa-check"></i><b>B.5.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.5.7" data-path="B-appendixB.html"><a href="B-appendixB.html#compute-p-value-1"><i class="fa fa-check"></i><b>B.5.7</b> Compute <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="B.5.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-3"><i class="fa fa-check"></i><b>B.5.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.5.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-3"><i class="fa fa-check"></i><b>B.5.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-paired-samples"><i class="fa fa-check"></i><b>B.6</b> Two means (paired samples)</a><ul>
<li class="chapter" data-level="B.6.1" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-4"><i class="fa fa-check"></i><b>B.6.1</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.6.2" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-4"><i class="fa fa-check"></i><b>B.6.2</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.6.3" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-4"><i class="fa fa-check"></i><b>B.6.3</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.6.4" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-4"><i class="fa fa-check"></i><b>B.6.4</b> Traditional methods</a></li>
<li class="chapter" data-level="B.6.5" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-4"><i class="fa fa-check"></i><b>B.6.5</b> Comparing results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-appendixC.html"><a href="C-appendixC.html"><i class="fa fa-check"></i><b>C</b> Reach for the Stars</a><ul>
<li class="chapter" data-level="" data-path="C-appendixC.html"><a href="C-appendixC.html#needed-packages-12"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="C.1" data-path="C-appendixC.html"><a href="C-appendixC.html#sorted-barplots"><i class="fa fa-check"></i><b>C.1</b> Sorted barplots</a></li>
<li class="chapter" data-level="C.2" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-graphics"><i class="fa fa-check"></i><b>C.2</b> Interactive graphics</a><ul>
<li class="chapter" data-level="C.2.1" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-linegraphs"><i class="fa fa-check"></i><b>C.2.1</b> Interactive linegraphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="D-appendixD.html"><a href="D-appendixD.html"><i class="fa fa-check"></i><b>D</b> Learning Check Solutions</a><ul>
<li class="chapter" data-level="D.1" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-2-solutions"><i class="fa fa-check"></i><b>D.1</b> Chapter 2 Solutions</a></li>
<li class="chapter" data-level="D.2" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-3-solutions"><i class="fa fa-check"></i><b>D.2</b> Chapter 3 Solutions</a></li>
<li class="chapter" data-level="D.3" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-4-solutions"><i class="fa fa-check"></i><b>D.3</b> Chapter 4 Solutions</a></li>
<li class="chapter" data-level="D.4" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-5-solutions"><i class="fa fa-check"></i><b>D.4</b> Chapter 5 Solutions</a></li>
<li class="chapter" data-level="D.5" data-path="D-appendixD.html"><a href="D-appendixD.html#chapter-6-solutions"><i class="fa fa-check"></i><b>D.5</b> Chapter 6 Solutions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Inference via Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img src='https://moderndive.com/wide_format.png' alt="ModernDive">
</html>
<div id="multiple-regression" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Multiple Regression</h1>
<p>In Chapter <a href="6-regression.html#regression">6</a> we introduced ideas related to modeling, in particular that the fundamental premise of modeling is <em>to make explicit the relationship</em> between an outcome variable <span class="math inline">\(y\)</span> and an explanatory/predictor variable <span class="math inline">\(x\)</span>. Recall further the synonyms that we used to also denote <span class="math inline">\(y\)</span> as the dependent variable and <span class="math inline">\(x\)</span> as an independent variable or covariate.</p>
<p>There are many modeling approaches one could take, among the most well-known being linear regression, which was the focus of the last chapter. Whereas in the last chapter we focused solely on regression scenarios where there is only one explanatory/predictor variable, in this chapter, we now focus on modeling scenarios where there is more than one. This case of regression more than one explanatory variable is known as multiple regression. You can imagine when trying to model a particular outcome variable, like teaching evaluation score as in Section <a href="6-regression.html#model1">6.1</a> or life expectancy as in Section <a href="6-regression.html#model2">6.2</a>, it would be very useful to incorporate more than one explanatory variable.</p>
<p>Since our regression models will now consider more than one explanatory/predictor variable, the interpretation of the associated effect of any one explanatory/predictor variables must be made in conjunction with the others. For example, say we are modeling individuals’ incomes as a function of their number of years of education and their parents’ wealth. When interpreting the effect of education on income, one has to consider the effect of their parents’ wealth at the same time, as these two variables are almost certainly related. Make note of this throughout this chapter and as you work on interpreting the results of multiple regression models into the future.</p>
<div id="needed-packages-4" class="section level3 unnumbered">
<h3>Needed packages</h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). Read Section <a href="2-getting-started.html#packages">2.3</a> for information on how to install and load R packages.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(moderndive)
<span class="kw">library</span>(ISLR)
<span class="kw">library</span>(skimr)</code></pre>
<hr />
</div>
<div id="model3" class="section level2">
<h2><span class="header-section-number">7.1</span> Two numerical explanatory variables</h2>
<p>Let’s now attempt to identify factors that are associated with how much credit card debt an individual will have. The textbook <a href="http://www-bcf.usc.edu/~gareth/ISL/">An Introduction to Statistical Learning with Applications in R</a> by Gareth James, Daniela Witten, Trevor Hastie, and Robert Tibshirani is an intermediate-level textbook on statistical and machine learning freely available <a href="http://www-bcf.usc.edu/~gareth/ISL/ISLR%20Seventh%20Printing.pdf">here</a>. It has an accompanying R package called <code>ISLR</code> with datasets that the authors use to demonstrate various machine learning methods. One dataset that is frequently used by the authors is the <code>Credit</code> dataset where predictions are made on the credit card balance held by <span class="math inline">\(n = 400\)</span> credit card holders. These predictions are based on information about them like income, credit limit, and education level. Note that this dataset is not based on actual individuals, it is a simulated dataset used for educational purposes.</p>
<p>Since no information was provided as to who these <span class="math inline">\(n\)</span> = 400 individuals are and how they came to be included in this dataset, it will be hard to make any scientific claims based on this data. Recall our discussion from the previous chapter that correlation does not necessarily imply causation. That being said, we’ll still use <code>Credit</code> to demonstrate multiple regression with:</p>
<ol style="list-style-type: decimal">
<li>A numerical outcome variable <span class="math inline">\(y\)</span>, in this case credit card balance.</li>
<li>Two explanatory variables:
<ol style="list-style-type: decimal">
<li>A first numerical explanatory variable <span class="math inline">\(x_1\)</span>. In this case, their credit limit.</li>
<li>A second numerical explanatory variable <span class="math inline">\(x_2\)</span>. In this case, their income (in thousands of dollars).</li>
</ol></li>
</ol>
<p>In the forthcoming Learning Checks, we’ll consider a different scenario:</p>
<ol style="list-style-type: decimal">
<li>The same numerical outcome variable <span class="math inline">\(y\)</span>: credit card balance.</li>
<li>Two new explanatory variables:
<ol style="list-style-type: decimal">
<li>A first numerical explanatory variable <span class="math inline">\(x_1\)</span>: their credit rating.</li>
<li>A second numerical explanatory variable <span class="math inline">\(x_2\)</span>: their age.</li>
</ol></li>
</ol>
<div id="model3EDA" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Exploratory data analysis</h3>
<p>Let’s load the <code>Credit</code> data and <code>select()</code> only the needed subset of variables.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ISLR)
Credit &lt;-<span class="st"> </span>Credit <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(Balance, Limit, Income, Rating, Age)</code></pre>
<p>Let’s look at the raw data values both by bringing up RStudio’s spreadsheet viewer and the <code>glimpse()</code> function. Although in Table <a href="7-multiple-regression.html#tab:model3-data-preview">7.1</a> we only show 5 randomly selected credit card holders out of 400:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(Credit)</code></pre>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model3-data-preview">TABLE 7.1: </span>Random sample of 5 credit card holders
</caption>
<thead>
<tr>
<th style="text-align:right;">
Balance
</th>
<th style="text-align:right;">
Limit
</th>
<th style="text-align:right;">
Income
</th>
<th style="text-align:right;">
Rating
</th>
<th style="text-align:right;">
Age
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
1551
</td>
<td style="text-align:right;">
22.6
</td>
<td style="text-align:right;">
134
</td>
<td style="text-align:right;">
43
</td>
</tr>
<tr>
<td style="text-align:right;">
1677
</td>
<td style="text-align:right;">
11200
</td>
<td style="text-align:right;">
140.7
</td>
<td style="text-align:right;">
817
</td>
<td style="text-align:right;">
46
</td>
</tr>
<tr>
<td style="text-align:right;">
283
</td>
<td style="text-align:right;">
4270
</td>
<td style="text-align:right;">
36.9
</td>
<td style="text-align:right;">
299
</td>
<td style="text-align:right;">
63
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
3327
</td>
<td style="text-align:right;">
35.0
</td>
<td style="text-align:right;">
253
</td>
<td style="text-align:right;">
54
</td>
</tr>
<tr>
<td style="text-align:right;">
450
</td>
<td style="text-align:right;">
4442
</td>
<td style="text-align:right;">
30.4
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
30
</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(Credit)</code></pre>
<pre><code>Observations: 400
Variables: 5
$ Balance &lt;int&gt; 333, 903, 580, 964, 331, 1151, 203, 872, 279, 1350, 1407, 0, …
$ Limit   &lt;int&gt; 3606, 6645, 7075, 9504, 4897, 8047, 3388, 7114, 3300, 6819, 8…
$ Income  &lt;dbl&gt; 14.9, 106.0, 104.6, 148.9, 55.9, 80.2, 21.0, 71.4, 15.1, 71.1…
$ Rating  &lt;int&gt; 283, 483, 514, 681, 357, 569, 259, 512, 266, 491, 589, 138, 3…
$ Age     &lt;int&gt; 34, 82, 71, 36, 68, 77, 37, 87, 66, 41, 30, 64, 57, 49, 75, 5…</code></pre>
<p>Let’s look at some summary statistics, again using the <code>skim()</code> function from the <code>skimr</code> package:</p>
<pre class="sourceCode r"><code class="sourceCode r">Credit <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Balance, Limit, Income) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">skim</span>()</code></pre>
<pre><code>Skim summary statistics
 n obs: 400 
 n variables: 3 

── Variable type:integer ──────────────────────────────────────────────────────
 variable missing complete   n    mean      sd  p0     p25    p50     p75  p100
  Balance       0      400 400  520.01  459.76   0   68.75  459.5  863     1999
    Limit       0      400 400 4735.6  2308.2  855 3088    4622.5 5872.75 13913
     hist
 ▇▃▃▃▂▁▁▁
 ▅▇▇▃▂▁▁▁

── Variable type:numeric ──────────────────────────────────────────────────────
 variable missing complete   n  mean    sd    p0   p25   p50   p75   p100
   Income       0      400 400 45.22 35.24 10.35 21.01 33.12 57.47 186.63
     hist
 ▇▃▂▁▁▁▁▁</code></pre>
<p>We observe for example:</p>
<ol style="list-style-type: decimal">
<li>The mean and median credit card balance are $520.01 and $459.50 respectively.</li>
<li>25% of card holders had debts of $68.75 or less.</li>
<li>The mean and median credit card limit are $4735.6 and $4622.50 respectively.</li>
<li>75% of these card holders had incomes of $57,470 or less.</li>
</ol>
<p>Since our outcome variable <code>Balance</code> and the explanatory variables <code>Limit</code> and
<code>Income</code> are numerical, we can compute the correlation coefficient between pairs
of these variables. First, we could run the <code>get_correlation()</code> command as seen
in Subsection <a href="6-regression.html#model1EDA">6.1.1</a> twice, once for each explanatory variable:</p>
<pre class="sourceCode r"><code class="sourceCode r">Credit <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">get_correlation</span>(Balance <span class="op">~</span><span class="st"> </span>Limit)
Credit <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">get_correlation</span>(Balance <span class="op">~</span><span class="st"> </span>Income)</code></pre>
<p>Or we can simultaneously compute them by returning a <em>correlation matrix</em> in
Table <a href="7-multiple-regression.html#tab:model3-correlation">7.2</a>. We can read off the correlation coefficient
for any pair of variables by looking them up in the appropriate row/column combination.</p>
<pre class="sourceCode r"><code class="sourceCode r">Credit <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(Balance, Limit, Income) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cor</span>()</code></pre>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model3-correlation">TABLE 7.2: </span>Correlations between credit card balance, credit limit, and income
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Balance
</th>
<th style="text-align:right;">
Limit
</th>
<th style="text-align:right;">
Income
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Balance
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.862
</td>
<td style="text-align:right;">
0.464
</td>
</tr>
<tr>
<td style="text-align:left;">
Limit
</td>
<td style="text-align:right;">
0.862
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.792
</td>
</tr>
<tr>
<td style="text-align:left;">
Income
</td>
<td style="text-align:right;">
0.464
</td>
<td style="text-align:right;">
0.792
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
</tbody>
</table>
<p>For example, the correlation coefficient of:</p>
<ol style="list-style-type: decimal">
<li><code>Balance</code> with itself is 1 as we would expect based on the definition of the correlation coefficient.</li>
<li><code>Balance</code> with <code>Limit</code> is 0.862. This indicates a strong positive linear relationship, which makes sense as only individuals with large credit limits can accrue large credit card balances.</li>
<li><code>Balance</code> with <code>Income</code> is 0.464. This is suggestive of another positive linear relationship, although not as strong as the relationship between <code>Balance</code> and <code>Limit</code>.</li>
<li>As an added bonus, we can read off the correlation coefficient of the two explanatory variables, <code>Limit</code> and <code>Income</code> of 0.792. In this case, we say there is a high degree of <em>collinearity</em> between these two explanatory variables.</li>
</ol>
<p>Collinearity (or multicollinearity) is a phenomenon in which one explanatory variable in a multiple regression model can be linearly predicted from the others with a substantial degree of accuracy. So in this case, if we knew someone’s credit card <code>Limit</code> and since <code>Limit</code> and <code>Income</code> are highly correlated, we could make a fairly accurate guess as to that person’s <code>Income</code>. Or put loosely, these two variables provided redundant information. For now let’s ignore any issues related to collinearity and press on.</p>
<p>Let’s visualize the relationship of the outcome variable with each of the two explanatory variables in two separate plots:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(Credit, <span class="kw">aes</span>(<span class="dt">x =</span> Limit, <span class="dt">y =</span> Balance)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Credit limit (in $)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Credit card balance (in $)&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Relationship between balance and credit limit&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)
  
<span class="kw">ggplot</span>(Credit, <span class="kw">aes</span>(<span class="dt">x =</span> Income, <span class="dt">y =</span> Balance)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Income (in $1000)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Credit card balance (in $)&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Relationship between balance and income&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:2numxplot1"></span>
<img src="ismaykim_files/figure-html/2numxplot1-1.png" alt="Relationship between credit card balance and credit limit/income" width="\textwidth" />
<p class="caption">
FIGURE 7.1: Relationship between credit card balance and credit limit/income
</p>
</div>
<p>First, there is a positive relationship between credit limit and balance, since as credit limit increases so also does credit card balance; this is to be expected given the strongly positive correlation coefficient of 0.862. In the case of income, the positive relationship doesn’t appear as strong, given the weakly positive correlation coefficient of 0.464. However the two plots in Figure <a href="7-multiple-regression.html#fig:2numxplot1">7.1</a> only focus on the relationship of the outcome variable with each of the explanatory variables independently. To get a sense of the <em>joint</em> relationship of all three variables simultaneously through a visualization, let’s display the data in a 3-dimensional (3D) scatterplot, where</p>
<ol style="list-style-type: decimal">
<li>The numerical outcome variable <span class="math inline">\(y\)</span> <code>Balance</code> is on the z-axis (vertical axis)</li>
<li>The two numerical explanatory variables form the “floor” axes. In this case
<ol style="list-style-type: decimal">
<li>The first numerical explanatory variable <span class="math inline">\(x_1\)</span> <code>Income</code> is on of the floor axes.</li>
<li>The second numerical explanatory variable <span class="math inline">\(x_2\)</span> <code>Limit</code> is on the other floor axis.</li>
</ol></li>
</ol>
<p>Click on the following image to open an interactive 3D scatterplot in your browser:</p>
<center>
<a target="_blank" class="page-link" href="https://assets.datacamp.com/production/repositories/1575/datasets/f369dc94041e88effd5ed66512978f8cdfd33801/03-01-slides-interactive_3D_scatterplot_regression_plane.html"><img src="images/credit_card_balance_3D_scatterplot.png" style="width=200%"/></a>
</center>
<p>Previously in Figure <a href="6-regression.html#fig:numxplot4">6.6</a>, we plotted a “best-fitting” regression line through a set of points where the numerical outcome variable <span class="math inline">\(y\)</span> was teaching <code>score</code> and a single numerical explanatory variable <span class="math inline">\(x\)</span> was <code>bty_avg</code>. What is the analogous concept when we have <em>two</em> numerical predictor variables? Instead of a best-fitting line, we now have a best-fitting <em>plane</em>, which is a 3D generalization of lines which exist in 2D. Click <a href="https://beta.rstudioconnect.com/connect/#/apps/3214/">here</a> to open an interactive plot of the regression plane shown below in your browser. Move the image around, zoom in, and think about how this plane generalizes the concept of a linear regression line to three dimensions.</p>
<!-- Need to replace link here since RStudio Connect is Amherst? -->
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-205"></span>
<img src="images/credit_card_balance_regression_plane.png" alt="Regression plane" width="\textwidth" />
<p class="caption">
FIGURE 7.2: Regression plane
</p>
</div>
<!--
<center>
\begin{center}
<center><a target="_blank" class="page-link" href="https://beta.rstudioconnect.com/connect/#/apps/3214/"><img src="images/credit_card_balance_regression_plane.png" style="height: 200px;"/></a></center>
\end{center}
</center>
-->
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.1)</strong> Conduct a new exploratory data analysis with the same outcome variable <span class="math inline">\(y\)</span> being <code>Balance</code> but with <code>Rating</code> and <code>Age</code> as the new explanatory variables <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. Remember, this involves three things:</p>
<ol style="list-style-type: lower-alpha">
<li>Looking at the raw values</li>
<li>Computing summary statistics of the variables of interest.</li>
<li>Creating informative visualizations</li>
</ol>
<p>What can you say about the relationship between a credit card holder’s balance and their credit rating and age?</p>
<!-- CHESTER: I'm not sold on this practice and prefer to assign new variables in R like `Credit_small` instead of overwriting. I seem to remember us agreeing that re-assignment was only OK if we added more variables in Chapter 2-5, not if we chose a subset. We should stay consistent throughout so I'd recommend switching this to a different name as I have with `evals` in Chapters 6 and 7. -->
<div class="learncheck">

</div>
</div>
<div id="model3table" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Multiple regression</h3>
<p>Just as we did when we had a single numerical explanatory variable <span class="math inline">\(x\)</span> in Subsection <a href="6-regression.html#model1table">6.1.2</a> and when we had a single categorical explanatory variable <span class="math inline">\(x\)</span> in Subsection <a href="6-regression.html#model2table">6.2.2</a>, we fit a regression model and obtained the regression table in our two numerical explanatory variable scenario. To fit a regression model and get a table using <code>get_regression_table()</code>, we now use a <code>+</code> to consider multiple explanatory variables. In this case since we want to perform a regression of <code>Limit</code> and <code>Income</code> simultaneously, we input <code>Balance ~ Limit + Income</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">Balance_model &lt;-<span class="st"> </span><span class="kw">lm</span>(Balance <span class="op">~</span><span class="st"> </span>Limit <span class="op">+</span><span class="st"> </span>Income, <span class="dt">data =</span> Credit)
<span class="kw">get_regression_table</span>(Balance_model)</code></pre>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model3-table-output">TABLE 7.3: </span>Multiple regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
-385.179
</td>
<td style="text-align:right;">
19.465
</td>
<td style="text-align:right;">
-19.8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-423.446
</td>
<td style="text-align:right;">
-346.912
</td>
</tr>
<tr>
<td style="text-align:left;">
Limit
</td>
<td style="text-align:right;">
0.264
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
45.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.253
</td>
<td style="text-align:right;">
0.276
</td>
</tr>
<tr>
<td style="text-align:left;">
Income
</td>
<td style="text-align:right;">
-7.663
</td>
<td style="text-align:right;">
0.385
</td>
<td style="text-align:right;">
-19.9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-8.420
</td>
<td style="text-align:right;">
-6.906
</td>
</tr>
</tbody>
</table>
<p>How do we interpret these three values that define the regression plane?</p>
<ul>
<li>Intercept: -$385.18 (rounded to two decimal points to represent cents). The intercept in our case represents the credit card balance for an individual who has both a credit <code>Limit</code> of $0 and <code>Income</code> of $0. In our data however, the intercept has limited practical interpretation as no individuals had <code>Limit</code> or <code>Income</code> values of $0 and furthermore the smallest credit card balance was $0. Rather, it is used to situate the regression plane in 3D space.</li>
<li>Limit: $0.26. Now that we have multiple variables to consider, we have to add
a caveat to our interpretation: <em>taking all other variables in our model into account, for every increase of one unit in credit <code>Limit</code> (dollars), there is an associated increase of on average $0.26 in credit card balance</em>. Note:
<ul>
<li>Just as we did in Subsection <a href="6-regression.html#model1table">6.1.2</a>, we are not making any causal statements, only statements relating to the association between credit limit and balance</li>
<li>We need to preface our interpretation of the associated effect of <code>Limit</code> with the statement “taking all other variables into account”, in this case <code>Income</code>, to emphasize that we are now jointly interpreting the associated effect of multiple explanatory variables in the same model and not in isolation.</li>
</ul></li>
<li>Income: -$7.66. Similarly, <em>taking all other variables into account, for every increase of one unit in <code>Income</code> (in other words, $1000 in income), there is an associated decrease of on average $7.66 in credit card balance</em>.</li>
</ul>
<p>However, recall in Figure <a href="7-multiple-regression.html#fig:2numxplot1">7.1</a> that when considered separately, both <code>Limit</code> and <code>Income</code> had positive relationships with the outcome variable <code>Balance</code>. As card holders’ credit limits increased their credit card balances tended to increase as well, and a similar relationship held for incomes and balances. In the above multiple regression, however, the slope for <code>Income</code> is now -7.66, suggesting a <em>negative relationship</em> between income and credit card balance. What explains these contradictory results?</p>
<p>This is known as Simpson’s Paradox, a phenomenon in which a trend appears in several different groups of data but disappears or reverses when these groups are combined. We expand on this in Subsection <a href="7-multiple-regression.html#simpsonsparadox">7.3.2</a> where we’ll look at the relationship between credit <code>Limit</code> and credit card balance but split by different income bracket groups.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.2)</strong> Fit a new simple linear regression using <code>lm(Balance ~ Rating + Age, data = Credit)</code> where <code>Rating</code> and <code>Age</code> are the new numerical explanatory variables <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. Get information about the “best-fitting” line from the regression table by applying the <code>get_regression_table()</code> function. How do the regression results match up with the results from your exploratory data analysis above?</p>
<div class="learncheck">

</div>
</div>
<div id="model3points" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Observed/fitted values and residuals</h3>
<p>As we did previously in Table <a href="7-multiple-regression.html#tab:model3-points-table">7.4</a>, let’s unpack the output of the <code>get_regression_points()</code> function for our model for credit card balance for all 400 card holders in the dataset. Recall that each card holder corresponds to one of the 400 rows in the <code>Credit</code> data frame and also for one of the 400 3D points in the 3D scatterplots in Subsection <a href="7-multiple-regression.html#model3EDA">7.1.1</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">regression_points &lt;-<span class="st"> </span><span class="kw">get_regression_points</span>(Balance_model)
regression_points</code></pre>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model3-points-table">TABLE 7.4: </span>Regression points (first 5 rows of 400)
</caption>
<thead>
<tr>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
Balance
</th>
<th style="text-align:right;">
Limit
</th>
<th style="text-align:right;">
Income
</th>
<th style="text-align:right;">
Balance_hat
</th>
<th style="text-align:right;">
residual
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
333
</td>
<td style="text-align:right;">
3606
</td>
<td style="text-align:right;">
14.9
</td>
<td style="text-align:right;">
454
</td>
<td style="text-align:right;">
-120.8
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
903
</td>
<td style="text-align:right;">
6645
</td>
<td style="text-align:right;">
106.0
</td>
<td style="text-align:right;">
559
</td>
<td style="text-align:right;">
344.3
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
580
</td>
<td style="text-align:right;">
7075
</td>
<td style="text-align:right;">
104.6
</td>
<td style="text-align:right;">
683
</td>
<td style="text-align:right;">
-103.4
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
964
</td>
<td style="text-align:right;">
9504
</td>
<td style="text-align:right;">
148.9
</td>
<td style="text-align:right;">
986
</td>
<td style="text-align:right;">
-21.7
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
331
</td>
<td style="text-align:right;">
4897
</td>
<td style="text-align:right;">
55.9
</td>
<td style="text-align:right;">
481
</td>
<td style="text-align:right;">
-150.0
</td>
</tr>
</tbody>
</table>
<p>Recall the format of the output:</p>
<ul>
<li><code>Balance</code> corresponds to <span class="math inline">\(y\)</span> (the observed value)</li>
<li><code>Balance_hat</code> corresponds to <span class="math inline">\(\widehat{y}\)</span> (the fitted value)</li>
<li><code>residual</code> corresponds to <span class="math inline">\(y - \widehat{y}\)</span> (the residual)</li>
</ul>
<hr />
</div>
</div>
<div id="model4" class="section level2">
<h2><span class="header-section-number">7.2</span> One numerical &amp; one categorical explanatory variable</h2>
<p>Let’s revisit the instructor evaluation data introduced in Section <a href="6-regression.html#model1">6.1</a>, where we studied the relationship between instructor evaluation scores and their beauty scores. This analysis suggested that there is a positive relationship between <code>bty_avg</code> and <code>score</code>, in other words as instructors had higher beauty scores, they also tended to have higher teaching evaluation scores. Now let’s say instead of <code>bty_avg</code> we are interested in the numerical explanatory variable <span class="math inline">\(x_1\)</span> <code>age</code> and furthermore we want to use a second explanatory variable <span class="math inline">\(x_2\)</span>, the (binary) categorical variable <code>gender</code>.</p>
<p><strong>Note</strong>: This study only focused on the gender binary of <code>&quot;male&quot;</code> or <code>&quot;female&quot;</code> when the data was collected and analyzed years ago. It has been tradition to use gender as an “easy” binary variable in the past in statistical analyses. We have chosen to include it here because of the interesting results of the study, but we also understand that a segment of the population is not included in this dichotomous assignment of gender and we advocate for more inclusion in future studies to show representation of groups that do not identify with the gender binary. We now resume our analyses using this <code>evals</code> data and hope that others find these results interesting and worth further exploration.</p>
<p>Our modeling scenario now becomes</p>
<ol style="list-style-type: decimal">
<li>A numerical outcome variable <span class="math inline">\(y\)</span>. As before, instructor evaluation score.</li>
<li>Two explanatory variables:
<ol style="list-style-type: decimal">
<li>A numerical explanatory variable <span class="math inline">\(x_1\)</span>: in this case, their age.</li>
<li>A categorical explanatory variable <span class="math inline">\(x_2\)</span>: in this case, their binary gender.</li>
</ol></li>
</ol>
<div id="model4EDA" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Exploratory data analysis</h3>
<p>Let’s reload the <code>evals</code> data and <code>select()</code> only the needed subset of variables. Note that these are different than the variables chosen in Chapter 6. Let’s given this the name <code>evals_ch7</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">evals_ch7 &lt;-<span class="st"> </span>evals <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(score, age, gender)</code></pre>
<p>Let’s look at the raw data values both by bringing up RStudio’s spreadsheet viewer and the <code>glimpse()</code> function, although in Table <a href="7-multiple-regression.html#tab:model4-data-preview">7.5</a> we only show 5 randomly selected instructors out of 463:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(evals_ch7)</code></pre>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model4-data-preview">TABLE 7.5: </span>Random sample of 5 instructors
</caption>
<thead>
<tr>
<th style="text-align:right;">
score
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:right;">
3.3
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:right;">
4.4
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:left;">
male
</td>
</tr>
</tbody>
</table>
<p>Let’s look at some summary statistics using the <code>skim()</code> function from the <code>skimr</code> package:</p>
<pre class="sourceCode r"><code class="sourceCode r">evals_ch7 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">skim</span>()</code></pre>
<pre><code>Skim summary statistics
 n obs: 463 
 n variables: 3 

── Variable type:factor ───────────────────────────────────────────────────────
 variable missing complete   n n_unique                top_counts ordered
   gender       0      463 463        2 mal: 268, fem: 195, NA: 0   FALSE

── Variable type:integer ──────────────────────────────────────────────────────
 variable missing complete   n  mean  sd p0 p25 p50 p75 p100     hist
      age       0      463 463 48.37 9.8 29  42  48  57   73 ▅▅▅▇▅▇▂▁

── Variable type:numeric ──────────────────────────────────────────────────────
 variable missing complete   n mean   sd  p0 p25 p50 p75 p100     hist
    score       0      463 463 4.17 0.54 2.3 3.8 4.3 4.6    5 ▁▁▂▃▅▇▇▆</code></pre>
<p>Furthermore, let’s compute the correlation between two numerical variables we have <code>score</code> and <code>age</code>. Recall that correlation coefficients only exist between numerical variables. We observe that they are weakly negatively correlated.</p>
<pre class="sourceCode r"><code class="sourceCode r">evals_ch7 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">get_correlation</span>(<span class="dt">formula =</span> score <span class="op">~</span><span class="st"> </span>age)</code></pre>
<pre><code># A tibble: 1 x 1
  correlation
        &lt;dbl&gt;
1      -0.107</code></pre>
<p>In Figure <a href="7-multiple-regression.html#fig:numxcatxplot1">7.3</a>, we plot a scatterplot of <code>score</code> over <code>age</code>. Given that <code>gender</code> is a binary categorical variable in this study, we can make some interesting tweaks:</p>
<ol style="list-style-type: decimal">
<li>We can assign a color to points from each of the two levels of <code>gender</code>: female and male.</li>
<li>Furthermore, the <code>geom_smooth(method = &quot;lm&quot;, se = FALSE)</code> layer automatically fits a different regression line for each since we have provided <code>color = gender</code> at the top level in <code>ggplot()</code>. This allows for all <code>geom_</code>etries that follow to have the same mapping of <code>aes()</code>thetics to variables throughout the plot.</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(evals_ch7, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> score, <span class="dt">color =</span> gender)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Teaching Score&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Gender&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:numxcatxplot1"></span>
<img src="ismaykim_files/figure-html/numxcatxplot1-1.png" alt="Instructor evaluation scores at UT Austin split by gender (jittered)" width="\textwidth" />
<p class="caption">
FIGURE 7.3: Instructor evaluation scores at UT Austin split by gender (jittered)
</p>
</div>
<p>We notice some interesting trends:</p>
<ol style="list-style-type: decimal">
<li>There are almost no women faculty over the age of 60. We can see this by the lack of red dots above 60.</li>
<li>Fitting separate regression lines for men and women, we see they have different slopes. We see that the associated effect of increasing age seems to be much harsher for women than men. In other words, as women age, the drop in their teaching score appears to be faster.</li>
</ol>
</div>
<div id="model4table" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Multiple regression: Parallel slopes model</h3>
<p>Much like we started to consider multiple explanatory variables using the <code>+</code> sign in Subsection <a href="7-multiple-regression.html#model3table">7.1.2</a>, let’s fit a regression model and get the regression table. This time we provide the name of <code>score_model_2</code> to our regression model fit, in so as to not overwrite the model <code>score_model</code> from Section <a href="6-regression.html#model1table">6.1.2</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">score_model_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(score <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>gender, <span class="dt">data =</span> evals_ch7)
<span class="kw">get_regression_table</span>(score_model_<span class="dv">2</span>)</code></pre>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-220">TABLE 7.6: </span>Regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
4.484
</td>
<td style="text-align:right;">
0.125
</td>
<td style="text-align:right;">
35.79
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
4.238
</td>
<td style="text-align:right;">
4.730
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
-0.009
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
-3.28
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
-0.014
</td>
<td style="text-align:right;">
-0.003
</td>
</tr>
<tr>
<td style="text-align:left;">
gendermale
</td>
<td style="text-align:right;">
0.191
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
3.63
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.087
</td>
<td style="text-align:right;">
0.294
</td>
</tr>
</tbody>
</table>
<p>The modeling equation for this scenario is:</p>
<p><span class="math display">\[\begin{align}
\widehat{y} &amp;= b_0 + b_1 \cdot x_1 + b_2 \cdot x_2 \\
\widehat{\mbox{score}} &amp;= b_0 + b_{\mbox{age}} \cdot \mbox{age} + b_{\mbox{male}} \cdot \mathbb{1}_{\mbox{is male}}(x)
\end{align}\]</span></p>
<p>where <span class="math inline">\(\mathbb{1}_{\mbox{is male}}(x)\)</span> is an <em>indicator function</em> for <code>sex == male</code>. In other words, <span class="math inline">\(\mathbb{1}_{\mbox{is male}}(x)\)</span> equals one if the current observation corresponds to a male professor, and 0 if the current observation corresponds to a female professor. This model can be visualized in Figure <a href="7-multiple-regression.html#fig:numxcatxplot2">7.4</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:numxcatxplot2"></span>
<img src="ismaykim_files/figure-html/numxcatxplot2-1.png" alt="Instructor evaluation scores at UT Austin by gender: same slope" width="\textwidth" />
<p class="caption">
FIGURE 7.4: Instructor evaluation scores at UT Austin by gender: same slope
</p>
</div>
<p>We see that:</p>
<ul>
<li>Females are treated as the baseline for comparison for no other reason than “female” is alphabetically earlier than “male.” The <span class="math inline">\(b_{male} = 0.1906\)</span> is the vertical “bump” that men get in their teaching evaluation scores. Or more precisely, it is the average difference in teaching score
that men get <em>relative to the baseline of women</em>.</li>
<li>Accordingly, the intercepts (which in this case make no sense since no instructor can have an age of 0) are :
<ul>
<li>for women: <span class="math inline">\(b_0\)</span> = 4.484</li>
<li>for men: <span class="math inline">\(b_0 + b_{male}\)</span> = 4.484 + 0.191 = 4.675</li>
</ul></li>
<li>Both men and women have the same slope. In other words, <em>in this model</em> the associated effect of age is the same for men and women. So for every increase of one year in age, there is on average an associated change of <span class="math inline">\(b_{age}\)</span> = -0.009 (a decrease) in teaching score.</li>
</ul>
<p>But wait, why is Figure <a href="7-multiple-regression.html#fig:numxcatxplot2">7.4</a> different than Figure <a href="7-multiple-regression.html#fig:numxcatxplot1">7.3</a>! What is going on? What we have in the original plot is known as an <em>interaction effect</em> between age and gender. Focusing on fitting a model for each of men and women, we see that the resulting regression lines are different. Thus, <code>gender</code> appears to interact in different ways for men and women with the different values of <code>age</code>.</p>
</div>
<div id="model4interactiontable" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Multiple regression: Interaction model</h3>
<p>We say a model has an <em>interaction effect</em> if the associated effect of one variable <em>depends on the value of another variable</em>. These types of models usually prove to be tricky to view on first glance because of their complexity. In this case, the effect of <code>age</code> will depend on the value of <code>gender</code>. Put differently, the effect of age on teaching scores will differ for men and for women, as was suggested by the different slopes for men and women in our visual exploratory data analysis in Figure <a href="7-multiple-regression.html#fig:numxcatxplot1">7.3</a>.</p>
<p>Let’s fit a regression with an interaction term. Instead of using the <code>+</code> sign in the enumeration of explanatory variables, we use the <code>*</code> sign. Let’s fit this regression and save it in <code>score_model_3</code>, then we get the regression table using the <code>get_regression_table()</code> function as before.</p>
<pre class="sourceCode r"><code class="sourceCode r">score_model_interaction &lt;-<span class="st"> </span><span class="kw">lm</span>(score <span class="op">~</span><span class="st"> </span>age <span class="op">*</span><span class="st"> </span>gender, <span class="dt">data =</span> evals_ch7)
<span class="kw">get_regression_table</span>(score_model_interaction)</code></pre>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-222">TABLE 7.7: </span>Regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
4.883
</td>
<td style="text-align:right;">
0.205
</td>
<td style="text-align:right;">
23.80
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
4.480
</td>
<td style="text-align:right;">
5.286
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
-0.018
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
-3.92
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
-0.026
</td>
<td style="text-align:right;">
-0.009
</td>
</tr>
<tr>
<td style="text-align:left;">
gendermale
</td>
<td style="text-align:right;">
-0.446
</td>
<td style="text-align:right;">
0.265
</td>
<td style="text-align:right;">
-1.68
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
-0.968
</td>
<td style="text-align:right;">
0.076
</td>
</tr>
<tr>
<td style="text-align:left;">
age:gendermale
</td>
<td style="text-align:right;">
0.014
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
2.45
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.024
</td>
</tr>
</tbody>
</table>
<p>The modeling equation for this scenario is:</p>
<p><span class="math display">\[\begin{align}
\widehat{y} &amp;= b_0 + b_1 \cdot x_1 + b_2 \cdot x_2 + b_3 \cdot x_1 \cdot x_2\\
\widehat{\mbox{score}} &amp;= b_0 + b_{\mbox{age}} \cdot \mbox{age} + b_{\mbox{male}} \cdot \mathbb{1}_{\mbox{is male}}(x) + b_{\mbox{age,male}} \cdot \mbox{age} \cdot \mathbb{1}_{\mbox{is male}}(x)
\end{align}\]</span></p>
<p>Oof, that’s a lot of rows in the regression table output and a lot of terms in the model equation. The fourth term being added on the right hand side of the equation corresponds to the <em>interaction term</em>. Let’s simplify things by considering men and women separately. First, recall that <span class="math inline">\(\mathbb{1}_{\mbox{is male}}(x)\)</span> equals 1 if a particular observation (or row in <code>evals_ch7</code>) corresponds to a male instructor. In this case, using the values from the regression table the fitted value of <span class="math inline">\(\widehat{\mbox{score}}\)</span> is:</p>
<p><span class="math display">\[\begin{align}
\widehat{\mbox{score}} &amp;= b_0 + b_{\mbox{age}} \cdot \mbox{age} + b_{\mbox{male}} \cdot \mathbb{1}_{\mbox{is male}}(x) + b_{\mbox{age,male}} \cdot \mbox{age} \cdot \mathbb{1}_{\mbox{is male}}(x) \\
&amp;= b_0 + b_{\mbox{age}} \cdot \mbox{age} + b_{\mbox{male}} \cdot 1 + b_{\mbox{age,male}} \cdot \mbox{age} \cdot 1 \\
&amp;= \left(b_0 + b_{\mbox{male}}\right) + \left(b_{\mbox{age}} +  b_{\mbox{age,male}} \right) \cdot \mbox{age} \\
&amp;= \left(4.883 + -0.446\right) + \left(-0.018 +  0.014 \right) \cdot \mbox{age} \\
&amp;= 4.437 -0.004 \cdot \mbox{age}
\end{align}\]</span></p>
<p>Second, recall that <span class="math inline">\(\mathbb{1}_{\mbox{is male}}(x)\)</span> equals 0 if a particular observation corresponds to a female instructor. Again, using the values from the regression table the fitted value of <span class="math inline">\(\widehat{\mbox{score}}\)</span> is:</p>
<p><span class="math display">\[\begin{align}
\widehat{\mbox{score}} &amp;= b_0 + b_{\mbox{age}} \cdot \mbox{age} + b_{\mbox{male}} \cdot \mathbb{1}_{\mbox{is male}}(x) + b_{\mbox{age,male}} \cdot \mbox{age} \cdot \mathbb{1}_{\mbox{is male}}(x) \\
&amp;= b_0 + b_{\mbox{age}} \cdot \mbox{age} + b_{\mbox{male}} \cdot 0 + b_{\mbox{age,male}}\mbox{age} \cdot 0 \\
&amp;= b_0 + b_{\mbox{age}} \cdot \mbox{age}\\
&amp;= 4.883 -0.018 \cdot \mbox{age}
\end{align}\]</span></p>
<p>Let’s summarize these values in a table:</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-223">TABLE 7.8: </span>Comparison of male and female intercepts and age slopes
</caption>
<thead>
<tr>
<th style="text-align:left;">
Gender
</th>
<th style="text-align:right;">
Intercept
</th>
<th style="text-align:right;">
Slope for age
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Male instructors
</td>
<td style="text-align:right;">
4.44
</td>
<td style="text-align:right;">
-0.004
</td>
</tr>
<tr>
<td style="text-align:left;">
Female instructors
</td>
<td style="text-align:right;">
4.88
</td>
<td style="text-align:right;">
-0.018
</td>
</tr>
</tbody>
</table>
<p>We see that while male instructors have a lower intercept, as they age, they have a less steep associated average decrease in teaching scores: 0.004 teaching score units per year as opposed to -0.018 for women. This is consistent with the different slopes and intercepts of the red and blue regression lines fit in Figure <a href="7-multiple-regression.html#fig:numxcatxplot1">7.3</a>. Recall our definition of a model having an interaction effect: when the associated effect of one variable, in this case <code>age</code>, depends on the value of another variable, in this case <code>gender</code>.</p>
<p>But how do we know when it’s appropriate to include an interaction effect? For example, which is the more appropriate model? The regular multiple regression model without an interaction term we saw in Section <a href="7-multiple-regression.html#model4table">7.2.2</a> or the multiple regression model with the interaction term we just saw? We’ll revisit this question in Chapter <a href="11-inference-for-regression.html#inference-for-regression">11</a> on “inference for regression.”</p>
</div>
<div id="model4points" class="section level3">
<h3><span class="header-section-number">7.2.4</span> Observed/fitted values and residuals</h3>
<p>Now say we want to apply the above calculations for male and female instructors for all 463 instructors in the <code>evals_ch7</code> dataset. As our multiple regression models get more and more complex, computing such values by hand gets more and more tedious. The <code>get_regression_points()</code> function spares us this tedium and returns all fitted values and all residuals. For simplicity, let’s focus only on the fitted interaction model, which is saved in <code>score_model_interaction</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">regression_points &lt;-<span class="st"> </span><span class="kw">get_regression_points</span>(score_model_interaction)
regression_points</code></pre>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model4-points-table">TABLE 7.9: </span>Regression points (first 5 rows of 463)
</caption>
<thead>
<tr>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
score
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
gender
</th>
<th style="text-align:right;">
score_hat
</th>
<th style="text-align:right;">
residual
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
4.25
</td>
<td style="text-align:right;">
0.448
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4.1
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
4.25
</td>
<td style="text-align:right;">
-0.152
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.9
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
4.25
</td>
<td style="text-align:right;">
-0.352
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4.8
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
4.25
</td>
<td style="text-align:right;">
0.548
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
4.20
</td>
<td style="text-align:right;">
0.399
</td>
</tr>
</tbody>
</table>
<p>Recall the format of the output:</p>
<ul>
<li><code>score</code> corresponds to <span class="math inline">\(y\)</span> the observed value</li>
<li><code>score_hat</code> corresponds to <span class="math inline">\(\widehat{y} = \widehat{\mbox{score}}\)</span> the fitted value</li>
<li><code>residual</code> corresponds to the residual <span class="math inline">\(y - \widehat{y}\)</span></li>
</ul>
<hr />
</div>
</div>
<div id="related-topics-1" class="section level2">
<h2><span class="header-section-number">7.3</span> Related topics</h2>
<div id="correlationcoefficient2" class="section level3">
<h3><span class="header-section-number">7.3.1</span> More on the correlation coefficient</h3>
<p>Recall from Table <a href="7-multiple-regression.html#tab:model3-correlation">7.2</a> that we saw the correlation
coefficient between <code>Income</code> in thousands of dollars and credit card <code>Balance</code>
was 0.464. What if in instead we looked at the correlation coefficient between
<code>Income</code> and credit card <code>Balance</code>, but where <code>Income</code> was in dollars and not
thousands of dollars? This can be done by multiplying <code>Income</code> by 1000.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ISLR)
<span class="kw">data</span>(Credit)
Credit <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Balance, Income) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Income =</span> Income <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">cor</span>()</code></pre>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:cor-credit-2">TABLE 7.10: </span>Correlation between income (in dollars) and credit card balance
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Balance
</th>
<th style="text-align:right;">
Income
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Balance
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.464
</td>
</tr>
<tr>
<td style="text-align:left;">
Income
</td>
<td style="text-align:right;">
0.464
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
</tbody>
</table>
<p>We see it is the same! We say that the correlation coefficient is invariant to linear
transformations! In other words,</p>
<ul>
<li>the correlation between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> will be the same as</li>
<li>the correlation between <span class="math inline">\(a\times x + b\)</span> and <span class="math inline">\(y\)</span> where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are numerical values (real numbers in mathematical terms).</li>
</ul>
</div>
<div id="simpsonsparadox" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Simpson’s Paradox</h3>
<p>Recall in Section <a href="7-multiple-regression.html#model3">7.1</a>, we saw the two following seemingly contradictory results when studying the relationship between credit card balance, credit limit, and income. On the one hand, the right hand plot of Figure <a href="7-multiple-regression.html#fig:2numxplot1">7.1</a> suggested that credit card balance and income were positively related:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-226"></span>
<img src="ismaykim_files/figure-html/unnamed-chunk-226-1.png" alt="Relationship between credit card balance and credit limit/income" width="\textwidth" />
<p class="caption">
FIGURE 7.5: Relationship between credit card balance and credit limit/income
</p>
</div>
<p>On the other hand, the multiple regression in Table <a href="7-multiple-regression.html#tab:model3-table-output">7.3</a>, suggested that when modeling credit card balance as a function of both credit limit and income at the same time, credit limit has a negative relationship with balance, as evidenced by the slope of -7.66. How can this be?</p>
<p>First, let’s dive a little deeper into the explanatory variable <code>Limit</code>. Figure <a href="7-multiple-regression.html#fig:credit-limit-quartiles">7.6</a> shows a histogram of all 400 values of <code>Limit</code>, along with vertical red lines that cut up the data into quartiles, meaning:</p>
<ol style="list-style-type: decimal">
<li>25% of credit limits were between $0 and $3088. Let’s call this the “low” credit limit bracket.</li>
<li>25% of credit limits were between $3088 and $4622. Let’s call this the “medium-low” credit limit bracket.</li>
<li>25% of credit limits were between $4622 and $5873. Let’s call this the “medium-high” credit limit bracket.</li>
<li>25% of credit limits were over $5873. Let’s call this the “high” credit limit bracket.</li>
</ol>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center"><span id="fig:credit-limit-quartiles"></span>
<img src="ismaykim_files/figure-html/credit-limit-quartiles-1.png" alt="Histogram of credit limits and quartiles" width="\textwidth" />
<p class="caption">
FIGURE 7.6: Histogram of credit limits and quartiles
</p>
</div>
<p>Let’s now display</p>
<ol style="list-style-type: decimal">
<li>The scatterplot showing the relationship between credit card balance and limit (the right-hand plot of Figure <a href="7-multiple-regression.html#fig:2numxplot1">7.1</a>).</li>
<li>The scatterplot showing the relationship between credit card balance and limit now with a color aesthetic added corresponding to the credit limit bracket.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:2numxplot4"></span>
<img src="ismaykim_files/figure-html/2numxplot4-1.png" alt="Relationship between credit card balance and income for different credit limit brackets" width="\textwidth" />
<p class="caption">
FIGURE 7.7: Relationship between credit card balance and income for different credit limit brackets
</p>
</div>
<p>In the right-hand plot, the</p>
<ul>
<li>Red points (bottom-left) correspond to the low credit limit bracket.</li>
<li>Green points correspond to the medium-low credit limit bracket.</li>
<li>Blue points correspond to the medium-high credit limit bracket.</li>
<li>Purple points (top-right) correspond to the high credit limit bracket.</li>
</ul>
<p>The left-hand plot focuses of the relationship between balance and income in aggregate, but the right-hand plot focuses on the relationship between balance and income <em>broken down by credit limit bracket</em>. Whereas in aggregate there is an overall positive relationship, when broken down we now see that for the low (red points), medium-low (green points), and medium-high (blue points) income bracket groups, the strong positive relationship between credit card balance and income disappears! Only for the high bracket does the relationship stay somewhat positive. In this example, credit limit is a <em>confounding variable</em> for credit card balance and income.</p>
<!--
Alternatively, we could also have used facets, where each facet has roughly 25% of people based
on the credit limit bracket. However, IMO the above plot is easier to read.

<div class="figure" style="text-align: center">
<img src="ismaykim_files/figure-html/2numxplot5-1.png" alt="Relationship between credit card balance and income for different credit limit brackets" width="\textwidth" />
<p class="caption">(\#fig:2numxplot5)Relationship between credit card balance and income for different credit limit brackets</p>
</div>
-->
<hr />
</div>
</div>
<div id="conclusion-5" class="section level2">
<h2><span class="header-section-number">7.4</span> Conclusion</h2>
<div id="additional-resources-5" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Additional resources</h3>
<p>An R script file of all R code used in this chapter is available <a href="scripts/07-multiple-regression.R">here</a>.</p>
</div>
<div id="whats-to-come-5" class="section level3">
<h3><span class="header-section-number">7.4.2</span> What’s to come?</h3>
<p>Congratulations! We’re ready to proceed to the third portion of this book: “statistical inference” using a new package called <code>infer</code>. Once we’ve covered Chapters <a href="8-sampling.html#sampling">8</a> on sampling, <a href="9-confidence-intervals.html#confidence-intervals">9</a> on confidence intervals, and <a href="10-hypothesis-testing.html#hypothesis-testing">10</a> on hypothesis testing, we’ll come back to the models we’ve seen in “data modeling” in Chapter <a href="11-inference-for-regression.html#inference-for-regression">11</a> on inference for regression. As we said at the end of Chapter <a href="6-regression.html#regression">6</a>, we’ll see why we’ve been conducting the residual analyses from Subsections <a href="11-inference-for-regression.html#model3residuals">11.4.3</a> and <a href="11-inference-for-regression.html#model4residuals">11.4.4</a>. We are actually verifying some very important assumptions that must be met for the <code>std_error</code> (standard error), <code>p_value</code>, <code>conf_low</code> and <code>conf_high</code> (the end-points of the confidence intervals) columns in our regression tables to have valid interpretation. Up next:</p>
<center>
<img src="images/flowcharts/flowchart/flowchart.006.png" title="ModernDive flowchart" width="800"/>
</center>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="6-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="8-sampling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/moderndive/moderndive_book/edit/master/07-multiple-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
